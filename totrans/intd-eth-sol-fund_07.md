© Chris Dannen 2017Chris Dannen 介绍以太坊和 Solidity10.1007/978-1-4842-2535-6_7

# 7. 加密经济学调查

在安全计算机网络上进行的经济活动研究被称为加密经济学 Chris Dannen^(1 )(1)美国纽约州布鲁克林让我们暂停一下挖矿和部署，谈谈一些涉及以太坊的设计选择，特别是围绕其经济激励和惩罚系统的选择。总的来说，以太坊的这个方面与博弈论领域重叠，博弈论研究在涉及冲突和合作的情况下的理性、智能决策。博弈论被用于经济学、国防规划、心理学、政治科学、生物学，甚至用于赌博研究(!)作为研究、分析和预测人类和计算机在一个已知系统内工作行为的方法学。这本书是关于理解以太坊网络的目的，以及如何连接到它的。我们很幸运，不需要成为数学家才能做到这一点。如果你碰巧是其中之一，并且想要更深入地了解这个简短但重要章节中的概念，可以参考以太坊白皮书和黄皮书，分别位于以下 URL：

+   [`github.com/ethereum/wiki/wiki/White-Paper`](https://github.com/ethereum/wiki/wiki/White-Paper)

+   [`gavwood.com/paper.pdf`](http://gavwood.com/paper.pdf)

## 我们是如何到达这里的

密码技术以某种方式存在了数千年，作为发送编码消息的一种方式，但密码学的研究只是在二战后的几十年内才正式成为一门学科。在那场战争中，盟军能够拦截和破解轴心国恩尼格玛机传输的莫尔斯密码加密消息，这一因素被艾森豪威尔将军认为是盟军胜利的决定性因素¹。如今，随着数字通信的发展，我们不再依赖于模糊的模拟无线电频谱进行传输，那里的信息可能会随着干扰的嘶嘶声和混乱而不断出现和消失。我们可以在许多设备和协议之间获得清晰、明确的数字信号。今天我们所知道的数字通信时代是由密码分析，也称为破译代码，引入的。由此产生的新的信息理论领域使现代计算机、计算机语言和网络成为现实，几十年前它们是未来发明家构想的产物。

### 新技术创造新经济

信息理论的伟大承诺是确定性和隐私。1 和 0 使计算机能够发送无误的信号；我们可以相信计算机每次执行相同的代码都会以相同的方式进行，从而实现我们今天所享受的高度自动化。加密学使得在信息传播过程中保持信号的含义对于发送者和接收者来说是私密的成为可能，即使消息穿越全球，沿途经过许多网络——其中一些可能配备了间谍装置。为了保护他们在网络上发送的信息，今天的计算机可以使用比 1945 年左右的恩格玛机强得多的加密强度来加密信息。密码消息传递可以宽泛地定义为在不可信环境中的通信，或者在任何您的信息容易被利用或破坏的情况下。战争是一个例子，但工业间谍活动、宗教迫害，甚至自然灾害也是如此。经济学领域通常研究人与人之间的互动，有时在敌对的环境中，比如战争。加密经济学这一新兴领域是研究在对抗性环境中通过网络协议进行的经济活动。加密经济学的领域包括以下内容：

+   在线信任

+   在线声誉

+   密码安全的通信

+   去中心化应用程序

+   货币或资产作为网络服务（可以这么说）

+   对等金融合同（智能合约）

+   网络数据库共识协议

+   反垃圾邮件和反 Sybil 攻击算法

在 Sybil 攻击中，攻击者会向对等网络中注入大量伪匿名身份，以获取不成比例的影响力。这对于点对点网络来说是一个显著的漏洞。第六章中描述的 51%攻击类似于 Sybil 攻击。正如你将看到的，你可能称之为应用密码经济学的大部分内容都是创建一个具有可行激励和惩罚措施的游戏化系统，这种系统创建了一种稳定的紧张关系，使网络保持运行。

### 游戏规则

构建密码经济系统（公共区块链开发者）的人每天都在思考这些网络应该如何运作。这些假设大多是基于对其他加密网络协议的现实生活经验的过去和现在。这些假设如下：

+   警惕中心化：任何持有接近 25%网络挖矿算力或加密货币本身的两个个体都危险地接近能够诱导敌意分叉并破坏网络完整性。

+   大多数人是理性的：但是，每个网络都会有一些难以理解行为方式的用户配额。其中一些人可能会试图故意或出于某种不可思议的意外而破坏网络。

+   大型网络中有人员进出：这会在网络流量和用户使用中产生起伏，但是一些用户会保持并维持高水平的活动。

+   无法进行审查：合约可以信任它们从其他合约接收到完整的消息。

+   节点可以自由交流：任何两个节点都可以快速轻松地传递消息。

+   债务和负面声誉主张无法强制执行：因为任何使用公共链的人都可以随时创建新的钱包地址，某些类型的社区只能存在于由软件合约或中央机构控制的限量发行钱包地址的私有链上。

尽管许多这些假设适用于比特币，但它并没有充分利用它们来解决人类今天面临的所有各种问题。它在长期债务工具的创建方面的不灵活性，比如债券或抵押贷款，只是一个例子，说明了人类活动的一个主要领域——债务融资——比特币似乎不太适合。这并不是对比特币的抨击，而是承认了它作为全球流动支付层的优势。它不是一种存储媒介，也不是一种有用的商品，也不是财富的显著标志。货币价值的表达在人类文化中是很多的，发现新的货币形式部分是推动当前围绕加密经济学的活动热潮的原因。

## 加密经济学有何用处？

首先，应用加密经济学是关于在公共网络和各种攻击者之间构建一层防御的工程。它结合了博弈理论系统设计、加密和密码哈希，以保护一个常用的、常操作的资源——在本例中是全球交易状态机。由于公共链是公开的，它们需要对具有大量计算能力的攻击者具有韧性。因此，拥有更多节点、更分布式的节点，由离散的不相关的所有者拥有，被认为更安全。挖矿池有助于中心化，这就是为什么任何拥有超过 25%哈希算力的矿池都接近网络威胁门槛的原因。如果出现两个这样的矿池，它们可能很快就能控制一个网络。通过使用定制的、抗 ASIC 的 Ethash 算法，并设计网络快速增加难度，协议设计者确保了矿工进行专业化和整合的动机很小。

### 理解哈希与加密的区别

回想一下第一章中提到，区块链由三种构成技术组合而成。它们如下：

+   密码哈希

+   不对称公钥密码学

+   分布式 P2P 计算

在上一章中，你了解到每个区块头都包含整个链的根哈希，以及区块中交易的哈希。区块头中的这两个数据用于创建一个加密种子，进而生成 DAG 文件，扩展到 1 GB，并作为一种弹出式配料盘用于工作量证明算法，该算法将从 DAG 中的数据块中哈希出的数据块一起进行哈希，以寻找一个获胜的 nonce 值来验证该区块。**请注意** 大公司也从公共链中受益，因为它们可以抵消安全、私有应用数据层的巨大成本。在 2017 年 2 月 28 日在纽约布鲁克林举行的以太坊企业联盟启动仪式上，以太坊联合创始人乔·卢宾指出，对于大型组织来说，“在没有公共组件的区块链上构建是没有意义的，因为从私有到公共的加密经济学几乎是不可能的。”这两个过程都是算法的：一些信息输入，不同的信息输出。但它们用于不同的目的。

### 加密

我们在本书中已经谈到了加密，但让我们复习一下：以太坊和比特币账户都使用一对密码学密钥，一个公钥和一个私钥，来加密发送到它们各自虚拟机的交易。（这两个网络都使用了称为 secp256k1 曲线的相同算法进行加密。）回想一下，这被称为公钥加密，也称为非对称加密。这与对称加密形成对比，对称加密中，双方共享一个公钥和一个私钥，就像你和配偶可能共享一个地址并拥有重复的家用钥匙一样。对称加密模式是当今大多数服务器使用的模式。当服务器通信时，它们通常使用相同的私钥来互相验证。只有当你信任交易另一端的服务器能够保持这个私钥——这个私钥对双方来说都是有价值的——不被任何破坏者知晓时，这才是安全的。加密将一个人类可读的字母或数字字符串转换为一个由随机字母和数字组成的不可读的块，但有一个重要的警告。加密算法产生的密文没有固定的长度。Pretty Good Privacy (PGP) 和 Advanced Encryption Standard (AES) 是用于此目的的流行算法。RSA 加密算法是全球 IT 部门中另一个广泛使用的标准。然而，有时这些流行加密算法生成的公钥可能非常长且难以管理。以太坊使用与比特币相同的基于椭圆曲线的加密协议，也称为 ECDSA 算法，它具有安全性和简洁性的优势：ECDSA 允许更小的密钥尺寸，从而减少了存储需求和传输要求。然而，Vitalik Buterin 表示该协议未来可能会从目前的 ECDSA 实现转向提供更高安全性的其他东西。

#### 加密的弱点

然而，加密也有其弱点。首先，它以占用大量 CPU 资源而著称。其次，私钥可能在密码学上是安全的，但并不免于人为失误的影响。私钥必须小心管理。事实上，美国国家标准与技术研究院（NIST）根据数据或需要保护的密钥的敏感性提供了密码键的生命周期指南，以及所保护的数据量（或密钥对）。² 需要注意的是，如果你不希望任何人解密你的消息，加密并不是你的最佳选择。事实上，私钥的存在实际上在暗示你的信息迟早会被解锁，大概率是由你本人，但也有可能被任何获取到私钥的人！

### 哈希算法

哈希比加密更安全，至少在没有私钥可以将哈希“逆向”为其原始可读形式的意义上更安全。因此，如果一台机器不需要知道数据集的内容，那么它应该给予数据集的哈希值。哈希算法与加密算法一样接收数据，但它们生成固定长度的字符串或数字。在大数据集中只改变一个字符将导致哈希值完全不同。基本上不可能将哈希数据还原为其原始形式。流行的哈希算法包括 MD5、SHA-1 和 SHA-2。以太坊和比特币协议都使用 SHA-256，这是目前最强大的哈希算法。

#### 哈希有什么用处

如果你认识以 SHA 开头的那些哈希算法的名称，可能是因为当你连接到 Wi-Fi 并输入密码时，你在智能手机或计算机的网络接口上见过它们。由于哈希本质上是单向的，它们非常适合比较两个秘密值而不泄露它们是什么。因此，如果你的计算机对 Wi-Fi 密码进行哈希处理并将其交给了知道密码的 Wi-Fi 路由器，它应该对密码本身进行哈希处理并获得相同的结果。这证实了你有正确的密码并且被允许连接。这里的优势在于网络上窥探的任何人都看不到密码，只能看到哈希值。

## 为什么区块速度很重要

第六章将一个块定义为一个时间段：确切地说是 15 秒。挖矿过程中的许多子程序都被设计为保持这个块时间。然而，我们并没有停下来问这个块时间是否比比特币的 10 分钟块“更好”，或者它是否仅仅是以太坊协议工作方式的特征。你应该知道的一个事实是全球比特币节点的延迟。根据 2013 年一支学术团队的测量，大约 95%的节点可以在 12.6 秒内到达。这个数字与块大小成正比，所以在一个“更快”的块时间货币中，你可以拥有一个更响应的网络。然而，短时间内快速的块在安全性上不如慢速的块。但是从好的方面来说，它们产生了快速的确认时间；换句话说，它们受益于更多信息的细化。因此，虽然节点可能最初更容易被愚弄，但是在几代人内，它们被强烈地吸引到“真正”的链上。更快的块比更慢的块成比例地不安全的想法是错误的。要了解更多关于块时间速度如何影响各种网络特性的信息，请阅读以太坊博客上的这篇文章：[`blog.ethereum.org/2015/09/14/on-slow-and-fast-block-times/`](https://blog.ethereum.org/2015/09/14/on-slow-and-fast-block-times/) 。

## 以太发行方案

网络创建以太来支付矿工。然而，一些以太在 2014 年中期预售以启动网络的资金。大约有 6000 万 ETH 以不同价格出售，每比特币 1000 至 2000 ETH 不等。（约有 10％分配给以太坊基金会，另有 10％在预售时保留为储备。）从预售开始，系统每年将以 1560 万以太的形式向矿工支付奖励。以太永远不会停止发行，但每年发行的数量是总发行量的一个越来越小的百分比。正如您在图 7-1 中所见，曲线在 2014 年至 2015 年间有一个小小的上升，这表示了预售期间。因此，以太的发行方案是通货膨胀的（就数量而言，而不是价格），直到大约 2025 年，之后是数量上的紧缩。以太的价格取决于市场需求和 EVM 上的时间。就像汽油一样，价格波动主要取决于人们驾驶的量或者谁通过交易操纵价格！

## 常见攻击场景

接下来，我们将简要讨论以太坊协议如何应对 P2P 网络中的一些最常见的攻击向量。正如我们在 EVM 探索的第三章中所介绍的，状态转换函数受限于每个区块的有限计算步骤。如果执行时间较长，则会被中断，并且这些状态更改将被撤销。但是，仍然会向矿工支付这些被撤销的更改的费用。通过加密经济学的视角来看，协议中这种设计决策的合理性变得显而易见。以太坊白皮书使用以下示例来演示其规范在网络遭受攻击时的有用性：

+   如果攻击者向矿工发送包含无限循环的合同，那么最终 gas 将用尽。然而，从矿工的角度来看，交易仍然是有效的，因为矿工可以为程序每一步的计算要求攻击者支付费用。

+   即使攻击者试图支付适当的 gas 费用来维持矿工的工作，矿工也会发现 STARTGAS 值过高，并且事先知道计算将需要太多步骤。

+   想象一下，一个攻击者对他的 gas 支付非常小心：攻击者发送的合同代码刚好足够提款，但不足以使账户余额减少。这类似于双重支付攻击，因为它无中生有地创造了资金。然而，在以太坊中，这个交易将被完全回滚，因为它在中途用光了 gas。

### 机器之间的社会证明

将机器视为社会的概念有点奇怪，但机器的网络就是如此：始终保持交流。工作量证明有点像人类之间的社会证明。社会证明是一种一致行为，其中一个个体——不确定如何行事——模仿那些似乎更懂行的人的行为。在许多情况下，这意味着模仿大多数人的行为。这种现象怎么可能保护一个网络？嗯，在以太坊和比特币网络中，“真实”的交易顺序只是大多数节点说是真实的顺序。它不过是那样简单。这就是为什么 51% 攻击是一个真实现象的原因：它是一个巨大的诱因，任何人都可以启动大多数矿工，并分叉网络以开始获取价值。能够阻止它发生的原因只是这种攻击的巨大成本——绝对的无利可图性。购买、租赁或运行数千吉哈希的计算能力都是昂贵的。

### 网络规模扩大时的安全性

如今，以太币的市值虽然很小，但如果全球网络服务的一小部分开始使用它，以太币的价值可能会超过其自然的通货紧缩。然而，如果你将以太币视为一种商品，即用于支付 EVM 上的应用托管成本的燃料，那么以太币的价格并不重要。随着价格的涨跌，会吸引投机者和市场制造商，他们会在交易量过度的时期使波动性更高。这反过来会改变矿工的利润率，他们可能会选择关闭节点，直到以太币的价格再次带来净利润。波动性为恶意节点运营者和金融市场制造商串通创造了可能性，他们会压低价格以减少网络算力，然后打开一个整个矿场，试图将链分叉为一个新的状态——同时进行一次双重花费。截至目前，这种勾结尚未成功，也许永远不会成功。已经有许多知名华尔街银行宣布了以太坊开发计划，这些计划将在内部运行或与外部顾问合作，因此网络的稳健性每一天都在减少疑虑。

## 更多关于加密经济学的内容

本节标题来自 Vitalik Buterin 在 Reddit 上发布的一篇帖子，其中他列出了另外四种攻击场景，并对它们可能的发生方式提出了一些想法。你可以在 [www.reddit.com/r/ethereum/comments/453sid/empirical_cryptoeconomics/](https://www.reddit.com/r/ethereum/comments/453sid/empirical_cryptoeconomics/) 找到这些内容。如果你对加密经济活动的文化影响感兴趣，可以阅读 CoMakery 创始人 Noah Thorp 的这篇文章：[`medium.com/@noahthorp/how-society-will-be-transformed-by-crypto-economics-b02b6765ca8c#.e10qayhio`](https://medium.com/@noahthorp/how-society-will-be-transformed-by-crypto-economics-b02b6765ca8c#.e10qayhio)。

## 摘要

本章的简洁性是经济学这一子类别的新颖性的一个指示。尽管新颖，但随着每种加密货币都有其自身的发行参数，它必然会变得复杂。要对未来有所指导，或许可以参考美联储，看看这些问题在未来几十年可能如何解决。2015 年初，圣路易斯联邦储备银行的大卫·安多尔法托在一篇博客文章中写道，美国央行可能有理由考虑发行一种国家加密货币。他描述如下：

> 想象一下，作为核心开发者，美联储提供一种名为 Fedcoin 的开源比特币协议（适当修改）。关键在于：美联储有能力可信地固定 Fedcoin 与美元的汇率（汇率可以是任何数值，但假设为 1:1）。我为何要声称美联储在发行（例如）以美元支持的 BTC 并以固定汇率进行交换的私营企业上具有比较优势？这类企业的问题正是那些试图单方面将其货币与其他货币固定汇率的国家所面临的问题。单方面固定汇率制度本质上是不稳定的，因为固定 BTC/USD 汇率的机构无法可信地承诺不会因应对各种规模的赎回潮而用光美元储备。实际上，这种结构会引发投机性攻击。 ⁴

在那年早些时候在法兰克福举行的一次讲话中，他首次提出了这些提案，并将该系统称为全面的 Fedwire。 幸运的是，您可能会回想起我们在第三章中对 Fedwire 系统的讨论，以及我们对 EVM 的讨论。 接下来，我们将回到命令行，并学习 dapps 是如何部署的。脚注 1F.W. Winterbotham，《Ultra Secret：Operation Ultra，Bletchley Park 和 Enigma 的内幕故事》（伦敦：Orion Publishers，2000）。2NIST，“密钥管理建议”，[`www.nist.gov/node/563271`](https://www.nist.gov/node/563271)，2012 年。3 瑞士联邦理工学院苏黎世，“比特币网络中的信息传播”，[www.tik.ee.ethz.ch/file/49318d3f56c1d525aabf7fda78b23fc0/P2P2013_041.pdf](http://www.tik.ee.ethz.ch/file/49318d3f56c1d525aabf7fda78b23fc0/P2P2013_041.pdf)，2013 年。4MacroMania，“FedCoin：政府加密货币的可取性”，[`andolfatto.blogspot.co.uk/2015/02/fedcoin-on-desirability-of-government.html`](http://andolfatto.blogspot.co.uk/2015/02/fedcoin-on-desirability-of-government.html)，2015 年。
