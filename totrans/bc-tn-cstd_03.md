©作者（们），受 APress Media, LLC 独家授权，Springer Nature 2023B.吴，B.吴青少年区块链[`doi.org/10.1007/978-1-4842-8808-5_3`](https://doi.org/10.1007/978-1-4842-8808-5_3)

# 3. 比特币：货币的未来

布莱恩·吴（Brian Wu）和布丽吉特·吴（Bridget Wu）(1) 新泽西州，美国

从古代吕底亚人，他们发明了硬币作为支付方式，到中国的第一张纸币，货币和支付已经发展了数百年。2008 年，一个使用化名中本聪的匿名个人或团体发表了一份名为《比特币：一种点对点电子现金系统》的白皮书。自那时起，比特币（BTC）引领了去中心化数字货币和区块链技术的新时代。因此，近年来数字货币的受欢迎程度激增。目前大约有 20,000 种加密货币，总市值接近 1.2 万亿美元。作为最早和最有价值的加密货币，比特币占据了整个加密货币市场的约 45%。第二大加密货币是以太坊，市场份额为 16%。比特币的价格多年来波动不定，但总体呈上升趋势。2021 年 11 月，比特币达到了有史以来最高价，为 68,789.63 美元。

作为一种新的支付技术发明，比特币是一种稀缺资源，因为在区块链中只能挖掘出 2100 万个比特币。这种稀缺性以及其他因素，如供求关系，赋予了比特币价值，使比特币成为所有加密货币中的数字黄金。

前几章为介绍区块链基础提供了极好的起点，我们涵盖了诸如密码学、PoW 共识算法以及区块链如何工作的许多基本概念。在本章中，我们将继续探讨比特币。我们将涵盖以下具体主题：

+   比特币历史

+   了解比特币

+   交易

+   闪电网络

## 比特币历史

截至 2022 年 7 月，有超过 1 亿零 6 百万个比特币所有者，每天有 199,000 个已确认的活跃比特币交易。大约有 3400 万美国成年人和全球人口的 10%拥有加密货币。近年来，加密货币的受欢迎程度急剧上升。然而，如果你只了解一种加密货币，那么你应该首先了解比特币，因为当人们谈论数字货币时，大多数人通常指的是比特币。作为世界上第一种加密货币，比特币不是第一个尝试创建新的数字货币金融系统的项目。在其创建之前，许多项目尝试建立数字货币和/或电子支付系统。其中两个项目，DigiCash 和 HashCash，主要启发了比特币。

### 早期尝试

大卫· Chaum 在 1982 年的 CRYPTO 会议上发表了一篇名为《用于不可追踪支付的盲签名》的论文。盲签名描述了如何使用一种新型的数字签名来保护数字现金用户的隐私。

为了说明这个盲选过程，大卫使用了一个电子投票系统作为例子，说明选举投票中心应该验证所有选票。

在验证过程中，选民的选择隐私消息必须得到保护。除了选民之外，没有人知道他/她的选择。盲选过程如下描述：

1.  1.

    选民将填写好的匿名盲选票放入一张碳纸衬里的信封中，信封外面预先打印有选民的身份证。

1.  2.

    官员们验证文件的凭证。

1.  3.

    官员们在不知道消息内容的情况下对盲选票进行签名。

1.  4.

    一旦选票被签名，信封就被退还给选民。

1.  5.

    选民将已签名的选票放入一个新的、未标记的、普通的信封中。

1.  6.

    这样，选民的秘密和隐私可以得到保护。

流程图在图 3-1 中展示。![](img/535492_1_En_3_Fig1_HTML.png)

一个图表描述了 6 个投票步骤。通过盲选票进行身份验证，通过盲选票验证凭证，对盲选票进行签名，取消盲选票，投票，以及验证投票。

图 3-1

盲选示例

七年后，大卫·查姆（David Chaum）在阿姆斯特丹成立了一家名为 DigiCash 的公司。数字货币，也称为 DigiCash、eCash 或 EMoney，是第一种数字匿名货币。1994 年，DigiCash 证明了可以在互联网上发送小额支付。不幸的是，大卫·查姆和他的公司在 1998 年申请破产，以及他们革命性的*eCash*的终结。

随着 1990 年代互联网的日益普及，许多公司很快认识到它是一个极佳的广告工具。甚至在 1997 年后期，电子邮件垃圾邮件已经成为任何拥有电子邮件账户的人的一个严重问题。任何人都可以以几乎零成本发送数百万封电子邮件，广告公司可以使用群发邮件软件每天发送大量电子邮件。电子邮件炸弹，一种针对邮件服务器的拒绝服务攻击（DoS），始于 1990 年代末，经常导致网络瘫痪。

亚当·巴克（Adam Back）于 1997 年创建了 HashCash，并使用工作量证明（PoW）算法来防止电子邮件垃圾邮件和 DoS 攻击。它对比特币产生了重要影响，在比特币中用于交易。在比特币白皮书里，中本聪引用了 HashCash 系统作为比特币中工作量证明实现的参考：

> 为了在点对点的基础上实现分布式时间戳服务器，我们将需要使用类似于亚当·巴克（Adam Back）的 HashCash 的证明-工作量系统，而不是报纸或 Usenet 帖子。

HashCash 的工作量证明相对简单。

首先，邮件服务器选择一个难度级别来指定 PoW 必须有多难。在 HashCash 启用的 SHA-1 散列摘要中，工作量证明从默认的 20 个零二进制开始。

SHA-1 是一种加密散列函数，它接收输入并产生一个 160 位值。总共有可能的 2¹⁶⁰个散列值。如果我们使前 30 位为 0，发送者必须尝试 2³⁰个不同的二进制计数器，以找到一个具有 30 个前导零位的散列值。前导零位越多，找到有效散列值对越困难，解决问题所需的时间也越长。

十六进制中的一个前导零等于四个二进制中的 0。我们可以使用在线 SHA-1 工具和暴力方法来生成带有“Hashcash!”的前导零。我们从 0 开始一次。以下是尝试不同输入的结果。表 3-1

生成一个十六进制的前导零

| 十六进制值 | 输入文本 |
| --- | --- |
| 64a0565c8ef97e847d444c6961086c2ccdad9052 | Hashcash!00 |
| 6e7072540d426f7bdc3d589dfd73aeac0e3050a9 | Hashcash!01 |
| 0e4895d7a9ef022e313d72a1c5636e51a2f8dca | Hashcash!02 |
| cf4d1b9d11cef8f1067e6e43b5593439fb412df9 | Hashcash!03 |
| e2185e4362440d1a9f41f58f50032097f195aeb1 | Hashcash!04 |
| 05e82b6afcf3f6a4a81ba01cf9c6e44c2e16e244 | Hashcash!05 |

正如我们所看到的，我们需要尝试六次才能猜出一个前导零。想象一下，在默认值为 20，前导零位为 5（2⁵）的情况下，需要做更多的工作。

为了解决这个工作量证明问题，发送者需要不断尝试不同的输入，直到他们找出具有正确前导零的 HashCash 头部。然后发送者可以向接收者发送电子邮件。

当接收者收到一封电子邮件时，它会首先检查其有效的 HashCash 头部，该头部包含所需的前导零位数。接收者只需计算一次散列值，然后将其保存到数据库中。当收到新电子邮件时，它只需比较数据库中的前一个头部版本。因此，验证邮票所需的时间比找到一个有效的邮票要少得多。如果电子邮件验证失败，它将被移动到垃圾邮件文件夹。

### 2008 年金融危机

在 20 世纪 90 年代末和 21 世纪初，美国经济实现了强劲稳定的增长，失业率低，股市飙升。这得益于快速的技术变革和中央银行联邦基金利率从 6.5%降至 1.75%。

联邦基金利率的显著下降使得银行和贷款机构能够以更低的价格提供消费者信贷。在这一时期，许多创新性的贷款产品，如次级抵押贷款增加了。银行和贷款机构向许多信用记录不良、资产很少、收入不稳定或具有其他否定因素的房主提供低利率的抵押贷款。

随着这些高风险（次级）贷款的涌入，贷款方可以轻松地承担所有风险并获得抵押贷款，从而危及整个银行系统和全球经济。随着房价持续飙升，次级抵押贷款的比例急剧增长，大部分抵押贷款进入了违约状态，许多银行和贷款机构开始面临财务困难。2007 年 8 月，投资银行巨头雷曼兄弟的股价因两家贝尔斯登对冲基金的失败而急剧下跌。2008 年 3 月，贝尔斯登破产，六个月后，雷曼申请破产。这场危机导致了 Great Recession，房价下跌了 30%以上，数百万人失去了工作，大约有 250 万家企业倒闭。美国家庭受到的打击尤为严重，预计净资产损失达到 16 万亿美元。

金融危机动摇了人们对金融体系的信心和信任，人们将钱存放在中央银行系统这样的中央权威机构中。中央政府的权威可以印刷更多的货币，因此政府可以印刷无限量的货币。这将降低系统中流通货币的价值。中央银行根据现代货币理论（MMT）原则印刷货币。宽松的货币政策有时会导致人们对货币价值下降的不确定性和不可预测性。

人们开始考虑一种新的金融体系，以克服传统货币的不足。新系统可以要求一种不依赖于第三方信任，如中央银行权威的货币。

#### 比特币的诞生

2008 年 8 月，比特币项目的两名第一位开发者，中本聪（Satoshi Nakamoto）和马蒂·马尔米（Martti Malmi）注册了比特币.org。2008 年 10 月 31 日，一个名为中本聪的实体在比特币.org 上发表了一篇名为《比特币：一种点对点的电子现金系统》的白皮书。中本聪提出了一种使用点对点网络防止双重花费的解决方案。该系统引入了一种工作量证明（Proof of Work，PoW）共识算法，消除了对中央银行或政府财政的需求。

在传统的集中式金融体系中，物理复制黄金或把一盎司黄金变成两盎司是不可能的。这就是黄金作为价值储存手段的原因，并且可以作为商品货币用来交换商品。

政府发行的纸币不易复制。例如，要复制一张美元钞票，需要特殊的设备、正确的货币纸张，以及许多其他材料，如安全线和水印。使纸币成为合法的法定货币需要一个非常繁琐、安全且复杂的过程。

当使用实物货币时，当你买东西时，你会把黄金或纸币作为支付证明交给某人。由于货币是以实物形式给出的，双方可以立即验证交易。钱从你这边转移到了另一边，你不能花同样的钱两次。

双重花费是数字货币交易中的一个问题，数字货币或资产是一组可以被复制并发送给多个收件人的软件代码。一个集中式的方法通常涉及一个审计员（比如银行），负责监督和控制货币的发行、分发和验证。因此，通常需要做大量工作来保证集中式权威没有双重花费，这导致了数字货币交易上的手续费成本。

2009 年 1 月 3 日，第一个比特币创世区块（区块 0）由中本聪本人挖掘，代表了加密货币的生日。这里是来自 blockchain.com 的比特币创世区块详情的链接 [www.blockchain.com/btc/block/0](http://www.blockchain.com/btc/block/0)。

这个区块包含了一条来自中本聪的信息。让我们找出它是什么，以及你如何可以亲自验证这些信息。

通过打开上述创世区块链接，你会发现有一个“交易”部分。点击散列链接，它将导航到交易页面。在“输入”部分下，你应该找到一个从 5468652054696 开始的很长的十六进制密钥，如图 3-2 所示。![](img/535492_1_En_3_Fig2_HTML.png)

一条文本信息解释了输入内容，包括索引、地址、公钥脚本、签名脚本、详情和值。签名脚本被突出显示。

图 3-2

中本聪的比特币创世区块交易输入

复制这个编码的十六进制字符串。现在，去在线十六进制解码页面：[`cryptii.com/pipes/hex-decoder`](https://cryptii.com/pipes/hex-decoder)。解码来自中本聪的这条信息。

如果你做得正确，你的屏幕应该看起来像图 3-3 一样。![](img/535492_1_En_3_Fig3_HTML.png)

一条消息显示了文本和字节，解释了 Chancellor 正处于第二次银行救助的边缘的新闻。

图 3-3

来自中本聪的第一笔交易的信息

我们已经揭示了中本聪隐藏的信息。它写道：“《泰晤士报》03/Jan/2009 Chancellor on the brink of second bailout for banks。”同样的文本出现在比特币原始代码的第 1616 行注释中：

[`sourceforge.net/p/bitcoin/code/133/tree/trunk/main.cpp#l1613`](https://sourceforge.net/p/bitcoin/code/133/tree/trunk/main.cpp%2523l1613)

这条信息可能证明区块时间是在同一天挖出的，指的是英国的一份报纸《泰晤士报》关于大规模政府支出的报道。或者，它可能表明大型中央银行对中本聪来说是一个问题。

创世区块包含了有史以来创建的第一个 50 个比特币，奖励地址为：1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa。

2009 年 1 月 12 日，中本聪向哈尔·芬尼发送了 10 个比特币，作为挖掘区块-70 的第一笔官方比特币交易。

#### 早期发展

**比特币披萨日** **（2010 年 5 月）——** 在 2010 年 5 月 22 日，一位名叫拉斯洛·汉耶茨的比特币迷和程序员在加密货币论坛上发布了一个不寻常的请求，以 10,000 个比特币——当时据报道价值 40 美元——换取送两份必胜客披萨。加利福尼亚州的学生杰里米·斯图尔特注意到这个有趣的请求，并用 10,000 BTC 向拉斯洛·汉耶茨出售了两份披萨。这是历史上首次使用比特币进行的实体购买，被每年的 5 月 22 日的比特币披萨日所认可！[](../images/535492_1_En_3_Chapter/535492_1_En_3_Fig4_HTML.jpg)

照片显示了两份必胜客披萨。

图 3-4

两份必胜客披萨价值 10,000 比特币。

**第一个比特币交易所（2010 年 7 月）——** 在 2010 年 7 月，Mt. Gox 在东京推出了第一个加密货币交易所，一度成为世界上最大的比特币交易所。Mt. Gox 是“Magic: The Gathering Online Exchange”的缩写，有时被称为 MtGox 或 Mt Gox。在巅峰时期，Mt. Gox 处理了超过 70% 的比特币交易。

**第一个比特币挖矿池（2010 年 9 月）——** 在比特币的早期，挖矿是简单的。你可以轻松地用个人电脑生成 50 个比特币。当更多的参与者加入网络，一些人开始使用 GPU 挖矿时，区块生成的速度比预期的要快。比特币网络自动调整了挖矿的难度级别。为了使挖矿更有利可图和高效，在 2010 年 9 月，Marek Palatinus（许多人称之为“slush”）推出了世界上第一个比特币挖矿池：Slush Pool，原名 Bitcoin.cz。在 12 月 16 日，该池在首次运营的 24 小时内挖掘了三个区块。

**第一个比特币在线商店（2011 年 2 月）——** 在 2011 年 2 月，Silk Road 推出了第一个接受比特币支付的在线商店。Silk Road 也是第一个现代暗网市场。暗网市场是提供毒品、被盗信息、武器和服务等非法商品的黑网市场，通常使用加密货币作为支付方式。

Silk Road 是由 Ross William Ulbricht 创立的，他在 2013 年被捕，目前因在 Silk Road 中的角色正在监狱中服刑两个无期徒刑。联邦调查局最终在 2013 年关闭了 Silk Road。

**美元平价（2011 年 2 月）——** 2011 年 2 月 9 日是一个比特币信徒长期期待的历史性日子。比特币达到了 1 美元。这是 2011 年 1 月 11 日比特币论坛成员“jimbobway”的预测。他说，“当一个比特币达到 1 美元时，我们需要庆祝...我称之为‘平价派对’。你将为你的派对做什么？”

**莱特币（2011 年 10 月）** —— 2011 年 10 月，前谷歌工程师查理·李（Charlie Lee）创建了莱特币（LTC），这是一种从比特币区块链分叉而来的加密货币。莱特币最初设计用于实现快速支付，区块时间更短，交易吞吐量更高。与比特币的 10 分钟一个区块相比，莱特币大约每 2.5 分钟一个区块。比特币使用 SHA-256 加密算法，而莱特币使用 Scrypt——一种设计为通过要求大量内存来使大规模硬件攻击更加困难和成本高昂的内存密集型算法。

**比特币基金会（2012 年 9 月）** —— 2012 年 9 月，比特币基金会成立。创始成员包括加文·安德森（Gavin Andresen）、查理·夏尔姆（Charlie Shrem）、马克·卡佩莱斯（Mark Karpeles）、彼得·韦塞内斯（Peter Vessenes）、罗杰·维尔（Roger Ver）和帕特里克·默克（Patrick Murck）。该基金会的使命是“旨在标准化、保护和推广比特币加密货币的使用，造福全球用户。”

**第一次比特币泡沫（2013 年 11 月）** —— 在比特币诞生不到四年的时间里，2013 年 11 月 28 日，比特币的价格达到了历史最高点 1,217 美元，首次超过了 1,000 美元。当时流通中的比特币总市值约为 40 亿美元。这是第一次比特币泡沫。此后，价格逐渐下跌，到 2015 年 1 月跌至 172.15 美元。

#### 走向主流

**奥士克顿接受比特币支付（2014 年 1 月）** —— 奥士克顿（NASDAQ: OSTK）于 2014 年 1 月启动了一个国际支付系统，接受比特币，并成为首家接受加密货币的大型在线购物商店。

**门头沟被黑事件（2014 年 2 月）** —— 2014 年初，门头沟是世界上最大的比特币交易所，处理着全球超过 70%的比特币交易。

2014 年 2 月 7 日，门头沟突然停止了所有比特币提现，称这只是其比特币钱包上“异常活动”的正常调查，他们“在过去几周内进行了调查”。然后，在 2014 年 2 月 24 日，该交易所暂停了所有交易并关闭了网站。

2014 年 2 月 28 日，门头沟申请了破产保护。在门头沟问题期间，比特币的价值下跌了 40%，引发了比特币为期两年的熊市。作为一次大规模黑客攻击的受害者，门头沟丢失了大约 744,408 个比特币（当时所有比特币的 6%），另外还有 10 万个比特币作为公司负债。尽管后来找到了 20 万个比特币，但剩余的 65 万个比特币至今未找回。

**比特币征税（2014 年 3 月）** – 自比特币在 2009 年开始第一次公开交易以来，比特币持有者一直对比特币支付的法律问题感到紧张，直到美国国内收入局（IRS）发布了相关规定。随着 2013 年比特币市场的爆炸式增长，2014 年 3 月，IRS 发布了《2014-21 号公告》，解释加密货币持有为税务目的的“财产”，而非合法的、得到国家支持的货币。因此，任何新挖出的比特币都将被视为联邦所得税的财产，与其他你拥有的资产（如股票、各种房地产或黄金）一样处理。

**微软比特币支付（2014 年 12 月）** – 2014 年 12 月，微软（纳斯达克：MSFT）成为第一家支持比特币的大型科技公司。它宣布接受数字货币作为在其商店（如 Windows、Windows Phone、Xbox 游戏和 Xbox 音乐）购买数字内容的支付选项。微软的支付系统在整合 BitPay（成立于 2011 年的比特币支付服务提供商）时处理比特币交易。

**纽约比特币许可证（2015 年 6 月）** – 2015 年 6 月，纽约州金融服务部（DFS）发布了其比特币许可证规定。该规定要求在该州从事广泛虚拟货币交易的 公司——包括传输、挖掘以及买卖虚拟货币——向 DFS 申请比特币许可证。2015 年 9 月，位于波士顿的 Circle Internet Financial（一家全球加密货币金融公司）获得了第一个比特币许可证。此后，许多公司获得了在纽约运营加密货币业务的许可，如 PayPal、Coinbase、Ripple Labs、BitPay、Square、Robinhood 和 NYDIG。

**CFTC 将比特币归类为商品（2015 年 9 月）** – 2015 年 9 月，美国商品期货交易委员会（CFTC）根据美国商品交易法（CEA）将比特币和其他虚拟货币归类为商品。CFTC 是一个独立的美国联邦机构，负责监管美国衍生品市场，包括商品和金融期货与期权的销售。因此，比特币交易与其他商品（如黄金和石油）一样，必须受到 CFTC 在美国的监管和监督。因此，新规定开始限制交易加密货币产品的未注册公司。

**2018 年 1 月**，CFTC 对被告帕特里克·麦克唐纳和他的公司 CabbageTech, Corp.提起诉讼，指控其运营一个具有欺骗性和欺诈性的虚拟货币计划以诱骗客户。纽约联邦法官评估并采纳了 CFTC 的观点，即虚拟货币是《商品交易法》意义上的商品。这是测试 CFTC 遏制加密货币业务涉嫌欺诈能力的第一起案件。

**欧盟将比特币归类为货币（2015 年 10 月）** – 2015 年 10 月，欧洲最高法院裁定比特币被视为一种货币，与其他货币一样。因此，比特币不受增值税（VAT）的豁免。增值税是欧盟对所有商品和服务征收的消费税。

#### 区块大小之战

在比特币网络中，矿工使用工作量证明（proof-of-work）共识每十分钟创建一个区块。比特币的区块限制为 1 兆字节。随着比特币的广泛采用，交易量急剧增加，需要在 1 兆字节的限制内处理更多的交易。这降低了交易处理速度，高额交易费用可能使用户每笔交易付出 58-60 美元。然而，中本聪在 2010 年 7 月增加了 1 兆字节的区块大小上限，没有做任何评论或解释（[`sourceforge.net/p/bitcoin/code/103/`](https://sourceforge.net/p/bitcoin/code/103/)）。![](img/535492_1_En_3_Fig5_HTML.png)

一个表格显示了硬币值的数量和带有高亮值的描述最大区块大小 1000000\。它代表了比特币最大区块大小 1 MB。

图 3-5

比特币最大区块大小 1 MB

它引发了一个在比特币社区多年来甚至至今仍在讨论的“宪法危机”话题。在 2015 年和 2017 年期间，比特币社区就增加比特币区块链区块的限制大小进行了激烈的辩论。

为了解决可扩展性问题，社区分成了两个主要的解决方案：

一方面（大区块解决方案）是增加区块大小，让更多的交易能够装入每个区块，从而降低交易费用。然而，更大的区块大小也需要更长的传输时间，这只是个权宜之计。当网络用户继续增加时，新的区块大小将再次成为限制。这不是一个长期的解决方案。

由于比特币是去中心化的，任何提议的共识更改都必须获得比特币社区的大量支持。当比特币社区不同意提案时，将导致“分叉”。区块链有两种分叉——软分叉和硬分叉。软分叉将新实施的变化应用于现有的区块链，并且修改将支持向后兼容性。大多数参与节点同意这些变化。旧节点在变化后接受新节点。硬分叉对比特币协议进行了根本性的更改，导致链分为两条路。新链不需要向后支持兼容性，原始链上的旧节点不会接受新链上的新节点。硬分叉需要大多数矿工的长期支持——否则，新网络将失败。

大区块解决方案导致了几个硬分叉——比特币 XT，经典，无限，比特币现金和 SV。其中一些失败了，其他的至今仍在使用。

另一种解决方案（支持小区块的人）是保持 1MB 的区块大小，并通过第二层解决方案进行扩展，为最终用户提供轻松运行节点的选项。该解决方案包括 SegWit 软分叉和闪电网络。我们将在后面的章节中详细讨论这一点。

**Bitcoin XT（2015 年 8 月）** —— Bitcoin XT 是比特币核心的第一个重要硬分叉之一。

2014 年 6 月 10 日，Mike Hearn 发布了一份比特币改进提案（BIP 64），呼吁“对 P2P 协议进行小型扩展，以根据一系列出块点执行 UTXO 查找。”

2015 年 6 月 22 日，Gavin Andresen 发布了 BIP 101，呼吁“增加最大区块大小。”

这些更改将把区块大小从 1MB 增加到 8MB，然后每两年翻倍，直到 2036 年。最终区块大小将达到约 8GB。

2015 年 8 月，Bitcoin XT 以 8MB 的区块大小启动。在最初几个月里，有超过 1000 个节点在 Bitcoin XT 上运行。然而，比特币社区并没有广泛支持 Bitcoin XT 协议。因此，区块大小之争引起了媒体关注，并在各种社交媒体平台上—尤其是 Reddit 上—得到了广泛关注。这开始引发关于扩容的讨论，持续了数年。

许多社区成员担心更大的区块大小将导致比特币的中心化，正如一位评论者引用的话，“这与中本聪的道德观相悖。”几个月后，该项目失去了用户和节点运营商的兴趣，基本上消失了，并被其用户废弃。

**闪电网络白皮书（2016 年 1 月）** —— Joseph Poon 和 Thaddeus Dryja 在 2016 年 1 月 16 日发布了闪电网络白皮书。该白皮书提出了一种名为“闪电网络”的协议，通过在比特币区块链之上创建第二层，并使用用户生成的微支付通道来进行更有效的交易，从而加快交易速度。由于无需矿工参与，这些交易速度非常快，而且交易费用更低甚至无需支付，无需改变区块大小。支持小区块的人将其视为比特币可扩展性解决方案之一。

**Bitcoin Classic（2016 年 1 月）** —— 2016 年初，一群比特币社区成员提议将比特币块的最大大小从 1MB 增加到 2MB，这比 Bitcoin XT 提出的 8MB 更为保守。因此，一群开发人员推出了 Bitcoin Classic。2016 年初，Bitcoin Classic 从比特币硬分叉中产生，最初有大约 2000 个节点在网络上运行，但 Bitcoin Classic 从未得到社区的广泛采用。一年后，网络中只剩下不到 100 个节点。尽管 Bitcoin Classic 至今仍在运行，但与今天的比特币价格 23,028 美元相比，其价值仅为 0.027632 美元。

**香港协议 – SegWit 提案（2016 年 2 月）** – 2016 年 2 月，开发者 Peter Wuille 在香港数码港的比特币会议上提出了一个名为“隔离见证及其对可扩展性的影响”（SegWitness 或 SegWit）的想法。与交易输入的其他数据相比，签名数据较大，占用了 65%的空间。因此，它很快填满了区块。SegWit 是一种机制，通过创建自己的独立树，将见证签名数据与区块交易的输入字段分离。它允许计算没有签名的交易 ID，轻客户端可以完全跳过分离的数据输入。当需要授权交易输出给原始所有者时，签名将作为“见证人”。比特币包含一个验证这些签名的检查点机制。SegWit 使更多的交易能够存储在区块中。![](img/535492_1_En_3_Fig6_HTML.png)

一个区块图将 SegWit 之前的交易和 SegWit 之后的交易分类。它包括输入、输出和见证数据。

图 3-6

比特币 SegWit

SegWit 立即在社区内引发了新的讨论。会议结束后，比特币社区同意将 SegWit 作为未来的软分叉发布，并继续基于 SegWit 改进的安全硬分叉工作，包括将非见证数据增加到大约 2 MB。

**纽约协议（NYA）（2017 年 5 月）** – 2017 年 5 月 23 日，来自 22 个国家、代表超过 85%的网络计算能力的 58 家比特币公司举行了一次会议，以决定 BTC 的未来。会议旨在解决比特币的可扩展性问题，并通过进行软分叉和硬分叉来解决冲突。NYA 发表了一份名为 SegWit2x 升级的声明（基本上与香港协议相同）。目标是：

+   在 80%的阈值处激活隔离见证，在第 4 位发出信号

+   在六个月内激活 2 MB 的硬分叉

解决方案是在想要 SegWit 的人和其他希望进行硬分叉的人之间进行妥协。

**SegWit 激活（2017 年 8 月）** – 2017 年 8 月 8 日，100%的比特币矿池签署了支持 SegWit 的声明。隔离见证于 2017 年 8 月 24 日激活。根据 buybitcoinworldwide.com 的数据，截至 2022 年 7 月，大约 84%的比特币节点已经采用了 SegWit。![](img/535492_1_En_3_Fig7_HTML.png)

一个图表比较月份与百分比，并显示出上升趋势。

图 3-7

比特币 SegWit 采用

**比特币现金（2017 年）** -然而，NYA 并不能让所有人满意。一些大型区块阻止者对 SegWit 改进不满意，并认为这个协议将失败。一群比特币利益相关者、开发者和矿工开始讨论通过硬分叉将区块大小限制增加到 8MB 的新解决方案。2017 年 8 月，由企业家 Roger Verand 领导的比特币现金（BCH）问世，从比特币分叉而来。该网络每秒可以处理 24 笔交易，成本大大降低，约为 0.18 美分。区块大小为 8MB。

2017 年 8 月 1 日，比特币现金开盘价为约 400 美元，而比特币的价值约为 7567 美元。2017 年 12 月 19 日，比特币达到了历史高点 3923 美元，而与 2022 年 7 月 23 日比特币价格为 22532 美元相比，比特币现金为 124 美元。

**SegWit2x 取消，NYA 崩溃** -在 NYA 之后，许多比特币的核心开发者对 NYA 的发展计划感到愤怒，因为小型区块阻止者没有代表，也没有参与这个协议。他们强调，比特币应该是一个开放系统；因此，在封闭的房间里通过一个秘密邮件列表改变共识是一个突破点，他们考虑反对比特币，认为硬分叉将背离“真正的比特币”。

即使在 2017 年 8 月 Segregated Witness 上线后，比特币的核心开发者仍然坚决拒绝妥协。他们认为 SegWit2x 计划不会成功。

2017 年 8 月 18 日，比特币核心宣布不支持 SegWit2x 提案。![](img/535492_1_En_3_Fig8_HTML.png)

一段文本描述了关于 segwit 2x 和 b t c 1 的错误信息的纠正，包括大约、下载、博客、发布、发展和联系。

图 3-8

SegWit2x 的比特币核心声明 [`bitcoincore.org/en/2017/08/18/btc1-misleading-statements/`](https://bitcoincore.org/en/2017/08/18/btc1-misleading-statements/)

2017 年 11 月 8 日，BitGo 首席执行官 Mike Belshe 代表最初支持它的多家公司发送了一封电子邮件。这份声明意味着取消了 SegWit2x 硬分叉，并且 NYA 崩溃了。声明发布时，比特币价格飙升了 20%以上，反映出用户和投资者的逃离。![](img/535492_1_En_3_Fig9_HTML.png)

一篇文本页面解释了 Segwit 2x 的最后步骤，包括几段文字。

图 3-9

SegWit2x 取消 [`lists.linuxfoundation.org/pipermail/bitcoin-segwit2x/2017-November/000685.html`](https://lists.linuxfoundation.org/pipermail/bitcoin-segwit2x/2017-November/000685.html)

**闪电网络（2018 年 3 月）**——2018 年 3 月 15 日，闪电实验室宣布了比特币闪电网络的第一个测试版。Twitter 的 CEO，Jack Dorsey，支持这个网络。比特币的闪电网络扩展解决方案随着商业和用户采用率的不断提高而持续增长，但它仍处于早期阶段。截至 2022 年 4 月，闪电网络的容量增长到了大约 3600 个比特币，有超过 300 家公司、项目和应用程序在使用闪电生态系统。闪电网络的交易费用大约是一个 Satoshi 或 0.000301142 美元。事件链上的费用在 2021 年的高峰期接近了 60 美元。

**比特币 SV（2018 年的哈希战）**——历史往往重演。2018 年 8 月，比特币现金提出了对协议的升级：引入非现金交易以支持区块链上的智能合约和预言机价格预测服务。

再次强调，并不是每个人都支持源代码中的变化，反对者批评了非现金交易在区块链中的优先级，他们认为区块链应该只处理支付。比特币现金社区的一群人，由 Craig Wright 和 Calvin Ayre 领导，不同意源代码中的这些变化，并认为这次更新会破坏中本聪原始比特币白皮书的理念。相反，作为数字现金的比特币应该只处理支付，区块大小应该增加到 128MB，以解决未来的可扩展性问题。

2018 年 11 月 15 日，比特币现金网络分裂为比特币现金 ABC（BCH ABC）和比特币 SV（BCHSV）。两个竞争链之间的分裂是有争议的。双方链争相通过拥有更多区块的最长链赢得哈希竞赛。由 Craig Wright 和 Calvin Ayre 领导的比特币 SV 对由 Roger Ver 和 Bitmain 的 Jihan Wu 领导的比特币现金投入了大量哈希计算。这场激烈的哈希计算比赛持续了大约十天，并以比特币 SV 团队宣布与比特币现金永久分裂结束。“哈希战”这一时期因此得名。作为代价，比特币现金矿工损失了 345 万美元，比特币 SV 矿工损失了 249 万美元。

2018 年 11 月 15 日，比特币 SV 的开盘价约为 122 美元，而比特币现金的估值约为 388 美元。到了 2021 年 4 月 15 日，比特币 SV 达到了历史最高点 441.39 美元，而 2022 年 7 月 23 日，比特币 SV 的价格为 58 美元，相较于比特币现金的 124 美元。

#### 作为主流货币的接受度

**CME 推出比特币期货（2017 年 12 月）**——芝加哥商品交易所（CME）集团是一家美国全球市场公司，用于交易期货和期权。为了应对不断增长的投资者对 evolving 加密货币市场的兴趣，CME 获得了美国商品期货交易委员会的祝福，并于 2017 年 12 月 18 日推出了一款比特币期货合约。

CME 比特币期货将允许投资者在没有持有基础比特币的情况下对比特币的未来价格进行投注。

期货合约是一种法律协议，其中买方和卖方同意在预定的未来日期和价格购买或出售一种商品或资产。例如，7 月 1 日比特币价格为 22,000 美元。如果有人认为价格将会上涨，他们会在一个月后的$23,000 买入比特币期货。到了 8 月 1 日，如果比特币市场价格为$23,500，并且期货合约到期，买家将获得 500 美元的差价。

期货交易有着悠久的历史。第一个现代期货交易所始于 1710 年的日本大阪，而棉花期货则大约在 1870 年开始在纽约棉花交易所交易。专业的投资者和公司通常进行期货交易。比特币期货可能会为更多的华尔街公司进入比特币及其他加密货币领域打开大门，并有助于降低比特币市场的波动性。

**新西兰合法化加密货币工资（2019 年 9 月）** —— 2019 年 9 月 1 日，新西兰内陆收入局（IRD）正式宣布，员工可以使用比特币和以太坊等加密货币领取工资。这意味着只要在雇佣协议中注明，公司可以直接用加密货币支付员工工资。因此，新西兰成为了首个合法化加密货币工资支付选项的国家，并将加密货币纳入了日常支付方式。

**MicroStrategy 比特币购买（2020 年 8 月）** —— 2020 年 8 月 11 日，全球领先的商业智能公司 MicroStrategy Inc（纳斯达克：MSTR）宣布，已购买了 21,454 枚比特币（当时价值 2.5 亿美元）。MicroStrategy 成为了首家购买比特币作为合法投资资产的上市公司。MicroStrategy 的购买表明比特币的合法性日益增强，并逐渐被主流市场接受。

**PayPal 推出比特币支付服务（2020 年 10 月）** —— 2020 年 10 月 21 日，PayPal 从纽约州金融服务部门（DFS）获得了有条件的 BitLicense。在 DFS 的批准下，2020 年 11 月 12 日，PayPal 推出了一项新的支付服务，允许 PayPal 用户购买、持有和出售加密货币。PayPal 拥有约 3.5 亿用户和超过 2600 万活跃商家。PayPal 的采用意味着另外 3 亿用户可以使用比特币和其他加密货币作为支付方式。

**加密货币用户数量超过 1 亿（2021 年 1 月）** —— 在 COVID-19 期间，全球加密货币用户快速增长。根据 Crypto.com 的一份报告，现在有超过 1 亿人首次在全球范围内使用加密货币。

**Coinbase 上市**（**2021 年 4 月**）——2021 年 4 月 14 日，作为华尔街最受期待的事件之一，乘着加密货币市场整体繁荣的浪潮，Coinbase Global Inc. 在纳斯达克上市。Coinbase 是美国交易量最大、最流动的受监管加密货币交易所。作为纳斯达克上第一个主要加密货币交易所的上市，Coinbase 为其他加密货币交易所设定了基准，并且上市是数字资产行业的分水岭时刻。Coinbase（COIN）的股价开盘价为每股约 340 美元，市值达到 860 亿美元。

**萨尔瓦多使比特币成为法定货币**（**2021 年 9 月**）——2021 年 6 月，总统纳伊布·布克尔在迈阿密比特币 2021 年大会上宣布了比特币法。

2021 年 9 月 7 日，萨尔瓦多成为世界上第一个接受比特币作为法定货币的国家，并与美元并列。新法律要求公司接受比特币作为支付。政府还基于闪电网络协议推出了一个名为“chivo”的国家虚拟钱包，允许免手续费交易和快速支付。

**美国首只比特币交易所交易基金（ETF）**（**2021 年 10 月**）——交易所交易基金（ETF）正如其名：可以在交易所交易的投资基金。当你投资于 ETF 时，你可以在股票市场买卖，就像公司股票一样。ETF 通常跟踪特定的指数——例如，“蜘蛛”ETF（SPDR S&P 500 – SPY）是最为人所知的跟踪标普 500 指数的 ETF。ETF 是目前全球最受欢迎的投资方式之一。美国首只 ETF（SPY）于 1993 年推出；iShares 于 2002 年推出了其首只债券 ETF LQD；SPDR 黄金信托 ETF 是美国首只黄金支持的 ETF。2021 年 10 月 19 日，美国首只比特币交易所交易基金（ETF）ProShares 比特币策略 ETF（BITO）开始交易。ProShares 比特币策略 ETF 在上市前两天的资产吸引了超过 10 亿美元。与黄金 ETF GLD 相比，后者用了三天时间才达到十位数。BITO 成为市场历史上交易最活跃的 ETF 之一。![](img/535492_1_En_3_Fig10_HTML.jpg)

一段文字描述了纽约证券交易所。它提到了 Proshares 的比特币策略 BITO。它包括关于聆听、交易和数据的内容以及洞察。

图 3-10

在纽约证券交易所上市的 BITO

比特币 ETF 为机构投资者和零售投资者提供了一种在传统股票交易所投资加密货币市场的方法，而不是在加密货币交易平台上交易。因此，之前因交易技术复杂性和其他安全问题而却步的投资者无需创建新的加密钱包账户来持有代币，就可以间接投资比特币市场。

**比特币价格超过 68,000 美元（2021 年 11 月）** —— 2021 年 11 月 5 日，比特币价格达到了新的历史高点，为 68,521 美元。飙升的比特币价格推动加密货币市值超过了 3 万亿美元。这表明比特币正在成为一种领先的创新支付模型，并且正在被更广泛地采用。

**Taproot – 比特币隐私更新（2021 年 11 月）** —— 在 2017 年 8 月激活 SegWit 并在三个月后取消 SegWit2x 之后，比特币已经有四年没有重大升级了。终于，在 2021 年 11 月 14 日，Taproot——自 2017 年以来比特币社区最期待的升级——上线了。这是比特币的一个里程碑，Taproot 几乎得到了矿工、开发者和用户的一致支持。

Taproot 是比特币核心开发者 Gregory Maxwell 于 2018 年 1 月首次提出的软分叉升级。自那时以来，该提案已经在社区中进行了多次审查、讨论和测试。

尽管 SegWit 和闪电网络的主要目标是提高交易速度和降低费用，但 Taproot 旨在解决比特币的可扩展性、隐私和透明度问题。

Taproot 更新包括三个主要改进：

+   BIP340 – 通过用 Schnorr 替换传统的椭圆曲线数字签名算法（ECDSA），升级比特币的核心密码学。与 ECDSA 公钥的 33 字节相比，Schnorr 公钥为 32 字节，签名将从 72 字节的 ECDSA 签名缩短到 64 字节。此次升级使得复杂的比特币交易更加安全、简单且成本更低。

+   BIP-341 – 引入 Taproot 功能的 Merkleized Alternative Script Trees (MAST)，旨在使比特币网络能够执行智能合约。它带来了支持使用 Schnorr 签名进行去中心化金融（DeFi）和 NFT 项目的潜力。

+   BIP342 – 引入了一种新类型的交易脚本语言，称为“Tapscript”，它允许比特币节点在单个交易中结合 Schnorr 签名和 MAST。此外，它还通过移除 10,000 字节的尺寸限制，为比特币智能合约提供了更多的灵活性和控制权。

**比特币 ETF（2021 年 10 月至 2022 年 7 月）** —— 2013 年 6 月，卡梅伦和泰勒·文克勒沃斯共同创立了加密货币交易所 Gemini。他们因与马克·扎克伯格就 Facebook 的所有权进行斗争而闻名，这对双胞胎提议与证券监管机构合作创建比特币交易所交易基金。然而，2017 年 3 月，美国证券交易委员会拒绝了文克勒沃斯兄弟创建比特币 ETF 的请求。

Nearly eight years later, with long-awaited development for the cryptocurrency industry, investors, and securities issuers, S.E.C. approved the first Bitcoin ETF—BITO. BITO start to trade on the New York Stock Exchange (NYSE). Legitimacy is a crucial concern for Bitcoin trading in the finance industry. Gaining approval from the U.S. Securities and Exchange Commission (S.E.C.) opens the door for Bitcoin’s acceptance as a mainstream digital currency. Since the first Bitcoin ETF was approved in October 2021, many other crypto ETFs have been approved by S.E.C. and are available to trade on the stock market. Here is the list of Bitcoin ETFs:Table 3-2

SEC-approved Bitcoin ETF

| Symbol | ETF Name | Asset Class |
| --- | --- | --- |
| ARKW | ARK Next Generation Internet ETF | Equity |
| BITO | ProShares Bitcoin Strategy ETF | Currency |
| SPBC | Simplify US Equity PLUS GBTC | ETF |
| BITQ | Bitwise Crypto Industry Innovators ETF | Equity |
| BTF | Valkyrie Bitcoin Strategy ETF | Currency |
| XBTF | VanEck Bitcoin Strategy ETF | Currency |
| BITS | Global X Blockchain & Bitcoin Strategy | ETF |
| RIGZ | Viridi Bitcoin Miners ETF | Equity |
| SATO | Invesco Alerian Galaxy Crypto Economy ETF | Equity |
| BLKC | Invesco Alerian Galaxy Blockchain Users and Decentralized Commerce ETF | Equity |
| BTCR | Volt Crypto Industry Revolution and Tech ETF | Equity |
| CRYP | AdvisorShares Managed Bitcoin Strategy ETF | Multi-Asset |

## Getting to Know Bitcoin

In a centralized economy, the currency issued by a central bank is supposed to match the economy’s growth and the number of goods exchanged at stable prices. A central bank controls the money supply, and there is no fixed formula to determine how much money a central bank should print. However, the money system may sometimes lose control.

Bitcoin’s inventor, Satoshi Nakamoto, designed Bitcoin to resist inflation, limit its supply, and cap the number of coins at 21 million. As a result, the new number of Bitcoins is reduced by half every four years, and the last coins will be minted around 2140.

Limited supply makes Bitcoin a scarce asset, which can boost the coin’s future price—one of the reasons Bitcoin is often referred to as “digital gold.”

### Bitcoin Unit

Today, one Bitcoin is around $25,000, and the total market cap is 455B. Like major centralized world currencies such as the US dollar and the Euro can be broken down into smaller units such as cents, Bitcoins can also be broken down into Satoshi. Satoshi is the smallest unit of a Bitcoin.

1 Bitcoin equals 100 million Satoshi, divisible to the eighth decimal place.

Table 3-3 shows the Satoshi unit conversion in the Bitcoin system:Table 3-3

Bitcoin denominations and unit name

| Unit name | BTC |
| --- | --- |
| Satoshi | 0,00000001 BTC |
| μBTC (Micro Bitcoin) | 0,00001 BTC |
| MBTC (Milli Bitcoin) | 0,001 BTC |
| cBTC (Centi Bitcoin) | 0,01 BTC |
| dBTC (Bitcoin said) | 0,1 BTC |
| BTC (Bitcoin) | 1 BTC |

考虑支付 1 BTC 换取$23,798.46。1 MBTC 是$ 0.001 23.8，而 1 μBTC 是$ 0.24。

### 比特币减半

比特币减半，也被称为“减半”，是比特币历史上一个关键的事件。每隔四年，新的比特币被释放到流通中，比特币挖矿奖励的数量减半。比特币的最大总供应量是 2100 万。

以下是过去和未来的比特币减半过程的简要说明：

+   2009 —— 比特币网络开始奖励矿工，从每十分钟 50 BTC 开始。

+   2012 – 在挖出 210,000 个区块后，第一次比特币减半，奖励降低到了 25 BTC。

+   2016 —— 在挖出 420,000 个区块后，第二次比特币减半，挖矿奖励降低到了 12.5 BTC。

+   2020 —— 在挖出 630,000 个区块后，第三次比特币减半，挖矿奖励降低到了 6.25 BTC。

+   2024 —— 下一个比特币减半事件将发生在挖出 840,000 个区块时，挖矿奖励将降低到 3.125 BTC。

+   2140 —— 第 64 次也是最后一次减半事件将发生，不会再生产新的比特币。

中本聪将减半政策写入比特币的挖矿算法中，以通过保持稀缺性来降低比特币的通货膨胀率。当矿工的奖励减少，他们可出售的比特币减少时，有限的供应在需求增加时正面影响价格。

### 比特币钱包

“不是你的钥匙，不是你的币”是加密货币世界中最著名的座右铭之一。它的意思是，如果你没有真正控制你的私钥，那么你实际上并不“拥有”你的加密货币/币。换句话说，如果你丢失了你的比特币钱包的私钥，你将丢失里面的资金。

在传统金融系统中，你有一个钱包来存放现金。比特币钱包与你的普通钱包相似，但它用于存储、发送和接收比特币。它有两个主要功能：

首先，存储用户的公钥和私钥，其次，执行交易——例如，接收和发送比特币。

#### 如何运作比特币钱包

我们在第二章“密码学”中学习了公钥和私钥。这一章展示了使用非对称加密生成一对私钥和公钥的示例。之后，从其公钥派生出区块链地址。

在比特币中，当你创建一个区块链钱包时，私钥和公钥与之关联。每个地址有一个私钥。比特币地址是公开可见的，代表你在区块链中的账户，用于接收和发送比特币。

私钥保持秘密。它用于验证交易、账户所有权或花费你账户中的比特币。它可能有多种形式：

1.  1.

    一个 256 个字符长的二进制代码。示例：

    1010111100111000000011110110001111010111101001010010001011001111011110100011000010100011111100100010100011110001110101000110011111110000101000110001010111010001010011111110101001010011110110110110000001101111010011000001110101101001000010001000010000100111。

1.  2.

    一个 64 位的十六进制代码。示例：

    c2e44f51a0277e7bde2b244de3ac9afb62b528bf2f234f0a0a085e963ef7134e

    关联地址：1Ghftir7isD9MsJVH6qcTbm2nCBHTs3Csp

1.  3.

    一个二维码示例：

    你可以通过提供比特币地址在线生成比特币二维码：[www.bitcoinqrcodemaker.com/](http://www.bitcoinqrcodemaker.com/)。

![](img/535492_1_En_3_Fig11_HTML.jpg)

图片显示了比特币网络二维码。

图 3-11

比特币二维码

1.  4.

    助记词示例：

![](img/535492_1_En_3_Fig12_HTML.png)

文本截图代表了比特币助记词。它包括助记词语言和有关比特币钱包的详细信息。

图 3-12

助记词

当艾丽斯想从她的钱包向鲍勃发送一个比特币时，钱包处理的流程可以描述如下：

**步骤 1 –** 艾丽斯收集待发送的交易数据。一旦交易最终确定，艾丽斯使用鲍勃的公钥来加密交易数据。

**步骤 2 –** 艾丽斯然后使用她的私钥，为交易签署数字签名。艾丽斯然后将交易、数字签名和她的公钥发送给鲍勃。

鲍勃收到交易信息。他必须验证从艾丽斯发送的数据是否被篡改，并确认确实来自艾丽斯。

**步骤 3 –** 鲍勃使用他的私钥解密交易数据。

**步骤 4 –** 鲍勃收到艾丽斯的公钥，以验证数字签名，确保信息来自艾丽斯。

如果为真，鲍勃知道数据没有被篡改，可以进行下一步。![](img/535492_1_En_3_Fig13_HTML.png)

图表说明了比特币钱包的工作原理。它包括艾丽斯、交易、鲍勃的公钥、签名私钥、公开、散列、艾丽斯的公钥、原始文档和鲍勃的私钥这些步骤。

图 3-13

比特币钱包是如何工作的

#### 比特币钱包的类型

钱包分为两大类：热钱包和冷钱包。两者的区别在于，热钱包需要互联网连接，而冷钱包则将加密代币存储在离线状态下。

由于热钱包始终连接在互联网上，使用起来既简单又方便，非常适合初学者学习或交易者进行快速在线支付。它非常用户友好。另一方面，热钱包通常安全性较低，更容易受到黑客和在线攻击的侵害。热钱包有几种类型；最常见的是网络钱包、移动钱包和桌面钱包。

冷钱包不连接互联网。它非常安全。从冷钱包中窃取资金需要物理访问冷钱包，并输入拥有者的密码或 PIN 码。它最大限度地减少了在线黑客攻击。同时，它难以访问，用户友好性较差，交易时间更长。它适合长期存储大量加密资产。冷钱包包括纸钱包和硬件钱包。

图 3-14 展示了比特币钱包的两种类型。![](img/535492_1_En_3_Fig14_HTML.png)

比特币钱包的类型可以用流程图来表示。它分为热钱包和冷钱包两种。热钱包又可以分为网络钱包、移动钱包和桌面钱包。冷钱包则分为纸钱包和硬件钱包。

图 3-14

比特币钱包的类型

##### 网络钱包

正如其名，在线钱包存储您的私钥，这些私钥完全由第三方在线管理，通常是中心化的交易所。网络钱包供应商作为云服务提供。用户友好的网络界面使得用户能够顺畅地处理他们的钱包并执行各种操作，如发送和接收支付。您可以通过网络浏览器从任何地方访问网络钱包。然而，网络钱包经常受到黑客的攻击。在热钱包中，网络钱包的安全性是最低的。大多数交易所将客户资金的大部分存储在离线的冷钱包中。出于安全考虑，用户通常不应该在热钱包中保留大量的加密货币。

一个流行的网络钱包的例子是[www.exodus.com/](http://www.exodus.com/)或者[`electrum.org/`](https://electrum.org/)。

##### 桌面钱包

桌面钱包是一种下载到您桌面或笔记本电脑上的计算机软件。这种钱包软件生成一个数据文件来管理用户的密钥。私钥存储在您的硬盘驱动器或固态硬盘（SSD）上。

与其它热钱包相比，桌面钱包是最安全的，是使用计算机进行小额加密货币交易的一个极佳解决方案。在使用钱包时，用户应该创建一个强密码来访问密钥。

由于桌面钱包连接到互联网，它也容易受到恶意软件或病毒的影响。为了保护您在桌面钱包中的资金，您需要使用安全的密码短语来保护您的计算机。最佳实践是将大部分资金存放在冷存储中。

##### 移动钱包

与桌面钱包类似，移动钱包是一种安装在您手机上的移动应用程序。

##### 硬件钱包

比特币硬件钱包是冷钱包中最常用的一种形式，也是存储比特币最安全的方式。账户的私钥与互联网隔离并存储在一个安全的物理设备中。与便携式设备类似，硬件钱包可以连接到计算机以进行交易。设备中的私钥会自动签署加密货币交易，而无需您输入密钥，这有效地防止了黑客窃取您的私钥。

Trezor ([`trezor.io`](https://trezor.io)) 和 Ledger 钱包 ([www.ledger.com](http://www.ledger.com)) 是目前最流行的硬件钱包供应商之二。

##### 纸钱包

正如其名，纸钱包是一张包含与钱包地址相关联的公钥和私钥的纸片。此外，纸钱包通常以二维码的形式打印，因此你可以快速扫描它们来进行交易。

作为一种冷钱包，纸钱包存储你的加密货币相当安全，因为你的钥匙完全离线，且不受在线黑客的侵害。它是成本最低的冷钱包选项。与 Trezor Ledger 等硬件钱包相比，成本可能在 50 到 300 美元之间。

纸钱包是通过下载钱包生成软件来生成的。

一旦下载，你必须检查确保软件不包含恶意软件。然后，要打印出纸钱包，你需要禁用浏览器插件和扩展程序，断开互联网连接，并添加一个密码短语。最后，遵循钱包生成器的说明来完成过程，打印新生成的钱包，并删除文件。只需确保没有人在看着你创建你的钱包。

避免使用公共打印机，比如学校和工作场所的打印机；钱包信息可能会存储在打印机的内部硬盘存储中。公共未加密的 Wi-Fi 网络也可能泄露你的钱包信息。

纸钱包容易损坏或丢失。万一应用被卸载，你会丢失你的资金。而且，在用钱包接收资金时，纸钱包不会告诉你你是否收到了比特币以及收到了多少；你需要使用另一个应用来检查。

由于纸钱包存在许多缺点，目前它并没有被广泛使用。

你可以在各种服务提供商网站上在线创建自己的比特币纸钱包，比如[`bitcoinpaperwallet.com/`](https://bitcoinpaperwallet.com/)、[`paperwallet.bitcoin.com/`](https://paperwallet.bitcoin.com/)或[www.bitaddress.org/](http://www.bitaddress.org/)。

### 比特币网络

比特币是一个基于工作量证明协议的节点对节点（P2P）网络。每个参与者——节点，实际上就是运行比特币软件的计算机。节点随机选择并与其他对等节点连接。任何人都可以下载并安装比特币软件来启动一个新的比特币节点并加入网络。新的节点随时可能出现，因此网络中的节点是动态的，它们不断加入和离开。

当发送者使用比特币钱包将比特币发送给接收者时，交易将被广播到网络中的其他节点和矿工。矿工利用计算能力运行数学过程来验证交易并将它们添加到一个区块中。之后，矿工将新的区块广播到网络。收到新区块的节点将验证矿工是否遵循网络规则并将区块添加到它们的节点中。矿工因其对网络的贡献而获得铸造的比特币奖励。在确认交易后，接收者从发送者那里收到比特币。

比特币网络上存在不同类型的节点，其中主要有三种类型：完整节点或超级节点、轻节点或 SPV（简单支付验证）以及挖矿节点。

让我们详细探讨不同的节点。

#### 完整节点

完整节点运行比特币软件以验证来自其他完整节点的交易和区块。它可以验证一直回溯到创世区块的交易，然后将它们传递给更远的完整节点。完整节点存储整个区块链历史的副本，包括所有创建的区块。在撰写本文时，运行比特币完整节点至少需要 280 GB 的免费空间。

新的完整节点安装客户端软件并与其他同伴节点连接。客户端软件然后嵌入“创世”区块——区块链中的第一个区块——并且新节点将发送提供带有区块高度的区块头的“版本”消息。

同伴节点将通过将其自己的整个区块链数据副本与区块高度进行比较来检查区块高度。如果新节点的区块号码低于其副本，则同伴节点将知道新节点缺失多少个区块。同伴节点可以将缺失的区块发送给新节点以赶上最新的区块数据。每个完整节点在单个节点连接中最多可以有 500 个区块。

当设置新的完整节点连接到比特币网络时，它将开始一个初始区块下载（IBD）过程。![](img/535492_1_En_3_Fig15_HTML.jpg)

区块图表示完整节点。它通过以下步骤分类新完整节点并连接同伴完整节点，如通过区块高度发送版本消息，通过顶部区块发送邀请消息，获取区块数据。

图 3-15

完整节点初始区块下载（IBD）

IBD 指的是从创世区块下载并验证到当前区块的全部区块链区块。根据节点连接速度和 CPU、内存等硬件配置的不同，整个 IBD 可能需要几小时甚至几天。在 IBD 过程中，完整节点将不接受或发送交易。

**提高隐私：** 与第三方节点连接会广播您的交易。它可能会收集有关您交易的详细信息。您的交易请求与您的 IP 地址相关联，这可能与您的姓名相关联。为了保护您的隐私并真正保持匿名，您需要连接到您设置的完整节点以广播和验证您自己的交易。

运行完整节点的益处如下：

**维护去中心化：** 加入比特币网络后，您将帮助网络变得更加去中心化和安全。完整节点将通过拒绝不符合共识规则的区块和交易来确保比特币的共识被遵循。

**更高的安全性：**运行完整节点允许用户创建一个未签名的交易，称为部分签名比特币交易（Partially Signed Bitcoin Transaction, PSBT）。你可以选择一个离线钱包来签名交易，然后你可以从你的完整节点广播该交易。在整个过程中，你的私钥都是安全的。

运行完整节点有最低要求，例如：

更新的操作系统软件版本（例如，比特币核心）

至少 2 GB 的随机存取内存（RAM）

你的节点每天至少运行 6 小时

一个至少每秒传输 400 千比特（50 千字节）的快速互联网连接

至少需要 280 GB 的免费存储空间，至少 100 MB/秒的读写速度。

#### 轻节点或 SPV

轻节点或简单支付验证（Simple Payment Verification, SPV）节点执行与完整节点类似的功能，但只下载先前交易的区块头并确认区块链的有效性。与完整节点相比，它节省了大量的存储空间，并允许更快、更便宜的交易。区块头的大小仅是区块的 1/1000。比特币区块链的总大小为 280 GB，那么区块头的总大小将约为 280 MB。许多移动照片都比这大。这对于手机或平板电脑来说是一个可承受的大小。

一个 SPV 节点或钱包应用程序需要了解其用户的未花费交易输出（Unspent Transaction Output, UTXO）——交易后剩余的比特币数量。由于 SPV 节点只包含头部信息，并没有完整地了解所有可花费的 UTXO，SPV 节点必须连接到其他完整节点并通过给定的比特币地址查询找到相关交易。一旦 SPV 节点通过给定的比特币地址获取了所有相关交易，钱包应用程序就可以找出未花费的交易输出。

#### 挖矿节点

挖矿节点通过执行工作量证明（Proof-of-Work, PoW）共识机制来挑选交易并生成新区块。矿工们可以组成团队建立挖矿池。利用联合矿工的资源可以增加更快地找到并生成比特币区块的概率。一旦挖矿池成功并获得奖励，根据矿工的贡献，奖励会在参与者之间分配。

## 交易

交易是比特币生态系统的核心，可以简单到只是将一些比特币转移到比特币地址。

假设 Alice 想要向 Bob 发送一个比特币。她使用自己的钱包私钥创建并数字签名交易。在下一步，Alice 的钱包会将交易广播到比特币网络。这个交易包含发送者和接收者的地址、转账金额以及 Alice 的数字签名。网络中的任何节点都可以捡起这个交易并将其添加到未确认交易池，称为 mempool。现在，挖矿过程开始。矿工捡起这些未确认的交易并解决 PoW 问题。挖矿过程通常需要十分钟左右。一旦交易被验证，它们将被添加到一个新挖掘的区块中，并公开广播到网络。其他节点可以验证并确认新区块中的交易。这通常需要三到六次确认（六次确认后双重支付的概率被排除）并将它们添加到当前区块。交易被最终确定，Bob 在他的钱包中得到一个比特币。

图 3-16 展示了一个交易详情的例子。![](img/535492_1_En_3_Fig16_HTML.png)

一个表格表示交易的详细信息。它包括散列类别、状态、接收时间、大小、权重、包含在区块中、确认、总输入、总输出、费用、每字节费用、每权重费用、交易时的价值。

图 3-16

交易详情

让我们回顾一些交易数据结构的概念。

### 交易数据结构

图 3–16 显示了典型的交易信息。还有许多其他字段；我们选择了一些最常用的字段并在表 3-4 中说明。表 3-4

比特币交易详情

| 字段名 | 描述 |
| --- | --- |
| 交易哈希（交易 ID（TxID）） | 交易哈希是给予每个被验证并添加到区块链的交易的唯一字符串。比特币使用 SHA-256 哈希算法生成交易哈希值。 |
| 交易状态 | 它检查比特币交易确认的状态。 |
| 接收时间 | 发送者钱包将交易广播到网络的时间。 |
| 大小 | 此交易的总大小。 |
| 区块 | 该交易所属的区块编号。 |
| 确认次数 | 成功哈希交易并将其添加到区块链的确认次数。 |
| 费用/字节 | 处理此交易的总额。 |

Alice 向 Bob 发送比特币。Alice 的钱包将开始创建一个交易。在高级别，交易有三个主要部分：

1.  1.

    输入：包含 Alice 的比特币地址以及 Alice 拥有的比特币数量。

1.  2.

    输出：Bob 的比特币地址或公钥。

1.  3.

    金额：Alice 发送给 Bob 的比特币数量。

图 3-17 展示了一个输入和输出的例子：![](img/535492_1_En_3_Fig17_HTML.png)

表分类了交易中的输入和输出。它包括索引、地址、公钥脚本、签名脚本和见证。

图 3-17

交易输入和输出

#### 输入

将输入视为对比特币账户的支出，将输出视为储蓄。通常，每个输入花费一个先前的输出。每个输出都是一个**未花费交易输出** (**UTXO**)，直到稍后的输入消耗它。

一个交易可以包含多个输入和输出。如果输入金额超过相关输出金额，并且输入金额还包括交易费用，则交易有效。

UTXO 是用于下一个新交易花费的未花费交易输出。交易输入的数据结构在表 3-5 中描述。表 3-5

比特币交易输入

| 字段名称 | 类型(长度) | 描述 |
| --- | --- | --- |
| 交易哈希/Tx-ID | 32 字节 | 交易哈希使用 SHA-256 算法。前一个交易的 ID 与未花费交易输出(UTXO)相关联。 |
| 交易索引 | 4 字节 | 前一个交易输出的索引。 |
| 解锁脚本长度 | 2-9 字节 | 解锁脚本的大小。 |
| 解锁脚本 | 可变 | 它包含了解锁脚本。 |
| 序列 | 4 字节 | 序列号。默认值为 0xffffffff。 |

#### 输出

输出包含三个字段，包含发送比特币的信息。第一个字段是要发送的 Satoshi 金额，而第二个字段指示锁定脚本的字节大小。最后，第三个字段包含一个锁定脚本，定义了期待未来其他人花费该输出的条件。交易输出的数据结构在表 3-6 中解释。表 3-6

比特币交易支出

| 字段名称 | 类型(长度) | 描述 |
| --- | --- | --- |
| 价值 | 8 字节 | 要以 Santoshi 为单位转账的金额。 |
| 锁定脚本长度 | 2-9 字节 | 锁定脚本的大小。 |
| 锁定脚本 | 可变 | 它包含锁定脚本。 |

#### UTXO (Unspent Transaction Output)

每个交易输出，称为未花费交易输出(UTXO)，用作下一个花费交易的输入。在比特币网络中，UTXO 只能被花费一次，因此比特币交易输出可以被分为 UTXO 或已花费交易输出。由于比特币区块链不维护每个人账户的余额，比特币钱包应用程序可以查询区块链全节点数据，并聚合比特币钱包地址的总 UTXO。类似于区块链中区块的连接方式，每个交易输入与前一个交易的输出相链接，每个输出指向后续交易的收入。

想象一下，爱丽丝从 2022 年 8 月 1 日到 8 月 5 日收到了多笔付款。每笔交易包含不同价值的 BTC，如图 3-18 所示。![](img/535492_1_En_3_Fig18_HTML.png)

两个表格表示聚合输入、交易、时间、输出和值。它提到总输入和输出值以及差异。它指出三个字符：爱丽丝、鲍勃和矿工。

图 3-18

聚合交易输入并生成输出

爱丽丝的钱包地址是 18AEg8g8VWxBfFGeWLqJURuw1DLKQne8jV。爱丽丝想要向鲍勃发送 0.005 BTC。爱丽丝只需解锁 2022 年 8 月 1 日至 2022 年 8 月 5 日之间的任何交易，因为所有这些交易都有大于 0.005 BTC 的未花费交易输出（UTXO）。但如果爱丽丝想要向鲍勃发送 0.13 BTC，她必须解锁所有这些交易。为了支付 0.13 BTC，爱丽丝不能简单地取交易 1-4，并从交易 5 中得到 0.03 BTC。换句话说，你不能将 UTXO 作为部分消费；所有这些交易都需要解锁并相加，在新的交易中花费 0.16 BTC，支付 0.02 BTC 给矿工作为交易费，然后将剩余的 0.01 BTC 退回到爱丽丝。

一旦比特币网络中的交易被提交，除非收款人启动新交易并将比特币退回到你的比特币地址，否则比特币交易是不可逆的。

与传统账户不同，输入值可以略高于输出值。在前面的例子中，爱丽丝向鲍勃发送比特币。它需要合并五个不同的交易输入并生成三个输出：一个给鲍勃，一个给矿工，剩余的退回到爱丽丝。

让我们来看看比特币交易的最常见类型。

##### 一输入 – 两输出

![](img/535492_1_En_3_Figa_HTML.png)

文本截图表示一个输入和两个带有值的输出，并指示标题摘要。

交易的两个输出是比特币交易的最常见类型。例如，爱丽丝向鲍勃发送 8 BTC，但她的交易 UTXO 有 10 BTC。她将得到剩余部分退回到她的地址。这部分剩余金额将成为她地址下下一个交易的输入。

##### 一输入 – 多输出

![](img/535492_1_En_3_Figb_HTML.png)

文本截图包括一个输入和多个带有值的输出。

交易的多个输出可能代表某人向许多收款人发送比特币。例如，如果账户是业务账户，可能是支付给其员工。

##### 多输入 – 一或两个输出

![](img/535492_1_En_3_Figc_HTML.png)

文本截图包括多个输入和 1 或 2 个带有值的输出。

当拥有许多不同金额较小的钱包地址时，所有者可以将这些资金转移到一个地址。另一种情况可能是业务账户接收公开的比特币支付。

### 交易池

在交易被添加到区块之前，它们首先被添加到一个公共交易池中。这些交易是“未确认”的。交易池，也称为内存池，包含所有已被验证但尚未被挖掘的未确认交易。

然后，矿工根据费用以及交易在池中的顺序位置从交易池中选择未确认的交易。较高的交易费将有更好的机会被选中。

一旦交易被挖掘或添加到区块链中，交易池就会被清空。然后，矿工将新块广播到网络。网络上的每个节点都有交易池的副本。当节点接收到更新时，它会调整其交易池。

### 交易费

交易费用作激励奖励，鼓励矿工在区块中验证用户交易和支持网络安全。从数学角度来看，交易费是比特币交易输入金额和输出金额之间的差额。

当比特币钱包发送交易时，它通常会显示一个选项，以选择每单位萨图什的费用率，缩写为 sats/vByte。此交易费将基于交易数据大小乘以此率计算。比特币块可以包含最多 4 MB 的数据，较大的交易将占用更多的块空间。因此，较大的交易将支付更多的费用。如果您想加快交易验证过程并减少等待时间，您需要在交易中包含更多的费用率，这使其更有可能包含在下一个块中。然而，如果您不介意等待，可以支付像两个萨图什/字节这样的最低费用。交易通常在一到一周内得到确认。可以用一个简单的公式表示为：

费 = 输入之和 - 输出之和

从高层次来看，比特币交易包含三个主要组件：元数据（包括头部）、输入和输出。这三个前述组件各自都有特定的大小。整体交易大小将是这些组件大小的总和，如下所示：

![](img/535492_1_En_3_Figd_HTML.jpg)

一个表格包括三列，交易输入、交易输出和元数据。

假设一笔交易具有以下大小，网络费率为每字节 10 萨图什：

+   每个输入 120 字节

+   每个输出 58 字节

+   元数据 22 字节

![](img/535492_1_En_3_Fige_HTML.jpg)

区块图输入 0 为 120 字节，输出 0 为 58 字节。还提到 22 字节。

对于每笔交易，总交易大小为：

输入 120（字节）+ 输出 58（字节）+ 元数据 22（字节）= 200 字节

如果交易费率是每字节 10 萨图什，那么发送 200 字节需要 2000 萨图什。

1 萨图什等于 0.00000001 比特币；2000 等于 0.00002 比特币。

在撰写本文时，BTC 的价格为 23,147.80 美元，因此总交易费为：

$23,147.80 * 0.00002 = $0.462956

你需要支付上述交易的$0.462956。

## 闪电网络

2016 年 1 月，Joseph Poon 和 Thaddeus 发布了一份名为《比特币闪电网络：可扩展的链下即时支付》的白皮书。闪电网络是比特币扩容的一种解决方案，它不受比特币主网络的限制。闪电网络是一种“第二层”去中心化支付协议，建立在比特币区块链之上，允许链下交易。交易过程只需要在双方之间进行验证，而无需将其作为交易提交给比特币网络。随着比特币的普及，闪电网络已经成为一种流行的比特币扩容解决方案。目前有超过 20,000 个活跃的闪电网络节点，拥有超过 83,000 个独特的支付通道。闪电网络的一些好处包括：

1.  1.

    **即时支付：**

    比特币网络每秒可以处理大约三到七笔交易（tps）。闪电网络建立一个点对支付通道，其中两个节点建立一个双向支付连接，并通过加密协议从 2-of-2 多重签名地址分配资金。通道内的双方可以提交交易并直接互相支付，而无需通过比特币网络的矿工验证创建链上交易—所以闪电网络内的支付过程几乎是即时的。

1.  2.

    **可扩展性**

    闪电网络上的通道是“双向的”，因为双方参与者可以根据通道容量发送和接收支付。

    通道容量是指参与者在通道中持有的总余额。例如，Alice 和 Bob 通过进行一笔 10 BTC 的交易来开启一个支付通道。如果 Alice 通过通道向 Bob 发送 10 BTC，她就无法接收任何支付。Bob 可以从 Alice 那里收到 10 BTC，但无法发送任何支付。然而，如果 Alice 向 Bob 发送 5 BTC，双方现在都可以在通道内发送和接收最多 5 BTC。根据通道容量，在没有链上矿工参与的情况下，可以在离线支付通道内发生许多交易，这可能会扩展到每秒数百万次交易（tps），从而大幅提高比特币网络的容量。

1.  3.

    **低成本**

    使用闪电网络的交易费用几乎为零。闪电网络的费用大约是一个 Satoshi 或 $0.000233。

1.  4.

    **跨区块链交易**

    只要区块链支持类似的加密哈希函数，闪电网络的功能就可以在多个区块链上实现。闪电网络可能会实现最终的去中心化交易所。交易可能会跨越多个区块链进行，无需第三方的参与。

1.  5.

    **隐私**

    没有区块链记录。个体闪电网络支付交易的详细信息并没有直接记录在区块链上。支付可能会通过许多连续的通道进行路由，每个节点运营商都能看到他们通道中的支付，但如果这些资金是非相邻的，他们将无法看到资金的来源或目的地。

闪电网络的几个限制：

闪电网络由两个节点之间的双向支付通道组成，这些通道共同创建智能合约。如果任何时候任何一方放弃通道，该通道将关闭并在区块链上结算。

由于闪电网络的争议机制的性质，该机制要求所有参与者始终监控他们的通道并跟踪网络广播的离线账本的状态，因此已经发展出了“观察塔”的概念。

### 闪电网络是如何工作的

最初，Alice 持有 A1 承诺交易，Bob 持有 B1 承诺交易。

对于 A1，撤销键 K [A1] 只有 Alice 拥有。

对于 B1，撤销键 K [B1] 只有 Bob 拥有。

假设 Alice 和 Bob 各自在钱包里拥有 5 BTC。Alice 想要将 2 BTC 发送给 Bob。

![](img/535492_1_En_3_Figf_HTML.jpg)

一个块形图表示资金交易。它指出 2 个 2 多重签名和 5 BTC。钥匙是 A1 K a1，B1 K b1。两个人物相连是 Alice 和 Bob。

Alice 和 Bob 通过将资金承诺到一个 2-of-2 多重签名地址并发送一个交易来开启闪电网络支付通道，这个交易也称为资金交易或锚定交易，发送到比特币网络。这个交易被挖掘出来创建通道。

Alice 和 Bob 都存入相同金额的钱——在我们的案例中，5 BTC——并且每个人都在上面加了个锁。

建立支付通道后，双方可以开始签名和交换交易。这些交易被称为承诺交易，将改变通道内的初始状态。

Alice 创建了一个新的交易，B2，它将 3 BTC 分配给 Alice 和 7 BTC 分配给 Bob。

Alice 签署 B2 并将其发送给 Bob。Bob 收到 B2，签署它并保留它。

![](img/535492_1_En_3_Figg_HTML.jpg)

一个块形图表示资金交易。它指出 3 BTC 和 7 BTC。钥匙是 A1 K a1，B1 K b1。两个人物是 Alice 和 Bob。

Bob 创建了一个新的交易，A2，它将 3 BTC 分配给 Alice 和 7 BTC 分配给 Bob。

Bob 签署 A2 并发送给 Alice。

![](img/535492_1_En_3_Figh_HTML.jpg)

一个块形图表示资金交易。它指出 3 BTC 和 7 BTC。它用笔标记指向 A2 和 B2。钥匙是 A1 K a1，B1 K b1。两个人物是 Alice 和 Bob。

Alice 收到 A2，签署它并保留它。

Alice 提供 K [A1]，使 A1 无效；她然后可以删除 A1。

![](img/535492_1_En_3_Figi_HTML.jpg)

一个区块图表示了资助交易。它指示了 3 B T C 和 7 B T C。钥匙是 A1 K a1，B1 K b1。这两个角色是爱丽丝和鲍勃。

鲍勃提供 K [B1]，使 B1 无效；他随后可以删除 B1。

![](img/535492_1_En_3_Figj_HTML.jpg)

一个区块图表示了资助交易。它指示了 3 B T C 和 7 B T C。被忽视的钥匙是 A1 K a1，B1 K b1。这两个角色是爱丽丝和鲍勃。

总结一下，支付通道创建了双方的钱池组合，然后以商定的方式转移池入资金的所有权承诺。

当爱丽丝或鲍勃在任何时候决定关闭支付通道时，他们可以签署一个关闭交易。关闭通道意味着双方拿回自己的钱，并在双方之间解决最终的余额。然后，这个交易将被比特币网络挖掘。无论在支付通道中执行了多少交易，比特币网络只会挖掘两个交易——打开和关闭通道的交易。

哈希时间锁合约（HTLC），如其名称所示，由两部分组成：哈希验证和时间过期验证。它是一种支付方式，其中双方同意一种金融安排，一方在截止日期前生成加密证明以获得另一方的特定金额。否则，钱将退还给付款人。支付通道默认为时间锁定。通过扩展哈希锁，支付可以通过多个端到端的支付通道路由。交易可以在没有直接通道连接的各方之间发送，因此任何连接到闪电网络的人都是单一、互联的全球金融系统的一部分。

让我们来看一个例子。

爱丽丝想要向鲍勃发送支付，但她没有与他的支付通道。爱丽丝与约翰有一个支付通道，约翰与鲍勃有一个支付通道。爱丽丝如何支付鲍勃？

鲍勃必须创建一个加密的秘密字符串（密钥），使用如 SHA-256 的哈希函数对其进行哈希，然后发送给爱丽丝。鲍勃还与约翰分享了这个哈希值。为了简化这个文字说明，我们将价值表示为 V。

![](img/535492_1_En_3_Figk_HTML.jpg)

一个图示展示了三个角色：爱丽丝、约翰和鲍勃。它表示了 V(8743 b)的价值和一个笔和锁的标记。

这个哈希 V 是锁；密钥是解锁 HTLC 的代码。

爱丽丝与约翰创建了一个哈希时间锁合约（HTLC），并告诉他，如果他能在两天内产生 V 的预图像，她就会支付给他。爱丽丝在广播后签署了带有两天锁时间的交易。约翰知道 V 时可以赎回它，之后，只有爱丽丝可以赎回。HTLC 允许爱丽丝对约翰做出有条件的承诺，同时确保如果约翰永远不知道 V 是什么，她的资金不会被意外烧毁。

约翰也做了同样的事情，设定一个 HTLC，如果鲍勃能在一天内产生 V，就会支付给鲍勃。然而，实际上鲍勃知道 V。因为鲍勃可以通过使用他的密钥从约翰那里提取所需的金额，所以鲍勃可以认为他从爱丽丝那里得到了付款。现在，他没有问题地将 V 告诉约翰，这样他们也可以收集他们的资金。

鲍勃在一天内将他的密钥透露给约翰，然后鲍勃得到了约翰的付款。

约翰在两天内将他的密钥透露给爱丽丝，然后约翰得到了爱丽丝的付款。

![](img/535492_1_En_3_Figl_HTML.jpg)

图片展示了三个角色，爱丽丝、约翰和鲍勃。它指出了一、二、三、四 B T C 过程，并提到了 K=V。

在大家合作之后，所有这些交易都在闪电网络内发生。大家以一种机械的方式得到付款。闪电网络在本质上几乎是原子的并且是双向的，这意味着每个人都能得到付款或者没有人能得到付款。

在闪电网络中，当支付交易被广播时，所有的个别交易将首先被验证，并且它们必须与交易历史相匹配，以避免广播虚假或错误的交易。对于欺诈交易还有一种惩罚，如果闪电网络发现系统中的不良行为者，他们会立即被收取罚款。这样，整个网络在确保信誉和一致性的同时，也 discouraging 不良行为。

## 摘要

本章的主要目的是介绍比特币网络的基本概念。虽然它只触及了整个比特币区块链的表面，但本章为您提供了丰富比特币知识的机会。本章从讨论比特币的历史开始，然后我们学习了比特币的基本概念（包括比特币钱包和比特币网络）。接下来，我们了解了比特币交易，使您熟悉了比特币区块链背后的关键概念，这些概念构成了比特币网络的脊梁。最后，我们还简要介绍了闪电网络的概念。

在下一章中，我们将继续跟随以太坊：通往加密货币之门的学习旅程。
