© 作者（The Author(s)，独家许可给斯普林格自然瑞士有限公司 2022A. Kumar 等人（eds.）现代计算系统的量子和区块链：愿景与进展数据工程与通信技术讲义 133[`doi.org/10.1007/978-3-031-04613-1_7`](https://doi.org/10.1007/978-3-031-04613-1_7)

# 量子生成建模及其应用案例

Kusal M. Abeywickrama^(1)，Srinjoy Ganguly^(2  )，Luis Gerardo Ayala Bertel^(3  ) 和 Saurav Mohanty^(4)（1）斯里兰卡努瓜杜瓦大学（University of Sri Jayewardenepura），努盖戈达，斯里兰卡（2）马德里理工大学（Technical University of Madrid），马德里，西班牙（3）卡塔赫纳大学（Cartagena University），卡塔赫纳，哥伦比亚（4）约翰·摩尔大学（John Moore’s University），利物浦，英国 Srinjoy Ganguly （通讯作者）邮箱：srinjoyganguly@gmail.comLuis Gerardo Ayala Bertel 邮箱：layalab@unicartagena.edu.co

## 摘要

生成模型描述了数据集如何根据概率模型生成以及如何通过对该模型进行抽样生成新数据。在以下工作中，我们介绍了量子中的生成模型方法以及为生成模型优化开发的其他算法，同时也介绍了基于量子生成模型的一些算法。我们描述了使用变分量子本征求解器进行分子模拟和优化的用例。我们描述的量子生成模型在许多重要用例中具有重要用途，其中我们讨论了概率分布、药物和金融应用中的期权定价的生成。我们回顾了各种应用及其影响评估，以确定量子生成器算法的使用是否比传统机器学习方法更合适。根据先前的工作，量子生成器算法的使用已被证明比传统机器学习方法更合适。这使我们将量子发展置于人工智能领域的位置。

关键词量子计算量子机器学习量子生成对抗网络生成对抗网络机器学习缩写词

DL

深度学习

GAN

生成对抗网络

KNN

K-最近邻算法

ML

机器学习

NN

神经网络

QGAN

量子生成对抗网络

QAE

量子振幅评估

RL

强化学习

SVM

支持向量机

VQE

变分量子算法

## 1 经典计算中的机器学习

目前，机器学习是最突出和最强大的技术之一。更重要的是，我们尚未完全发挥其潜力。它毫无疑问将继续在可预见的未来成为头条新闻。其中有一个子集称为深度学习，它专注于模仿神经网络的行为，以解决更复杂和非线性的问题。因此，拥有能够处理张量的更广泛的工具。

什么是机器学习？1959 年，Arthur Samuel [1]将机器学习定义为“赋予计算机学习能力而不是显式编程的研究领域”。1997 年，Tom M. Mitchell [2]给出了一个更技术性的定义：“一台计算机程序被认为在某一类任务 T 上通过性能度量 P 从经验 E 中学习，如果它在任务 T 上的表现，由性能度量 P 衡量，随着经验 E 的增加而提高”。

人类与数据的交互方式和关系由于机器学习的影响已经发生了根本性的变化。从自动驾驶汽车到能够击败最优秀人类的智能代理在“危险边缘”和围棋方面都有着出色的表现，这只是少数例子。大型数据集存在于许多应用中，推动着当前的技术和处理资源达到极限。主要类型包括监督学习、无监督学习和强化学习。

监督学习被认为是一种在标记数据上训练的机器学习算法。当输入变量添加并且它们的输出已知时，算法使用监督学习数据进行训练。我们将 X 作为自变量，Y 作为因变量。数据被处理，然后被分割或折叠。一个用于训练，剩下的用于测试。

在无监督学习中，与第一种不同，使用的数据是未标记的，这意味着它适用于没有先前知识的数据，采用聚类方法。目标是查看数据并发现其中的任何隐藏模式。让我们来看看机器学习中的一些显著的核心算法。线性回归被认为是基本算法。使用线性回归建立两个相关变量之间的联系是相当准确的。为此，首先确定独立变量，而将使用一个依赖变量来建立条件概率。它搜索的是分析关系而不是预先确定的关系。例如，使用这种方法可以确定体重和身高之间的相关性。线性回归的一个衍生算法，逻辑回归，用于分类而不是回归问题。它使用与线性回归相同的输入特征向量，但返回的不是连续的数值，而是一个类别标签。基于病人的医疗信息预测病人是否患病的算法就是逻辑回归的一个例子。

我们还可以强调的另一个是决策树，一种机器学习技术，根据代表性特征将大型输入集分成较小的组，以连续地达到较小的适合信息以描述准确的输出。它要求我们对数据进行标记（数据需要分配一个或多个标签，例如照片中的名称，例如植物的名称），然后该方法尝试使用该知识来标记新数据。

另一方面，二元分类是一种离散的机器学习过程，将数据分类，最常见的例子是垃圾邮件，其中将 0 分配给故障邮件，将 1 分配给正常邮件，除了这种方法之外，还存在回归，需要连续和依赖变量来预测值，例如尺寸与价格之间的关系，比如房屋价格与其面积相关。这种查询对决策树算法非常理想。当一个条件变量是定量的时候，例如，为了确定贷款客户的可能性，可以使用估计回归树。随机森林是决策树的集成。集成学习是一种使用多个学习算法来提高预测性能的方法。这样，模型更有效地泛化，并且不太可能过度拟合[3]。

也有一个特殊的算法，支持向量机（Support Vector Machine），这种方法致力于确定一个在 N 个变量空间中有用的超平面，用于分析数据结构以进行分类或回归。有许多超平面，两种类型的数据点可以形成。其主要目标是识别具有最大间隔或将数据点分离为两个类的平面。最大化每个边界距离提供了显著的支持，更容易地解析数据对象。

最基本的算法之一，K-最近邻算法（K-Nearest Neighbours，KNN），可以在分类或回归查询中工作。这个决定找到 k 个最近的邻居，并根据平面上最近的一组点的类的多数投票提供预期的输出。

对于回归问题，其目的是通过计算显著的均值估计和最近邻居，发现 k 个最接近的邻居，并预测理想输出。这是一种无监督学习算法，这意味着它从未被标记的数据中学习模式。这意味着模型可以被训练来在不需要首先标记数据的情况下在任何数据集上构建集群。

还有一种特殊的方法，即主成分分析，它避免了在高维空间中的过拟合等问题。这是一种降低变量数据量的方法，选择大量输入数据集中最相关的部分。这缩短了数据空间大小并保留了最佳潜在信息。这种策略合并高度相关的变量以生成更少的洞察变量，称为“主成分”，可用于大多数数据减少方差并避免过度拟合或拟合不足。

现在我们介绍深度学习的基础知识。它是 ML 的一个最复杂的子集。它通过预测、分析层内的信息输入来为计算机“学习”。数据可以是非结构化的，如文本、声波、图像，可被表达为矩阵以进行解决或提供特定的应用。它试图模仿神经系统的工作方案。其目标是通过模拟人脑的功能来产生一些真正的魔法。深度学习算法用于识别输入和输出之间的相关性，使用所谓的神经网络。神经网络结构示例如图 1 所示。![](img/516210_1_En_7_Fig1_HTML.png)

图 1

三层神经网络的示意图

接下来，我们可以看到输入，经过前馈隐藏层，以及输出，输出可以是单个或多个，每个层由节点组成，处理其数量。输入层以数字形式表示数据，对于图像来说，信息被视为每个像素中的 RGB 矩阵，输出层则是测试集的参考，并提供了关于工作的证据或准确性，同时，隐藏层通过处理、分析和更新参数来进行最大的计算，以减小期望值的损失误差。

所以，为什么它被称为“深度学习”？深度学习被定义为创建许多称为深层网络的隐藏层。现在，通过添加额外的权重和偏差，依赖大量层是否可以改善算法估计复合函数的能力。深度学习是一个令人着迷的领域，它正在大大改变我们的社会。我们应该对深度学习和深度学习的基础感兴趣，因为它很容易理解。

在神经网络中存在各种类型的模型，比如卷积神经网络和循环神经网络，这些实践取决于我们将要处理的问题标准。神经网络总体上是以层的形式设计和描述的，这些层通过激活函数做出响应，并使用先前的数据输入以及权重和偏差进行馈送。

最后但并非最不重要的是，强化学习，一种机器学习技术，其输入不是原始数据，算法需要自行识别场景。强化学习是一种常用于未来独立步骤序列的指导，比如机器人设备、策略游戏或自主导航。强化学习通过反复尝试和错误来学习，每次执行都会产生出色的结果。

在接下来的部分中，我们将探讨量子机器学习，这是一个令人兴奋的领域，因为它是量子和机器学习的结合。

## 2 量子机器学习

机器学习算法必须非常有效地处理大量数据，包括先前收集的输入-输出数据对。随着全球存储的数据量每年增长约 20％[4]，有压力寻找执行机器学习算法的新方法。如果数据点投影到更高的维度，经典计算机无法执行这样的计算。即使经典计算机可以处理，也需要更长的时间。因此，将量子信息处理和机器学习相结合的目的已成为近年来的重要研究方向[5–7]。

### 2.1 量子机器学习的兴起

量子机器学习是机器学习和量子计算机结合的领域，它将改变未来的发展方向[6]。大量数据通过机器学习方法进行计算，而量子机器学习则利用量子比特和量子操作或特定的量子算法增强了计算速度和数据存储能力。

根据数据的生成或处理方式，可以通过几种方式将量子计算和机器学习结合起来，如图 2 所示。这包括经典和量子处理的组合，其中计算成本高昂的经典算法由量子设备执行[5]。第一种方法是，通过经典实验生成的经典数据集可以使用量子算法进行处理。另一种方法是，可以应用量子算法而不是经典数据来测量基于量子实验的量子状态[8]。除此之外，经典机器学习方法适用于由量子实验生成的数据，例如学习多体量子系统的相变[9]。最后一种方法是通过量子计算机处理量子数据[7]。![](img/516210_1_En_7_Fig2_HTML.png)

图 2

量子计算方法

### 2.2 量子信息处理概念回顾^(1)

量子位（或量子比特）是经典比特的量子对应物，由两个状态组成。这两个量子位态，称为狄拉克符号，类似于经典的二进制状态，并且可以同时处于两个状态以及两个状态的叠加态。量子位可以使用以下符号描述，|*ψ*⟩ = *α* | 0⟩ + *β* | 1⟩，其中 *α, β* ∈ *C*，且 | *0*⟩，| *1*⟩ 在希尔伯特空间 *H*^(*2*) 中。量子动力学始终保持归一化条件，即 | *α* |² + | *β* |² = 1。Bloch 球给出了量子位的图形表示，如图 3 所示。量子理论基于一种观察，即测量在态 | 0⟩ 或 | 1⟩ 中的概率，其平方振幅为 | *α* |²，| *β* |²。因此，量子位的状态不能仅定义为‘0’或‘1’状态，并且可能在两种状态中的任一状态中被测量。这允许在两种状态中同时执行计算，这称为量子并行性。量子位可以在 Bloch 球中显示。![](img/516210_1_En_7_Fig3_HTML.png)

图 3

使用 Bloch 球表示量子位

当考虑具有两个量子状态的 N 个量子位系统时，量子机器学习的力量显而易见。量子系统可以允许所有 2^n 组合的叠加态存在。例如，考虑一个由 2 个量子位组成的系统，叠加态包括总共 4 个状态，{| *00*⟩ + | *01*⟩ + | *10*⟩ + | *11*⟩}。所有这些组合都可以通过算法并行处理。然而，通过测量产生的结果的不确定性总是限制量子计算机的效率。当测量一个量子位时，它将是 | 0⟩ 或 | 1⟩，然后系统将会坍缩到观察到的量子态。在此测量之后，系统将只生成观察到的状态作为输出。

引入量子信息理论的特定形式概念非常重要。在量子力学中，最重要的概念之一是幺正算符（U），它代表向量的转换。如果我们分析幺正算符及其共轭转置的乘积时，它始终等于一（*U*^† *U* = 1，其中 *U*^† 是共轭转置）[10]。量子算法是一组定义量子系统动态的幺正算符，这些幺正变换是比特操作的量子对应物。一定数量的这些量子门仅适用于单量子比特。例如，X 门可以翻转量子比特的状态，而 Z 门可以改变单一量子比特的振幅符号。通过应用哈达玛门（H 门）可以产生叠加态[11]。但是像控制非门（C-NOT）门这样的门需要多于一个量子比特才能完成其操作，并且只有当第一个量子比特处于状态 | 1⟩ 时，它才会翻转第二个量子比特的状态[11]。幺正变换 *U* = *e*^(*−iHt*) 可以从薛定谔方程得到量子门的更一般公式，而薛定谔方程是量子理论的基础。

量子比特具有一种称为纠缠的量子物理不同属性[12]，类似于叠加。由于叠加，量子比特可以同时处于许多状态，而纠缠则在两个量子比特之间创建了相关性，即使它们在物理上是分开的位置。当量子纠缠发生在两个粒子之间时，个体量子态在测量之前是不确定的，并且一个粒子的测量结果决定了另一个粒子的测量结果，即使测量过程相距甚远。上图（图 4）是量子纠缠电路的图形表示之一。n 个量子比特的量子态意味着所有可能的配置都处于叠加态（2n）。n 个量子比特的电子自旋的量子纠缠将希尔伯特空间的维度指数级地从 2 扩展到 2^(*n*)。![](img/516210_1_En_7_Fig4_HTML.png)

图 4

量子电路（量子纠缠电路）

因此，量子算法提供的计算优势比经典算法更多。量子范式不是为了快速解决问题，而是要用全新的技术和更有效的方式来解决问题。此外，当使用传统计算无法一次生成如此多状态的技术时，使用叠加或纠缠等概念，量子算法可以具有显着优势。

### 2.3 变分量子算法（VQAs）

在量子领域运行时，量子位（qubits）的行为非常微妙且难以预测。此外，随着量子位数量的增加，量子位的脆弱性也增加。用于制造的材料质量直接影响量子位的稳定性。由于这种不稳定性，很难保持量子位的高相干时间。然而，我们需要大量量子位来解决高相干时间的先进问题。目前，还无法访问这类量子计算机，但是由大量具有较低相干时间且非常嘈杂的量子位组成的嘈杂中间尺度量子（NISQ）计算机[8, 13]可以使用。

变分量子算法（VQAs）[14, 15] 是量子计算中的一个改进，运行在采用经典优化器来训练参数化量子电路的 NISQ 计算机上。可以将变分算法用作许多用例的构建模块，包括量子分类器的设计。在复杂性和操作速度方面，其操作方式类似于经典支持向量机。支持向量机（SVMs），通常称为 SVMs，是一种用于解决分类和回归问题的监督学习模型，常用于机器学习中。与任何支持向量机一样，量子变分电路以与普通 SVM 相同的方式进行超平面切片。

只要核函数在经典计算机上高效执行，基于量子逻辑的分类器在性能上就没有优势。然而，当特征空间非常宽广且核函数难以发现时，量子计算可能会带来极大的好处。变分算法，就像传统的支持向量机一样，利用量子处理器运行的希尔伯特空间来确定最佳的超平面切割。该算法用于训练和分类。训练阶段利用先前分类的数据集。依赖自由参数的量子算法被称为变分或参数化量子电路。它们，就像普通的量子电路（如图 5 所示），由三个组成部分构成[16]；（i）固定初始状态的准备；（ii）由一组自由参数 ***θ*** 定义的量子电路 ***U(θ)*** 的创建；以及（iii）在输出时，测量一个观测算符 ***B̂***。![](img/516210_1_En_7_Fig5_HTML.png)

图 5

变分量子电路

### 2.4 变分量子本征求解器（VQE）

当我们精确分析应用于计算的量子力学时，需要引入一些假设，这些假设塑造了理论并作为其他推理的基础。在这里，我们想要建立对 VQE 的正式视角，我们必须了解以下声明的相关性：

+   系统的可观测量由厄米线性算符表示。可观测量的本征值集称为谱，其精确或近似的本征矢量在希尔伯特空间中定义了一个基。

+   当系统处于归一化态时，对可观测量 A 的测量将得到本征值 a，概率为 ![$$PA|\Psi \rangle ={|\langle a|\Psi \rangle |}^{2}$$](img/516210_1_En_7_Chapter_TeX_IEq1.png)。特征向量与本征值 a 相关联，在希尔伯特空间表示中表达为 A|a⟩ = a|a⟩ [17]。

随后可以肯定 VQE 是量子力学变分方法的一个应用，通过以量子-经典混合方式进行算法，主要用于找到哈密顿矩阵的本征值，方法是准备一个任意选择的波函数 |Ψ⟩ 并利用 Ansatz，即一个带旋转门的参数化量子电路，创建提供测量以估算期望值的状态向量 [17]。

#### 2.4.1 量子特征向量的变分算法

VQE 与一个变分量子算法相关联，其最常见目的是尝试近似量子系统的基态。它是一种用于近似某些基态 |Ψ⟩ 和最低能量 E[min] 的方法，包括两个主要步骤。

首先通过一些参数 theta 选择试探态或标准态 |Ψ(θ)⟩，条件是只属于一个子空间，而不是查看描述所有可能的量子态的完整希尔伯特空间，然后第二步是变化 theta 参数以使能量值最小化，找到使试探态能量最低的合适参数 theta，自动我们可以近似得到基态 |Ψ⟩，因此标准态的选择对变分方法的工作非常重要。图 6 是这样一个量子电路的简单表示。![](img/516210_1_En_7_Fig6_HTML.png)

图 6

依赖于参数 θ 的量子电路；初始态、参数化电路和可观测量测量

使用变分量子电路 U(θ)准备量子态是获取提供如此方式的假设态，通过在量子计算机上运行电路来最小化 theta 参数的损失，从而给出能量值的测量结果，这将作为经典优化器的输入进行前馈，然后进行混合量子/经典反馈迭代以更新参数。

#### 2.4.2 VQE 使用案例 - 化学

变分量子本征求解器是一种吸引人的算法，尤其是在大规模矩阵中，化学中我们可以强调其用途，由于大数据如原子数的增加，当涉及到化学反应时，该算法已在模拟分子和化学反应中寻找基态能量中发挥作用。由于 VQE 的主要原因之一是与矩阵的本征值进行近似，其在量子化学中的原理是解决分子哈密顿本征值问题，这显示了关于大分子性质的一种途径，而经典计算机难以高效地做到这一点。

在实际情况中，已经有化学化合物中 VQE 的演示，例如 H[2]O，LiH，BeH[2]，2017 年最后一种成功在 IBM 量子计算机上实现了分子的基态能量的估计[18]。通过研究分子的基态，可以获得变化的原子间距之间的能量势和在势能面上最低的能量对应于分子的最稳定结构[19]。

要在超导量子处理器中高效解决分子结构问题，如果我们以 BeH[2] 化合物为参考，则基于费米子和量子比特算符之间的映射是必要的[20]。BeH[2] 哈密顿量定义了与 Be 相关联的 1s，2s，2px 轨道和与每个 H 原子相关联的 1s 轨道。为了获取 BeH[2] 的势能曲面，作者分别使用 2、4 和 6 个量子比特，在 d = 1 的深度下，针对不同原子间距的范围，搜索其分子哈密顿量的基态能量[19]。

展示使用变分形式中的单量子比特来解决类似于基态能量的问题的视角，应该给出一个随机概率向量，然后找出如何确定这个量子比特的可能参数化，其中它必须生成与该向量接近的概率分布。

## 3 量子生成对抗网络

在经典深度学习领域取得的最有前途的进展之一是 GAN（生成对抗网络）[21]，它是生成式机器学习模型的一部分。GAN 的思想是基于提供的其他训练数据样本生成尽可能逼真的数据样本。GAN 是更大的模型，比传统的深度学习模型更难训练，但尽管它们的训练限制，它们在工业中找到了一些非常有用的应用。一些主要应用包括图像超分辨率，图像生成，3D 对象生成和文本生成。

经典 GAN 的构建由两部分组成，如图 7 所示—*生成器* 生成新的数据样本，可以是图像、文本或音频，以及 *判别器* 其工作是区分生成器生成的样本和真实世界的数据样本。 在结构上，生成器和判别器都由神经网络层组成，可以近似复杂的函数，并捕捉提供给它们的数据特征的本质。 现在我们将详细了解经典 GAN 的架构，从中量子 GAN 的泛化将更有意义，您将看到它相当直观。![](img/516210_1_En_7_Fig7_HTML.png)

图 7

本图显示了常见的 GAN 组件

### 3.1 GAN 的架构和训练

回顾之前对生成对抗网络（GAN）的解释，生成器试图生成尽可能接近真实样本的样本。为方便起见，生成器将被称为 G，鉴别器将被称为 D。因此，我们可以假设我们有一些真实数据样本源 R，它可以生成这些真实数据样本的某种概率分布，称为*p*[*R*]*(x)*。此外，数据样本的生成器分布由*p*[*G*]*(x)*给出，其中*x*是输入数据样本。G 网络将一个随机变量*z*作为输入，该变量从某个正态或均匀分布中抽取，然后 G 的任务是将这个输入转换为数据样本，从而生成*p*[*G*]*(x)*。D 将真实数据或 G 生成的数据样本作为输入，并比较它们是否彼此更接近。现在根据对抗学习原理，G 希望最大化 D 误分类其生成的数据点的概率，而不是真实数据样本。另一方面，D 希望最大化成功分类与 G 希望相反的真实数据样本的概率，这创建了一个对抗性训练系统。

### 3.2 量子生成对抗网络（Quantum GAN）的结构和训练

在本文关于量子机器学习的整个讨论中，我们仅考虑了监督机器学习方法，因为这是最受欢迎的，也被各个行业广泛使用的方法。在这里，对于量子 GAN 的讨论[22, 23]，我们也将采用监督学习的方法，并且这意味着与数据样本相关联的标签。我们将要描述的主要量子生成模型结构和训练已在[24]中解释，我们将简要解释 GAN 的主要结构和性质。我们将重点关注量子 GAN 的条件 GAN 方面，因为它们提供了用于样本生成的标签条件。

现在，从架构上看，经典的模型和上图所示的量子 GAN 非常相似，其中我们有一个量子 D，它将作为输入的量子状态从量子 G 中区分开来（量子 G 采用量子噪声向量状态 | *z* > ，类似于你回忆的经典 G 情况），以及真实数据源 R。你可以回忆一下，在经典情况下，G 和 D 是深度神经网络层，因此在量子 GAN 的情况下，这些被量子变分电路取代，其中量子 G 的参数由 *θ*[*G*] 参数化，它接受输入标签状态 | *λ* > 和量子噪声 | *z* > ，产生一个具有与真实数据相应相似性的密度矩阵。当 | *z* > 随机波动时，可以为特定标签创建更多输出样本，并通过调整 | *z* > 来捕获生成样本的各种潜在属性，这些属性不被标签 *λ* 捕获。

图 8

这个图展示了基本的 QGAN 组件。

为了训练量子 GAN 模型，使用量子目标函数，以便训练过程高效进行。对于每个训练过程，G 和 D 参数都被初始化为一些随机值，然后通过公平硬币来选择 G 或 D 的启动过程。对于模型的训练，可以使用量子梯度，它依赖于数值有限差分法。通过使用这种技术，梯度可以在量子计算机上计算出来。

## 4. QGAN 的用例 —— 药物发现

通过前面部分介绍的 QGAN 的工作原理，我们现在将考虑 QGAN 技术的一个用例或实际应用。这个应用是在化学领域，更具体地说是在药物发现领域，其中要搜索的化学空间在维度上非常大，经典的 GAN 不适合进行这些发现，因为存在维度灾难。GAN 试图发现那些对疾病细胞更具亲和力的分子化合物，并在击败疾病机制方面取得更高的成功率。

论文中使用的称为 QGAN with Hybrid Generator（QGAN-HG）的技术将被审查，因为它是 QGAN 在化学/药物发现应用中的一个重要案例研究，除了通常的金融应用之外。通常，我们需要更多的量子比特来生成一个小分子，但是 QGAN-HG 在量子比特利用上非常高效，可以用更少的量子比特来生成分子。

QGAN-HG，就像 QGAN 一样，由一个变分量子电路组成，其中包括初始化层、参数层和测量层。通过应用测量层，提取一个特征向量，然后将其馈送到经典神经网络层（QGAN-HG 的 HG 部分），接着是一个原子和键层，成功形成原子向量和键矩阵。QM9 数据集[25]用于训练 QGAN-HG 模型，并且使用 Frechet 距离作为度量标准，通过将其与数据集中的真实分子进行比较，来衡量 QGAN-HG 生成的分子的性能。

使用前面描述的体系结构和设置，即使只有 4 比特，QGAN-HG 的性能也比其经典 GAN 对应物表现显著，这是因为使用的变分量子电路的表达能力强。获得的 Frechet 距离值与原始值结果一致。使用 RDKit 评估生成的分子的各种化学性质，然后最终将生成的预测分数反向传播到经典神经网络（HG）和变分量子电路，以更新其参数。

### 4.1 QGAN 用于加载随机分布

在本小节中，我们讨论了一种具有量子生成器和经典鉴别器的 QGAN 版本，该版本记录了经典训练样本的概率分布，该版本已在 IBM 文档[22]中发表。我们将研究如何在多项式时间内使用量子态加载分布数据的 QGAN。

可以使用量子生成对抗网络（QGAN）来学习数据库的随机分布，并将其直接加载到量子状态中，对于给定的 k 维数据样本：![$$\left| {{\text{g}}_{\theta } } \right. = \mathop \sum \limits_{i = 0}^{{2^{n} - 1}} \sqrt {p_{i} } \left| i \right._{n}$$](img/516210_1_En_7_Chapter_TeX_Equ1.png)(1)

其中描述了基态| *j*⟩的出现概率。

QGAN 的训练旨在生成一个状态| *g*⟩，其中，描述了接近训练数据基础分布的概率分布。将均匀分布加载到量子状态中是简单的，因为每个量子比特只需要一个 Hadamard 门[23, 26]。虽然加载正态分布需要更先进的方法，但所需的*O(poly(n))*门[24]很少会主导量子算法的总门复杂度。以下是训练和评估 QGAN 模型的步骤摘要。

量子生成对抗网络（QGAN）由一个量子生成器*G*[*θ*]、一个变分量子电路和一个经典鉴别器*D*[*ϕ*]，一个神经网络组成。为了实现量子生成器，选择了深度为 1 的变分形式，它实现了*R*[*Y*]旋转和*C*[*Z*]门，这些门以均匀分布作为输入状态。特别是，生成器的参数必须对于 k > 1 要仔细选择。例如，电路深度应该大于 1，因为更高的电路深度可以显示更复杂的结构。经典鉴别器是基于 NumPy 实现的神经网络。

在训练过程中，鉴别器和生成器的参数根据以下损失函数进行调整：![$$L_{G} \left( {\phi ,\theta } \right) = - \frac{1}{m}\mathop \sum \limits_{I = 1}^{m} \left[ {\log \left( {D_{\phi } \left( {g^{l} } \right)} \right)} \right]$$](../images/516210_1_En_7_Chapter/516210_1_En_7_Chapter_TeX_Equ2.png)(2)和![$$L_{D} \left( {\phi ,\theta } \right) = \frac{1}{m}\mathop \sum \limits_{I = 1}^{m} \left[ {\log \left( {D_{\phi } \left( {x^{l} } \right)} \right) + log\left( {1 - \left( {D_{\phi } \left( {g^{l} } \right)} \right)} \right)} \right]$$](../images/516210_1_En_7_Chapter/516210_1_En_7_Chapter_TeX_Equ3.png)(3)

其中，m 是批量大小的描述，*g*^l 是量子生成器数据样本的描述。

利用 QGAN，我们可以在多项式时间内有效地将随机概率分布加载到量子数据状态中，这可以用于银行和金融领域中的其他量子算法，如 QAE。为确保 QGAN 的最佳性能，必须适当设置生成器初始化的概率分布。进一步的研究发布了其他分布，以展示 QGAN 在量子金融研究中的有效性及应用。

### 4.2 使用 QGAN 进行期权定价^(2)

期权是金融衍生品，赋予购买者在约定价格和日期下购买或出售资产的权利。期权的价格，称为期权费，由多个变量组成，正确定价期权非常重要。Black–Scholes 模型、蒙特卡洛模拟和二叉树期权价格模型是广泛用于估计期权的模型之一 [27]。这些理论存在很大的误差范围，因为它们的价值是从其他资产衍生出来的。期权定价理论主要旨在确定到期时执行期权的概率。股票价格、行权价格、波动率和到期时间是用于输入数学模型以准确计算期权价格的典型变量。一种股票的基础期权是看涨期权，它赋予持有者在特定时间段内以某一价格购买股票的权利，而看跌期权允许持有者在特定时间段内以规定价格出售股票。本节将进一步讨论由 IBM 研究人员团队执行的工作，该工作基于只能在到期时建模的欧式看涨期权，并由 Black–Scholes 进行模拟和分析计算。他们提出了一种定价期权和期权组合的方法，并建议使用量子电路来实现它。

期权的相关变量包括标的资产价格分布（S[T]）、期权的到期时间（*T*）以及期权的支付函数（*f(S*[*T*]*)*）。Black–Scholes 模型建立在这样一个假设上，即欧式看涨期权到期时的标的价格 ST 服从正态分布 [28]。因此，量子生成对抗网络（QGAN）可以在对数正态分布上进行训练，并且其输出也可以作为期权的不确定性模型。接下来，可以构建一个量子电路来加载这个不确定性模型。电路的输出通过方程式 (1) 进行读取。

量子振幅估计（QAE）可以与训练有素的不确定性模型结合使用，以预测期权的支付函数的期望值。量子振幅评估（QAE）是一种简单但强大的量子方法，当适当使用时，能够为传统上使用蒙特卡罗模拟的问题提供高速解决方案[22, 28–30]。然而，一般来说，预计需要通用容错量子计算机，以与传统蒙特卡罗模拟相比获得二次加速。然而，在金融行业中，标准投资组合的成本需要比当前一代量子计算机更强大的量子硬件，能够执行更复杂的量子电路，具有更多的量子比特。

## 5 结论

在本章中，我们从经典机器学习领域背后的基本概念开始了我们的旅程，以及在当前机器学习行业中相关的各种类型。然后，我们将注意力集中在量子机器学习模型的基础上，其中使用了由参数化电路组成的变分电路，并且比经典神经网络具有更好的表达能力来学习特征。除此之外，我们看到了使用 VQE 算法进行分子模拟的变分算法的用例。然后，我们基于量子机器学习的概念，了解了更多关于量子生成对抗网络的知识，这是量子生成建模的最基本形式，并利用变分电路构建其生成器和判别器组件，并使用量子梯度优化其对抗目标函数。最后，我们探讨了 QGAN 的 3 个重要用例，包括小分子药物发现、随机分布的加载以及金融应用中的期权定价。此外，量子机器学习的另一个应用是处理自然语言，在这项工作中，我们希望扩展我们在量子自然语言处理方面的工作。
