# 第八章

# 技术限制、威胁和漏洞

在前一章中，你学习了节点之间通信的技术细节。这帮助你理解了交易和区块如何在网络上传播，节点如何找到对等节点，以及节点如何确定要连接哪个节点。

现在你已经深入了解了比特币协议，你可以从技术角度理解其局限性和脆弱性。

在本章中，我们将学习比特币的设计和实现如何为其使用创造局限性。我们将了解这些局限性为什么重要，以及它们如何赋予比特币其特性。我们还将学习比特币网络可能被攻击或受损的不同方式，以及为什么它仍然安全，可能不会很快受到攻击。此外，我们将讨论那些似乎今天安全但可能在将来成为其安全潜在风险的漏洞。

# 结构

在本章中，我们将涵盖以下主题：

+   设计限制

    +   区块大小限制

        +   交易验证的影响

            ![](img/ent.jpg) FIBER：快速互联网比特币传输引擎

        +   区块链大小的影响

    +   区块时间限制

    +   隐私限制

    +   隐私和扩展解决方案

        +   改进的硬件

        +   Utreexo 累加器

        +   签名聚合

        +   MAST：Merklized 抽象语法树

        +   Taproot

        +   雷电网络

        +   CoinJoin

        +   搅拌服务

+   比特币挖矿能源消耗

+   个人和网络的威胁

    +   来自政府的威胁

    +   来自中央银行的威胁

    +   恶意黑客

        +   比特币盗窃

            ![](img/ent.jpg) 利用加密弱点

            ![](img/ent.jpg) 恶意软件

        +   勒索软件

    +   丢失私钥或种子短语

    +   由于漏洞带来的威胁

        +   交易可塑性

        +   粉末攻击

        +   内存池洪水攻击

        +   自私挖矿

        +   BGP 劫持攻击

            ![](img/ent.jpg) 网络分区攻击

            ![](img/ent.jpg) 延迟攻击

        +   0 确认攻击

        +   隐藏哈希率

        +   黑名单地址

        +   重放攻击

        +   空块挖矿

        +   比特币挖矿集中化

            ![](img/ent.jpg) 51% 攻击

        +   女巫攻击

        +   服务拒绝（DoS）攻击

        +   量子计算攻击

        +   隐藏的错误、错误利用和重组

    +   欺诈和抢劫

# 目标

本章的主要目标是让读者从技术和非技术角度质疑比特币的合法性、必要性和价值。

此外，了解技术的攻击向量可以帮助你更好地为此做好准备并采取预防措施，使其对你影响较小。

所以，我们将在本章尝试回答以下问题：

+   为什么比特币没有非常大的区块大小？

+   为什么比特币没有更短的区块时间？

+   比特币真的需要消耗这么多能源，这如何影响环境？

+   比特币网络可能受到的不同攻击方式有哪些？这些攻击方式的严重性如何？

+   这项技术未来有风险吗？

+   除了技术漏洞，可能还有其他漏洞吗？

# 设计限制

比特币区块每 10 分钟挖掘一次，每个区块对于预 SegWit 限制为 1MB 大小，对于 SegWit 限制为 1MB 的 v 大小。这导致了低交易率。以下是历史上每秒交易量的图表：

![](img/Figure-8.1.jpg)

**图 8.1:** 每秒平均交易量

我们可以看到，比特币交易量达到了每秒 18 笔。即使区块包含所有 SegWit 交易，也只能达到平均每秒 25 笔。相比之下，Visa 平均每秒处理 2000 笔交易。这意味着比特币不适合在全球范围内进行小额支付。为了与 Visa 竞争，比特币需要是目前区块大小的 100 倍，或者需要在不超过 10 秒的时间内生成区块。

比特币在提供隐私方面也不是很好。由于所有交易都在区块链上，大多数比特币买卖是通过受监管的交易所进行的，几乎所有交易都可以通过大数据分析联系起来。

# 区块大小限制

增加区块大小或减少区块时间对网络和区块链大小的影响相似。将区块大小增加 10 倍或将区块时间减少 10 倍，由于区块传播会导致类似的网络流量增加和类似的区块链大小增长。

# 交易验证的影响

挖矿节点争相解决一个加密谜题以挖掘区块。当一个区块被挖掘时，它会在网络上发布。区块需要迅速到达所有节点。如果在区块传播过程中，另一个节点解决了加密谜题并发布了它的区块，节点之间会在比特币区块链的下一个区块上产生分歧。因此，形成了两个竞争的链，它们竞争证明哪一个是正确的链。累积了更高*PoW*的链被认为是更长的链并被接受，而另一条链被丢弃。

如你所想象，如果区块传播不快，可能会形成多个竞争链，随着传播延迟的增加，解决正确链的时间可能会呈指数增长。

以下是自 2015 年以来区块传播延迟的图表。图表中有一些空白，因为一些数据缺失：

![](img/Figure-8.2.jpg)

**图 8.2:** 区块达到 90%节点的 30 天滚动平均时间

如你所见，区块传播延迟从 2015 年的 15 秒降低到 2018 年的 2 秒。自 2016 年以来，P2P 比特币网络协议消息中引入了多项增强。这可能是传播延迟迅速降低的原因。

通常的做法是等待 6 次确认后再接受交易。这是因为如果由于同时挖掘区块而产生竞争条件，它通常在第六次确认之前得到解决。

如果由于同时挖掘区块而产生竞争条件，但在接下来的六个区块内没有解决，那么它将影响已确认交易的总体信心。

因此，区块大小是传播延迟和比特币网络信心的一个重要因素。

# **快速互联网比特币中继引擎**（**FIBRE**）

**快速互联网比特币中继引擎**（**FIBRE**）是一个旨在将比特币区块以与连接的节点相比拟的延迟交付给连接的节点的协议。它依赖于一个管理良好的网络来传递预期的结果。

使用 FIBRE，竞争链的可能性大大降低。这使得自私挖掘变得困难，使网络更加公平。

# 区块链大小的影响

正如您通过改进八卦协议所学的，我们可以大大减少传播延迟，进而允许区块大小增加。然而，区块链大小是增加区块大小的另一个重要障碍。目前，比特币区块链已经是 400GB，去年增加了近 60GB。

以下是随年份增加的区块链大小的图表：

![](img/Figure-8.3.jpg)

**图 8.3**：历年区块链大小的变化

如果我们还包括所有的索引，这个数字增加到 390GB。如果交易数量甚至更高，那么我们可能看到每年增加多达 100GB。这是一个 significant number，使运行完整节点变得有点成本高昂。对于大多数比特币爱好者来说，运行完整节点意味着放弃 400GB 的磁盘空间，这可能会在每年增加 100GB。在两年内，它将变成 500GB 的备用存储空间，在几年的时间里，可能会增加到 1TB。为了允许大学生或爱好者维护完整节点，磁盘存储成本应该降低，超过 1TB 成为笔记本电脑的标准。

以下图表显示了每 365 天区块链大小是如何增加的：

![](img/Figure-8.4.jpg)

**图 8.4**：区块链大小变化率（365 天滚动和）

作为替代方案，比特币核心提供了一个选项来修剪区块链并将其限制在一个更小的尺寸。比特币核心维护未花费交易和区块的索引，因此修剪节点仍然可以验证交易和区块，仍然被认为是完整的节点。然而，它无法重建修剪的区块，也无法为对等节点提供区块请求。由于每个区块都包含对较老区块的引用，如果维护了最近的区块并且有足够的节点维护完整的区块链，这并不是问题。

修剪节点有几个优点。一个修剪节点可以用仅 288 个区块创建，这不会超过 1GB。因此，使用修剪节点，我们可以在嵌入式设备上运行完整的节点。

然而，这仍然无助于增加块大小，因为区块链验证需要数天才能完成。所以，磁盘上的区块链大小不是增加块大小的主要限制因素；相反，阻止我们增加块大小的主要因素是区块链验证时间本身。

目前，由于验证时间，下载整个区块链需要花费 1 到 7 天的时间。

为了减少区块链验证时间，我们要么需要等待性能更好的计算机能够减少验证时间，要么需要找到更高效的块验证算法。

# 块时间限制

块时间调整每 2016 个块发生一次，基于网络哈希率。网络哈希率分布不太均匀，因此会受到环境灾害和政府控制的影响。

以下是 2016 个块的滚动平均挖掘一个块的平均时间：

![](img/Figure-8.5.jpg)

**图 8.5：** 挖掘一个块的平均时间（2016 个块的滚动平均）

过去的一些事件导致哈希率下降：

2020 年 8 月，中国的暴雨导致哈希率下降了 15%。

2021 年 6 月，中国实施了加密货币挖矿的禁令，导致网络哈希率下降超过 50%。在前面的图表中，我们可以看到块时间增加了超过 15 分钟。

哈希率的下降导致块时间增加，这会导致更多的交易在被包含在块中之前达到内存池。由于更多的交易争夺进入区块链的机会，交易费用会上升。然而，在下一个难度调整之后，这个问题就会消失，这个调整发生在每 2016 个块之后，或者大约 2 周之后。哈希率的下降延长了块时间，所以 2016 个块可能需要超过 2 周的时间。

以下是随着块时间的增加，等待添加到块中的交易数量如何增加的说明：

![](img/Figure-8.6.jpg)

**图 8.6：** 块时间对内存池大小的影响

这是一个持续超过两周的不便。这个问题的一种解决方案可能是通过计算 2016 个块的滚动平均来每块调整难度。

然而，有一个原因是比特币没有实施这个。由于几乎所有的比特币网络哈希率都由少数挖矿池控制，对这些大型矿工进行复杂的 DDoS 攻击可能会降低网络的哈希率，这将给攻击者一个窗口来破坏网络。为了安全的大局，这个不便之处是必要的恶。

# 隐私限制

比特币不是一种隐私币。它不支持如零知识证明之类的隐私协议。因此，我们需要意识到比特币确实在区块链和交易所中记录了我们的购买信息，以及我们使用比特币的在线商家/网站。然而，比特币确实提供了隐藏身份的方法，例如使用 CoinJoin 或洗钱服务，或者直接从个人那里购买等等。

# 隐私和扩展解决方案

在之前的子主题中，您了解到我们不希望区块大小增加的主要原因是最初的区块下载验证时间。目前正在发生的一些发展可能会帮助比特币扩展，同时也会提高其隐私性。

犯罪分子可以入侵交易所和商家的数据，并将这些数据与区块链中的信息关联起来，以获取关于个人的洞察。独裁政府也可以从交易所和商家那里获取信息。他们最终可以利用这些信息对抗那些信息被曝光的个人。因此，比特币有时被认为是*伪匿名*的。

比特币确实提供了隐藏身份的方法。以下是几种可以隐藏身份的方法：

1.  隐藏信息的简单方法是永远不要两次使用同一个地址。

1.  一些钱包，如 Samourai 钱包和 Wasabi 钱包，提供了 CoinJoin 的变体，使交易具有可替代性。

1.  个人还可以直接从另一个人或矿工那里发送或接收交易。

这些都是维护隐私的一些方法*。*这取决于个人如何管理他们的隐私，在政治压力下，个人可以被迫使他们的交易更加私密和隐藏。因此，比特币也被认为是*抗审查*的。

以下是一些已经使用或正在开发的不同的隐私和扩展解决方案：

![](img/254.jpg)

**表 8.1：** 不同解决方案对比特币网络和交易隐私及扩展的影响

# 改进的硬件

芯片技术的改进和小型化可以减少验证区块的时间，减少初始区块下载时间。我们有可能开发出 2nm 技术的微处理器，拥有改进的 RISC 架构和其他硬件设计元素，从而产生性能更高的硬件，这将减少验证区块链的时间。

# Utreexo 积累器

Utreexo 通过改变 UTXO 索引的结构来改进交易和区块验证。这个功能仍在开发中，并已显示出良好的结果。如果成功，它将允许通过减少初始区块下载的区块链验证时间来增加区块大小。

# 签名聚合

比特币正在经历许多变化，尽管将改进内容纳入共识规则中相当困难。改进是重要的，因为它使技术具有未来性。同时，与共识规则相关的改进是不可逆的，如果引入了错误的改进，对网络的成本非常高。另外，共识规则需要向后兼容，因此每一次改进都需要以软分叉的形式引入，这使得随着每次改进，共识规则变得更加复杂。

比特币将拥有一个名为 Schnorr 签名的新签名方案。与 ECDSA 不同，Schnorr 签名是线性的，这意味着签名可以被聚合成一个新的签名，而不会影响其大小。

这可以按照以下方式理解：

![](img/Figure-8.7.jpg)

**图 8.7：** 使用 Schnorr 签名的签名聚合

正如我们所知，签名在交易中占用了相当大的空间，因此我们可以通过在多签名输入中聚合多个签名来减小交易的有效大小。这将有助于在区块中容纳更多的交易，从而提高比特币的交易速率。

此外，由于签名聚合允许将多个签名和公钥聚合成单个签名和公钥，因此很难确定资金是由一个人还是多个人持有。这使得在不损害交易可验证性的情况下，追踪比特币消费者的难度增加。

# MAST：Merklized Abstract Syntax Trees

在 P2SH 交易中，我们可以嵌入具有条件和子条件的复杂脚本。当交易被花费时，只有嵌套的多个条件语句中的一部分会被执行。花费者必须透露脚本才能使用锁定的资金。这产生了不必要的高成本，对隐私不利。

为了理解条件语句和子条件语句，脚本可以表示为一个抽象语法树。这种表示法通常被编译器用来编译编程语言。作为一个例子，我们常用的脚本是 2-3-多签名。考虑 Alice、Bob 和 Carol 之间的 2-3-multisig，我们可以将其表示为以下的条件语句：

`(Alice AND Bob) OR (Bob AND Carol) OR (Carol AND Alice)`

以下是 Alice、Bob 和 Carol 之间的 2-of-3 多签名抽象语法树的表示：

![](img/Figure-8.8.jpg)

**图 8.8：** 2-of-3-multisig 的抽象语法树

MAST 使用 Merkle 树来表示比特币脚本。Merkle 树是抽象语法树的修改版，其中每个条件的两侧通过连接两侧的拼接散列来连接。这样可以将每个条件分开，使得交易支付者只需透露所需的 Merkle 证明的条件，并隐藏其他条件。所以，这就像 Merkle 证明一样，在*第五章，白皮书*的***简化支付验证***部分进行了说明。MAST 是一个在比特币交易中没有直接用途的概念。没有所谓的 Pay-2-Script-Merkle-Root。这只是理解 MAST 的一个概念，但 MAST 在 Taproot 中确实得到使用，所以这是需要理解的。

所以，在一个假设的 P2SMR 交易中，以下将会发生：

![](img/Figure-8.9.jpg)

**图 8.9：** 基于 MAST 的假设 P2SMR 交易

由于只揭示了脚本的一部分，它减少了交易中使用的字节数，有助于扩展，并提高了隐私性，因为它没有揭示整个脚本。

# Taproot

Taproot 更进一步。它将整个脚本或脚本的大部分隐藏在公钥签名对之下。因此，我们可以有一个复杂的脚本，其中包含多个条件和多方，这些都被地址隐藏起来。这减少了交易大小，复杂的脚本只占用 P2PKH 交易的空间，或者脚本散列稍微大一点。而且交易将脚本的所有细节隐藏在公钥和签名之内，使得观察者无法确定它是一个单签名还是多签名或复杂的智能合约。因此，它也非常适合隐私。

以下是资金交易的说明：

![](img/Figure-8.10.jpg)

**图 8.10：** Taproot 的资金交易

要花费 P2TR UTXO，我们可以使用私钥签署交易，或调整公钥，只有 Alice 和 Bob 知道，或者我们需要提供所需的散列，就像 Merkle 证明一样，连同签名一起。

所以，使用 P2TR UTXO 创建了两个可能的交易：

1.  当 Alice 和 Bob 签署交易时，由于他们创建了一个调整后的公钥，他们也可以创建聚合签名。以下是说明：![](img/Figure-8.11.jpg)

    **图 8.11：** 带有主要条件的 Taproot 花费交易

1.  当 Bob 和 Carol 或者 Carol 和 Alice 签署交易时，由于他们没有创建调整后的公钥，他们需要提供像 Merkle 证明一样的散列以允许验证。以下是说明：![](img/Figure-8.12.jpg)

    **图 8.12：** 其他条件的 Taproot 花费交易

# 闪电网络

任何关于区块大小的增强或改变，对每秒交易数的增加只能产生有限的影响。即使我们能将区块大小增加 10 倍，每秒交易数也只能达到 200 到 250 笔，这仍然远小于信用卡。根据记录，Visa 每秒处理 65,000 笔交易。

Lightning Network 是比特币区块链上的第 2 层协议。我们在第四章中介绍了 Lightning Network，标题为《比特币在现实世界》和主题《在线商户接受比特币》。

Lightning Network 允许在链下进行交易。由于它是通过涉及几个额外跳转的个人之间的路由，因此没有每秒可以发生的交易数量的限制。这增强了比特币完成大量交易的能力，并可与 MasterCard 和 Visa 卡竞争。

由于各方之间的交易数量可以任意多，而不需要在区块链上记录，只记录最终的交易，因此它提高了两方之间支付的隐私性。

Schnorr 签名通过将双方的签名整合成一个单一签名，进一步降低了创建和关闭 Lightning Network 通道的成本。我们现在甚至可以拥有多方通道，因为我们可以聚合签名。

# CoinJoin

CoinJoin 是一种通过以一种难以知道哪个输出接收来自哪个 UTXO 的硬币的方式，使比特币可替代的方法。实现这一点有多种方式。

一种方法是将输入中的值分割，并将输出中的值合并，以使输出值匹配。这样，很难将输入与输出相匹配。

例如，以下是三个必需的交易：

![](img/Figure-8.13.jpg)

**图 8.13:** 用于 CoinJoin 的交易

为了进行 CoinJoin，我们尝试将三个交易合并成一个交易，使得很难知道哪个 UTXO 将分配给哪个接收者。这消除了比特币的身份，使它们类似于现金。

这是一个 CoinJoin 交易的示例：

![](img/Figure-8.14.jpg)

**图 8.14:** CoinJoin 的示例

在前面的示例中，不可能知道哪些地址属于 Bob、Dave 和 Kirsten，以及谁在哪个输出中支付。

# Tumbler 服务

Tumbler 服务由匿名交易所提供，因为它们大多使用 TOR 网络，所以无法追踪。它们为混合交易收取费用。Tumbler 服务从发送者那里获取比特币，然后转发给接收者，但在中间，它们将比特币与其他交易或它们自己的交易混合，并在多个地址之间移动它们。这使得追踪变得不可能。

这一点可以通过以下说明理解：

![](img/Figure-8.15.jpg)

**图 8.15:** Tumbler 服务的示例

在前面的插图中，没有办法知道爱丽丝是否在支付鲍勃，或者卡罗尔是否在支付戴夫，或者约翰是否在支付克里斯滕，因为所有这些都是完全混合且相互独立的交易。

与由一些流行钱包提供的 CoinJoin 不同，Tumbler 服务不由任何已知实体提供。这是他们运营的本质。因此，这类服务存在风险，因为他们可能会偷走你的硬币。

# 比特币挖矿能源消耗

比特币因其高能源消耗而形象不佳，这是事实，正如我们在以下图片中看到的

![](img/Figure-8.16.jpg)

**图 8.16:** 比特币挖矿能源消耗与主要电力消耗国家比较

前图显示了 50 个能源消耗最高的国家。比特币目前排名第 24 位，几乎与欧洲富裕发达国家波兰相等。

相比之下，全球能源消耗为 23000 TWh，比特币能源消耗仅为 154TWh，占比不到 1.0%。比特币能源消耗与货币增长有关。随着对比特币的兴趣增长，比特币网络的能源消耗也将增长。

我们将进行一些计算，以了解为什么它并不像看起来那么糟糕。

为了不推广挖矿设备，我们将不透露用作参考的挖矿设备名称。

假设我在班加罗尔市的一个地点使用挖矿设备，该地点目前有以下电力成本：

![](img/262.jpg)

**表 8.2:** 班加罗尔市电力收费

我们使用与 *第六章，区块链、交易和挖矿* 中主题 *挖矿成本* 相同的程序。

我们以一个 hash 率为 90 TH/s 和电力消耗为 3050W 的矿工为例，定义如下：

`def getMinerHashRate():`

`return 100 * 10**12`

`def getMinerPowerWatt():`

`return 3050`

`我们定义单位价格为：`

`electricity_rates = {“rate_slabs”: [{“min”: 1, “max”: 30, “unit_price”: 4}, {“min”: 31, “max”: 100, “unit_price”: 5.45}, {“min”: 101, “max”: 200, “unit_price”: 7}, {“min”: 201, “unit_price”: 8.05}]}`

如果比特币当前价格为 ₹28,05,753，定义如下：

`def getCurrentSellPrice():`

`return 2805753`

以下代码用于调用`**miningReturn**`方法获取挖矿利润：

`blk_hash = ‘000000000000000000016acc33775c2ea52abeb4407381b84fee5f7af97fdd8b’`

`blk_hash_b = bytes.fromhex(blk_hash)[::-1]`

`blk_index = getBlockIndex(blk_hash, block_db_g)`

`blk_hdr_b = getBlockHeaderBytes(blk_hash_b)`

`jsonobj = getBlockHeader(blk_hdr_b)`

`blk_reward = getBlockReward(blk_index[‘height’])`

`miner_hashrate = getMinerHashRate()`

`print(“矿工 hash 率 = %d” % (miner_hashrate))`

`miner_power = getMinerPowerWatt()`

`print (“矿工电力消耗（瓦特）= %f” % (miner_power))`

`expense = getMiningPowerExpense(miner_power)`

`print (“矿工每月电力支出 = %.2f” % (expense))`

`bits_b = bytes.fromhex(jsonobj[‘bits’])[::-1]`

`mining_return = miningReturn(miner_power, miner_hashrate, bits_b, blk_reward)`

`print(“Mining Return Per Month = %s” % (mining_return))`

运行后，我们得到以下结果：

![](img/Figure-8.17.jpg)

**图 8.17：** 在班加罗尔测试矿工的挖矿盈利性

设备成本几乎达到了 90,000 卢比。

如果挖矿奖励保持恒定，那么需要 3 年时间才能实现盈亏平衡。这看起来是个合理的回报，但考虑到挖矿哈希率可能在此期间翻倍，这可能会将每月的挖矿收益降低到 0 到 5000 卢比之间，这是微不足道的，你还需要购买另一台设备，这可能更昂贵，可能消耗更多电力。因此，你可能会永远无法实现盈亏平衡。积极的一面是，在 3 年内，比特币的价格可能会上涨，挖矿仍然有利可图。

这使得挖矿存在一定的风险，除非你能获得补贴电力、来自廉价来源的电力、或者来自废料燃料或能源的电力。

因此，大型矿工主要位于电力补贴的国家。此外，许多电力生成公司和化石燃料公司也在挖比特币，以利用他们的过剩电力和燃料。天然气和石油钻探公司正在利用废气进行比特币挖矿，这对环境尤其有利，因为甲烷比二氧化碳更大的温室气体。

风能和太阳能的燃料效率比非可再生能源更好，除了天然气和核能。此外，离网电力减少了因输电造成的能源浪费，这进一步提高了挖矿利润。这使得离网可再生能源成为非补贴挖矿的首选能源。

对于为比特币提供电力补贴的政府来说，挖矿成本很高，因为它几乎不创造任何就业机会，所以政府倾向于攻击这类设施，如中国和伊朗。

因此，与当代观念相反，我们了解到比特币挖矿对环境有益，原因如下：

+   矿工更喜欢离网可再生能源作为电力来源。

+   废燃料，它由最强烈的温室气体组成，被用于比特币挖矿，并转化为较弱的温室气体，即二氧化碳。

+   比特币挖矿使政府不敢对矿场公司进行电力补贴。

# 个人和网络面临的威胁

在本章到目前为止，你了解到了设计限制以及比特币开发者社区是如何努力克服这些限制的。你也了解到了比特币挖矿大量能耗对环境并不是一个大问题。

比特币作为一种去中心化的点对点开放网络，用于价值传输，对攻击者来说是有利可图的，同时也被视为对现有全球货币系统的威胁。因此，比特币网络和比特币投资者可能不得不应对各种攻击，例如来自政府、中央银行、恶意黑客、欺诈者或抢劫的攻击。

然而，威胁可能并不总是因为多种攻击类型，也可能是因为今天存在的风险和潜在漏洞，或者可能在未来成为问题。

# 来自政府的威胁

正如我们在**第四章，比特币在现实世界**中看到的，在**比特币与**加密货币**监管**的主题下，世界上大多数国家的加密货币法律并不明确或根本不存在。这赋予了当局处理加密货币的额外司法权力，有时涉及威胁和腐败。有时，需要支付税款，但支付税款的条款并不明确。这就是印度和其他许多国家的问题。这影响了交易所、交易员、投资者和商人，导致了加密货币和相关服务价格的膨胀以及投资或商业风险的损失。

此外，也没有法律保护，这有时被不良分子通过勒索和欺诈行为滥用。

对比特币交易的禁令是一种潜在风险，一些国家确实采取了这种做法，这意味着任何参与加密货币交易的人都会受到惩罚。然而，这样做的国家非常少。

# 来自中央银行的威胁

大多数国家，无论发达国家还是发展中国家，都没有完全可兑换的货币，它们认为强势货币是一种威胁。这种担忧是，中央银行将失去控制，其货币可能变得疲软并失去价值。这是一个合理的担忧，主要是因为一个国家的财政政策存在弱点。此外，中央银行可能无法知道资金用于非法活动的风险。因此，作为预防措施，所有金融机构都严格执行 KYC 和 AML 标准。

加密货币非常流动，它们可以轻易地通过监管漏洞。这就是为什么中央银行对其广泛使用持谨慎态度。在许多国家，我们看到了银行禁令的存在，在一些国家，大型机构也被禁止交易加密货币。另一方面，在一些国家，与加密货币相关的某些活动被禁止。

正如我们所学的，与其他大多数加密货币不同，比特币并不是一个很好的投机工具，而更像是一种黄金一样的资产。像黄金一样，比特币不应该被视为对全球货币系统的威胁，中央银行应该认识到洗钱风险在于监管不足，因此每个国家都需要更多的监管，而不是更少。

# 恶意黑客

黑客可能以各种方式攻击个人、交易所和网络。黑客行为可能是盗窃、抢劫，或利用协议弱点。盗窃可以通过尝试用暴力破解或基于知识的攻击破解安全措施，或通过社会工程学等方法进行。抢劫也可以通过社会工程学和勒索软件进行。

# 比特币盗窃

比特币盗窃可以通过比特币钱包使用的密码学弱点发生。盗窃也可能通过其他方法通过恶意软件、间谍软件或社会工程学发生。

# 利用密码学弱点

比特币使用的哈希和 ECDSA 算法相当安全，但由于密码学算法中熵、盐或其他参数的选择仍存在一些风险。

+   **暴力破解攻击**

    比特币中使用的 256 位 ECDSA 加密与 3072 位 RSA 加密具有相同的安全强度。仅通过暴力破解，破解比特币使用的 256 位 ECDSA 加密需要数十亿年。几十年的时间里，我们仍有可能会发现破解加密的方法。那时，比特币需要转向新的算法。

+   **低熵攻击**

    比特币使用的签名算法非常安全，即使是最先进的计算机也需要数百万年才能破解。然而，私钥的安全性取决于用于生成私钥的随机生成器的熵。如果使用低熵系统生成私钥，那么私钥可以通过暴力破解猜测。

+   **碰撞攻击**

    SHA256 被认为是抗碰撞的，这意味着几乎不可能生成两个具有相同散列值的消息。所以，比特币从这类攻击中是安全的。

+   **预计算散列或彩虹表**

    PBKDF2-HMAC-SHA512 算法用于生成私钥和公钥的分层确定性钱包。该算法需要大量迭代来生成安全密钥，并且必须与盐值一起使用，否则生成的密钥容易受到使用预计算散列的攻击。此外，迭代或轮数至少应该是 2048，但可能是 10,000 甚至更高。使用高性能计算，可以推导出较低轮数生成的密钥，并可以窃取钱包中的所有比特币。

# 恶意软件

恶意软件是一种旨在窃取信息或损坏计算机或网络的恶意程序。恶意软件可以通过**间谍软件或特洛伊木马**来窃取信息。恶意软件可以通过某种形式的**社会工程学**安装，这种方法可能会利用紧迫感、贪婪和恐惧，诱使你点击邮件或网页上的链接进行下载。恶意软件也可以通过一个看起来很真实的假网站进行安装。这些恶意软件被称为**特洛伊木马**。

一种名为**间谍软件**的恶意软件在用户不知情的情况下安装在计算机上，可以读取文件、从网站收集信息，以及读取键盘的按键。

# 勒索软件

勒索软件是一种新的黑客形式，攻击者在通过恶意软件获得系统访问权限后，对系统上的文件进行加密。此后，攻击者要求以比特币作为赎金，以换取解密文件。

以下是被勒索软件抢劫比特币的步骤：

![](img/Figure-8.18.jpg)

**图 8.18:** 攻击者执行勒索软件攻击的步骤

# 丢失私钥或种子短语

丢失私钥和钱包种子是如此普遍，以至于有估计认为 20%的所有比特币已经丢失并且永远无法找回。当比特币还很新，并且几乎没有任何价值时，人们对私钥并不太在意，所以丢失比特币很容易。即使比特币开始变得有价值，软件也不容易使用，丢失私钥仍然很容易。

随着分层确定性钱包的出现，管理私钥变得更加容易，但人们仍然忘记他们保存种子的地方，因此永远失去了他们的比特币。由于硬件钱包变得相当普遍，因此丢失比特币的情况已经大大减少。然而，由于粗心大意、自然灾害或其他此类情况，人们仍然会丢失比特币。

# 由于漏洞带来的威胁

比特币网络确实因为设计和持续的技术改进而存在某些风险。

# 交易的可塑性

交易的可塑性将在*第十二章，隔离见证*中详细讨论，所以我们在这里不讨论它。

# 灰尘攻击

灰尘攻击被用来去匿名化用户。攻击者向大量的目标地址发送灰尘交易或极其低价值的交易。然后攻击者追踪资金，以确定哪些地址属于同一个钱包，并尝试去匿名化属于该钱包的用户。这需要对与灰尘交易相关的交易进行复杂的分析。一旦找到用户身份，攻击者就会对目标用户进行钓鱼或恶意软件攻击。

这可以从以下说明中理解：

![](img/Figure-8.19.jpg)

**图 8.19:** 攻击者执行灰尘攻击的步骤

灰尘交易可能被用于其他目的；例如，洗钱者可以向大量接收者发送灰尘交易，使得这些交易难以追踪。

为了防止灰尘攻击，钱包不应该接受小额交易。比特币节点不会转发小于中继费的网络费用交易，对于许多节点来说，中继费是 5000 萨索希。这相当高，所以中继费本身应该对灰尘攻击起到威慑作用。

# 内存池洪水攻击

内存池洪水攻击是一种 DoS 攻击，其中节点的内存池被低价值的未确认交易填满。这种攻击曾在比特币网络上发生，导致网络费用上涨。

这种攻击最早是在 2015 年 7 月被报告，而在 2017 年 5 月、8 月和 11 月，比特币网络上再次发生了此类攻击。怀疑这些攻击是为了影响比特币开发者、矿工和交易所对更大区块大小的支持。

比特币节点通过配置交易需要支付的最小中继费用来避免这种攻击，以将其传播到网络上。在比特币核心中，这默认为 5000  Satoshi。目前，它的价值接近 2 美元，这对阻止攻击者来说仍然是一笔可观的金额。此外，与 2017 年不同，现在的交易费用要高得多，因为比特币价格上涨，所以这种攻击已经不再可能。

# 自私挖矿

自私挖矿是一种恶意的挖矿攻击，在这种攻击中，只有少数拥有高挖矿能力的矿工，但没有人拥有超过 50% 的挖矿哈希能力。在这种攻击中，自私的矿工通过给竞争矿工带来损失，从而获得更大的哈希能力份额。

挖矿哈希能力份额是矿工发现区块的平均概率。由于这是一个平均概率，一个概率较低的矿工有时会比平均速度更快地找到一个区块。自私的矿工利用这一点对其他矿工造成损失。

考虑一个有三个矿工的场景：

Alice: 40%，Bob: 25%，Carol: 35%

假设 Carol 是个自私的矿工。当 Carol 发现一个区块时，她不会立刻发布这个区块，而是将其保留一段时间，试图再找到另一个区块。

如果 Carol 幸运地找到了另一个区块，那么她会等待另一个矿工发布一个区块，同时尝试找到另一个区块。如果在此期间，Bob 或 Alice 发布了一个区块，那么 Carol 会发布这两个区块。由于 Carol 有更长的链，Bob 或 Alice 发布的另一个区块会被拒绝。这对其他矿工造成的损失大于 Carol 通过保留区块所支付的成本。

如果 Carol 发现了三个区块，那么她会等待其他矿工发布两个区块。如果 Carol 发现了四个区块，那么她会等待其他矿工发布三个区块。

另一方面，如果 Carol 不走运，而 Alice 或 Bob 在 Carol 之前发布了他们的区块，那么 Carol 会立即发布她持有的区块，并不传播竞争区块。所以，即使 Alice 或 Bob 首先发布了区块，仍有一些节点会首先收到 Carol 的区块，并会将另一个区块视为竞争链。在这种情况下，哪个链胜出取决于概率以及 Carol 在区块传播延迟方面的优势。即使 Carol 赢得这种机会的几率非常低，而她的哈希率超过了网络哈希率的 33%，她仍能作为自私矿工增加她挖掘到区块的有效概率。

我们可以看出，自私挖矿并没有降低挖掘新块的成本。实际上，它增加了挖掘一个块的成本，即使对 Carol 也是如此。由于它对竞争矿工造成了更大的成本，Carol 获得了优势。

这可能带来多重后果：

1.  竞争矿工会停止他们的亏损挖矿设备，这将增加 Carol 在网络中的份额。

1.  竞争节点将加入 Carol 并开始与她一起挖矿，使她拥有超过 51%的网络哈希率。

1.  竞争节点将破产并完全停止运营，导致矿池矿工转向其他剩余的矿工，这可能导致 Carol 拥有超过 51%的哈希率。

1.  竞争节点将升级他们的亏损设备，这将花费他们一大笔钱，但最终，其他矿工将保持盈利并继续进行。

以下是自私挖矿场景的流程图：

![](img/Figure-8.20.jpg)

**图 8.20:** 矿工执行自私挖矿攻击所采取的步骤流程图

识别一个矿工是否参与自私挖矿是很容易的，因为自私挖矿增加了与没有自私矿工的正常情况相比，存在竞争链的可能性。

自私挖矿给自私矿工带来了优势。但有很多原因让矿工不愿意这么做：

+   自私挖矿可以很容易地被识别出来。这将影响比特币网络的声誉，进而影响比特币的长期价值。

+   挖矿的输入成本极高，大多数时候，利润率都很低。因此，矿工需要从长远考虑，不想参与任何影响比特币价值的事情。

+   挖矿是由依赖池矿工的矿池完成的。矿池的坏名声可能导致矿工转向不同的矿池，所以矿池最终会失去哈希率。

比特币网络在很大程度上避免了这种攻击，尽管过去可能发生过一两次此类事件。

比特币开发者社区一直在推动采用 FIBRE 协议以减少块传播延迟。如果广泛使用 FIBRE，矿工通过自私挖矿攻击网络将变得极为困难。

# BGP 劫持攻击

BGP 代表**边界网关协议**。它是一个网关协议，用于在自治系统或 AS 之间交换可达性信息。AS 类似于由 ISP 或互联网服务提供商创建的网络。

有多种方法可以利用 BGP 黑客攻击比特币网络。这种攻击之所以可能，是因为比特币挖矿高度集中，只有少数矿池控制着大部分网络哈希率。此外，比特币网络消息是不加密的，因此可以被攻击者修改。

通过攻击 AS 中的 BGP 服务器，攻击者可以延迟、修改甚至丢弃比特币网络消息。这可以用来执行多种攻击。

# 网络分区攻击

网络分区意味着以创建孤立的网络的方式断开节点。

如果攻击者控制了负责发送 BGP 路由消息的 ISP 服务器，它可以有效地将网络划分为两个孤立的网络。

由于分区攻击，矿池可能不知不觉地开始在不同的链上工作。这将被视为一种 DoS 攻击，因为矿池之间的挖矿哈希率份额将发生变化，并且很快就会被全世界知道。

然而，在问题解决之前，攻击者可以在网络中使用相同的 UTXOs 广播两个不同的交易，并执行双重花费攻击。如果问题在收到六个确认之前没有解决，那么两个零售商都将接受付款，实际上是双重花费。当网络分区被移除时，具有更多累计工作量证明的链被接受，而其他链被拒绝。被拒绝交易的商家将遭受损失。

这可以通过以下说明来理解：

![](img/Figure-8.21.jpg)

**图 8.21：通过 BGP 劫持攻击进行网络分区的说明**

如果你是商家，关注矿池之间的哈希率分布是有意义的。

# 延迟攻击

分区攻击的一种变体是延迟攻击。在这种类型的攻击中，攻击者不是创建孤立的网络，而是将一个 AS 集合的消息延迟发送到另一个 AS 集合，本质上给予某些 AS 相对于其他 AS 的优势。

在这种攻击中，攻击者让受害者不知情最新区块。如果受害者是商家，那么商家不会知道攻击者已经完成花费，因此成功地双重花费。如果受害者是矿工，那么矿工会浪费哈希力量在一个过时的链上工作，导致损失。

如果你是商家，通过运行在不同 AS 上的应用程序（如云平台或流行网站提供的 Web-API）来监控最新区块是有意义的。

# 0 确认攻击：

如果商家不等待交易确认，就可以执行零确认攻击。要执行此攻击，攻击者创建两个利用相同 UTXO 的不同交易：一个支付给商家，另一个将价值转移到不同地址。攻击者只将商家的交易发布到商家的节点，同时将另一个交易同时发布到其他节点。

商家节点接受它首先收到的交易，这是支付给它的交易，并拒绝其他交易。如果其他交易进入了一个区块，那么包含支付给商家的交易就会被拒绝，商家就会失去这笔付款。

攻击者可以连接到多个远程节点，以提高成功概率发布另一个交易。

以下是攻击的说明：

![](img/Figure-8.22.jpg)

**图 8.22:** 攻击者执行 0 确认攻击的步骤

要执行此攻击，攻击者需要知道商家的节点地址并连接到它。如果商家没有使用 TOR 网络隐藏其 IP 地址，这种攻击会变得更容易。攻击者可以通过 ping 商家的网站来找出商家的 IP 地址。或者，如果它是一个提供 WIFI 的实体店，那么攻击者可以通过公共网络找到 IP 地址。还有其他找出 IP 地址的方法，比如使用网络钓鱼攻击。

# 隐藏算力

在**第六章，区块链、交易和挖矿**下的主题**Coinbase 交易**中，你了解到矿工在挖出的区块中添加指纹。这个指纹可以用来确定每个挖矿池的相对算力贡献。由于我们可以计算网络算力，我们可以利用这些信息来计算每个挖矿池的算力。

然而，这是因为矿工告诉我们他们成功挖出一个区块的时候。如果他们不这么做，那么他们可以很容易地在不被人知道的情况下增加他们的算力贡献，除了很少关注的池矿工。池矿工甚至不试图知道他们是否真的在挖比特币或比特币现金或比特币 SV。

# 列入黑名单的地址

在矿场打击行动之前的估计显示，中国矿工贡献了比特币网络算力的几乎三分之二。因此，比特币网络容易受到中国政治决策的影响。例如，中国可以列入黑名单特定实体的比特币地址，如企业、机构或个人。

作为一个澄清，这种攻击不是关于中国的，因为如果另一个国家或一组国家的挖矿算力高于网络算力的 50%，那么这些国家也可以列入特定实体的地址黑名单。

由于中国的算力超过了 50%，它可以忽略任何区块，包括来自或发送给某些实体的交易，并且总能挖掘更长的链。因此，其他矿工也必须遵守中国执法部门的规定，否则他们在挖出的区块上会亏损，并很快破产。

一个拥有高网络算力的国家也可以执行黑名单攻击的变体，即使低于 50%的挖矿算力，它也可以通过利用自私挖矿技术来执行黑名单。

我们最近看到一个矿工接受了**外国资产控制办公室**（**OFAC**）的合规标准。OFAC 是美国的一个金融情报和执法机构。因此，矿工暂时列入了不符合规定的交易的黑名单，但后来同意不执行 OFAC。

# 重放攻击

当比特币网络发生硬分叉并创建了一种新的加密货币时，这种新的货币类似于从零开始创建的新货币。不同的是，它与母加密货币共享相同的历史。对于新的加密货币来说，拥有不实用的历史是一个不必要的负担。然而，好处是新的货币可以有类似于原币的名字，这样看起来熟悉，容易被人认出。

以下是一个硬分叉的说明：

![](img/Figure-8.23.jpg)

**图 8.23：** 硬分叉说明

如果新的加密货币维持与母币相同的地址方案，那么它不需要吸引用户，因为母币的用户会自动成为新加密货币的用户。此外，他们的 UTXO 在两条链上都有效。

然而，这样做的问题是人们可能会错误地将硬币发送到不同链上的接收者，从而失去支付。

此外，如果交易格式或地址方案没有改变，那么在一个网络上有效的交易在另一个网络上也将有效。这些有效的交易可以在不同的网络上重放，硬币可能会被盗。这被称为**重放攻击**。

当硬分叉发生时，许多用户意识到他们在新的分叉网络中有额外的货币。他们转账或出售自己的货币，以尽快赚钱，但这个交易可以被攻击者在原始价值较高的网络上重放，因为该交易在原始网络上的价值要高得多，攻击者会获得更大的价值。

这可以通过以下说明理解：

![](img/Figure-8.24.jpg)

**图 8.24：** 鲍勃执行重放攻击

在我们看来，一种加密货币不实施新的地址方案和交易格式是不道德的。

# 空块挖掘

比特币共识规则并没有阻止矿工挖掘空块。这意味着在寻找正确 nonce 的竞争中，矿工可以挖掘一个空块，这将使他们优于其他矿工，后者将使用额外的计算能力来选择、将交易添加到区块中，并计算他们收集的总网络费用。

以下图表显示了交易费占区块奖励的百分比：

![](img/Figure-8.25.jpg)

**图 8.25：** 交易费占区块奖励的百分比

近期区块奖励更新后，每个区块的区块奖励为 6.25![](img/Bitcoin.jpg)，网络每块收集的手续费接近 0.7![](img/Bitcoin.jpg)，这个数额相当大，没有矿工愿意损失这么多的金额。

以下图表显示了每年挖掘的空块数量：

![](img/Figure-8.26.jpg)

**图 8.26：** 每年挖掘的空块数量

我们也需要意识到，随着岁月的流逝，挖矿变得更加具有竞争力，这意味着矿工不得不花很多钱购买最有效的设备。由于这一点，挖矿空块不符合矿工的利益。因此，正如我们在前面的图表中所看到的，空块的数量逐年减少。

# 比特币挖矿集中化

我们知道矿工们会加入并形成一个池。少数矿池控制着网络大部分的计算能力。

下面的图片显示了矿池之间的挖矿哈希率分布：

![](img/Figure-8.27.jpg)

**图 8.27:** 各矿池的哈希率分布

在撰写本书时，前四大矿池分别是 F2Pool、AntPool、Poolin 和 BTC.com。

预计挖矿应该会随着时间的推移变得更加去中心化。实际上，在过去的 2-3 年里，它已经变得更加去中心化了。有两个原因可能导致这种情况：

+   矿池主要位于电力补贴较冷的地区。这影响了那些地区的人们。随着挖矿能源需求的增加，这将鼓励政府不再补贴电力，并鼓励他们转向离网能源。这将允许矿工转移到获得更多阳光或风能或天然气或石油矿井废能的地区。

+   芯片小型化使得能够生产更高效的微处理器，这使得 ASIC 机器具有更好的能效。由于 ASIC 机器的改进相当快，靠近芯片制造的矿工比远离运输增加成本和时间的矿工具有优势。随着芯片小型化遇到极限，能效改进放缓，因此，这种优势正在迅速消失。这将允许其他地区的矿工与中国矿工竞争，导致挖矿哈希力的进一步去中心化。

# 51% 攻击

51% 攻击是指矿工拥有超过网络一半的哈希率的攻击。在这种情况下，矿工可以执行以下操作：

+   通过挖出一个已经挖出的区块，从区块链中删除一个交易。

+   通过不包含发送或接收属于特定企业、机构或个人黑名单地址的比特币的交易，来审查个人。

+   更改自己的最近交易。

如果前四大矿工联手，他们的总哈希率将超过 50%，他们可以超越其他矿工，执行一次 51% 攻击。

2014 年 7 月，Ghash.io 控制了超过一半的网络计算能力，但它后来同意永远不会超过 50% 的计算能力。理解为什么我们自那时以来从未出现过这种情况，以及为什么任何矿工都会同意不接管网络，这一点很重要。

挖矿也为网络增加了价值，这意味着尽管矿工可以加入并阻止来自特定国家或交易所的交易，但他们不会做任何会引起注意并影响网络的事情，因为这会损害他们赚钱的来源。

# Sybil 攻击

在 Sybil 攻击的情况下，攻击者创建了大量节点。受害节点只连接到攻击者节点。攻击者节点不向目标节点转发交易和区块，从而使目标节点实际上与网络断开连接。攻击者可以将创建的区块发送到包含攻击者希望节点获取的交易的目标节点。由于目标节点只从攻击节点接收区块，因此它认为即使交易在实际网络中已经被花费，该交易也是有效的。

为了避免 Sybil 攻击，比特币核心客户端只在与 /16 地址中的一个连接，这意味着攻击节点需要广泛分布，并且位于多个 /16 地址中，但仍要隔离节点，这是不可能的，因为那么攻击者将需要接管整个比特币网络。

# 拒绝服务（DoS）攻击

拒绝服务攻击或 DoS 攻击是一种攻击，攻击者向目标发送大量数据，使其忙碌，因此目标无法提供所需的服务。

比特币节点在处理拒绝服务攻击方面很健壮，但这并不意味着 DoS 攻击不能发生在比特币节点上。如果恶意节点试图淹没一个节点，它将简单地将这些连接列入黑名单并关闭它们。用有效消息进行淹没是昂贵的，无效消息会被迅速拒绝。此外，节点还设置了交易、传播费和区块大小的限制，以避免此类攻击。

节点避免被 DoS 消息淹没的一些方法如下：

+   大于 100 Kbytes 的交易被认为是非标准的。

+   区块大小限制为 1MB vsize。

+   节点不会接受或转发网络费用低于节点设置的传播费的交易。

+   节点不会转发双重花费交易。

+   节点不会转发孤立交易。即没有已知未花费交易的交易。

+   节点限制孤立交易的数量。

+   节点会忽略大的孤立交易。

+   节点不会转发孤立区块，即没有已知前一个区块的区块。

+   节点不会转发已经看到或转发的区块。

+   默认情况下，禁止行为不良的 IP 地址 24 小时。

+   为每个连接的节点维护 DoS 评分，并在节点多次行为不当时断开连接。

+   节点在签名缓存中有签名数量的上限。

+   限制脚本的大小。

+   限制 OP_CHECKMULTISIG 操作中的密钥数量。

+   限制交易中每个值的大小。

+   只有未花费的交易输出（UTXO）存储在内存中。

+   限制交易输入可能请求的签名检查数量。

更多信息请参考：

**[服务拒绝攻击](https://en.bitcoin.it/wiki/Weaknesses#Denial_of_Service_.28DoS.29_attacks)**。

# **量子计算攻击**。

量子计算机使用电子状态的叠加和电子的纠缠来执行复杂操作，这是经典计算机无法实现的。然而，量子计算机并不是通用计算机，它们只对某些类型的操作有用。

与传统计算机不同，量子计算机使用量子位而不是位。位可以是 0 或 1，而量子位可以同时是 0 和 1。因此，一个量子位有 2 种状态的叠加，N 个量子位将具有 2 的 N 次方种状态的叠加。这使得 N 个量子位的量子计算机等同于 2 的 N 次方个经典位计算机。一个 500 个量子位的计算机是一个 2 的 500 次方个经典位的计算机，这超过了整个宇宙中的原子数量。

然而，有一个问题：一旦我们试图找到量子态，叠加就会消失，量子位就变成了普通的位。这称为**量子退相干**。因此，任何量子计算最终都必须导致非叠加的位。这使得量子计算机难以编程，并需要从门到编程语言的彻底重新设计。此外，它只适用于需要极高并行性但结果值相对较短的计算。

攻击者可以针对比特币使用以下算法：

+   肖尔算法，据估计，将需要近 2500 个量子位来破解比特币所使用的 256 位的 ECDSA 算法。

+   格罗夫算法可以指数级加速比特币挖矿。

比特币所使用的 SHA-256 散列对量子计算机是安全的。

2020 年 12 月，中国研究人员实现了 76 个量子位的系统。量子计算机仍然存在问题。量子计算机面临的最大问题是量子退相干，这会导致错误和相干性（叠加）的丧失。

量子退相干可以由任何环境因素引起，如热波动、辐射和磁场。这使得量子位非常不稳定，叠加可以在毫秒的分数内丢失。研究人员试图通过创建一个具有非常低温度、非常低辐射和非常低磁场的环境来增加退相干时间。我们还没有成功实现这一点，到目前为止，无论量子位的数量如何，量子计算机都无法执行任何深度操作，这使得它们对于实际应用几乎无用。

由噪声引起的量子错误可以通过量子错误校正来解决。

随着我们更好地控制这些环境因素，这种情况可能会在未来发生变化。然而，我们不知道量子计算机何时或是否会成为对称加密的威胁。

如果我们能够建造几个拥有几千个量子位的显著可靠的量子计算机，足够用来破解用于比特币的 256 位 ECDSA，那么它只会影响以已知公钥持有的比特币。正如你在前面的章节中学到的，建议不要重复使用地址。如果我们不重复使用地址，黑客不能使用量子计算来窃取比特币。

如果量子计算机能够破解比特币公钥，那么比特币可以转移到量子抵抗算法，如 Lamport 签名。

另一方面，Grover 算法只能加速 nonce 搜索，并给使用量子计算机的矿工带来优势。然而，与其他采矿设备一样，它将与其他量子计算机进行采矿竞争。这种情况就像 ASIC 矿工引入采矿优势时的情况。这不会影响网络，相反，随着时间的推移，它提高了网络的安全性。

# 隐藏的漏洞、漏洞利用和重组

始终存在这样的可能性：比特币核心软件、共识规则等中存在一个未知的漏洞，这可能会被攻击者利用。这可能是一个通货膨胀的漏洞，攻击者可以给自己支付额外的比特币，并导致比特币供应的增加。它可能会无限期地锁定未花费的交易。它可能会影响矿工或用户。

如果一个漏洞被利用，那么它需要立即被识别出来，或者在几个区块内。一旦确定了漏洞，需要修复，可能需要比特币社区计划比特币区块链重组。区块链重组意味着说服矿工升级比特币软件，使从被利用的区块开始的区块无效，并重新开始挖矿。

当一个区块被挖出时，矿工不能立即移动新铸造的比特币。矿工需要等待 100 个区块才能移动它。这使得开发者有时间为 100 个区块被挖出之前修复漏洞，并说服矿工重组，大约需要 16 小时 40 分钟。在此期间确认的交易需要再次等待确认。此外，在之前确认的交易可能在我们从大多数节点的内存池中删除之前不会再次确认。这将对比特币网络的信誉产生负面影响。

# 欺诈和抢劫

Bitcoin 非常有价值，因此吸引了罪犯。就像黄金一样，比特币有时会遭到武装抢劫。

比特币还可以通过社会工程学手段被盗，例如使用奖励、紧迫感和恐惧或通过伪造服务。这些欺诈行为可能类似于银行欺诈，通过 OTP 获取加密交易所的访问权限。诈骗者可以要求你填写详细信息，并可以获取你的 PIN 或钱包种子。诈骗者还可以要求你将币转入你的钱包以换取服务。

# 结论

在本章中，你了解到了比特币设计的局限性，为什么这些局限性是必要的，以及正在进行的哪些发展能够解决这些局限性。你还了解到了比特币持有者和网络可能受到的不同攻击方式，以及商家、矿工和比特币持有者可以采取的不同方法来减轻大多数这些风险，以及为什么有些风险实际上并不是风险，因为这些要么太难，要么对攻击者来说经济上不可行。

我们讨论了比特币集中化既不利于网络安全，又有利于通过比特币挖矿社区接受改进。我们还看到了比特币能源使用对环境有益。

在下一章中，你将学习到比特币地址格式，并理解如何生成私钥、公钥和地址。你还将了解到如何创建你的比特币钱包以及如何保护钱包不受黑客攻击。

# 要点

+   区块链验证时间是限制比特币区块大小在 1MB 至 4MB 最重要的原因。

+   通过使用 Taproot 替换多重签名和复杂脚本，只用一个公钥和签名来实现签名聚合和 Schnorr 签名，我们可以在一个区块中容纳更多的交易，并拥有更好的隐私性。

+   闪电网络是一个层二支付协议。

+   闪电网络提供了隐私性，因为个别交易不会记录在比特币区块链上。

+   闪电网络提供了扩展性，因为 peers 之间可以发生无限数量的交易。

+   比特币挖矿通过鼓励使用离网的可再生能源和利用废能，有助于降低碳足迹。

+   比特币挖矿难度每 2016 个区块调整一次。

+   矿池集中化后容易受到自然灾害、电力故障、政府打压或 DDoS 攻击，这导致了网络哈希率的下降。

+   哈希率的突然下降导致区块时间增加和网络费用飙升。

+   缺乏法律保护助长了比特币中的欺诈和非法活动。

+   大多数中央银行都鼓励使用比特币和其他加密货币，以保护其货币免受资本外流的影响。

+   高熵随机数生成器有助于生成抵御暴力攻击的私钥。

+   SHA256 算法具有抗碰撞性。

+   盐值保护可防止彩虹表攻击。

+   低轮次的 PBKDF2-HMAC-SHA512 算法容易受到暴力攻击。

+   分层确定性钱包，结合 12 至 24 词的助记词代码，简化了私钥的安全保管。

+   特洛伊木马是一种伪装成合法软件的恶意软件。

+   间谍软件是一种恶意软件，在受害者不知情的情况下被安装，用于窃取信息并发送给攻击者。

+   社会工程学是利用心理操纵手段以收集私人信息。

+   交易可塑性漏洞影响非 SegWit 交易。

+   BIP62 解决了大多数交易可塑性问题。

+   比特币节点默认情况下对所有接收的交易实施最小交易费用，以便接受并转发它们。这笔费用称为中继费。

+   中继费保护地址免受灰尘攻击。

+   为了防止灰尘攻击，钱包不应该接受非常小的价值交易。

+   在 mempool 洪水攻击中，攻击者发布大量小额交易，从而增加网络费用。

+   由于即使是中继费用也不便宜，mempool 洪水攻击变得不可行。

+   在自私挖矿中，一个恶意挖矿池通过给竞争挖矿池带来成本，从而获得对网络哈希率更大的控制权。

+   自私挖矿很容易被识别，因为它导致竞争链的出现更为频繁。

+   FIBRE 代表快速互联网比特币中继引擎。

+   FIBRE 是一种协议设计，通过管理良好的网络，可以实现传播延迟接近物理极限。

+   FIBRE 将传播延迟减少到不到一秒，这使得恶意挖矿池利用自私挖矿攻击网络变得非常困难。

+   集中的挖矿池也容易受到使用 BGP 劫持的网络分区和安全攻击。

+   即使是 SegWit 交易，未确认的交易也容易受到双重支付攻击。

+   始终运行一个完整节点以使用 Tor 路由进行连接。

+   矿工在新挖出的块的 coinbase 交易中添加指纹，这有助于网络了解每个矿工的挖矿哈希率。

+   如果矿工不添加其指纹，它可以隐藏其真实的哈希率，并且可以挖掘超过 51% 的哈希率。

+   由于比特币挖矿在地理上分布不均，因此政府很容易根据其政治目标执行地址的黑名单。

+   比特币共识上的硬分叉可能会导致投资者重复攻击，他们试图从新增的货币中获利。

+   与父币具有相同地址和交易格式的硬分叉币是重放攻击存在的原因。

+   如果前四个挖矿池联手，那么它们可以对网络执行 51% 的攻击。

+   一个 51% 的攻击者可以迫使网络将地址列入黑名单或双重支付它控制的交易。

+   在 Sybil 攻击中，攻击者通过启动大量节点，使整个网络对受害者造成屏蔽。

+   比特币核心客户端只在与 /16 地址的连接中防止 Sybil 攻击。

+   在 DoS 攻击中，攻击者向受害者发送大量数据，阻止受害者提供预期服务。

+   量子计算机利用电子状态的叠加和电子的纠缠来执行复杂的可逆操作，这是经典计算机无法实现的。

+   量子计算机容易受到最微小的环境干扰，这会导致波形坍缩，这种现象称为量子退相干。

+   理论上，量子计算机可以使用几千个量子位来破解比特币所使用的 256 位 ECDSA 算法。

+   量子计算机可以使用格拉夫算法加速比特币挖矿中的 Nonce 搜索。

+   矿工需要等待 100 个区块才能使用挖出的硬币，这给开发者几小时的时间来修复漏洞并重新组织区块链。

# 问题

1.  解释区块大小如何影响初始区块下载（IBD）。

1.  比特币挖矿的去中心化如何保障比特币网络的安全？

1.  解释零售商为保护自己免受双重支付攻击应采取的所有必要预防措施。

1.  解释矿工为保护自己免受不同类型攻击并提高盈利应采取的所有必要预防措施。

1.  解释比特币用户为保护自己免受不同类型攻击应采取的所有必要预防措施。

1.  解释隐私的重要性，并说明比特币用户可以采取的不同方式来保护他们的隐私。

1.  真/假：

    1.  SegWit 交易能够抵御 0 确认攻击。

    1.  比特币可替代，因为它可以用从不同来源接收的等量比特币来替换。

    1.  相比混合服务，CoinJoin 更好，因为混合服务可能会盗取你的硬币。

    1.  SHA256 对量子计算攻击是安全的。

    1.  格拉夫算法将结束比特币挖矿，比特币将需要改变挖矿算法。

1.  填写空白：

    1.  在 _________ 攻击中，攻击者向节点发送大量消息，导致节点无法为其他合法节点提供服务。

    1.  在 ________ 攻击中，攻击者向比特币网络发送大量交易消息，从而增加交易费用。

    1.  攻击者可以通过劫持 _________ 来分区比特币网络。

    1.  重放攻击发生在硬分叉币使用相同的 __________ 格式和 ___________ 方案时。

    1.  通过 __________ 挖矿，一个 hash 率超过 25%的挖矿池可以更大程度地控制网络 hash 能力。

    1.  交易 ______________ 已通过 _____________ 见证增强解决。
