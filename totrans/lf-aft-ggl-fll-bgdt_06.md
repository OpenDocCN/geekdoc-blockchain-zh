## 第六章

## 谷歌的数据中心政变

沿着 84 号州际公路驱车前行，穿过哥伦比亚河峡谷的绿意盎然的半圆形景观，来到风景如画的俄勒冈州达尔斯小镇（与“pals”押韵）。透过道格拉斯冷杉的缠绕，你可以看到被闪闪发光的瀑布削开的古老玄武岩崖。路标指引你前往本地美洲原住民博物馆，那里充满了羽毛和皮革制成的部落遗物。这里有农场和渔场，山坡上的葡萄园，鹰和鱼鹰在风中翱翔。

在地平线上，只有半小时的车程，是辉煌的、积雪覆盖的胡德山峰，有十一条冰川的源头，有半打河流的发源地，是四季滑雪的胜地。“我可以在这里生活，”我对自己说，向着城市波特兰回头望了一眼。与硅谷和旧金山之间的广告走廊相比，哥伦比亚山谷如同一场森林梦。

随着高速公路的尽头，一座废弃的铝厂的灰色废墟从贫瘠的山坡上升起。它的哥特式起重机和宽敞的熔炉空空如也，是对工业力量易逝性的深刻见证。¹

达尔斯的名字源自十八世纪航海者对哥伦比亚河附近危险急流的俚语，当地的工业涉及用独木舟运输海狸皮毛时。现在海狸被单独留下，铝厂大多被遗弃，但达尔斯正在蓬勃发展。2005 年，谷歌在这条河边购买了 30 英亩土地，建立了公司第一个自有自营的数据中心。达尔斯将成为其新世界系统的先锋。

九年间，当谷歌（以“莫瑞恩工业”为名）于 2014 年从陷入困境的西北铝业公司购买了另外 74 英亩的土地时，这个校园的规模增长了三倍以上。其对这个小镇的总投资接近 20 亿美元（在其全球工厂投资约 290 亿美元中）。在谈判期间采取的伪装和法律手段以及之后的慷慨慈善捐款，甚至使谷歌设法使其数据中心普遍免除了财产税。

数据中心本身笼罩在保密之中，设有大门，阻止未经正确审查的员工进入仓库核心区域，以及为每个进入仓库核心区域的人提供的类似机场的毫米波全身扫描仪。为了处理洪水般的比特和字节，谷歌达尔斯堡垒的三个玻璃墙仓库每个现在都容纳了 75000 台计算机服务器，与光纤线相互连接，排列在高耸的机架中。这些服务器尽可能地靠在一起，以最小化光速延迟，看起来像是放在巨大未来图书馆的书架上的发光水平书籍。

尽管常绿迷宫、雄伟的山脉和四季滑雪都起了一定作用，但两个特别的便利设施使得这个地方成为一个主要数据中心的吉祥地。首先是一座光纤枢纽，连接到华盛顿州哈伯波因特，位于达尔斯以北西 200 英里，在雷尼尔山的另一侧。这是 PC-1 庞大电缆的沿海着陆基地。由建造者加里·温尼克的命运不幸的全球交叉公司命名为太平洋交叉 1，这个网络节理是 2001 年建造的一条光纤动脉，每秒处理 640 吉比特（十亿比特）。十年后增加到 8.4 太比特（万亿比特），连接着六千英里太平洋上的亚洲和美国。

一根玻璃状延伸电缆蜿蜒穿越镇上的主要建筑，通过 NoaNet 接入更广阔的互联网，NoaNet 是曾经领先的 Internet2 标准的一个节点。在不可阻挡的乌尔斯·赫尔兹勒的领导下，谷歌的“云”服务在 2017 年迎来了十个新的数据中心，采用了一个更为先进的制度称为“Internet3”。

另一个设施是达尔斯大坝及其 1.8 千兆瓦发电站。这座大坝建于 1957 年，由工程兵团为邦纳维尔电力公司在华盛顿州克利基塔特和俄勒冈州沃斯科之间修建，将达尔斯急流引入廉价补贴的电力供应。曾经对铝冶炼至关重要的电力，现在成为计算的战略先锋。事实上，谷歌并不是唯一依赖哥伦比亚河的硅谷巨头，该河提供的电力成本大约是旧金山湾区电力成本的五分之一。

这种在“云”中聚合大数据和强大计算能力的凝聚，在计算历史上是前所未有的。这些机器通过其在计算和交易速度、密度以及数据存储规模上的卓越表现，掌控着它们的环境。³这些服务器正在推动零售、金融、保险和房地产等多样化行业的新主导地位。但是，谷歌的影响力最为显著（也许只有在盈利能力方面，东方的某个金融竞争对手能与之匹敌）。

摩尔定律描述了集成电路容量增长的规律，其衍生定律以戈登·贝尔命名，他是 80 年代 Digital Equipment Corporation 突破性 VAX 系列微型计算机背后的传奇工程师，现在是微软的首席研究员之一。⁴根据贝尔定律，每十年处理能力价格百倍下降促成了一种新的计算机架构。

就在上个世纪，你还记得很清楚，经历了两次经济危机的深渊——个人电脑曾经是王者。支配和消亡了权威的计算机主机，IBM 在 20 世纪 70 年代的信息技术，以及数码设备和数据通用小型计算机及其在 20 世纪 80 年代的客户端-服务器系统的主导地位。

谷歌的云定义了当前的贝尔定律体系。但甚至在 20 世纪 90 年代末，拉里·佩奇和谢尔盖·布林还是在斯坦福大学盖茨中心工作的非营利机构员工，试图搜索互联网上的 150 千兆字节索引。那时，当我想要用我对未来的敏锐感知力来激发人们的热情时，我会讲述着一种万亿级别（10 的 12 次方）的网络，描述着一个拥有难以想象的巨大内容总量的 1.5 万亿字节。

谷歌的全球仓库起源于这个曾经的未来主义的千兆字节范式，但它的操作环境现在是拍脑特级别——拍脑字节、拍脑操作、拍脑浮点。 “拍脑”意味着十五的 15 次方（也就是百万亿），但也因如此幸运地令人联想到拉丁动词“搜索”。今天，谷歌统治着一个数千拍脑字节的数据库，称为艾克萨拍脑字节，每天会因上百拍脑字节的 Gmails、Facebook 页面、总统推特、视频而增加。这是一场无情的每日增量进程，每天的增量都比十年前整个互联网还要大。谷歌每天处理十亿 YouTube 视频和 35 亿搜索，每年进行 15000 亿搜索。其内部带宽在 2014 年的六年里增长了 50 倍，预计在 2018 年又要再增长 10 倍。根据谷歌运营总监霍尔兹勒的说法，这个数字在接下来的两年内还将再增长 10 倍。

这个贝尔定律机器在全球范围内复制，位于达尔斯的这个机器是谷歌霸权的核心。这是哥伦比亚河上的政变，是谷歌霸权的基础。

1993 年，夜间，太阳微系统（Sun Microsystems）的首席技术官埃里克·施密特（Eric Schmidt）在他的办公室给我发了一封电子邮件，描述了未来：“当网络变得和处理器一样快时，计算机会空心化并传播到网络中。” 太阳（Sun）用简洁的短语宣传了这个概念：“网络就是计算机。” 但太阳的硬件高管们没有吸收施密特即将成为首席执行官的含蓄警告。这种转变的利润会流向何方？“不会流向生产最快处理器或最佳操作系统的公司。” 当时这将是太阳（Sun），它拥有 SPARCstations、RISC（精简指令集计算机）、Java 虚拟机、Solaris 操作系统等，所有这些都与正在崛起的巨头微软和仍然正在崛起的 IBM 竞争。不，施密特在他的夜间电子邮件中写道，利润将流向“拥有最佳网络和最佳搜索和排序算法的公司”。⁷

我称之为施密特定律。施密特不仅仅是一个午夜电子邮件的涂鸦者。他很快离开了太阳，然后在诺维尔（Novell）担任首席执行官，试图在犹他州建立最佳网络和搜索引擎，然后加入了谷歌，并很快成为了 CEO。在那里，他发现自己被他预测的未来所吞噬。而竞争对手如 Excite、Inktomi、AltaVista（DEC）和 Yahoo 正在用 SPARCstations 和 IBM 大型机构建网络时，谷歌却设计并制造了自己的服务器，这些服务器采用了由微处理器巨星英特尔和硬盘巨头希捷生产的廉价商品部件。

在 2005 年的一篇技术文章中，谷歌的运营首席霍尔兹勒（Hölzle）解释了为什么。高端处理器的价格“与其性能成非线性关系”，他观察到。也就是说，英特尔的高端微处理器的价格比它们在增量产出方面的价值更高。芯片碰到了可以称之为曼迪之墙（Mundie's Wall）。当他是微软的技术首席时，克雷格·曼迪（Craig Mundie）说过：

我们现在遇到了一道难题。推动我们更快计算的是提高 CPU 的时钟频率[每个计算周期的速度，以赫兹或每秒循环数来衡量]。更快的时钟会增加功耗。我们只能通过降低电压来提高时钟频率而不增加功耗。但我们不能再这样做了，因为我们已经进入了电子伏特，量子不确定性接管了。如果你不能降低电压，你就不能提高时钟频率而不使用更多的功率。

加快时钟频率并减少热排放比增加存储位的晶体管更困难。由于内存增长比微处理器操作快得多，更快的微处理器往往在内存访问中陷入困境。由 Larry Page 推动的 Hölzle 的解决方案是有希望的：将无数廉价处理器并行堆叠在一起，并用光纤线以光速相连。巧妙的新软件使它们能够共同工作。至少这是一条理论上的路径，一个可扩展的系统，在系统增长时性价比不会降低。

今天，Hölzle 的架构，体现了 Schmidt 的洞察力，证明了 Google 在全球范围内的影响力。Schmidt 经常出现在从阿斯彭到达沃斯再到戛纳的精英圈子里，带着一副傻傻的笑容，像一个计算机科学极客，已经成为了宇宙大师。

政变中的基本第一步，在达尔斯的工厂，是 Schmidt 所称的“有史以来进行的一些最好的计算机科学的成果”。通过建立自己的基础设施，而不是依赖商业数据中心，谷歌获得了“巨大的竞争优势”，Schmidt 当时告诉分析师们。

在每个时代，获胜的公司都是那些浪费丰富资源——正如急剧下降的价格所预示的那样——以节省稀缺资源的公司。谷歌一直在浪费数据存储和主干带宽的过剩。相反，它在最珍贵的资源——用户对延迟的耐心——上是吝啬的——你等待网页或搜索结果的时间有多长。

硬盘存储容量的持续爆炸使得摩尔定律看起来像是一场蟑螂竞赛。1981 年，一块千兆字节的硬盘的成本为 50 万美元，英特尔 286 处理器运行速度为六兆赫兹，成本为 360 美元。到 2018 年，一千兆字节的成本不到两美分，三千兆赫兹的处理器大约三千美元。按不变的美元计算，处理器的价格已经下降了大约五百倍，而硬盘的价格已经下降了 250,000 倍。按照这个粗略的度量标准，硬盘的成本效益增长速度比处理器快了五百倍。

你可能会认为，注重成本的谷歌员工会把他们的仓库填满硬盘。但是，硬盘存储的神奇进步掩盖了一个问题：独立硬盘越大、越密集，扫描它们以获取信息的时间就越长。读取硬盘的小臂无法移动得足够快以跟上处理器。

谷歌的解决方案是部署大量快速随机访问内存芯片。按字节计算，RAM 的成本比磁盘存储高出约一百倍。工程师通常会极度节约它，使用各种技巧来欺骗处理器，使其将磁盘驱动器视为 RAM。但是谷歌明白，最宝贵的资源不是金钱，而是时间。搜索用户表现出的是极度的不耐烦。研究表明，他们对在约一二十分之一秒内提供的结果感到满意。RAM 的访问速度比磁盘快大约一万倍。因此，从访问时间来衡量，RAM 比磁盘存储便宜一百倍。因此，谷歌长期以来一直领先于 RAM 的使用。

快速接触用户还不够。谷歌需要在用户所在的任何地方接触他们。这需要访问互联网骨干网，即环绕地球的长途光纤线路。谷歌将其数十万台处理器与每秒百亿比特的以太网线路相连，现在正在升级至每秒四百亿比特。在主要光纤节点附近放置巨大的数据中心是绝对值得的开支。

浪费丰富资源以节约稀缺资源，G 字母人已成为新千年的至尊企业家。这是谷歌时代。但是，像中午时分的死亡谷上空的一片闪烁的热雾一样，悬浮在海量并行、生产力极高的比特级计算机上。

空调将成为比特级时代的主要成本和难题。1999 年上任后，谷歌的 Hölzle 注意到了高额的电费。以每千瓦时十五美分的价格计算，电力主导了他的成本核算。他说：“一个电力公司可以免费提供 PC，并通过销售电力获得可观的利润。”在达尔斯（The Dalles），屋顶上的巨大突起物不是巨大的磁盘驱动器，而是冷却塔。涂着谷歌标志性颜色的管道穿过它们下方的仓库，用水冷却空气。

水力是有限的并且是局部资源，而核能承诺提供几乎无限的能源，可以在几乎任何地方产生几个世纪的能源。中国计划建造多达四十个新型核电站；下一波数据中心很可能会在深圳建立。

但就目前而言，谷歌已经实现了计算机科学中的一个圣杯：一个可扩展的大规模并行架构，可以容纳各种软件，同时处理 PB 级的大数据。谷歌的 PB 级搜索引擎已经部署完毕，接下来谷歌面临的问题是：还能做什么？谷歌的答案是：几乎任何事情。因此，该公司不断扩展其网络服务组合：提供广告（AdSense，AdWords）、地图（Google 地图）、视频（YouTube）、日程安排（Google 日历）、文档（Google 文档）、交易（Google Checkout）、翻译（Google 翻译）、电子邮件（Gmail）和生产力软件（Writely）等等。其他巨头也纷纷效仿。

我们的 CPU——我们 PC 的 CPU，由数十亿部智能手机放大——比以往任何时候都更强大，但使用率却更低。谷歌和其他公司将曾经委托给 CPU 的越来越多的任务吸入它们专有的云中。光网络可以在不降解的情况下在广阔的距离内传输数据，使得计算可以迁移到电力最便宜的地方。新的计算架构因此可以跨越地球表面进行扩展。截至我在 2018 年写作的时候，谷歌数据中心跨越的内部网络所谓的“横截面带宽”已经达到每秒 PB 级——是整个谷歌搜索、整理、挖掘和变现的互联网总带宽的多倍。而且这还远远不够。

球体中心的谷歌总部很快将使互联网本身相形见绌。在 2015 年 10 月介绍谷歌网络技术领导者阿明·瓦达特（Amin Vahdat）时，计算机协会的杂志宣称，“谷歌的一切都是规模化的，当然——传奇般的市值，无与伦比的人才储备，足够让律师大军穿着古驰度过一生的知识产权，还有——哦，是的——比你想象的要大得多，而且增长速度比互联网还要快的私人广域网（WAN）。"

从奥林匹克的视角看待情景，安迪·贝克托尔斯海姆（Andy Bechtolsheim），硅谷领先的网络硬件企业家，向谷歌及其竞争对手销售设备。他现在正在他的新兴网络公司 Arista 构建 400 千兆以太网。如果 CPU 无法降温太多，他推断，也许计算机的其他部分可以重新设计以将功耗降到最低。那是他的目标。一些行业老手认为，在云计算时代，贝克托尔斯海姆并不重要。但他在 1998 年确实重要，当时他为布林和佩奇提供了第一笔外部资金。在此之前，他曾作为 Sun Microsystems 的创始人，作为微软的主要早期投资者，以及作为 Gigabit 以太网交换机的发明者 Granite Systems 的创始人相继致富。作为现在被遗忘的 Frox 的创始人，他帮助推动了数字视频的许多重大发明。现在，他是 Arista 的技术领袖，数据中心时代新兴路由器和交换机公司的领导者。拥有 Cisco、谷歌、微软、Sun 和 Arista 作为他的皇家同花顺，他是硅谷历史上最杰出的投资者兼企业家。

以德国口音说话的贝赫托尔斯海姆相信，从搜索转向更雄心勃勃的服务符合谷歌的优势。 “为了实时提供视频、地图和其他所有内容，针对特定客户的需求进行优化，以使广告客户获得最大利益，这需要大量的硬件、存储和内存。 它需要为每个最终用户提供数百台计算机。 下一层次没有经济实力来建造这些东西。”

我问：“那么游戏结束了吗？” 贝赫托尔斯海姆回答：“只有当没有人改变游戏规则时才会结束。”

贝赫托尔斯海姆向后仰靠在椅子上，观察着说：“过去几年对于那些希望加快技术进步的人们来说是令人失望的。但现在世界又开始加速。”⁸

创新的下一波浪潮将会压缩今天的并行解决方案，实现电子和光学的进化融合：3D 甚至全息记忆单元；激光刻在芯片顶部，用光子流取代铜针；以及全光网络，其中成千上万种颜色的光沿着单根光纤传输。 随着这些进步逐渐应用到越来越多的设备中，量子级计算机将从恐龙缩小到一台耳中或信号路径中的“电脑电话”——今天手持设备的继任者。 它将访问无穷无尽的传感器、搜索器和服务器。

这些创新将使人们能够参与到似乎更符合谷歌云优势的元宇宙中，这将与全球数万亿传感器相连。 （iPhone8 有十六种不同的传感器系统，从一系列射频设备到陀螺仪、加速度计、气压计和众多成像设备。） 一个行星感知器将使谷歌始终了解世界的物理状态，从交通状况到您自己生物机器的运作。

虚拟现实发明者贾伦·兰尼尔将谷歌庞大、高效的数据中心称为“塞壬服务器”，暗指希腊神话中那些用迷人歌声引诱水手走向死亡的鸟女。在兰尼尔的比喻中，水手不是哥伦比亚河上的皮划艇者，而是拥有这些服务器的产业主宰者。塞壬服务器赋予谷歌暂时的统治快感，但在兰尼尔刻薄的预见中，这将被新范式的暗礁和波涛所取代，导致船只失事。

怀着这样的想法，让我们回顾一下贝尔定律。随着我们支付每字节存储的十亿分之一和每秒千兆比特带宽的一分钱，什么样的机器即将诞生？毕竟，贝尔的十年即将结束。塞壬会提供一台新的经济增长和进步、投资和资本积累、持续经济统治的机器吗？还是达尔斯是一个垂死的商业战略的纪念碑？中心化的日子结束了吗？
