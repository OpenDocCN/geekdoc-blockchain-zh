## 第十七章

## 缘分

当斯蒂芬·巴拉班向贝蒂·孟求婚时，天空上方用一颗巨大的钻石戒指祝福了这一事件。四年前的一天，他在帕洛阿尔托大学大道的奥伦鹰嘴豆店里的拥挤房间里第一次瞥见了她。现在，2017 年 8 月 21 日的早晨，两人站在俄勒冈州的马德拉斯，处于太阳食的七十英里宽的“全食带”的最佳位置。

冬季星星闪耀着光芒。一阵风使空气变冷。白天的黑暗持续了两分零四秒。诡异的阴影条带在地面上闪烁。然后，在上午 10:29 准时，太阳发出了它的回归信号。预期的太阳光钻石从月球背后爆发出来，斯蒂芬向女友呈上了一颗地球版。惊叹不已的贝蒂说了是的。

正如彼得·蒂尔在《从零到一》中写道，“每位伟大的企业家首先是一位设计师……”。但设计并不总是一次成功的尝试。在一连串意想不到的、突如其来的商业成功浪潮的顶峰，巴拉班购买了那枚钻石戒指，这是他在其中一场游戏中击败谷歌和亚马逊的事业之前，包括他自己在内，没有人期望他会做的事情。但是，在这个胜利的求婚场景之前，经历了一场深刻的学习考验。

巴拉班精通普通话，在 2010 年作为密歇根大学计算机科学和经济学学生休学一学期后，他去了北京。在中国，他帮助创办了一个“克隆”，正如他所描述的，是 Y-Combinator 初创企业加速器的克隆。他将其命名为“缘分”，即中国人认为的那种将人们联系在一起的命运概念。最终，由于创始人之间的冲突，他有了看着这个创业项目失败的教育经历。

返回密歇根州后，他拿到了学位，然后前往硅谷——在北京之后，这才是“真正的交易”。他搬进了旧金山历史悠久的唐人街的一间房间，房间里有自己的洗手池，走廊上有一个共用的浴室，骑自行车和坐 Caltrain 到帕洛阿尔托需要一个小时。那是 2012 年 4 月，巴拉班开始了一家公司，教会机器看和学，致力于移动设备的人脸识别。他给这家公司起了一个希腊名字而不是一个中文名字——Lambda Labs——以阿隆佐·丘奇的通用计算模型命名，这是图灵机的美国版本。

2012 年，人们知道人脸识别即将进入手机，但没有人能够将其变得紧凑和快速。巴拉班的工作引起了感知公司的学术形象专家扎克·斯通和尼古拉斯·平托的注意，他们于 11 月雇佣他开发 iPhone 的移动人脸识别技术。

像那时的所有类似项目一样，这个项目将基于深度神经网络处理。但这是移动机器学习，巴拉班解释说，“意味着在手机的图形处理单元上运行人脸识别和其他神经网络，甚至不上传到云端。”他发现人工智能不需要在巨大的数据仓库中进行。这是一个与众不同的洞见，值得一个蒂尔基金会的研究员（到 2013 年中期，他与两位蒂尔基金会的研究员奥斯汀·拉塞尔和托马斯·索默斯一起生活），但他花了一些年才能利用它。“基本上我在学习深度学习。”

他于 2013 年 11 月离开了 Perceptio。两年后，斯通和平托将公司以 2 亿美元的价格卖给了苹果。其人脸识别功能现在已成为新 iPhone 的标准功能。与此同时，巴拉班将他的孪生兄弟迈克尔从不断增长的成功故事 NextDoor 中挖走，NextDoor 提供本地化信息和服务，让他成为 Lambda Labs 的首席技术官。迈克尔似乎也有着与孪生兄弟一样的完美时机——到了 2015 年，NextDoor 已经成为价值超过十亿美元的独角兽。

巴拉班夫妇开始着手硬件开发。他们利用便携式人工智能和人脸识别技术，构想出了一款内嵌在棒球帽中的可穿戴摄像头，类似于谷歌眼镜或 Snapchat 的眼镜。问题是，硅谷没有人能够制造出“Lambda 帽”的原型，因此斯蒂芬又回到中国，在深圳这个与香港隔海相望的制造业中心进行了为期六个月的探索。他得到了一顶很酷的帽子，更好的普通话口语，以及更加犀利的销售陈述，但产品却没有制造商或市场。“技术还不成熟，” 斯蒂芬决定说。

尽管感到失望，他仍然不想去做“不属于自己的事情”。2015 年初，Gary Bradski——在英特尔开发了计算机视觉的机器人学先驱，创立了 Willow Garage 机器人孵化器，并使《连线》的凯文·凯利相信“机器人也有愿望”，并创办了 Industrial Perception，该公司生产了“装卸工机器人”，可以像斯蒂芬·巴拉班所描述的那样“优雅地拾起和扔掉一个箱子”，以至于谷歌收购了他们——那个 Gary Bradski——邀请巴拉班加入他在 Magic Leap 的深度学习团队。这家总部位于佛罗里达的由谷歌资助的虚拟现实公司于 2010 年推出，此前已筹集了五亿美元，而国内的杂志封面上却比虚拟现实的进展更多。尽管如此，尼尔·斯蒂芬森刚刚加入了公司（担任首席未来学家），但巴拉班并不信服，无论这个跳跃多么神奇和资金充裕。

而要跳到哪个方向呢？

2015 年 7 月，巴拉班，奥斯汀·拉塞尔和托马斯·索默斯租住的阿瑟顿房屋终于以 1000 万美元的要价售出。与此同时，索默斯引起了蒂尔的著名创始人基金的注意。蒂尔出资 200 万美元在台积电公司生产索默斯的新芯片。与此同时，来自蒂尔、1517 和其他基金的风险投资涌入拉塞尔在“小马场”进行的“隐秘”无人驾驶汽车项目。而巴拉班找到了一个意想不到的方向。

一个月前，克里斯·奥拉，维塔利克·布特林的高中朋友，比他先赢得了蒂尔奖学金，并且现在是谷歌大脑的一名实习生，与两名谷歌软件工程师合作发表了一篇博客帖子。它的标题是“入梦：深入神经网络”²。

这个名字本身就是多层次的——它是对他们正在使用的神经网络架构的一个引用，而这又是对一个关于“深入”的互联网迷因的引用，而这又是对 2010 年克里斯托弗·诺兰电影《盗梦空间》的引用，其中一个小偷在别人的梦境中挖掘。博客帖子简明地介绍了“一些简单的技巧，用于窥视这些[神经]网络的内部”，然后展示了一系列越来越疯狂的照片，就好像机器正在幻觉。一只小灰猫变成了噩梦的对象：一只毛发蓬松的野兽，额头和臀部上冒出了深色的狗眼和鼻子。

对 Balaban 来说，这段代码及其结果是对蒙特利尔人工智能熔炉中 Geoffrey Hinton 的同事 Yoshua Bengio 所称的“流形学习假设”的视觉确认。Bengio 认为神经网络的基本任务是学习一种表示的层次结构，其中每个新层都是从前一层解析出的表示构建起来的。机器从原始像素开始，将它们组合成从暗到亮的线条和曲线，然后转变为几何形状，最终可以编码为人脸或其他目标图形的元素。在早期阶段打乱这个过程，你会得到一幅技艺高超的图片；在层次结构较高的地方打乱它，你会得到一幅“梦幻与噩梦”图像的幻象，正如 Bengio 所说。在梦境和噩梦中，就像在机器学习的反馈循环中一样，没有感知到新的信息。没有新的输入，心智或机器会以引人入胜但无解决的模式搅动旧图像。

Balaban 是数百名被奥拉帖子吸引的人之一。 7 月 1 日，Google 发布了代码，现在被命名为“Deep Dream”，编码人员抓住机会制作自己的梦幻图像。

Balaban 本人着手开发一款面向普通大众的深度学习图像编辑器，他在一个简单的网站上提供了各种滤镜，大多数都取自艺术（“木炭”，“装饰艺术”）或迷幻亚文化（“鼠尾草”，“自我转化机器精灵”）的名称。

离 2015 年燃烧人节不到两个月。 网站“burners.me”发现了 Balaban 的应用程序，他将其命名为“Dreamscope”，并发布了一篇博客文章，提到菲利普·K·狄克的小说《电动羊的梦》中关于滑溜现实的内容。接着发布了十三张生动的燃烧人节照片，充满了迷幻的眼睛，蘑菇般的毛茸茸的狗脸，合并的人类奇美拉，以及迭代的涡旋。

Dreamscope 应用程序“起飞的速度比我以前见过的任何东西都快。... 第一天就有数百万次下载，”巴拉班记得。“这是人们第一次真正看到神经网络如何看待世界。”

Stephen 和 Michael Balaban 然后找到了支持近百万用户的方法，每个用户都在运行自己的小型机器学习梯度和编辑器。（Lambda Labs 仍然只是巴拉班兄弟和他们的表亲。）通过分布式队列处理系统进行扩展，“它允许我们按需向池中添加新节点。” 缺陷在于所有 GPU 都由亚马逊网络服务控制，必须支付。

Stephen Balaban 正遵循谷歌模式，即提供产品并收取“高级”订阅费用。问题在于，他的大多数“客户”发现免费访问上瘾的迷幻照片绘画已经足够好了。对于$9.95 的“高级版”，有十万人选择，但一百万美元不够。

几个月内，Dreamscope 差不多因为自己的成功而消亡。亚马逊网络服务的账单达到每月四万美元。公司仍有 15 万美元存款，但资金渐渐不足。正如亚历山德拉·沃尔夫在她关于希尔学者首届班级的激励性书籍《众神之谷》中记录的那样，不是所有的项目都会蓬勃发展，无论他们的世界体系有多好。

“这是大多数初创公司都无法做到的时候，”斯蒂芬说。正是在这个时候，正如丹尼尔·斯特拉克曼强调的那样，创业社区的力量就会发挥作用。巴拉班记得在他第一次遇到斯特拉克曼和吉布森时，就很欣赏他们这一点：“迈克和丹尼尔意识到了很多人忽视的创办公司的情感因素——那种非常耗费精力的情感过山车。我观察到他们真的很擅长确保每个人在你“盯着深渊并咀嚼玻璃”的时候都有支持网络，正如埃隆·马斯克生动地描述的那样。”

面对不断膨胀的亚马逊网络服务费用，巴拉班回到了 1517 年；丹尼尔和迈克又提供了 15 万美元。这又延长了四到五个月的时间。但这还不够。奥斯汀·拉塞尔在其中投资了两万美元（后来又增加了十万美元），魔术跃迁公司的加里·布拉德斯基等人也投资了。巴拉班设法筹集了另外五十万美元。

在那个时候，他对再也不给亚马逊寄钱感到一种本能的抵触。他就是做不到。这是一个“从零到一”的时刻，违背了硅谷最稳固的共识，风险投资家的保证——通过建立基础设施来与亚马逊和谷歌竞争是自杀的。过去十年最成功的两个案例——Netflix 和 Instagram，都通过使用 AWS 扩展规模到数百亿美元的估值，强烈地证实了这一共识。巴拉班被告知：“尽管成本高昂，你要专注于用户和业务的扩展，让亚马逊来扩展服务器。”

然而，巴拉班决定彻底放弃 AWS。他花了六万美元从零开始建造自己的服务器，或许受到托马斯·索默斯的启示：现今的服务器是一种浪费能源的混合物，将 98% 的能量用于在内存之间传输数据或处于“等待状态”。巴拉班决定他已经在“等待状态”上花费了足够的时间和金钱。肯定有比将学习数据以 TB 为单位发送到亚马逊 GPU 农场的队列更便宜和更快的方法。“把它们放在硬盘上然后打电话给联邦快递公司会更便宜、更快。”

在巴拉班看来，体现了繁琐的亚马逊设置的过度之处，是来自 Nvidia 的顶级“机器学习”特斯拉 GPU。他发现 Nvidia 的游戏芯片不仅便宜十倍，而且速度更快。对于巴拉班的机器学习算法来说，重要的不是所有定制的“机器学习功能”，而是每美元可用的浮点运算数量。正如比尔·达利在 Nvidia 所展示的那样，机器学习本质上是摩尔定律在处理速度和并行化方面的进步的产物。如果你可以在手机上做到，为什么还需要达尔斯？

巴拉班决心最大化每美元的可用 FLOPS。这意味着使用游戏机 GeForce 处理器，而不是达利在 Nvidia 为之自豪的特斯拉，或者乌尔斯·霍尔兹尔在谷歌珍视的张量处理单元。

Nvidia 的代表们会试图通过解释游戏芯片“不适合数据中心。它们不能被用于机器学习任务。我们不能支持它们。”来吓唬他。这是硅谷所谓的“FUD”——即对于像 Nvidia 在十年前生产的廉价替代设备，像 IBM 这样的老牌生产商散播的恐惧、不确定性和怀疑。

但是，巴拉班一直牢记着每美元的 FLOPS 关键指标，他计算得出高端的 Tesla 芯片的价格约为五千美元，性能为 10.6 的 Floating Point-32 teraflops。游戏芯片（GeForce GTX 1080 TI）产生了 11.3 teraflops，并且每个模块可以购买到 580 美元。这并不是一个难以决定的问题。在巴拉班的 FLOPS 每美元模型中，游戏芯片的性能是高出约二十四倍的。

那时，巴拉班发现了一个令人失望的事实，即 Nvidia 并未以他所需的微不足道的数量出售其 GeForce GPU 板卡用于他的服务器群。这看起来像是一个“阻碍”。但是他想起了与奥斯汀·拉塞尔关于为加密挖矿构建游戏板 GPU 集群的讨论。

解决方案很明显：“去 Fry's 买”，这是硅谷主导的电子零售连锁店，在台湾销售 Zotac 和 Asus 制造的板卡。Lambda 团队清空了湾区 1080 TI 的供应，对需要这些模块用于他们自己服务器的加密矿工们造成了一定的危机。

那时是 2016 年 1 月，拉塞尔邀请 Lambda 团队来到 Pony Tracks Ranch 池子后面的车库。他让他们免费使用这个空间；Lambda 只需支付电费。巴拉班和他的团队着手从底层构建服务器，使用具有 GPU 集群的游戏板。他们安装了自己的一百安培分流盒，功率为二十四千瓦。

2016 年 2 月 13 日凌晨 4:27，他们首次使用 GTX 980 TI Maxwell 架构启动了第一台服务器。峰值计算速率为 5.63 teraflops，因此每台机器有四个模块，总计 225.2 teraflops，使他们成为世界顶级超级计算机名单上的一员，拥有近四分之一的 petaflop 集群。

对巴拉班的进展感兴趣的人中包括乔治斯·哈里克，一位硅谷的巨头，他像巴拉班一样，在密歇根大学学习了计算机科学，然后进入谷歌开发了 AdWords。哈里克观察到，“我不知道 Dreamscope 会怎么样，但如果你们擅长 Linux 系统管理，你们可以做 GPU 云服务。” 这是谷歌的第十名员工建议他们在云计算领域与谷歌竞争。这是一个想法。

巴拉班和他的团队已经学会了如何最大化他们机器上每美元的浮点运算数，立即结果是停止了来自亚马逊的账单。六周内偿还了六万美元的投资，为使 Dreamscope 取得成功创造了发展空间。他们已经建立了一个团队，由斯蒂芬和他的兄弟迈克尔组成；他们的首席科学家 Chaun Li，是一位利用神经网络将照片转换为绘画的专家；以及史蒂夫·克拉克森，他从伯克利的软件工程博士项目中退学。

截至 2016 年 12 月，Dreamscope 的盈利计划在某种程度上已经开始奏效——他们拥有许多热心用户，并且每月通过数百万次下载赚取约五千美元。有了更多的资金和更长的时间，它可能会成为一个盈利的产品。

然而，巴拉班决定降低 Dreamscope 的档次，转向计算机基础设施市场。他会像迈克尔·戴尔早年那样出售电脑。巴拉班在家族圈子里混了个乱，拉来了一个高中同学，名叫杰克逊·森格尔，从达特茅斯学院的生物工程博士诱走。他了解在你体内制造所有蛋白质的核糖体。为什么不违反新的硅谷规范，正如彼得·蒂尔在 2014 年对学员们说的那样，“做一些每个人都认为很愚蠢的事情”——销售自制电脑？

他们开始手工逐步将它们组装在硅谷的深夜。由于他们在 GPU 成本上的巨大优势，每个模块仅需 580 美元，他们在组装方面并不需要特别高效率。他们的产品是一个 GPU 工作站，其中包含了来自 Nvidia 的四个 GPU GeForce 游戏模块，Lambda 将其定价为一万美元；如果你想要将它们安装在云架构中，价格则为二万五千美元。

他们将其放在自己的 Lambda Labs 网站和 Amazon.com 上。“不是 AWS，”Balaban 指出，“只是 Amazon.com。”他们称其为“深度学习 DevBox”—“Dev” 指开发。他们使用 Google AdWords 进行广告宣传。Harik 很可能感到高兴。

2017 年 3 月，DevBox 开始销售。它们带来了两万五千美元的收入，是 Dreamscope 收入的五倍。那是一件了不起的事情。然后在 4 月，他们卖出了七万五千美元，是 Dreamscope 的十五倍。5 月他们卖出了 13.5 万美元。八月来了日食和建议。到 11 月，他们的销售额已接近 50 万美元，并准备推出一个由 Dreamscope 测试过的数据中心业务，Balaban 说这将被用来“吃自家的云服务”。

Harik 认为他们可以进入 GPU 深度学习集群的 Linux 管理员业务似乎是有道理的。另一位前 Google 员工也鼓励了 Balaban。Ken Patchett，在亚洲建立了 Google 的绿地数据中心，然后转而为 Facebook 建立数据中心，向他解释了数据中心额外成本的来源。所有那些 24/7 的可靠性、冗余和电池备份，所有昂贵的碳抵消能源化妆品，所有高端的 ASICS 和空调。

或许世界各地的巨型 Google 数据堡垒在每瓦的 FLOPS 和每美元的 FLOPS 方面已经变得严重不太理想。它们确实可以进行搜索，但新的贝尔定律时代已经来临——一个新的去中心化时代，手持设备中的人脸识别，汽车和移动容器中的数据中心——开启了一个新时代的“天空”计算，将云散开。
