© 作者，独家授权给施普林格自然瑞士有限公司 2022A. Kumar 等人编著的现代计算系统的量子和区块链: 视觉和进步数据工程与通信技术讲义 133[`doi.org/10.1007/978-3-031-04613-1_9`](https://doi.org/10.1007/978-3-031-04613-1_9)

# 区块链技术可能面临的挑战的量子解决方案

Nivedita Dey^(1  ), Mrityunjay Ghosh^(2  ) 和 Amlan Chakrabarti^(3  )(1)印度加尔各答加尔各答大学 QRDLab(2)印度加尔各答的 HCL Technologies, 加尔各答大学(3)印度加尔各答的加尔各答大学 Nivedita Dey 邮箱: mail.dnivedita@gmail.comMrityunjay Ghosh (通讯作者) 邮箱: g.mrityunjay@gmail.comAmlan Chakrabarti 邮箱: acakcs@caluniv.ac.in

## 摘要

随着量子计算的最近出现，当前区块链加密系统的安全性可能会受到更大程度的威胁。量子算法，如 Shor 的大整数分解算法和 Grover 的非结构化数据库搜索算法，相比其经典对应物，可以分别提供指数级和二次级的加速。这可能对公钥或非对称密钥加密系统和哈希函数构成威胁，这必然要求从经典密码学迁移到量子安全密码学。本工作首先研究当前和未来经典最先进的区块链可扩展性和安全原语。陈述了比特币、以太坊、Corda 等已经采取的相关量子安全区块链加密系统倡议，并就关键尺寸、哈希长度、执行时间、计算开销和能源效率进行了比较。此外，该工作旨在提供量子辅助解决方案可以如何克服区块链技术中的挑战，以及如何在后量子时代增强可扩展性、安全性和性能的不同方法。尽管量子信息本身处于噪声中间规模量子（NISQ）时代，尚未发展到高技术准备水平，但本工作还涵盖了在近期实现后量子区块链的实际挑战和未来研究方向。

## 1 引言

量子计算对企业而言不再只是一个理论概念；它现在在创造经济价值方面具有真实的应用，有效地解决了复杂的挑战。IT 系统中的传统安全性由几个非对称密钥和对称密钥密码系统提供[1]。非对称密钥密码算法如 RSA（Rivest Shamir Adleman）加密、ECDSA（椭圆曲线数字签名算法）、ECDH（椭圆曲线 Diffie Hellman）算法、EdDSA（爱德华兹曲线数字签名算法）使用数学难题如离散对数问题、大整数因子分解问题作为底层的加密安全提供者[2–4]。相反，对称密钥或共享密钥密码算法如 DES（数据加密标准）、TDES（Triple DES）、AES（高级加密标准）使用分组密码技术生成一个对称密钥，该密钥可用于加密和解密[1]。

区块链和其他分布式账本技术（DLT）是一种新颖的计算数据结构，在过去几年中发展迅速，因为它们能够提供安全通信、数据隐私、弹性和透明度。通过使用公钥加密原语和哈希函数，比特币、以太坊、门罗币、瑞波币、Zcash 等区块链技术可以展示冗余、透明度和责任 [5]。区块链用户利用公钥加密原语来验证交易 [6]。另一方面，哈希函数用于生成数字签名和创建不一定相互信任的区块。量子计算的前所未有的增长可能对经典区块链加密原语构成潜在威胁。Shor 的因式分解算法可以利用两倍于密钥大小的逻辑比特数来破解非对称加密，这必然意味着使用 2048 位 RSA 密钥来实现 112 位安全级别时，4096 量子比特的量子计算机已经足够。同样地，另一方面，破解 AES-128 加密密钥最终将被减少到破解 64 位对称加密密钥。这是通过 Grover 的非结构化数据库搜索算法实现的，该算法可以将暴力攻击时间缩短到其平方根 [7, 8]。近期量子时代可能存在的量子威胁导致了一些抵御量子计算机未来无法破解的量子抗性加密算法的发展。后量子密码学（PQC）致力于设计抵御量子攻击的算法。一些最有前途的 PQC 领域包括基于哈希的密码学、基于编码的密码学、基于格的密码学和多变量二次方程密码学 [7]。这些后量子密码学算法在实际实施中不太适用于经典区块链技术，因为存在几个缺点。解密延迟、大量消耗计算资源和增加的密钥大小是可能阻碍区块链性能的几个挑战。在这项工作中，已经分析了与经典区块链相关的可扩展性和安全性问题。工作的组织如下。

第二部分从区块链技术的操作原理及其组成部分，包括区块、链、网络以及几种共识机制开始讨论。在第三部分中，从现有和未来的角度探讨了区块链的不同可扩展性方面。随后，在下一节中展示了如何利用量子优势来解决区块链技术中的可扩展性问题。为了分析这一点，从区块链辅助的金融科技应用中识别出了几个研究用例，如超级数据分析、计算速度、减少欺诈检测中的假阳性案例数量以及可以应用量子计算的蒙特卡罗模拟。为了引导研究人员开发量子抗性区块链应用的需求，第 5 和 6 节提供了关于当前区块链使用的密码学基元面临的潜在威胁的广泛视角，如 Shor 和 Grover 算法。此外，第 7 和 8 节阐明了针对通用量子抗性密码学和特定基于区块链的后量子倡议所采取的最相关的后量子密码学倡议。这两节还包括五种区块链加密货币（比特币、以太坊、莱特币、门罗币和 Zcash）在近期量子时代的漏洞。在第九部分中，还对这些 DLT 的量子攻击可行性进行了扩展研究。由于后量子区块链存在挑战，因此在第十部分讨论了可靠区块链安全基元的挑战和未来研究方向，随后是结论部分。

## 2 区块链和分布式账本技术

区块链或任何分布式账本技术（DLT）是一种数据库，它在一组用户之间共享、同步和复制，经过共识同意。短语“分布式账本”指的是区块链网络上的每个节点或参与方复制和存储交易数据。预定义的分布式账本规则自动处理一致性和数据库冲突等问题。分布式账本的特性包括点对点网络功能、交易数据存储的去中心化、支持基于共识的交易以及防篡改性。这使得分布式账本具备可编程性、安全性、匿名性、一致性、分布性、时间戳和不可变性，如图 1 所示。区块链的核心部分包括区块、链、网络和区块链共识机制。区块由定期记录的交易列表组成。交易代表在区块链数据库中发生的任何虚拟活动。在网络创建时，每个区块都可以根据预定义的规则设置其大小或允许存储在区块中的交易的最大基数。![](img/516210_1_En_9_Fig1_HTML.png)

图 1

分布式账本技术的特性

![](img/516210_1_En_9_Fig2_HTML.png)

图 2

比特币加密货币中的区块链技术

区块的链接在区块在交易数量方面达到最大限制时是必要的。然后，通过哈希链接区块以建立前一个区块和下一个区块之间的连接。上一个区块的哈希值被放置到下一个区块中。因此，每个区块通过密码哈希对下一个区块产生影响。这在图 2 中已经显示。哈希是一种数据处理方法，它将可变长度的数据字符串作为输入，并输出固定长度的值。这种哈希方案对于生成可以轻松验证和分发给其他节点的小交易数据至关重要。对未更改的数据块重复应用哈希函数将始终产生相同的哈希输出。这可以从表 1 进一步理解，其中“National Archives”一词拼写的轻微变化导致在应用安全哈希算法（SHA—256）时产生不同的输出值。Merkle 树是简单哈希算法的扩展，其中包含多个哈希值。单个哈希输出，称为 Merkle 根，可以表示多个哈希[9]。表 1

对“National Archives”一词拼写略有变化的情况下安全哈希算法生成的不同哈希值（256 位）。

| 文本变量字符串输入值 | 哈希值 |
| --- | --- |
| “National Archives” | 6429799b9af2d91cbf915cb0290f3a50281193a977b3457d63e4541cc5788c5b |
| “National Archives” | d926fe7e72d09b249701dbcde2dad0ccb9b4bb653e053e461a67bbb951dcae0b |
| （加入了额外空格） |   |
| “Nati0nal Archives” | 5f2d570fc940d5f8de89310db43f789fdd99f51e89c021e1a50acb7a6fe2cf83 |

![](img/516210_1_En_9_Fig3_HTML.png)

Fig. 3

区块链技术中交易的流程

区块链网络由节点或块组成，每个节点都包含所有交易的记录。区块链网络中的每个节点都是等概率可信的，一旦一个节点解决了一个加密难题（一个数学上困难的问题），它就可以在交换性能奖金的情况下添加下一个区块到区块链中。这种技术被称为挖矿，解决难题的节点被称为矿工 [10]。表 2

区块链共识机制

| 机制 | 运行原理 |
| --- | --- |
| 工作证明 | 矿工解决复杂的数学难题以获得区块作为奖励。难题的难度水平由挖掘速度决定 |
| 股权证明 | 使用随机过程选择将获得添加区块机会的节点。最有可能创建新区块的用户是拥有最大股权或拥有比特币时间最长的用户。这是一种比工作证明更节能的方法 |
| 授权股权证明 | 用户抵押他们的硬币来投票给一定数量的代表，在加权投票机制中。得到最高票数的代表被看好会创建一个新的区块。这是区块链中最快的共识机制之一 |
| 容量证明 | 用户使用数字存储来存储加密难题的解决方案。存储容量最小的用户有机会创建一个新区块 |
| 已经过时间证明 | 使用用户花费的时间量来选择新区块的生产者。每个用户被分配一个随机等待时间。等待时间最短的用户有机会创建下一个区块 |
| 权威证明 | 网络验证者的个人身份被置于危险之中。只有验证者节点被允许创建新区块。这是工作证明的修改版本 |
| 活动证明 | 它是工作证明（具有挖矿奖励地址和头信息的区块）和股权证明（使用头信息随机选择验证器）的结合 |
| 身份证明 | 将用户的私钥附加到给定交易上，以确保创建的数据的完整性和真实性的加密证据。只有确认身份的用户才能在网络中创建一个区块 |

区块链共识机制是一组规则，它规定了节点验证要进入区块链的交易的过程，如图 3 所示。这些规则在区块链创建时建立。在双方都想要在不知道或不信任对方的情况下启动通信的情况下，为了就将交易包含到区块链中达成一致，内置了一种共识机制。这可以解决拜占庭将军问题[11]。为了支持交易记录的真实性和不可变性，每个区块链都有其自己的共识方法，该方法基于其处理的活动交易类型。工作证明（PoW）、股权证明（PoS）和委托权益证明（dPoS）是几种知名的共识机制[7]。容量证明、经过时间的证明、权威证明、活动证明和身份证明是一些其他的共识程序。表 2 表示了所有这些共识机制的基本操作原则。由于基础平台的初创性，寻找一个可靠的单一共识机制的过程变得越来越复杂。但是，将区块链技术与业务应用程序集成需要了解所有这些机制的信息。

## 3 经典区块链的可扩展性方面

对于在区块链中实现可扩展性的渴望是无限的，因为区块链的采用往往因缺乏可扩展解决方案而受阻。比特币的处理能力为每秒处理 4.6 个交易（TPS）；相反，Visa 平均每天可处理超过 1.7 亿笔交易的 TPS。基于区块链的系统速度较慢。区块链的交易速度慢是企业依赖高性能传统交易处理系统的一个主要关注点。仅举一个数字来说明组织对区块链采用的百分比，根据 Tata Communications 进行的一项调查，这一数字接近 44%。

### 3.1 从现有角度看区块链可扩展性

转账过程中无法控制的延迟，比特币网络上的过高费用，以及以太坊区块链网络上的拥塞-在其中进行数千个去中心化交易-所有这些都可以归因于区块链可扩展性问题。

#### 3.1.1 区块链可扩展性度量

区块链交易速度是平均区块大小和平均交易大小的函数。从数学上讲，区块链网络的交易速度可以视为：

#### 3.1.2 比特币 TPS 的市场不足

比特币的区块大小被硬编码为 1 百万字节（8.388608 兆比特），其平均交易大小约为 3040 比特。这导致每个比特币区块可容纳大约 2759.12 笔交易，TPS 仅为 4.6。比特币社区已尝试通过修改区块链参数来增强区块链的可扩展性。为此，选择的指标是区块大小（以字节为单位，增加以提高 TPS）和区块生成时间（以秒为单位，通过改变哈希难题的复杂性减小其值）。要实现像 Visa 那样的 TPS 加速，比特币需要将其区块大小增加到 3.775 亿字节，这是比特币默认区块大小的 377.5 倍 [6]。保持区块生成时间为 10 分钟和平均交易大小为 380 字节（与默认值相同）理论上可以达到 TPS 为 1736。然而，实际上，这种加速不太可能实现，因为新区块必须广播到比特币网络上的每个其他节点，这涉及传播延迟或中继时间。在包含 10,198 个节点的比特币网络中，需要大约 14 秒来将 1 百万字节的区块大小传输给对等节点的 99%。另外，如果区块创建时间短于 14 秒，则在大多数当前区块接收旧区块之前将生成一个新区块。

#### 3.1.3 SegWit—区块链中的流量控制

SegWit 或隔离见证旨在为比特币网络的可扩展性问题提供解决方案。它认为任何交易的见证部分应该与实际交易分开。实际交易是覆盖比特币如何移动，它们正在移动到哪里以及它们如何被访问的基本交易数据。但，“见证”部分包括一小段代码和用来证明比特币所有者有意花费比特币的加密签名数据。这可以防止服务拒绝行为，并帮助实现不可否认性。SegWit 软分叉方法有助于增加区块大小，而不需要对核心代码进行更改，但可扩展性的真正挑战在于区块链的价值主张。交易的高传播时间可能导致重大的安全问题，如双花攻击。

**区块链中的双花攻击** 一个去中心化的工作证明系统的计算能力是各个节点的个体计算能力的累积和。增加的计算能力增加了每个新创建区块的挖矿奖励的获胜概率，从而在挖矿池中创建了一种激励或偏见。如果一个集合能够获得 51%的哈希算力，就能够有效地推翻网络交易并创建双花攻击。比特币分叉“比特币黄金”（BTG）在 2018 年和 2020 年都受到了这样的攻击，造成了约价值 72,000 美元的 BTG 的损失[14]。

### 3.2 未来解决可扩展性问题的传统方法

传统方法无法解决跨加密货币平台中区块链可扩展性问题的不适用性是一个重大关注点。另一个挑战在于理解为多个可扩展性参数之间的权衡所做的假设。

#### 3.2.1 批量处理多笔交易

批处理是将多个交易压缩成单个交易记录的过程，以减少交易记录的大小。这样可以为每个区块增加更多的交易，从而实现所有交易的单一批量支付。在这里，不是完整存储所有交易的信息，而是完全存储第一笔交易信息。对于其余的交易，只存储部分数据。这种方法有助于减少要存储的交易数据（以字节为单位）和支付成本。但是，通常会有一个限制，即无法从不同的钱包创建不同交易的批处理。此外，这种方法不提供隐私，因为批处理中其他交易的细节是公开的。

#### 3.2.2 比特币现金——硬比特币

比特币现金是比特币的一个硬分叉，旨在作为比特币的替代品添加交易速度方面的价值主张。比特币现金的主要动机是将默认区块大小从 100 万字节（用于比特币）增加到 800 万字节，这可以加快整个交易处理系统的速度，并提供默认的 8 倍 TPS。但是，这只是满足全球基准并在交易空间竞争的临时解决方案。此外，它可能不适用于其他区块链网络。

#### 3.2.3 预留比特币交易的闪电网络

闪电网络促进了预留交易的即时处理，并促进了微交易。在闪电网络上创建的支付通道不会通过比特币区块链运行交易，而是将它们视为预留，并不收取额外的交易费用。这种方法允许用户从区块链中检索比特币，并与另一方进行私人交易。但是，闪电网络存在一些限制，它只适用于基于比特币核心的区块链，例如比特币现金、狗狗币、DigiByte、莱特币等 [15]。

#### 3.2.4 BloXroute—区块链无关的链上解决方案

与链下交易不同，链上交易只有在区块链被修改以在公共账本上反映交易时才被视为有效。另一方面，区块链无关性是指允许从不同基础区块链技术进行操作的单一平台。BloXroute 是一家专注于 BDN（区块链分布式网络）的初创公司，受 CDN（内容分发网络）概念启发。内容分发网络是由代理服务器和数据中心组成的空间分布网络。CDN 的主要目标是通过复制技术以更高的频率向最终用户传送内容。CDN 通过利用其他服务器的内容并将其定向到距用户最近的数据中心，提供 Web 内容服务。尽管 BDN 仍处于概念阶段，但它可以指引我们正确解决未来区块链可扩展性问题的方向。

#### 3.2.5 EOS—通过委托 PoS（股权证明）实现可扩展性

EOS 是一个区块链项目，利用委托型 PoS 提供高端理论可扩展性。比特币中使用的大量电力是由于使用 PoW（工作量证明）算法作为一种共识机制来保护比特币区块链。PoW 算法通过要求所有区块链节点解决一个密码学难题来运作。矿工解决这个难题，而第一个解决它的矿工将获得矿工奖励。根据数字经济学家的说法，“比特币矿工单独使用约 54 Twh 的电力，足以为美国的 500 万户家庭提供电力，甚至为整个新西兰国家提供电力”。在设备质量和数量方面拥有改进设施的人在 PoW 中会得到更多奖励。哈希率越高，创建区块并获得挖矿奖励的可能性就越大。矿工经常组成矿池，将他们的哈希算力组合起来，并将奖励平均分配给矿池的所有参与者。上述 PoW 的问题引发了新的共识机制需求，即所谓的股权证明（PoS）。PoS 采用选举过程随机选择一个节点来验证下一个区块。验证者的选择不完全是随机的；相反，要成为验证者，节点必须向网络存入一定数量的硬币作为抵押。抵押量的大小与验证者铸造下一个区块的可能性之间存在线性关系。与比特币不同，EOS 依赖于由 21 个验证者民主选举产生的节点池来达成更快的共识。这的确以去中心化的代价为代价，因为要控制 EOS 共识机制，只需控制超过 50% 的生产者（21 个节点中的 11 个）。委托型 PoS 是实现 EOS 所承诺的革命性速度（百万级 TPS）和效率的关键部分。

## 4 量子助力经典区块链

区块链和其他分布式分类账技术的技术发展承诺为寻求透明度、冗余性和责任制的应用提供重大优势。采用这些新兴技术实际上需要融入成本效益、快速、支持服务质量（QoS）、安全和可扩展的设计。此外，区块链平台的计算延迟导致交易速度缓慢，因此量子计算原理可能提供显著的加速和可扩展性来加快交易处理和挖矿过程。

### 4.1 量子提供了计算领域前所未有的增长

量子计算利用量子力学定律中发现的奇特随机性，展现了非确定性，并且代表了从经典信息处理中的根本变化。它利用了量子力学现象的“怪异性”（计算的概率性性质，叠加态和纠缠理论），创建的机器比当今高性能计算机更强大。当今的经典、基于晶体管的机器利用经典比特，0 和 1 来表示信息。在量子设置中，粒子通常存在为数学上的多种可能性而不是在没有任何观察时存在的一个实际对象。量子计算机不仅能够提供超出其经典对应物的指数级加速，而且它们的基本工作原理将允许处理那些甚至对现有机器来说都无法实现的复杂计算任务。

#### 4.1.1 量子比特

一个量子比特，也被称为量子位，是量子计算中的最小信息单位。它是经典比特的量子版本，可以在物理上实现为 0 和 1 的相干共存，而不像经典计算中的任何状态。量子比特的测量可能会破坏相干性并在叠加态中不可撤销地引起干扰。两个正交基态的线性叠加可以用来表示量子比特的量子态。2*n*维希尔伯特空间中的叠加态矢量可以表示多量子比特（*n*比特）系统。

#### 4.1.2 量子叠加

量子叠加是指量子粒子以数学上的可能性存在，而不是作为一个实际对象。数学上，它对应于薛定谔方程的解的一个性质，其中任何解的线性组合都是另一个解。在量子信息处理中，![$$ \left| {0} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq1.png) 和 ![$$ \left| {1} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq2.png) 是表示纯量子态的狄拉克符号，通过测量转换为经典逻辑时，分别始终给出结果 0 和 1。然后，量子态 ![$$\alpha \left| {0} \right\rangle + \beta \left| {1} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq3.png) 将是线性态 ![$$ \left| {0} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq4.png) 和 ![$$ \left| {1} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq5.png) 的叠加，其中复数 ![$$\alpha $$](img/516210_1_En_9_Chapter_TeX_IEq6.png) 和 ![$$\beta $$](img/516210_1_En_9_Chapter_TeX_IEq7.png) 作为系数，表示 ![$$ \left| {0} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq8.png) 和 ![$$ \left| {1} \right\rangle $$](img/516210_1_En_9_Chapter_TeX_IEq9.png) 进入每个构型的程度 [16]。这种在多个状态下共存的概念仅在没有观察时成立。

#### 4.1.3 量子纠缠

比叠加态更令人惊讶的是，爱因斯坦的“远距离幽灵作用”理论中的“EPR（爱因斯坦-波多尔斯基-罗森）悖论”开辟了量子力学解释的新维度，即纠缠。量子理论预测，两个纠缠的实体可能具有相关的命运，因为对一个实体的测量立即导致相关结果。在测量之前，量子实验的结果是未知的，但在获得实际结果之前，结果之间的相关性是完全确定的。一旦得到纠缠对的一个结果，对另一个结果就不再存在不确定性。

### 4.2 区块链可扩展性中的量子优势

上述提到的量子机械原理可以在经典计算上提供实质性的加速[17]。由于区块链平台在多个金融科技应用中得到严格使用，已经分析了四个金融科技应用的使用案例，其中可以进行量子入侵以提供计算优势。

#### 4.2.1 超级数据分析

解锁区块链管理物联网（IOT）设备的潜力将有助于理解由多个交易生成和处理的大量数据。此分析主要有助于决策系统，其中一致性、自主性和处理延迟可以进行调整。区块链技术中的预测分析使得沿供应链追溯物品的来源成为可能。缺乏足够的数据会导致不准确的预测，而具有经典位的可用经典系统在处理大量数据时效率较低。利用量子机械原理如量子并行性可以在超级数据分析中提供显著的加速。更好地利用一个特定组织的区块链数据的量子启用的分析模型使得可以识别潜在的投资回报（ROI）来源。

#### 4.2.2 计算速度更快

有限的区块大小和比特币共识协议的工作证明难度导致了交易处理能力的瓶颈[18]。诸如重复记录保留、第三方验证等操作构成了有限的透明度，并导致数据验证缓慢。传统解决方案，如使用更好的机器或更快的通信链路，可以提供增强的交易处理速度，但仅在一定程度上（约为 5 倍）。随着容错量子计算机的可用性，在未来，量子时代将提供无噪声的量子比特，以增强处理速度、准确性，并使用量子网络的更快通信模式。这种即时执行交易的模式将带来较低的计算复杂度和降低的资源开销。

#### 4.2.3 减少欺诈检测中的误报

传统欺诈检测模型主要依赖于解释过去的支付方式来分配风险分数和检测欺诈支付交易。尽管人工智能和机器学习算法的出现，传统智能系统无法适应每个事件实时动态数据的处理。这导致未经筛选的误报案例，这些案例会严重影响资源开销和欺诈调查速度，从而对盈利能力和客户体验产生重大影响。降低误报的一个可能解决方案是计算速度和选择数据点的最优性。这可以增强欺诈警报调查的准确性和适应性。量子机器学习有望在经典机器学习模型上实现显著加速。如果将更多数据点输入训练模型，则调整欺诈检测规则和模型以匹配感知风险水平的能力将得到增强。

#### 4.2.4 高效的蒙特卡洛模拟

加密货币市场仍然波动不定，因为它是去中心化、开放和高度可访问的。蒙特卡洛模拟和时间序列分析对于预测在选定时间段内与加密货币相关的未来风险和回报至关重要。经典的蒙特卡洛算法在对许多变量进行模拟并受到不同约束的情况下计算效率较低。这个过程会产生巨大的时间开销，并且近似解需要进行许多计算。如果放入模型的条件和参数不佳且未经筛选，则模拟结果将很差。通过估计任意定义的随机函数的期望输出值，量子算法可以在非常一般的情况下加速并实现对经典蒙特卡洛算法的二次加速。

## 5 Shor’s Algorithm—威胁经典公钥区块链算法

Shor’s 算法是用于大整数因式分解的多项式时间量子算法。由 Peter Shor 于 1994 年开发，它能够找到任何整数的质因子。Shor’s 算法的效率源于 QFT（Quantum Fourier Transform，量子傅里叶变换）、QPE（Quantum Phase Estimation，量子相位估计）和通过重复平方的模指数运算的效率。Shor’s 算法能够破解 RSA、ECDSA、EdDSA 等经典加密方案，因为这些算法本质上依赖于质因子分解和离散对数问题的数学难度。Shor’s 算法能够比已知的最佳经典算法提供指数级的加速。

### 5.1 RSA（Rivest Shamir Adleman，里维斯特-沙米尔-阿德尔曼）算法

在 RSA 中，用户将他或她的公钥发送给服务器并请求机密信息。服务器使用用户的公钥加密数据或明文，然后返回加密数据，称为密文。用户在接收到数据后使用他或她的私钥解密数据。为了创建和加密区块链钱包，区块链使用与 RSA 类似的算法[19]。每当创建加密货币钱包时，都会生成一对公钥地址-私钥。用户的公钥地址用于接收加密货币并检查相应的区块链余额[20]。另一方面，用户的私钥与公钥一起用于访问和花费用户的加密货币。从数学上讲，RSA 使用一种单向陷阱函数，其中公共信息是两个大素数，它们的乘积用作加密和解密的模数。难点在于数学上难以计算回这样一个大整数的因子。但直到 1994 年，彼得·肖尔发明了一种使用量子傅里叶变换（QFT）和量子相位估计（QPE）进行大整数因子分解的新颖量子算法。具有 4096 个逻辑量子比特的量子计算机可以在比经典对应物更短的时间内破解 2048 位密钥的 RSA 加密[19]。

### 5.2 ECC（椭圆曲线加密）和 ECDSA（椭圆曲线数字签名算法）

基于椭圆曲线的算法子程序被用作生成钱包密钥和签署交易的标准。为了生成公钥，ECDSA 从 256 位随机种子生成一个私钥[3, 21]。从经典角度来看，对于给定生成的公钥找到随机值是非常困难的。随机生成的私钥用于签署交易，而公钥用于证明已经使用了一个私钥。另一方面，Shor's 算法可以反向计算任何公共地址的私钥，并控制一个人的钱包。尽管从密码原语“安全级别”（以比特或攻击者必须遵守的操作数量来衡量，以便破坏底层系统的安全性）的角度来看，ECDSA 提供了比 RSA 更好的安全级别。一个 224 位大小的公钥 ECDSA 提供了 112 位的安全级别。另一方面，为了达到相同的 112 位安全级别，RSA 需要一个 2048 位大小的公钥。但是，就后量子抗性而言，ECDSA 比传统的 RSA 更受威胁[4, 19]。根据研究洞见，“RSA 2048 位密钥需要大约 4096 个量子比特（52 万亿 Toffoli 量子门）才能被击败，而 ECDSA 256 位密钥只需要 2330 个量子比特（1260 亿 Toffoli 量子门）”[3]。

### 5.3 ECDH（椭圆曲线 Diffie-Hellman）算法

ECDH 协议是一种密钥协商平台，使两个方在不安全的网络上建立共享秘密成为可能。在区块链技术的背景下，接收比特币的一方发布一些 ECDH 信息，发送方用于计算一个共享秘密 [22]。这个共享秘密就是比特币地址，也称为隐形地址、可重复使用的付款码、可重复使用的地址或支付码，发送方向其中发送他的货币 [22]。接收方计算相应的私钥以获得对货币的访问权限。密钥交换协议的基础密码学难题依赖于离散对数问题（DLP）的数学。目标是确定一个唯一的整数，该整数可以是有限循环群的生成元素的阶。对于一般的椭圆曲线来说，DLP 似乎是极其难以计算的，因为目前已知的最佳椭圆曲线 DLP 经典算法都是对描述问题所需的比特数指数级运行时间复杂度的通用算法。修改后的 Shor 算法用于 DLP 可以在理论上实现指数级加速，以破解‘被认为是’不可逆和难以处理的单向函数。

### 5.4 DSA（数字签名算法）

数字签名用于在区块链系统中确保文件或消息的完整性，以确认信息的不可否认性（事后否认）。然而，由于工业环境中多样性不足，目前可用的加密系统很可能会受到量子计算攻击的影响。经典数字签名（CDS）方案提供的安全程度取决于大整数因子分解和离散对数问题的复杂性和难度。这使得该系统在近期不再具有量子安全性 [23]。

## 6 Grover 算法—对经典区块链技术的威胁

Grover 算法能够展示出比经典计算机更强大的搜索速度。它展示了使用一种称为量子幅度放大的技术解决非结构化数据库搜索问题的二次加速。但最大的优势在于它可以作为一般技巧或子程序来解决各种其他复杂算法。

### 6.1 更快的哈希碰撞检测

区块链专注于计算哈希函数，以提供对先前区块的更改的安全性，从而确保区块的完整性。底层分布式架构要求在重新计算一系列区块、找到与现有哈希冲突的哈希以及修改单个区块方面进行大量的计算工作，这是极具挑战性的[24]。然而，Grover 算法可以专门解决以前难以反转的函数值的预图像问题[25, 26]。在将哈希值（签名）和哈希函数作为输入提供给量子计算机时，Grover 算法可以以二次较小的努力为我们提供应用哈希的原始数据。这比蛮力搜索更有效和加速了哈希碰撞的生成[8]。因此，它提供了在检测哈希碰撞方面的可行加速，这可以用于替换区块而不危及区块链的完整性——这可能会对经典区块链构成严重的安全威胁。

#### 6.1.1 重新创建整个区块链

Grover 可以加速生成随机数的过程，以至于可以使用持续修改的哈希来重新创建整个记录链。 经典攻击需要使用线性时间的暴力搜索，这涉及到整个哈希空间，直到找到与已知哈希值匹配的值为止[26]。 这可能会导致系统中的漏洞，因为插入修改的区块将不会被发现，因为它不会对区块的顺序一致性产生负面影响。

## 7 个量子抗击密码的后量子倡议

后量子密码学的目标是通过开发新的数据和通信保护方法来解决由超级强大的量子计算机造成的量子威胁问题。 包括基于哈希函数的技术和加密技术的不同经典密码算法的预量子和后量子安全级别分别在表 3 和表 4 中显示。 这反过来又需要制定实施量子抗击加密的策略。 提前规划将减少系统停机时间，并为适应部署缺陷提供灵活性。 以下部分介绍了全球科学家和研究人员采取的四项主要后量子倡议，为量子抗击加密解决方案做出贡献。表 3

受量子威胁的基于哈希函数的算法

| 经典算法 | 当前安全级别（位） | 后量子安全级别（位） | 导致威胁的量子算法 | 受威胁的分布式账本 |
| --- | --- | --- | --- | --- |
| SHA-256（安全哈希算法） | 256 | 128 | Grover | 比特币，以太坊，达世币，门罗币，莱特币，泽什，瑞波币，NXT，字节块[27] |
| Keccak-256 | 256 | 128 | Grover | 以太坊，门罗币，字节币 |
| Keccak-384 | 384 | 192 | Grover | IOTA [28] |
| Keccak-512 | 512 | 256 | Grover | 以太坊 |
| Scrypt | 256 | 128 | Grover | Litecoin, NXT |
| RIPEMD 160（RIPE 信息摘要） | 160 | 80 | 格罗弗 | 比特币、以太坊、门罗币、莱特币、瑞波币、字节币 |
| SHA-3 256 | 256 | 128 | 格罗弗 | – |

表 4

受量子威胁的非对称和对称加密算法

| 经典算法 | 当前安全级别（位） | 后量子安全级别（位） | 造成威胁的量子算法 | 受威胁的分布式账本 |
| --- | --- | --- | --- | --- |
| ECDSA | 128 | 已破解 | 肖尔 | 比特币、以太坊、达世币、莱特币、泽币、瑞波币、字节球 |
| RSA-1024 | 80 | 已破解 | 肖尔 | – |
| RSA-2048 | 112 | 已破解 | 肖尔 | – |
| RSA-3072 | 128 | 已破解 | 肖尔 | – |
| AES-128 | 128 | 64 | 格罗弗 | – |
| AES-256 | 256 | 128 | 格罗弗 | – |

### 7.1 PQCrypto

这是允许用户从经典密码学迁移到量子抗性密码学或后量子密码学的倡议之一，以便他们长期保持安全，抵御来自量子计算机的攻击。 PQ Crypto 的主要目标是设计一系列在后量子时代具有（i）提高速度，（ii）增强安全性，（iii）适应物联网，云和移动设备等多种性能挑战的公钥加密系统组合。 [29]。

### 7.2 SAFEcrypto

[SAFEcrypto](https://wiki.example.org/safecrypto)这个词代表着未来新兴密码学的安全架构。其主要目标是为量子时代未来的物联网应用提供强大而物理安全的解决方案 [30]。提供计算困难性的基础数学源是基于格密码学原语，以增加数字签名、认证方案、公钥加密、基于属性的加密（ABE）和基于身份的加密（IBE）等的安全性。由于后量子计划需要低功耗和实时性能，SAFEcrypto 旨在实现实时应用场景的 10 倍速度提升和低功耗嵌入式移动应用的能耗减少 5 倍。基于格密码方案的算法优化和改进设计可以提高资源受限和实时互联网应用的性能。

### 7.3 CryptoMathCREST

这个后量子计划是 CREST 资助计划的一部分，由日本科学技术振興机构（JST）管理。这个计划背后的主要目标是分析下一代密码系统安全建模的数学公式及其变体。

作为新的研究成果出现的新颖数学技术将作为构建新密码协议的基础。CREST Crypto Math 项目的四个关键研究领域，包括 25 名数学家和四名博士后研究员，涉及对行业应用安全模型的调查、后量子密码学安全性和效率的评估、用于密码学的数学对象和约简映射的研究，以及量子技术和量子信息理论的理论背景的探索 [31]。

### 7.4 后量子标准化

后量子密码学标准化是由 NIST 主持的一个项目，旨在更新他们的标准，其中后量子密码学（PQC）或量子抗性算法（QRAs）可以被纳入。像高级加密标准（AES）、数据加密标准（DES）这样的对称密钥加密基元相对容易修改，以帮助它们提高安全级别（以比特为单位）并成为量子抗性 [32]。因此，NIST PQC 计划的主要重点是公钥密码学基元，如数字签名和密钥封装机制（KEMs），目前，NIST 启动了第三轮预期的四轮提案征集。NIST 后量子密码学标准化项目的提案征集和时间表已在图 4 [33–35] 中描述。这些后量子密码学计划可以在安全应用的广泛范围内发挥作用 [36–38]。更精确的面向区块链的后量子计划包括比特币后量子、以太坊 3.0，以及用于 Abel 平台的量子抗性密码系统和 Corda 区块链的 PQC 等重要计划 [39]。在下一节中，将讨论所有这四个后量子计划，包括它们的操作原理、优缺点、与当前区块链技术的相关性以及实施中的基本挑战 [40, 41]。NIST 标准化项目的时间表如下图所示 4 [42, 43]。![](img/516210_1_En_9_Fig4_HTML.png)

图 4

NIST 标准化项目的时间表

## 区块链上的 8 个后量子计划

区块链技术中使用的经典加密原语面临量子计算机的威胁。为了克服经典区块链中的加密挑战，已经采取了几项后量子加密倡议[44]。这些倡议的主要目标以及它们与经典安全系统的相关性如下所述。

### 8.1 比特币后量子

针对比特币区块链技术的后量子倡议将包括比特币安全原理的操作原理，它在后量子时代的脆弱性以及如何使用基于哈希的 PQC 方案使经典比特币成为量子安全。

#### 8.1.1 比特币安全原语/操作原理

去中心化数字加密货币比特币的安全性基于 ECDSA 和工作证明（PoW）算法，这些算法授权支付方并防止双重支付[45]。比特币通过从一个地址到另一个地址的交易在用户之间转移，其中地址代表接收者公钥的哈希，在交易在比特币网络上分布时公开[4]。拥有的比特币数量由与给定公钥关联的私钥所有权决定。用于签署交易的数字签名显示了所有权的证明。

#### 8.1.2 比特币安全的量子威胁

ECDSA 的强度基于离散对数问题，这对 Shor 算法是脆弱的[46]。每当在网络中披露公钥时，量子计算机就可以计算出相应的私钥。一个新的交易可以伪造出一个有效的数字签名。但是，即使在量子计算机中，搜索哈希的前像的过程仍然计算复杂。Grover 算法的二次加速对适当长度的哈希函数不会产生明显的加速。

#### 8.1.3 量子安全的基于哈希的密码学

高安全性、充分的签名长度和可接受的密钥生成时间使得扩展 Merkle 签名方案（XMSS）能够在 PQC 时代作为量子安全的数字签名方案使用[47]。为了实现后量子安全级别，至少需要 256 位哈希（如 P2WSH 中使用的），以提供 128 位碰撞抵抗力。XMSS 数字签名方案与 RFC 8391 结合可以自然抵御侧信道攻击，并通过提供 128 位后量子安全级别（256 位哈希）来保证安全，抵御量子攻击[48]。 （四）可用性和与当前区块链的相关性：从给定的 XMSS 树中找到认证路径所需的签名数量是树高的指数决定因素。增加 XMSS 树的高度将意味着需要签署更多交易（对于 h = 10、20，分别为 2h = 1024、1048576）。在现代经典计算机上，即使是量子安全的，这可能需要消耗从不到一秒钟（h = 10）到约 10 分钟（h = 20）的时间[48, 49]。此外，根据比特币后量子（BPQ）共识，最突出的方法是生成 XMSS 密钥和量子安全地址。然而，到目前为止发现的 BPQ 方法对于区块链应用来说是不切实际的，因为 XMSS 计算速度较慢[50, 51]。

### 8.2 以太坊 3.0

为了理解以太坊的后量子倡议，首先讨论了以太坊中使用的经典安全原语，然后讨论了经典密码算法在以太坊上引起的漏洞。然后考虑了量子安全的密码原语的详细信息，以增强以太坊的安全性，以及它与当前区块链情景的可用性和相关性。

#### 8.2.1 以太坊安全原语/运行原理

以太坊使用零知识（ZK）证明技术，使一方能够向另一方证明其知识，而无需实际传递信息本身 [52, 53]。这种增强隐私的技术使以太坊成为一种可扩展技术，因为用户之间的信息传输量将大幅减少，并且证明可以以更快的速度进行验证 [52, 54]。

#### 8.2.2 量子对以太坊安全的威胁

以太坊加密货币依赖于零知识简洁非交互式知识论证（ZK-SNARK）技术 [55, 56]。尽管该技术是非交互式的，意味着代码可以自主运行或部署，但它需要一个可信的设置。可信的设置架构需要密钥创建来生成和验证私人交易的证明。用于生成这些密钥的秘密如果没有销毁，就可能被用来伪造交易。用于 ZK-SNARK 的底层密码学基元是以太坊技术的另一个劣势，因为它主要依赖椭圆曲线密码学。这可能会对以太坊的安全性造成威胁，因为一旦全面量子计算机可用，对于给定的公开已知基础，获取随机选择的椭圆曲线的离散对数将不再是不可行的。

#### 8.2.3 量子安全的密码学基元（ZK—STARKS）

ZK-STARK（零知识可扩展透明知识证明）是以太坊 3.0 的后量子倡议，后量子安全性可以通过量子抗攻击哈希函数实现[25, 57]。此外，在网络中使用 ZK-STARK 时不再需要可信设置架构。这有助于消除信任方损害整体系统隐私的漏洞。STARK 的优势在于改进的可扩展性和增强的隐私[56]。它可以执行批量计算和存储链下，允许区块链基础设施呈指数级扩展而不失去计算完整性。

#### 8.2.4 可用性及与当前区块链的相关性

尽管存在诸如需要可信设置架构和椭圆曲线算法的量子攻击等问题，但技术如 ZK—SNARK 相对于量子抗攻击的 ZK—STARKS 有更快的采用率[48]。导致 ZK—STARKS 采用率较低的原因是缺乏开发者库、已发布的代码、项目以及当前可用于该技术的开发者。此外，量子计算机的发展，即更多无噪声量子比特可执行这些量子攻击，也处于初期阶段，并且相对于当前情况，对最终用户更昂贵。

### 8.3 Abelian

Abelian 是几个利用基于格的密码方案提供可追溯隐私的 PQC 平台之一。Abelian 计划允许不同监管机构审核私人交易，以服务各种联合应用。该计划的主要目标是设计、开发、部署和运行一个完全操作的量子抗攻击区块链方案平台。

#### 8.3.1 区块链隐私原语/操作原理

数据隐私一直是区块链应用中的一大挑战。在基于权限和无权限的应用情况下，加密工具可以保护隐私。Fully Homomorphic Encryption (FHE)、Multiparty Computation (MPC)、Functional Encryption (FE)、Searchable Encryption (SE) 等应用存在一些挑战和与之相关的计算复杂性[58]。FHE 似乎是任何区块链隐私问题的通用解决方案，但在近期内无法实现。MPC 技术在计算和通信方面非常复杂且效率低下，尽管它们可以在分布式计算平台上提供隐私和可验证性。FE 和 SE 技术缺乏理论研究来设计引人注目的用例和更有效的方案，而不会牺牲安全性。Table 5

主要加密货币的隐私视角

| Bitcoin | (a) 伪匿名来自隐私关注 |
| --- | --- |
| (b) 钱包地址和钱包持有人的个人信息被独立保存 |
| (c) 基本隐私级别 |
| (d) 所有交易都记录在公共账本上，因此交易是可追溯的 |
| (e) 威胁：如果可以建立一个图来表示所有钱包地址为节点，所有交易为边，那么通过图分析可以从单个比特币完整节点获取比特币系统的完整视图 |
| Dash | (a) 使用以隐私为中心的主节点改进比特币，以降低可追溯性 |
| (b) 通过将个别交易的输入和输出与其他交易的输入和输出相结合，使用“混合技术”来模糊个别交易的输入和输出之间的联系 |
| CryptoNote | (a) 是对比特币和 Dash 的改进 |
| (b) 使用环签名来隐藏发起者的身份 |
| (c) 应用迪菲-赫尔曼密钥交换协议来隐藏接收者的身份 |
| Zerocoin | （a）打破个别交易之间的关联以提高隐私性 |
| Monero | （a）结合 Dash 和 CryptoNote 的技术来隐藏每笔交易金额 |
| （b）应用零知识范围证明以确保发起者不能超支任何金额 |
| （c）被认为提供全面隐私的加密货币技术之一 |
| Zerocash | （a）打破交易之间的关联 |
| （b）可以隐藏用户的身份，从而提供匿名性 |
| （c）应用零知识 SNARKs 来掩盖每笔交易金额 |
| （d）另一种提供全面隐私的加密货币技术 |

#### 8.3.2 主要加密货币的隐私视角

现有的加密货币由于能够保持每笔交易的发起者和接收者的匿名性，同时隐藏每笔交易金额，可以提供双重隐私。但是这些技术无法提供任何既能够抵御量子攻击又能够提供带有问责制的隐私解决方案。主要加密货币的隐私视角已在表 5 中展示。

#### 8.3.3 量子安全的阿贝尔加密货币（ABE）

ABE 旨在构建高效且抗量子的隐私币，它使用基于格的密码构造来提供可追溯性。ABE 的用户可以为每笔交易选择隐私级别。其基本隐私级别可与比特币相媲美，而完整隐私级别可与门罗币或零币相提并论。除了这两个隐私级别外，ABE 还允许用户选择一个指定的机构，该机构可以将当前交易与上一笔交易相链接，并同时破解实际交易金额。ABE 的密码学原语基于格结构的难题的难解性，即短整数解（SIS）和带误差学习（LWE）。这些方案在 ABE 中的使用得到了后量子安全性的严格证明，从而提供了一个具有增强隐私视角的实用且可扩展的解决方案。

### 8.4 Corda

Corda 可能是最具密码学敏捷性的 DLT 技术，允许用户在多个签名密钥类型之间进行选择[59]。这些密钥类型包括(a)类似 RSA、ECDSA、EdDSA（爱德华兹曲线数字签名算法）等非量子安全技术，以及(b)类似于 SPHINCS（后量子状态无状态基于哈希的签名方案）等量子安全技术[2, 19]。SPHINCS-256 是一种高安全性方案，在现代 3.5 GHz 容量的 4 核 Intel CPU 上每秒可以签名数百条消息[3, 4]。SPHINCS 提供大小为 328 Kb 的签名，以及大小为 8 Kb 的公钥和私钥。传统的基于密码散列函数的签名方案是有状态的，意味着它们在处理每个签名后必须记录信息（系统状态）[60]。一般来说，这些基于散列函数的签名方案以秘密密钥作为输入，消息本身可以产生一个签名和一个更新的秘密密钥作为输出[26]。如果在更新或复制密钥时出现任何故障，系统的整体安全性就容易受到破坏。与这些方案不同，SPHINCS 是一种应用随机化树状无状态签名的方法。这可以提供长期的![$$2^{128}$$](img/516210_1_En_9_Chapter_TeX_IEq10.png) 安全性，在可预见的未来对任何量子攻击都是抵抗的。此外，这种签名方案也是实用的，因为它可以在速度和签名大小之间提供实时可接受的权衡。

## 9 区块链 DLT 上量子攻击的可行性

密码方案的基础依赖和缺乏量子抗量子算法使得当前的区块链 DLT 对量子计算机发动的几种攻击易受攻击。因此，有必要了解在近期量子计算机可用时可以利用的当前漏洞程度以及执行这些量子攻击所需的计算度量（以 qubit 数量、门保真度、qubit 噪声、底层物理机器描述等为单位）[61, 62]。在下一节中将讨论对区块链技术的几种量子攻击的概念和操作可行性。

### 9.1 比特币

比特币将 Hashcash 作为基础共识机制，旨在打击电子邮件系统的拒绝服务（DoS）攻击。这使得潜在的发送者只有在解决了一个计算上困难的问题后才能发送电子邮件。Hashcash 中的一个潜在的矿工必须计算头部和一个随机选择的数字的 SHA-256 哈希值。这个随机数是衡量数学难题的计算复杂性的一个重要参数，这个难题需要解决。比特币的交易机制采用了 ECDSA 认证协议，以展示权威、所有权、交易不可变性和令牌使用的无可辩驳性。所采用的椭圆曲线是 secp256-k1[63–65]。这个签名由两个值组成，即 S 和 R，其中 R 对应于椭圆曲线点的 x 坐标，后续签名的另一部分（S）可以如下获得：![$$\begin{aligned} S=K-1 ( SHA256 (M) + dA.R )mod\ p \end{aligned}$$](img/516210_1_En_9_Chapter_TeX_Equ2.png)(2)其中，

K = 暂时选择的私钥。

dA = 用于签名的私钥。

p = 椭圆场的阶（素数）。

SHA256 (M) = 在应用 SHA-256 哈希算法时，消息 M 的输出[66]。

具有二次加速的 Grover 算法可以比传统矿工更快地操作 PoW。如果攻击者可以产生等于网络其余部分的 PoW（超过 50%），那么另一个脆弱性来源是对交易使用 ECDSA 方案。经典计算机可以以 *O*(2*n*) 的复杂度解决 ECDSA 方案的难题，这提供了计算开销。Shor 算法可以比经典对应算法更快地执行相同的计算 [46]。ECDSA 的难题数学问题是离散对数问题，Shor 算法可以在 ![$$n³ log (n) log log (n)$$](img/516210_1_En_9_Chapter_TeX_IEq11.png) 的时间内在量子计算机上解决这个问题，复杂度为 ![$$O (n³)$$](img/516210_1_En_9_Chapter_TeX_IEq12.png)。此外，当公钥和已经广播到网络的签名交易时，Bitcoin 可以进行有效的量子攻击，目标是找到相应的私钥。量子计算机可以加速使用私钥签署新交易的过程。这将帮助一个非法用户冒充密钥所有者，并将该非法交易放置在区块链上的原始交易之前。因此，原始交易可能被盗取，并且新生成的未花费交易输出（UTXO）可以被定向到一个账户，从而导致存在一个并行区块链。实验证明，一个具有 4,85,550 个量子比特且时钟频率为 10GHz 的量子计算机能够在 30 分钟内解决这个问题 [67]。

### 9.2 以太坊

以太坊主要旨在促进智能合约和去中心化应用的采用，每个交易都会向用户账户中增加或减少以太币。以太坊早期的共识机制是 Ethtlash，它是一个 PoW，只包含单轮 SHA-3 哈希运算 [50]。矿工的算力由其持有的以太币数量确定。与比特币类似，以太坊采用了 ECDSA 变体，其中用户账户关联的主公钥未向网络公开。相反，可以通过另一用户的交易签名使用公钥恢复技术来检索公钥。EthHash 容易受到量子计算机的 Grover 算法攻击。对以太坊进行成功攻击的难度值可以描述如下：![$$\begin{aligned} D = (H_r * B)/2^{32} \end{aligned}$$](img/516210_1_En_9_Chapter_TeX_Equ3.png)（3）其中 D = PoW 机制的难度

![$$H_r$$](img/516210_1_En_9_Chapter_TeX_IEq13.png) = 网络的哈希率

B = 区块链的块生成时间

在经典系统中，对于![$$B=16$$](img/516210_1_En_9_Chapter_TeX_IEq14.png)秒和![$$H_r=18*10^{3}$$](img/516210_1_En_9_Chapter_TeX_IEq15.png)H/秒，困难值为![$$D=670552$$](img/516210_1_En_9_Chapter_TeX_IEq16.png)。相反，在具有操作频率 S 的量子设备上的等效估计哈希率为![$$0.04 * S\sqrt{D}$$](img/516210_1_En_9_Chapter_TeX_IEq17.png) [68]。这使得量子计算机只需 5THz 的时钟速度就能执行 51%攻击。由于它与 ECDSA 的相似性，以太坊也容易受到 Shor 算法的影响。以太坊的交易数据处理时间（TPS）显著加快，比比特币更有优势。与 UTXO 模型不同，以太坊采用基于账户的交易模型，涉及地址的重复使用。但这导致以太坊对量子攻击更加敏感，因为通过账户本身将用户与相应的交易绑定的过程会导致网络整体隐私的恶化。在以太坊中，所有出站交易都必须使用与账户关联的单一公钥/私钥对进行签名。量子对手可以通过使用 Shor 算法以显著更快的速度获得公钥并确定私钥[46]。这可能导致完成单个交易处理后暴露整个账户余额。

### 9.3 莱特币

Litecoin 的设计目标是比比特币更快的交易处理速度。为了增加 TPS，Litecoin 采用了一种名为 Scrypt 的不同 PoW 系统，其消耗的哈希功耗明显低于比特币[69, 70]。（比特币的哈希率约为 ![$$46*10⁶$$](img/516210_1_En_9_Chapter_TeX_IEq18.png) TH/sec，而 Litecoin 为 298 TH/sec）[71, 72]。因此，Litecoin 优先考虑在挖矿节点上密集使用 RAM 而不是处理能力[73]。但由于 Litecoin 是比特币的项目分支，它也潜在地容易受到量子攻击的威胁。Litecoin 使用的签名方案也是 ECDSA 的 secp-256k1 椭圆曲线，这使其容易受到 Shor 算法的攻击[63]。此外，Scrypt 的 PoW 也容易受到 Grover 算法的量子计算机攻击。用于成功攻击 Litecoin 的难度值可以描述如下：![$$\begin{aligned} D = ( 32*10^{13}*150)/2^{32}= 11175870 \end{aligned}$$](img/516210_1_En_9_Chapter_TeX_Equ4.png)(4)。当前的 Litecoin 哈希率为 ![$$3.2*10²$$](img/516210_1_En_9_Chapter_TeX_IEq19.png) TH/sec，允许量子计算机在时钟频率为 ![$$2.4*10^{12}$$](img/516210_1_En_9_Chapter_TeX_IEq20.png) cycles/sec 的情况下攻击当前的哈希率[72]。由于其相对较短的区块时间和比特币更快的吞吐量，Litecoin 在抵抗量子攻击方面似乎具有轻微的优势。然而，由于区块奖励减少导致的较低哈希率可能会使系统更易受到量子攻击的威胁和影响。

### 9.4 莫内罗

Monero 是区块链加密货币之一，旨在通过使用 Pedersen Commitments 和 Range Proofs 来混淆用户身份和交易金额以提供隐私。 Monero 的 CryptoNight V8 PoW 方案是一种内存密集型的过程，可以在随机间隔处进行缓慢的内存访问[74]。 Monero 采用 EdDSA 作为签名算法，该算法基于扭曲爱德华兹曲线 Ed25519[75]。与 ECDSA 类似，Monero 的签名方案还取决于离散对数问题的数学难度，以确保其安全性，因此可以认为在近期量子时代的 Shor 算法下是不安全的[46]。此外，Monero 还能够通过结合使用环签名、隐形地址和环保密交易来提供交易匿名性[76, 77]。Bulletproof 是目前用于 Monero 的零知识证明机制，以确保交易的平衡。使用此机制有助于 Monero 在计算开销和区块链所需空间方面更为高效[78]。Monero 最近将其共识算法框架从 CryptoNight V8 转换为 RandomX[79]。 RandomX 方案旨在使用特殊指令集来处理随机程序的执行，包括整数算术、浮点算术和分支指令。由于不向攻击者透露目标交易中要转移的金额信息，Monero 对量子攻击具有稍微更强的抵抗力。这种隐私为 Monero 提供了额外的安全性，使其对量子攻击不那么具有吸引力。还应进一步注意到，目前尚未发现 RandomX 存在量子攻击漏洞。

### 9.5 Zcash

Zcash 是一种基于隐私的区块链，允许公共账户和私人账户之间的交易。Zcash 交易依赖于 ZK-SNARK，它基于可信设置架构来证明交易的公平性。Equihash 是 Zcash 下的 PoW 方案，它依赖于广义生日问题[80]。与门罗币类似，Zcash 也是使用 EdDSA 作为签名算法，并采用椭圆曲线 Ed25519[63, 75, 81]进行实现。这个签名方案也基于离散对数难题的复杂性，因此容易受到 Shor 算法的量子攻击。此外，Grassi 等人开发了一种量子算法，可以在时间复杂度为 ![$$O(2^{n/(2 + log2k )})$$](img/516210_1_En_9_Chapter_TeX_IEq21.png)内解决广义生日问题或 K-xor 问题，而目前已知的最佳经典算法瓦格纳算法的计算复杂度为 ![$$O(2^{n/(1 + log2k )})$$](img/516210_1_En_9_Chapter_TeX_IEq22.png)[82]。这个量子算法在时间和空间复杂度方面展示了显著优势，因此可能导致对系统的量子 51% 攻击。如果攻击者能够使用 Shor 算法拥有全局私钥，则可以无限生成 Zcash 代币。如果代币可以随意创建，并且通过混淆将代币创建保持对网络的其余部分不可见，那么整体安全性和网络性能可能会受到严重影响。因此，可以得出结论，由于其对量子计算攻击的低抗性，Zcash 比现有的区块链技术更容易受到攻击。

## 实现量子后区块的认识和未来研究方向

后量子区块链技术不使用量子力学原理来利用计算速度的提升。相反，它们是在经典计算上的进步，以使当前在区块链中使用的加密原语能够抵抗未来的量子计算攻击。研究人员一直在努力寻找新的后量子方案，这些方案可以在不久的将来实现，并为实施提供实用的、可扩展的解决方案。区块链从前量子时代向后量子时代的过渡需要实现一定的目标，以确保其成功整合。在制定这一领域的任何新研究时涉及的主要挑战可以描述如下。

### 10.1 密钥大小和签名大小

后量子密码系统声称在现有经典立场上提供更高的安全级别。增加用于加密密钥和签名的比特数可以提高安全性，但这可能会对区块链网络的整体性能产生重大影响。为了实现 128 比特量子安全级别，所需的密钥大小为公钥 2,688 比特，私钥 384 比特，签名为 120 KB。这必然需要存储大量信息，从而引入巨大的计算开销。因此，需要研究制定新的技术，以在安全级别和区块链系统性能之间提供平衡。

### 10.2 密钥生成速率

在前量子区块链方案中，可以使用相同的密钥签署多个消息。然而，如果必须提高安全级别，则必须限制可以使用相同密钥签署的消息数量。高速密钥生成依赖于伪随机数生成器（PRNGs），其依赖于复杂算法的数学属性来生成密钥。这些密钥不提供足够的熵，也不是固有随机的，导致统计上相关的密钥。另一种替代方法依赖于真正基于硬件的随机数生成器（HRNGs），其可以利用经典物理学的属性生成真正的随机位。尽管这些基于硬件的随机数生成器提供了足够的熵，但它们的密钥生成速率不足以应对需求增加。最近，研究人员正在研究基于量子的随机数生成器，它可以利用量子力学现象生成真正的随机位。需要进行深入研究，以便专注于密钥生成机制和密钥生成速率之间的权衡，以提高区块链的效率。

### 10.3 区块链合规问题

多个后量子区块链计划已经启动，研究仍在进行中。因此，研究人员和开发人员应该对正在批准的标准后量子方案进行持续监控，以避免任何合规问题。

### 10.4 现有硬件的不兼容性问题

后量子密码系统具有很高的计算密集型，因为它们需要大量的计算开销来增加系统安全性。但是，这种开销需要大量的计算资源和增加的处理能力。这使得后量子方案的可扩展性较低，因此，不太实际进行实施。需要进行研究以解决这种经典硬件不兼容性，以便在整体安全性和计算复杂性之间取得权衡。

### 10.5 密文开销

后量子密码系统应生成大量密文，以使其解密变得复杂。但是，这会给资源受限的嵌入式系统的整体性能带来很大的开销。量子计算可以是减少密文开销的潜在解决方案之一。可以利用量子叠加的量子并行性来准备一个量子状态空间，在其中可以将经典数据编码为量子比特而不是比特，如图 5 所示。然而，这带来了另一个挑战：将量子计算部分与经典计算部分分离开来[62]。如果可以将量子混合系统纳入后量子区块链中，它可以在安全性和计算速度方面帮助整体系统改进。![](img/516210_1_En_9_Fig5_HTML.png)

图 5

量子启用压缩技术的拟议块图

## 11 结论

尽管量子计算技术的发展尚处于初级阶段，但已经吸引了研究人员和开发者关注量子计算机在区块链和其他分布式分类账技术中的潜在优势和威胁。在这项工作中，讨论了经典区块链技术现有和未来的可扩展性方面。分析了量子计算对区块链辅助金融科技应用提供的潜在好处，以便进一步提升区块链在实际应用中的性能。分析了格罗弗算法和肖尔算法对经典区块链安全原语构成威胁的影响。为此，审查了最相关的区块链分布式分类账技术，如比特币、以太坊、莱特币、门罗币、Zcash。详细分析了它们被真正的量子计算机攻击的脆弱性领域。此外，针对量子抵抗密码学和区块链的特定后量子倡议进行了研究，包括其操作原理、可能的量子威胁、量子安全的密码原语以及这些方案在当前区块链场景中的相关性。本工作还包括实现后量子区块链和利用量子技术的挑战和潜在研究方向。因此，本工作可以为量子计算和区块链技术的研究领域提供有用的指导，更重要的是，在理解后量子区块链中可能发生的几种量子入侵的情况下，制定新的抗量子区块链技术。
