- en: '12'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: INTERNAL CONTROLS
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: GERARD BRENNAN
  prefs: []
  type: TYPE_NORMAL
- en: 12.1\. INTRODUCTION
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The advent of blockchain and distributed ledger technology (BC/DLT) ushers in
    a whole new asset class and potentially a new methodology and practice for auditing
    and financial reporting. As outlined throughout this book, this technology is
    new and different. This technology is disruptive not just to the markets and business
    processes it impacts, but also to internal controls and the financial reporting
    process of businesses. Risks, assertions, information systems, business processes
    and internal controls are all very different in the BC/DLT environment and will
    need to be addressed with different methods and tools.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter will compare and contrast some of the similarities and profound
    differences between BC/DLT technology and conventional central database type business
    systems currently in use in most businesses. Blockchain may well be the “gateway”
    disruption which will encourage us to replace antiquated assurance methodologies
    and practices in favor of a much more comprehensive, automated approach. For example,
    periodic sampling used widely today in auditing, must give way to population-based
    auditing and monitoring. Blockchains are by design automated networks which leverage
    analytics and cryptology extensively to facilitate reporting and assurance. Conventional
    database assurance and reporting often use periodic non-statistical sampling methods
    simply because it is cost-effective. The effort and resources needed to do population-based
    auditing or statistical sampling using our current auditing procedures is prohibitive.
    We need to recognize that even without the advent of BC/DLT our current auditing
    practice needs to change to adequately address the new and existing risks to operational
    and financial reporting.
  prefs: []
  type: TYPE_NORMAL
- en: The current methodology and frameworks (i.e., COSO) undergirding auditing are
    sound and sustainable, but the current audit practice methods are woefully inadequate!
    Progress is being made in areas such as population monitoring with automated analytics
    however the adoption rate is ever so slow. This slow adoption rate of automation
    in auditing and reporting is not just the result of technical challenges, but
    rather it reflects cultural resistance to change because of the profitable infrastructures
    which supports the current auditing profession. Auditing fees are often billed
    based on “bodies and hours” discouraging the use of automation by firms. Complex
    manual sampling methodologies and practice guidelines are entrenched and encourage
    antiquated manual auditing methods. Regulators and standard setters do not adequately
    encourage automated audit practices, holding auditing firms accountable only for
    the predominately manual processes they have adopted. The technology of analytics
    and automation has been around for decades and their adoption in re-defining operational
    and marketing processes has been rapid. Financial services, internet retail, social
    media advertising and others have embraced structured and unstructured data analytics
    rapidly while auditing and financial reporting have lagged in leveraging these
    methods and tools.
  prefs: []
  type: TYPE_NORMAL
- en: There are many reasons why auditing procedures should become automated and rely
    less on manual techniques. In today’s increasingly fast paced business environment
    the concept of an annual (vs. continuous) audit seems increasingly inadequate.
    Finding a serious internal control deficiency in December which occurred back
    in January of the current year is often far too late to provide adequate assurance
    on the effectiveness of internal controls to the organization. The damage to the
    organization may be significant and the effort to investigate and remediate will
    be expensive.
  prefs: []
  type: TYPE_NORMAL
- en: There is a severe limitation in obtaining audit assurance based on a small sample
    rather than auditing the population. The sampling methodology is used even in
    situations when fraud may exist and there may be attempts to conceal. Testing
    entire populations is often prohibitively expensive when done manually. However,
    the proper use of technology could make testing the population feasible. Undoubtedly,
    the level of assurance and precision will always be better in a population versus
    a statistical or non-statistical sample.
  prefs: []
  type: TYPE_NORMAL
- en: Most current internal control processes are based on the simple long standing
    “4 Eyes” or “segregation of duties” principles of auditing. These are effective
    control methodologies providing there is no collusion within the organization.
    The ACFE 2018 Fraud Report to the Nations based on some 2,700 actual fraud cases
    around the world shows that ∼49% of all frauds are collusive (i.e., perpetrated
    by two or more participants).[¹](#fn1) This is concerning that nearly half of
    identified actual frauds in 2018 override the “4 Eyes” based control environment!
    The only way in a central database environment to prevent the perpetration or
    concealment of fraud is to create a “perception of monitoring” using population-based
    continuous analytics. Unlike the “4-Eyes” based control environment represented
    in most central databases, most blockchain databases have 8, 10, 100, 1,000 or
    more eyes reviewing every transaction. When collusion is present, which represents
    almost 50% of actual frauds, the predominant control standard of “4-eyes” is inadequate
    to detect and prevent fraud and abuse.
  prefs: []
  type: TYPE_NORMAL
- en: There are many other hard and soft reasons audit and internal control processes
    need to change, one of the most compelling is the skills, interests, and motivations
    of the next generation of auditors and accountants. It is this millennial generation
    which is taking the reins from the current generation in designing and performing
    the audit of the future. These 20- and 30-year-olds are technologically savvy,
    they want to constantly explore and use new technologies, they want to be empowered
    and not just be directed in the workplace and they will choose employers based
    on the technology prowess and opportunities presented by organizations they join
    to start careers. According to a study by CompTIA, “three-quarters of millennials
    say technology usage by a company affects their employment decisions.”[²](#fn2)
    These employees are the future auditors, managers, directors and partners who
    will shape and define the auditing firms and practice in the future.
  prefs: []
  type: TYPE_NORMAL
- en: 12.2\. RISK MANAGEMENT AND INTERNAL CONTROLS FRAMEWORK
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Internal controls are just one part of the larger risk management process which
    helps a business identify and mitigate risks which endanger the achievement of
    clear business objectives and identify and leverage opportunities to help achieve
    those same objectives. The best practice frameworks for risk management defined
    below apply equally to organizations using BC/DLT networks or traditional central
    database networks.
  prefs: []
  type: TYPE_NORMAL
- en: Risk management is the term used to describe the overarching framework for assessing
    and managing threats to the objectives of an organization, providing a macroview
    of an organization’s risk universe. All organizations have constantly changing
    risks and opportunities and successful companies diligently manage them to assure
    they remain competitive. Risks and opportunities are always related to and should
    be determined in light of the organization’s objectives. These objectives should
    be clear, specific, measurable, and communicated effectively throughout the organization
    and outside of the organization so all stakeholders are clear about the mission
    of the organization. Firms which are unable to clearly articulate their mission
    and objectives will not be able to effectively manage risks within their organization
    or stay focused on clear organizational objectives.
  prefs: []
  type: TYPE_NORMAL
- en: As outlined in [Fig. 12.1](#fig1), all organizations have risks, the aggregate
    of all risks is often referred to as “Gross Risks,” encompassing the entire universe
    of risks within the organization which may adversely impact the achievement of
    the organization’s objectives. The managements’ internal control process is the
    first line of defense in helping the organization mitigate some of their risks.
    This internal control process may include controls implemented as a result of
    regulation such as compliance with Sarbanes–Oxley or other industry-specific regulatory
    compliance controls or due to internal entity controls defined by ISO, Levels
    of Authority or other company defined internal control frameworks. Often the COSO
    model serves as a bell weather framework for developing a comprehensive internal
    control process.
  prefs: []
  type: TYPE_NORMAL
- en: With a careful, comprehensive and successful implementation of an internal controls
    framework the entity is now left with “Net Risks.” These include risks that are
    not covered by the internal control process, but still may represent a material
    risks to the achievement of the entities’ objectives. These may include more macrotype
    risks such as megatrends in the marketplace, competitive activities, resource
    constraints, major initiative/project failures, loss of key personnel, etc. Often
    the potential value loss to the entity from these types of risks may be much more
    significant than from the risks traditionally covered by the internal control
    process. These net risks are best addressed by a comprehensive, sustained Enterprise
    Risk Management (ERM) process. The ERM process constantly monitors the net risks
    of the organization, scores them based on their respective impact and likelihood
    and weighs the risks based on their potential to disrupt the achievement of key
    business objectives. The risk management team then develops/implements specific
    response measures to appropriately mitigate these risks.
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.1:    Risk and Internal Controls.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: In addressing net risk with enterprise risk management (ERM), organizations
    often find gaps in the internal control process which can be remedied through
    updates or changes to controls. Response strategies for enterprise risks identified
    by the ERM process are often mitigated by avoiding or reducing the risk through
    implementing additional internal controls, transferring the risk by leveraging
    some type of insurance or sometimes by just accepting the risk and continuing
    to monitor it because the cost of active mitigation is just too high.
  prefs: []
  type: TYPE_NORMAL
- en: 12.2.1 Risks and Internal Controls
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: A common misconception is that risks, internal controls and audits are only
    needed as they relate to financial business processes – making sure nobody is
    “cooking the books.” However, as we will see below the most impactful risks to
    most organizations are not from a failure of internal controls over financial
    reporting (ICFR) or a financial process failure, but rather from strategic and
    operational risks which are not appropriately identified and mitigated that can
    put any entity out of business quickly. Companies such as Kodak had sound financial
    internal controls processes and operational management prowess. At its peak, Kodak
    captured 90% of the US film market and was one of the world’s most valuable brands
    – they invented the first digital camera in 1975\. However, Kodak failed to accurately
    anticipate the cadence and market impact of digital films’ dominance, resulting
    in Kodak declaring bankruptcy in 2012.[³](#fn3) There are countless other examples
    of organizations that failed to effectively and consistently manage risks and
    opportunities across their entire business spectrum, resulting in similar fates.
  prefs: []
  type: TYPE_NORMAL
- en: 'Risk management, internal controls and ERM are not limited to financial risks
    and processes, but should include all the activities and processes impacting the
    business including: strategic, operations, financial and regulatory compliance
    components. The number of categories or the category names may vary, but everything
    the organization does internally and all external influences on the organization
    should fit into one of these categories. A comprehensive ERM or internal control
    assessment should address all of these key business processes and define mitigation
    strategies and control to effectively manage risks and leverage opportunities
    in all these areas.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Fig. 12.2](#fig2) provides an example of business processes that may fit into
    one or more of these categories. There should be no critical functions missing
    from these lists for which the company is not evaluating the need for controls
    and ERM reviews. If a significant business activity/process is identified which
    is outside of these four categories it should be appropriately added and managed
    to assure that risks are evaluated across all key business processes.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.2:    Key Processes and Activities Impacting Organizations.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG2.jpg)'
  prefs: []
  type: TYPE_IMG
- en: In support of the contention above that risk management should cover the universe
    of risks for an organization, the study in [Fig. 12.3](#fig3) from the Corporate
    Executive Board shows that the greatest potential value loss for most companies
    comes from operational and strategic risks and not from financial or compliance
    risks as is often assumed. Market changes, competitive activities, product obsolescence,
    senior management changes, poor forecasting, etc., often represent a much greater
    potential reputational, earnings or growth risks to most companies than financial
    reporting errors or omissions.
  prefs: []
  type: TYPE_NORMAL
- en: This study shows that over 75% of the potential value loss of an entity is often
    in strategic and operational processes/activities. It is critical that controls
    and ERM are not limited by addressing only financial or compliance risks and opportunities.
    Often employees in an organization who work on internal controls and ERM development
    and management are from the finance department where the primary focus is financial
    risks and controls
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.3:    Value Loss by Key Organization Processes.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG3.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: Adapted from Corporate Executive Board Co.'
  prefs: []
  type: TYPE_NORMAL
- en: 12.2.2\. COSO Framework – Template for Internal Controls
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The Committee of Sponsoring Organizations of the Treadway Commission (COSO)
    is a joint initiative of five private sector standard setting organizations including
    the AICPA, IMA, AAA, FEI and the IIA – providing a comprehensive widely adopted
    framework for defining and managing internal controls within the risk management
    process. COSO provides a consensus of strategic and tactical thought leadership
    through the development of frameworks and guidance on ERM, internal controls and
    fraud deterrence.
  prefs: []
  type: TYPE_NORMAL
- en: The “COSO Cube,” as it is commonly referred to, provides a good summary of the
    COSO framework. The top of the cube outlines the key business process areas where
    there are risks and where controls are needed to mitigate them as we discussed
    above. The right side of the cube outlines the need to ensure the risk management
    process and control environment cover all levels of the business from the headquarters
    to the most remote entities. The front panel of the COSO cube represents the risk
    management process and activities that need to be in place to ensure the appropriate
    identification and mitigation of risks in the organization ([Fig. 12.4](#fig4)).
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.4:    COSO Cube.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG4.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: [AICPA.org](http://AICPA.org), used with permission.'
  prefs: []
  type: TYPE_NORMAL
- en: Leveraging the COSO framework should be adequate to cover new processes and
    risks within the blockchain and distributed ledger environment. The risks, processes
    and participants may be different, but the need for a comprehensive, sound framework
    for evaluating distributed ledgers should be evaluated using the COSO cube.
  prefs: []
  type: TYPE_NORMAL
- en: 12.2.3 Financial Controls Identification “Top-Down” Approach
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The “top-down” approach used to identify risks and internal controls for financial
    audits was developed from the COSO framework and is the traditional methodology
    used for most financial auditing to identify the risk points and key controls
    over financial reporting.
  prefs: []
  type: TYPE_NORMAL
- en: Risks are identified against clear business objectives and significant accounts
    are identified for audit review based on dollar value or activity thresholds.
    Management assertions such as completeness, accuracy, cut-off, etc., are applied
    to form a theoretical basis from which external auditors develop a set of audit
    procedures, controls and control activities. Then the key processes and systems
    supporting the significant accounts are identified and the auditing question “what
    can go wrong?” is poised to help identify key risks and mitigating controls for
    the respective processes and systems. These controls over financial reporting
    are then designed and implemented in ways that help assure they will effectively
    mitigate risks to the organization’s financial reporting ([Fig. 12.5](#fig5)).
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.5:    Top Down Approach to Internal Controls Development.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG5.jpg)'
  prefs: []
  type: TYPE_IMG
- en: In the annual or ongoing financial audit process controls are reviewed to make
    sure they are properly designed and are operating effectively to mitigate risks
    to the financial reporting of the organization. This control methodology must
    be constantly reviewed as material changes within the organization or in the scope
    of the financial reporting processes may result in a design or operating effectiveness
    failure of a key control – endangering the financial reporting process and the
    entities financial statements.
  prefs: []
  type: TYPE_NORMAL
- en: 12.2.4\. Management Assertions
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Management assertions are claims made by management regarding certain aspects
    of the organization, most often related to financial reporting.[⁴](#fn4) As outlined
    above in the “Top-Down” risk assessment description, assertions are a concept
    primarily used in developing and auditing a risk-based financial audit process.
    Management assertions while referring to financial type controls, could sometimes
    be applied to other controls as well. A study by the Wall Street Blockchain Alliance
    evaluating management assertions on traditional central database processes and
    BC/DLT found that for most common management assertions, BC/DLT networks have
    much stronger assertions inherent in their design. [Table 12.1](#tab1) outlines
    the most common assertions applied to ICFR. Note how much stronger some key assertions
    will be when applied to a blockchain or distributed ledger network or process.
  prefs: []
  type: TYPE_NORMAL
- en: '**Table 12.1:     Impact of Blockchain on Audit Assertions.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-TAB1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: When considering the design and operation of public or private blockchain or
    distributed networks covered in earlier chapters, it seems reasonable that assertions
    such as completeness, occurrence, accuracy and cut-off would have a much higher
    level of assertion strength and precision on an immutable, distributed network
    secured by consensus and cryptology. Other assertions such as valuation would
    not inherently be more robust due to the structure of a blockchain.
  prefs: []
  type: TYPE_NORMAL
- en: 12.3\. TYPES AND ASSESSMENTS OF INTERNAL CONTROLS
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Internal controls exist across the four key business process vectors outlined
    above, including strategic, operational, compliance and financial controls. The
    greatest emphasis is often put on ICFR, however the other business control areas
    as demonstrated above often represent a much greater risk to the objectives of
    an organization than ICFR controls. Generally, internal controls in any organization
    or those governing business processes can be broken down two broad categories.
  prefs: []
  type: TYPE_NORMAL
- en: Entity level controls.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Transaction or business process level controls.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Entity level or company level controls are the overarching internal controls
    which reflect the tone and directives of management. These help ensure that management
    is functioning the way it should. That is, the top management is committed to
    managing the company in a manner consistent with the law, the company policies
    and the business conduct guidelines to help assure the achievement of clear business
    entity objectives. Examples of entity level controls include:'
  prefs: []
  type: TYPE_NORMAL
- en: Controls over the company’s risk management and internal audit functions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Centralized processing and company level controls over corporate shared service
    environments.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Controls to monitor results of operations.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Controls over financial and tax reporting.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internal audit.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Whistle-blower hotline.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IT environment and organizations.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Oversight by the Board of Senior Management.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Transaction or Business Process Level Controls are the more granular level controls
    which may be specific to a part of the business or business process. These are
    generally more specific, automatable and have clear testing or sampling methodologies.
    Examples of transaction level controls may include controls to assure key business
    processes such as payment, billing or payroll are operating as desired. Transaction
    level controls ensure specific controls are operating effectively in a business
    process, such as assuring that there are no duplicate invoices in the payment
    process (via a duplicate invoice analytic check) or that only authorized employees
    are being issued pay checks (by comparing the payroll register against a current
    employee listing). Transaction level controls are generally more formal and easier
    to automate with analytics than entity level controls because transaction level
    controls are generally more specific.
  prefs: []
  type: TYPE_NORMAL
- en: It is important in any control environment that both of these broad control
    types are leveraged to help mitigate the risk of fraud and misappropriation at
    all levels of the organization. Public and private distributed ledgers also need
    to assure macro and microlevels controls are in place to mitigate the very different
    control environment this new technology demands – we will be having more discussion
    on this below.
  prefs: []
  type: TYPE_NORMAL
- en: 12.3.1\. Assessment of Internal Controls
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The review or assessment method of controls should be commensurate with the
    risk the control is mitigating. Controls over lower risk processes or for secondary
    controls may involve a simple review or observation of the process. The acceptable
    assessment process for primary or key controls with an appropriate level of risk
    is the test of design (TOD) and test of effectiveness (TOE). These tests assure
    that the control is properly designed and operating effectively to provide reasonable
    assurance, that the identified risks are appropriately mitigated and the outstanding
    risks do not cause harm or jeopardize the achievement of the organizations objectives.
  prefs: []
  type: TYPE_NORMAL
- en: The TOD is generally an annual review of the internal control system performed
    manually by an expert (i.e., external/internal auditors, internal control experts
    in management, etc.). The efficacy of controls should also be reviewed after any
    material process change or when processes are introduced or deleted. The latter
    required review process is often overlooked as engineers and process owners are
    those making the changes and are not focused on the impact of the change on the
    control environment.
  prefs: []
  type: TYPE_NORMAL
- en: Another important control design issue is the emerging audit approach called
    “Process Mining.” In process mining, the system logs are reviewed/monitored with
    continuous analytics to assure that controls designed around the defined formal
    process are actually working and have not been subverted. Often times, employees,
    customer and vendors may substitute an informal process in lieu of the defined
    process because of cost and convenience. Process mining should also be part of
    the design review if possible.
  prefs: []
  type: TYPE_NORMAL
- en: The TOE is the testing of the control, preferably on a continuous basis to assure
    that a properly designed control has been operating effectively over the entire
    period under consideration. The TOD is often assessed in current audit practice
    on a periodic bases (i.e., annually) and with a statistical or non-statistical
    sample. This sample-based manual approach is often inadequate in ensuring the
    effectiveness of controls over an extended time. If a control is deemed to not
    be designed effectively (TOD) then the auditor should not proceed with a test
    of the effectiveness (TOE) and a control deficiency should be reported. The TOE
    provides the greatest opportunity for improving the efficiency and control precision
    of an internal control using continuous auditing or monitoring analytics. The
    tools and technology to perform continuous automated tests of effectiveness are
    available and need to be more widely adopted by all auditors.
  prefs: []
  type: TYPE_NORMAL
- en: The methodology of using TOD and TOE in the assessments of controls can and
    should be appropriately applied to auditing blockchains and distributed ledgers.
    However the TOE must, by the very nature of blockchain, be a continuous automated
    assessment process leveraging population-based analytics. The automated, cryptographical,
    secured structure of a blockchain demands that the controls/control activities
    providing assurance on the blockchain align with the unique structure of a distributed
    ledger and are automated like the blockchain. This concept will be discussed in
    greater detail in the following sections.
  prefs: []
  type: TYPE_NORMAL
- en: 12.3.2\. Information Technology Controls
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Undergirding the control environment for all business processes is the integrity
    and security of the underlying information systems applications and processes
    supporting the business. In modern business, most key business processes rely
    on key automated application systems for producing/delivering products and services
    and providing the required accounting, financial reporting and auditing assurance
    for these business processes. Examples of these information systems include, Enterprise
    Resource Planning systems such as SAP, Customer Resource Planning, such as “Sales
    Force,” Financial Systems for Purchase to Pay, Order to Cash, etc. These often-complex
    information systems need to be audited in order to assure transactions and outputs
    from these systems are appropriately accredited and can be relied on by key stakeholders.
    This is why it is critical to establish the integrity of the key systems supporting
    the business processes of the organization. Information technology (IT) controls
    provide needed assurance on the integrity of the information systems supporting
    the key business processes. These IT controls can be broken down into several
    categories as outlined in [Fig. 12.6](#fig6).
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.6:    The Overall IT Controls Approach.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG6.jpg)'
  prefs: []
  type: TYPE_IMG
- en: These IT controls are broken down into the two broad categories we discussed
    above for all controls, the “Corporate” or Entity Level controls and the “Application”
    or Transaction Level controls. The core IT control categories are the IT general
    and application controls which form the basis for most System Audits of IT applications,
    System and Organization Controls (SOC) reporting under the SSAE-18 performed by
    CPA firms, ISO 27001 a prominent security standard for IT and other respected
    IT control standards. Section 404 of Sarbanes–Oxley Act signed by President G.
    W. Bush in 2002 deals with the effective assessment of ICFR and specifically emphasis
    the importance of sound IT controls – which if not designed properly or not operating
    effectively can result in a significant deficiency or even a material weakness
    for the entity being audited. Germane to the importance of sound IT controls at
    all levels is the underlying principle that if the information or application
    of any type is processed on is not secure, accurate and complete then there is
    no basis for reliance on any information emanating from that system.
  prefs: []
  type: TYPE_NORMAL
- en: The IT internal control categories and the common auditing methodologies for
    providing assurance on IT processes and systems are universal and can be effectively
    adapted for blockchains – albeit the risks and controls will be different. What
    must change is the often manual legacy audit practice/programs used by external
    audit firms and internal audit staffs that fail to leverage automated analytics
    and population-based continuous monitoring. Blockchains and distributed ledgers,
    by their very nature, are automated information systems secured by automated cryptology.
    As outlined earlier in this chapter, the concept of using periodic sample-based
    auditing procedures on large central or distributed databases is “woefully inadequate”
    in delivering an appropriate level of control assurance to mitigate the risks
    of fraud and abuse.
  prefs: []
  type: TYPE_NORMAL
- en: 12.4\. AUDITING BLOCKCHAINS/DISTRIBUTED NETWORKS
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The traditional methodology and approach for developing risk-based internal
    controls and auditing outlined above is applicable to providing assurance on blockchains
    and distributed ledgers. An objective centric, risk-based and top-down approach
    to identify and review the internal controls on distributed ledgers is certainly
    appropriate, however, the methods and practice of providing assurance on distributed
    ledgers needs to leverage a very different approach and toolset. Blockchains represent
    a very different architecture from traditional central database structures, with
    a new set of capabilities and risks which result in a very different internal
    controls environment.
  prefs: []
  type: TYPE_NORMAL
- en: 'The pros and cons of auditing a blockchain versus a traditional central database
    system are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Pros*:'
  prefs: []
  type: TYPE_NORMAL
- en: Much higher level of control precision and formalization.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security and sustainability via distributed ledgers – no single point of failure.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fully automated and integrated ecosystem secured by cryptography.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consensus helps prevent simple collusion – instead of “4 eyes” – 8, 100 and
    1,000 eyes!
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Cons*:'
  prefs: []
  type: TYPE_NORMAL
- en: BC/DLT is new and still suspect.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Objectives, risks and controls are very different from central database processes.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Limited technical expertise/experience in audit and IT around blockchains.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The automated nature of a blockchain facilitates the use of analytics and formalized
    automated controls. Consider that the protocol code in a blockchain network is
    a set of automated preventive analytics which review/approve every block of transaction
    before any information is even submitted to the ledger. A blockchain ledger is
    much more secure than a central database due to cryptography, decentralization
    and the consensus mechanism which assures more than a common “4-eyes” review of
    every transaction. For example, most public or private blockchain have 8, 100,
    1,000 or more eyes reviewing every transaction. A blockchain or distributed computer
    generally has no data center, central computer or single point of system failure.
  prefs: []
  type: TYPE_NORMAL
- en: The challenges of auditing blockchains and distributive ledgers mostly revolve
    around this being a new emerging technology. Auditors have limited experience
    and traction performing to scale in enterprise applications. As we will discuss
    later, objectives, risks, controls and assertions are very different for blockchains
    as compared to central database applications. There is also a limited pool of
    knowledgeable technical experts who understand distributed ledgers and the control
    assurance processes which need to be in place to monitor them. None of these constraints
    on the adoption and development of blockchains are insurmountable, but it will
    take time to work out the kinks and develop sustainable internal control and audit
    processes for blockchains and distributed ledgers.
  prefs: []
  type: TYPE_NORMAL
- en: 12.4.1\. Securing a Blockchain
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: As discussed above, BC/DLT, by design, are much different than traditional central
    databases. Blockchains are significantly more secure than traditional central
    databases as a result of protocol analytics, consensus mechanism, cryptology and
    the distributed nature of the ledger. However, there are new risks, assertions
    and controls that must be applied to auditing blockchain networks. BC/DLT networks
    are often open source with no clear owner or central authority (i.e., public blockchains)
    or the participants/nodes are cross organizational representing more than one
    sovereign organization (i.e., private blockchains). This section will distinguish
    between the control implications of public and private blockchains. We will focus
    primarily on the optimal approach to the system audit with the implication that
    if the blockchain cannot be trusted, then neither can the information emanating
    from it.
  prefs: []
  type: TYPE_NORMAL
- en: Public or non-permissioned blockchains represent the most prevalent application
    of distributed ledgers. Bitcoin, Ethereum, Litecoin, etc., are examples of public
    or non-permissioned BC/DLT networks. Almost anyone can join and participate in
    a public network. Many public blockchains such as Bitcoin are large international
    networks with millions of participants transacting with cryptocurrency primarily
    for investing or other financial services applications. Auditing a large, public,
    worldwide distributed network is a daunting task for any auditor or audit firm
    – it is a bit like “auditing the internet”! However, when material transactions
    by an individual or entity are being performed on a public blockchain that network
    needs to be reviewed and accredited to rely on the information transacting and
    used for financial reporting off that network.
  prefs: []
  type: TYPE_NORMAL
- en: Private or permissioned blockchains are a newer entrant into the BC/DLT network
    world. These generally represent smaller earlier stage applications with use-cases
    and some large projects being developed in the areas of supply chain management,
    insurance, food safety as well as financial services. Private blockchains are
    generally much smaller than the large public chains. In private blockchains the
    participants must be invited or permissioned onto the chain and private chains
    may even be dedicated to transacting just within one company. For example, private
    blockchains can be used in a large multinational company for consolidation of
    division reporting. Performing a system audit on a private BC/DLT network may
    be more efficient on a large public network. This is because a private or permissioned
    blockchain has only invited and trusted participants. Complexities may exist if
    the private chain is comprised of multiple entities and jurisdictions or of competitive
    participants. In those instances, there could be additional issues such as which
    party is responsible for maintaining the blockchain and who will bear the costs
    of auditing the network, etc.
  prefs: []
  type: TYPE_NORMAL
- en: 12.4.2\. Risks and Limitations
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Let’s discuss below some of key limitations of developing internal controls
    and auditing processes, systems or transactions on BC/DLT networks. As discussed
    above, the current risk management and internal controls framework suggested by
    COSO for developing internal controls and auditing unconventional databases is
    sound and is applicable to blockchain technology, however, the detailed implementation
    and internal control BC/DLT networks are completely different and must be changed.
  prefs: []
  type: TYPE_NORMAL
- en: One important consideration in defining an approach to auditing and internal
    control design for BC/DLT network is that blockchain networks often have incomplete
    or a limited amount of data needed to perform an audit of a complete process or
    for an end-to-end transactions. Blockchains by design carry a limited amount of
    information in the database to prevent the network from “bloating” (getting too
    large to efficiently be sent out to all nodes on the blockchain) as the network
    grows. Remember, blockchains are generally not archived and must keep and distribute
    all of the information on the chain from the first or “genesis” block to the current
    block. A blockchain record may only have a few fields such as a public key, a
    number of units, a date stamp, etc., lacking any valuation, link to source documents
    and other critical information needed to evaluate internal controls and perform
    a comprehensive audit.
  prefs: []
  type: TYPE_NORMAL
- en: 12.4.3\. Netting of Transactions and Control Implications
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Blockchain networks transacting with cryptocurrencies on public blockchains
    have a unique issue evaluating or auditing transactions because even with appropriate
    access, the blockchain often provides an incomplete picture of the transactions
    related to an individual or entity. This results from cryptocurrency Exchanges
    and Wallets “netting” intraexchange transactions and never submitting them to
    the blockchain. For example, if cryptocurrency trader “A” on exchange “X” transfers
    5 Bitcoin to cryptocurrency trader “B” also on exchange “X,” this transaction
    may never be submitted to the Bitcoin blockchain because exchange “X” will just
    net the transactions between the two clients. This common practice, known as “off-chain”
    transactions, allows cryptocurrency Exchanges to save time effort and money by
    not submitting intraexchange transactions to the blockchain. Transactions are
    only submitted to the respective blockchain network if they are interexchange
    transactions or initial purchases of the cryptocurrency – these are referred to
    as “on-chain” transactions. The implication for internal controls and auditing
    is that the control environment and auditing approach for cryptocurrencies must
    address the entire blockchain ecosystem and not just the blockchain itself to
    ensure a comprehensive control review or audit. An approach for a system audit
    or any audit involving cryptocurrencies must be able to identify all transactions
    across all stakeholder in the cryptocurrency ecosystem and including exchanges,
    wallets, over-the-counter traders, banks and other third parties to ensure a complete
    picture of the processes and transactions.
  prefs: []
  type: TYPE_NORMAL
- en: This phenomenon is illustrated in [Fig. 12.7](#fig7). The data is from a CoinDesk
    2019 “Research Blast” that shows how pronounced this has become in recent years.
    With an increase in the level of activity in the world of cryptocurrency trading,
    the ratio of “off-chain” transactions is also growing. The chart shows “On–Off
    Ratio” over time, representing the volumes of transactions which are recoded “on-chain”
    as part of what are often private transactions outside of the exchanges and those
    “off-chain” which are cryptocurrency transactions made only within an exchange
    between participants.
  prefs: []
  type: TYPE_NORMAL
- en: 'Observing the two key metrics from each category: On-Chain volume and Off-Chain
    volume (Exchange Volume), the study measures the ratio between those values from
    December 2013 to December 2018\. This simple metric is called the On–Off Ratio.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.7:    On/Off Chain Ratio.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG7.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: CoinDesks “Research Blast”: 1/11/2019 (p. 2). [https://mail.google.com/mail/ca/u/0/#inbox/FMfcgxwBVDFGBNSTPnWSkxFGzczhPVkB](https://mail.google.com/mail/ca/u/0/#inbox/FMfcgxwBVDFGBNSTPnWSkxFGzczhPVkB)'
  prefs: []
  type: TYPE_NORMAL
- en: The graph depicts how many dollars moved on the blockchain for every dollar
    moved on exchanges over the study period. A ratio of greater than 1 would indicate
    higher On-Chain volume relative to exchange. A ratio of less than one would indicate
    that intraexchange transactions far exceeds interexchange transactions. This implies
    that for most transactions between individuals there is no record on public blockchain
    as both parties belonged to the same exchange. The “On–Off Ratio” is used to evaluate
    how much of the transaction volume of a cryptocurrency is not reflected on the
    network securing that currency – these “Off-Chain” transactions are not protected
    by and documented by the BC/DLT network representing a particular asset. For much
    of Bitcoins history, we see the ratio indicating that there was always more “On-Chain”
    volume occurring than exchange volume. This was the case up until the dawn of
    Q1 2018 when the trend flipped. Ever since, the average has been 0.94 with a standard
    deviation of 0.31\. The implications of this phenomenon/trend is that auditors
    evaluating cryptocurrency have an increasingly difficult task auditing end-to-end
    transactions, due to incomplete data, missing transactions on the blockchain,
    the integrity of “Off-Chain” transactions and even the possibility of data/value
    loss if an Exchange fails.
  prefs: []
  type: TYPE_NORMAL
- en: 12.4.4\. Addressing the Broader BC/DLT Ecosystem
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Given the above limitations of auditing blockchains as a separate entity, it
    quickly becomes apparent that a comprehensive financial reporting or auditing
    of any blockchain or distributed ledger network needs to encompass the broader
    ecosystem in the audit scope to capture the end-to-end processes and transactions.
    An innovative approach to accomplish this has been developed by a rapidly growing
    Financial Technology companies such as Lukka Tech. Lukka provides middle and back
    office financial and tax reporting for funds, fund managers, over the counter
    (OTC) desks and others transacting in cryptocurrencies. As outlined above, blockchains
    have a limited amount of data and do not provide complete transactions for cryptocurrencies
    because of the netting or “off-chain” transactions on most of the major exchanges.
  prefs: []
  type: TYPE_NORMAL
- en: Lukka’s approach detailed in the next section, extracts append only cryptocurrency
    transactions for a client using proprietary application programing interfaces
    (API’s) to extract data into an accredited (via “SOC” review) secure “System of
    Record” managed on a secure cloud database. The data is ingested for the client
    from the entire blockchain ecosystem including all the major blockchains, exchanges,
    wallets, banks, OTC desks, miner pools, etc., assuring that all client transactions
    are captured and integrated into an accredited system of record. The data is then
    normalized and enriched with pricing, valuation, positions, etc., information
    and provided back to the client in formats appropriate for financial or tax reporting.
  prefs: []
  type: TYPE_NORMAL
- en: 'Lukka in research collaboration with universities, accounting firms and others
    is exploring ways to extract infrastructure data about the blockchains into its
    current secure system of record database. Thereby clients or auditors can run
    continuous automated control analytics with a versatile “analytics engine” to
    monitor risk-based blockchain system audit controls in the following three key
    areas of its audit framework:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Protocol accreditation* – to ensure the protocol analytics are secure, complete
    and appropriate for this blockchain use-case/application.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Consensus mechanism* – to test whether the public or private blockchains are
    conforming to their agreed upon consensus mechanism.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Transactions and smart contracts* – to verify whether transaction combinations
    and ubiquitous smart contract controls are in place to mitigate the risks of manipulation
    and smart contract hacks.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lukka currently has an inventory of about 75 blockchain-specific controls across
    the above three risk categories which it has open-sourced to glean additional
    input from clients, accounting firms, academic researchers and other thought leaders
    in the space to help further the development of automated system audits for blockchain
    networks.
  prefs: []
  type: TYPE_NORMAL
- en: 12.4.5\. Distributed Audit for Distributed Ledger
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: An alternative approach to performing a comprehensive system audit on blockchain
    or distributed ledger networks is to establish a read only audit node on a public
    or private blockchain. The audit node could act as a detective control and continuously
    monitor, with automated analytics, the features of the blockchain when each and
    every transaction is executed through the blockchain. This assures that the audit
    program (or smart contract) is appropriately approved by the consensus mechanism
    of the network and allows for pre-transaction preventive controls reviews of the
    network. Alerts could be provided by the network that would prevent transactions
    or code (i.e., smart contracts) from executing on the blockchain network. With
    the “system of record” approach to providing a system audit of a blockchain outlined
    above, the controls are always providing only detective or post-transaction assurance
    on the network. By establishing a secure, read only audit node on the network
    we can extend the inherent security and immutability of the blockchain to the
    smart contract enabled audit program – assuring no one can tamper with or change
    the consensus mechanism or analytics in the smart contract.
  prefs: []
  type: TYPE_NORMAL
- en: 'While this distributed approach is promising and may ultimately be the way
    to perform internal control reviews and audit blockchains and distributed ledger
    networks in the future it still has to overcome several challenges including:'
  prefs: []
  type: TYPE_NORMAL
- en: Sparse amount of data on any given blockchain needed to perform end-to-end process
    or transaction controls reviews and audits. As noted earlier, data input in blockchain
    does not contain many fields you would need to conduct a comprehensive audit –
    this is by design to prevent it from getting “bloated,” that is becoming too big
    to efficiently distribute.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Not all of the cryptocurrency transactions are reported on blockchain – preventing
    an end-to-end process or transaction audit – refer to the previous discussion
    on “Off-line” transactions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The technology is still developing and currently there are only a limited number
    of blockchain protocols which can manage and process smart contracts – especially
    of the complexity needed to perform a full population-based audit of all transactions
    on blockchain network.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As discussed above smart contracts are themselves the greatest single control
    risk to blockchain networks.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the long-term, the distributed audit as a node approach to internal controls
    may well be the preferred solution as it is most consistent with the distributed
    decentralized design of this emerging technology. Currently, however, there are
    technology constraints, implying the need for further maturation of smart contracts
    for a decentralized audit approach to really work. Hence there is an urgent need
    for an interim audit solution for blockchains and distributed ledger networks
    for individuals and entities which need internal controls and audit reviews that
    can be executed and implemented presently.
  prefs: []
  type: TYPE_NORMAL
- en: 12.5\. SYSTEM AUDIT FOR BLOCKCHAIN
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: We now explore in greater detail the specific internal controls and audit approach
    for a systems audit conducted on a blockchain. As outlined above, the system audit
    controls are the first priority audit before testing financial, strategic, operational
    or compliance controls related to a business processes – one must assure at the
    outset that the underlying information systems are secure and accredited before
    testing controls transacting on these systems. This section will explore how traditional
    IT general controls in a system audit align with the risks and controls needed
    to audit a blockchain or distributed ledger.[⁵](#fn5)
  prefs: []
  type: TYPE_NORMAL
- en: 12.5.1\. Traditional System Audit Controls Applied to Blockchain
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[Fig. 12.8](#fig8) identifies common categories of IT general controls used
    in a system audit of any central database system. We apply these to blockchain
    systems to see how closely they map. These include standard IT general controls
    across categories such as access security, change management, computer operations,
    archiving, etc. Interestingly, only a few of the traditional IT general control
    categories apply to blockchains or distributed ledgers.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.8:    Traditional System Audit Controls Applied to Blockchain.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG8.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The native structure and operation of a blockchain as outlined in earlier sections
    of this book is by design much more secure than a traditional central database
    business process. On a blockchain or distributed network, there is no central
    data center or computer operations. Blockchains, by definition, do not archive
    any part of the ledger. Change management is generally transparent/secured within
    the consensus mechanism. Moreover, there are no passwords or other form of access
    controls. Of the controls and categories of controls that apply to a traditional
    system audit, only a few directly apply to a system audit of a blockchain.
  prefs: []
  type: TYPE_NORMAL
- en: 12.5.2\. New Technology – New Risks
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Almost all traditional system audit controls do not apply to blockchains, there
    are however clearly new risks, assertions and controls introduced by the blockchain
    structure that need to be evaluated and addressed with new sets of internal controls.
    These new sets of risks and controls fit into the following three primary categories
    ([Fig. 12.9](#fig9)).
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.9:    Blockchain Audit Framework.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG9.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: Figure obtained with permission from Lukka Tech at [https://Lukka.tech](https://Lukka.tech).'
  prefs: []
  type: TYPE_NORMAL
- en: The key risk areas where controls are needed to include the Protocol Accreditation
    where we need controls which help assure the blockchain protocol code is secure,
    complete and designed appropriately for the respective blockchain use-case/application.
    Protocol code is the rules-based code that defines the governance of any blockchain.
    It is a set of preventive analytic controls which run on every transaction submitted
    within a block to the respective blockchain. The protocol code is open-source
    code on most public blockchains and is secured like transactions by the consensus
    mechanism of the network. In public and private blockchains the protocol code
    is first defined by the founders of the blockchain at its inception and is often
    just copied from other successful blockchains usually without a rigorous review
    of the risks or adjustments needed to address process differences between networks
    or the application of respected assurance standards (COSO, IIA, AICPA, NIST, COBIT,
    etc.). This represents a new key risk today for blockchains in that the protocol
    code which works for Bitcoin or some other successful network may not apply for
    another cryptocurrency network or for an entirely different blockchain application
    such as a supply chain or insurance use-cases.
  prefs: []
  type: TYPE_NORMAL
- en: The Bitcoin blockchain has really good protocol analytics which have never been
    hacked in over 10 years. It helps secure the Bitcoin network, but this does not
    imply it will be as successful for other blockchain applications. Developers of
    new blockchain networks who just copy protocol controls from Bitcoin or some other
    prominent network and apply them to a new blockchain application without regard
    for process or function differences, the required level of security and control,
    run the risk of deficiencies in the protocol protecting the network. The protocol
    code on any blockchain needs to be designed for the specific application of the
    network and be carefully accredited at inception and monitored on an ongoing basis
    to address proposed changes, errors, upgrades, etc., which may threaten to compromise
    the integrity of the network.
  prefs: []
  type: TYPE_NORMAL
- en: The consensus mechanism is another new risk area for blockchains. The consensus
    mechanism for a blockchain or distributed ledgers is simply the agreed method
    by which all transactions or changes will be reviewed and approved before being
    submitted to the blockchain ledger. This consensus mechanism is a key control
    area for any blockchain and may take many forms and leverage many types of consensus
    (i.e., proof of work, proof of stake, zero knowledge proof, etc.), but regardless
    of the agreed mechanism, it is only effective if it is designed appropriately
    for the processes supported by the ledger and it is operating effectively on the
    network.
  prefs: []
  type: TYPE_NORMAL
- en: Most public and private blockchains require the consensus approval of at least
    some simple majority (i.e., 51% or more) of the validators and generally include
    some type of analytics review and a proof of work or stake to confirm which miner
    submits the new version of the ledger to all nodes or participants on the network.
    The key risks here are around the blockchain network nodes or participants conforming
    to their agreed consensus mechanism. As an example, on a private blockchain the
    founders/participants may agree in their consensus mechanism that 75% of the active
    and valid participants must approve any transactions or changes impacting the
    network. Suppose it is a hot day in August and all but 25% of the network participants
    are away on vacation or off the network and a block of transactions needs to be
    submitted to the network? How will the network assure those minority of participants
    don’t just approve the transactions in violation of the consensus mechanism? Controls
    are needed to assure the network and its respective participants follow the consensus
    mechanism they have agreed to ensure the ongoing integrity of the blockchain.
  prefs: []
  type: TYPE_NORMAL
- en: Transactions and smart contracts represent the area with the greatest new potential
    risks for blockchains. These include transactions or unforeseen combinations of
    transactions submitted to the ledger from approved blocks, and those triggered
    by smart contract activity on the network. There may be certain transaction combinations
    which create unforeseen vulnerabilities or certain ubiquitous smart contract risks
    which may result in a vulnerability on a network (i.e., “Reentrancy” when a smart
    contract is triggered a second time prior to finishing the first trigger, resulting
    in some unanticipated anomaly) – examples are discussed below. Most of the recent
    hacks/compromises on BC/DLT’s have resulted from vulnerabilities within smart
    contracts. Smart contracts are just computer code validated by the consensus mechanism
    of the blockchain network. They perform certain predetermined actions based on
    trigger events on the network. As with any computer code there will always be
    unforeseen vulnerabilities and risks and all computer code must be constantly
    monitored to identify trigger events, process changes or anomalies which may compromise
    the code.
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.10:    Controls Inventory Examples – Public/Permissioned Blockchain.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: Figure obtained with permission from Lukka Tech at [https://Lukka.tech](https://Lukka.tech).'
  prefs: []
  type: TYPE_NORMAL
- en: '[Fig. 12.10](#fig10) provides examples of the types of controls which may be
    included in a blockchain system audit across the three key framework areas discussed
    above. Under the framework area of protocol accreditation, controls cover topics
    such as conformance to agreed upon parameters like max block/transaction size,
    allowable number/type of nodes, allowable assets, preventing “double spend” via
    checking the block history, etc. Under the consensus mechanism controls may include
    assuring the appropriate number of dynamic voting nodes are present to approve
    and submit transactions to the network, assuring validators/miners are approving
    only eligible blocks and only one vote per block, etc. Under the final risk area
    “Transaction Assurance and Smart Contract,” controls would ensure transactions
    or transaction combinations with multiple signature requirements (“Multisig”)
    have the appropriate number of signatures, assure transactions with location stamps
    are not from sanctioned jurisdictions, and assure that ubiquitous smart contract
    controls helping assure that hack and compromises to smart contracts are mitigated.'
  prefs: []
  type: TYPE_NORMAL
- en: '[Fig. 12.11](#fig11) is the snapshot of Lukka’s system audit control inventory.
    As mentioned earlier, Lukka currently has an inventory of about 75 blockchain-specific
    controls across the above three framework risk categories which it has open-sourced
    to further enrich the controls. This will help establish a baseline for a comprehensive,
    sustainable, automated system audit for blockchain networks. Note in the chart
    below, each proposed control is identified within one of the three system audit
    frameworks we discussed above. Each control’s objectives, risks and assertions
    are identified with a brief explanation of how the control applies to blockchains/distributed
    ledgers. A pseudocode analytic is then defined along with a closed loop escalated
    alerting process for each control. Finally, each proposed control is aligned as
    appropriate with respective IT and related standards.'
  prefs: []
  type: TYPE_NORMAL
- en: 12.5.3\. Risks in Smart Contracts
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Smart contracts pose the largest potential risk to the integrity of blockchain
    networks. Smart contracts are computer code validated by the consensus mechanism
    of the blockchain defining some predetermined action based on trigger events on
    the network. Hence, the risk of smart contracts emanate from the frailties of
    any computer code. Consider how often well written Applications “APPS” (which
    are just computer programs) have to be updated for bugs and performance issues
    on a regular basis. The “APPS” on your cell phone were written by very good programers
    from reputable firms, tested thoroughly and yet almost weekly most of them have
    some type of updates which need to be implemented to protect against security
    or performance issues.
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.11:    Sample Controls Inventory.**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG11.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: Figure obtained with permission from Lukka Tech at [https://Lukka.tech](https://Lukka.tech).'
  prefs: []
  type: TYPE_NORMAL
- en: 'All software code is subject to some type of ongoing risks resulting from vulnerabilities
    missed in design/acceptance testing, due to changes in the underlying processes
    the code supports or resulting from unforeseen programs interacting with other
    programs within the network. Even respected enterprise level code from top tier
    companies (i.e., Windows, Apple IOS, etc.) have regular patch updates to address
    these issues with their respective software. Inevitably, codes cannot be gotten
    right the first time and sustained to ensure its future fidelity. The underlying
    issues in some of the recent high-profile BC/DLT compromises include issues such
    as:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Reentrancy* – This occurs when a smart contract is triggered a second time
    prior to finishing the first trigger, resulting in some unanticipated anomaly.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Race conditions* – This occurs when two sound smart contracts, which run well
    independently, may malfunction when running concurrently. These create unforeseen
    vulnerabilities.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hence, there is a need for preventive/detective controls that might include
    restrictions or alerts addressing the issues above or on network transaction dominance
    by any one or group of nodes. For example, the blockchain founders/participants
    may want an alert when any one node is using more than X% of the network resources
    at any given time. Smart contracts generally command a fee or resources called
    “gas” to run on the network. Restrictions could be imposed on the amount of “gas”
    any smart contract can consume over some defined period. This would, for example,
    warn network participants that one or few nodes are consuming too much resource
    and may be perpetrating nefarious activity on the network. These are some examples
    of ubiquitous transaction or smart contract controls/analytics needed to assure
    the early detection of potential anomalies. Early detection, in the absence of
    prevention, can at least ensure that the impacts of these vulnerabilities are
    contained. With time and further development, these vulnerabilities can be mitigated
    on blockchains with population-based, continuous controls/analytics and closed
    loop escalated alerting.
  prefs: []
  type: TYPE_NORMAL
- en: 12.6\. CONTROLS FOR THE ENTIRE ECOSYSTEM
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Given the limitations outlined above of auditing just a blockchain or a group
    of blockchains, the following section outlines an approach for internal controls
    and auditing the entire blockchain ecosystem. This helps assure that internal
    controls are present for an end-to-end processes within the blockchain ecosystem.
    As discussed, blockchains have a limited amount of data for auditing and in the
    case of cryptocurrencies the transactions on the blockchain are often incomplete.
    A broader approach is needed to ensure the systems audit covers all the potential
    risks in the blockchain ecosystem.
  prefs: []
  type: TYPE_NORMAL
- en: 12.6.1\. The Blockchain Ecosystem
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The blockchain ecosystem includes the on and off ramps providing access to
    a particular blockchain. In addition to blockchains these may include:'
  prefs: []
  type: TYPE_NORMAL
- en: Exchanges which manage cryptoassets.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Wallets which store cryptoassets.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Miners or mining pool who earn cryptoassets in exchange for validation of the
    network.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OTC desks who facilitate private transaction.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Banks/financial institutions providing funds or currency conversions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Oracles providing secure third-party information to the blockchain.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With the exception of the blockchain most of the above members of the ecosystem
    are traditional central database systems. These processes also need to have proper
    and functioning internal controls as well as assurance reviews and audits.
  prefs: []
  type: TYPE_NORMAL
- en: 'It is challenging to identify end-to-end process controls and provide integrated
    assurance on this complex blockchain ecosystem. A blockchain or distributed ledger
    is often a “common” or “shared” resource of a larger decentralized ecosystem.
    On both public and private blockchains questions arise about ownership, boundaries
    and responsibilities within the distributed ecosystem and ledger. Some of the
    pervasive questions in a public blockchain include:'
  prefs: []
  type: TYPE_NORMAL
- en: Who owns the Bitcoin blockchain?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How would you audit it?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who pays for the audit?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If everybody pays, then how do you allocate the cost of auditing any public
    ledger?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In a private blockchain comprised of independent permissioned participants cooperating
    on an agreed business mission, questions will arise around who owns the blockchain,
    how is it most effectively audited, how are the auditing costs shared and many
    other related questions. Answering these questions and developing control/assurance
    process to address unique blockchain risks requires a level of collaboration beyond
    what might be needed in a central database environment.
  prefs: []
  type: TYPE_NORMAL
- en: Many public and private blockchain networks, accounting firms, standard setters,
    regulators and others are presently wrestling with these challenges. The present
    blockchain ecosystem requires integrated internal controls and assurance solutions.
    The existing internal control solutions and procedures are of limited usefulness
    for the blockchain ecosystem. New approaches are being developed to counter the
    new challenges, one such approach is presented next.
  prefs: []
  type: TYPE_NORMAL
- en: 12.6.2\. System of Record
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Lukka[⁶](#fn6) has developed an accredited “system of record” approach to address
    some of the limitations discussed above in the cryptocurrency and blockchain space.
    Lukka is in the process of improving the functionality of their platform to include
    an analytics engine. The analytics engine will enable them to perform automated,
    continuous operational and internal control reviews. By ingesting infrastructure
    information as well as transaction in the three blockchain risk areas we reviewed
    above (i.e., protocol, consensus mechanism and transactions/smart contracts),
    Lukka will be able, using automated analytics, to perform a system audit control
    review on the entire blockchain ecosystem for a specific client.
  prefs: []
  type: TYPE_NORMAL
- en: '[Fig. 12.12](#fig12) outlines an integrated “system of record” approach to
    internal controls monitoring and auditing on a blockchain and its respective ecosystem.
    Note that the entire ecosystem is providing information about activities related
    to the blockchain. The information captured from the various sources includes
    not just transactional data from a blockchain but also the infrastructure data
    discussed above, including protocol consensus mechanism and transaction combinations
    and smart contract input. This approach extracts “append only” (i.e., data can
    only be added and not changed or modified in any way) transactions with permissioned
    client meta data (i.e., keys, access codes, etc.) via open and proprietary API’s
    into an accredited “System of Record” secure cloud database.[⁷](#fn7) Data is
    ingested for the client from the entire blockchain ecosystem including all the
    major blockchains, exchanges, wallets, banks, OTC desks, miner pools, etc., assuring
    that all client transactions are captured and integrated into an accredited system
    of record. The data is then normalized and enriched with valuation, pricing, positions
    in LIFO, FIFO, etc., and provided back to the client for financial or tax reporting.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Fig. 12.12:    Auditing Blockchain Ecosystem as a “System of Record.”**'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](../images/C12-FIG12.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '*Source*: Figure obtained with permission from Lukka Tech at [https://Lukka.tech](https://Lukka.tech).'
  prefs: []
  type: TYPE_NORMAL
- en: 12.6.3\. Other Frameworks
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: There are other promising approaches to monitor internal controls and perform
    comprehensive system audits on blockchain or distributed ledger networks. We described
    above establishing a read only audit node on a public or private blockchain with
    the controls monitoring/audit executing as a smart contract within the blockchain.
    Variations on this include the idea of interblockchain nodes monitoring many different
    blockchains in a hub or from a parent blockchain node. These nodes could conceptually
    access via smart contracts and oracles other parts of the blockchain ecosystem
    to audit complete transactions and end-to-end processes. However, there needs
    to be a significant maturation in the adoption, security and sophistication of
    smart contracts on blockchains and distributed ledger for these approaches to
    be viable. In the interim, blockchains and their respective ecosystems need controls
    and system audit reviews now for material activity in the current year and beyond.
  prefs: []
  type: TYPE_NORMAL
- en: 12.7\. CONCLUSION AND OTHER CONSIDERATIONS
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In this chapter, we discussed inherent risks imposed by blockchain technology
    and how the internal control framework can be adapted to address those risks.
    Of course, since the technology is new, not all the potential risks are known
    or mitigated. This is an evolving area that will require much attention from accountants
    and auditors to prevent, detect and address flaws. For this technology to reach
    its fullest potential and be used in mainstream transactions, it is imperative
    that a comprehensive system of internal controls is developed.
  prefs: []
  type: TYPE_NORMAL
- en: The risks and controls needed to mitigate exposure on distributed networks are
    very different than those needed for central database systems. The system audit
    of the blockchain network is the first assurance priority, as it provides the
    basis for the accreditation of the transaction and structure of the blockchain
    – without this assurance any business or reporting process built upon the network
    is at risk. Blockchains by design carry a limited amount of transaction information
    and in the case of cryptocurrencies often incomplete transactions, requiring a
    review of internal controls/audit for the larger blockchain ecosystem (i.e., exchanges,
    wallets, other third parties, etc.).
  prefs: []
  type: TYPE_NORMAL
- en: In the popular press there is some speculation that blockchain will make auditing
    redundant or even obsolete. We disagree. Blockchains do need to be audited! Independent
    auditing/assurance of blockchains is needed now from both internal and external
    assurance providers on both public and private blockchains. Despite the inherent
    security of the blockchain, auditors will remain relevant. Leveraging automated
    auditing tools on the blockchains will free auditors and accountants to trade
    up to the more strategic, forensic aspects of the audit.
  prefs: []
  type: TYPE_NORMAL
- en: Blockchains will not remove auditors from assessing transactions, but they can
    transform the way auditors perform system and financial statement audits. The
    evidence that comes with blockchain will allow auditors to perform more analytics,
    leverage automation, artificial intelligence and machine-learning capabilities.
    If auditors embrace these technologies there is an opportunity to realize an exponential
    increase in the precisions and efficiency of the audit with a significant reduction
    in the financial reporting and auditing cycle.
  prefs: []
  type: TYPE_NORMAL
- en: How we best audit the blockchains and distributed ledgers in the future is emerging
    and is still being studied, however, it is sure to include the use of control
    analytics and continuous auditing/monitoring technology. Applications are currently
    being developed, both in academia and businesses. The approaches are based on
    prevalent risk frameworks of COSO, COBIT, NIST and others, which are also being
    constantly updated to address emerging risks and technologies. There of course
    are limitations in the current control/audit practice. For example, manual, periodic,
    non-statistical sampling methods, limited “4-eyes” reviews, etc., have limited
    ability to address the assurance needs of a dynamic, distributed, automated BC/DLT
    ecosystems. The tools, technology and methodologies are being developed to re-define
    audit practices to address blockchain and distributed ledgers.
  prefs: []
  type: TYPE_NORMAL
- en: NOTES
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[1.](#ifn1) ACFE 2018 “Fraud Report to the Nations” Association of Certified
    Fraud Examiners (p. 42). Available at [https://mail.google.com/mail/ca/u/0/#inbox/FMfcgxwBVDFGBNSTPnWSkxFGzczhPVkB](https://mail.google.com/mail/ca/u/0/#inbox/FMfcgxwBVDFGBNSTPnWSkxFGzczhPVkB)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2.](#ifn2) Comp TIA Article “New Comptia study offers insight into how millennials
    may change the workplace” Steven Ostrowski Comp TIANov. 4, 2015 Link = [https://www.comptia.org/about-us/newsroom/press-releases/2015/11/04/new-comptia-study-offers-insight-into-howmillennials-may-change-the-workplace](https://www.comptia.org/about-us/newsroom/press-releases/2015/11/04/new-comptia-study-offers-insight-into-howmillennials-may-change-the-workplace)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3.](#ifn3) Darn (2012)'
  prefs: []
  type: TYPE_NORMAL
- en: '[4.](#ifn4) Management Assertions in Auditing, Accounting Tools Nov. 2017 (p.
    1). Available at [https://www.accountingtools.com/articles/what-are-management-assertions-in-auditing.html](https://www.accountingtools.com/articles/what-are-management-assertions-in-auditing.html)'
  prefs: []
  type: TYPE_NORMAL
- en: '[5.](#ifn5) This work is based on cooperative research from Rutgers Universit’s
    Continuous Audit and Reporting Laboratory (CarLab) and Lukka Tech.'
  prefs: []
  type: TYPE_NORMAL
- en: '[6.](#ifn6) This section is based on product development by Lukka [https://lukka.tech/](https://lukka.tech/).
    Lukka builds middle and back office financial/tax reporting and auditing solutions
    for blockchains and their respective eco-systems. Lukka’s successful enterprise
    financial and tax reporting solution is being used by individuals and large entities
    transacting in cryptocurrencies around the world.'
  prefs: []
  type: TYPE_NORMAL
- en: '[7.](#ifn7) This approach is accredited by SOC1 and SOC2\. For definition of
    SOC, see AICPA – Website “Defines SOC”. Available at [https://www.aicpa.org/soc](https://www.aicpa.org/soc)'
  prefs: []
  type: TYPE_NORMAL
- en: CONTRIBUTOR CONTACT INFORMATION
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Gerard (Rod) Brennan is a principle of Ocean View Advisors LLC and an Educator/Researcher
    providing innovative Accounting and Audit Technology solutions. Rod can be reached
    at [rod.brennan@verizon.net](mailto:rod.brennan@verizon.net)
  prefs: []
  type: TYPE_NORMAL
