# 区块链论坛

© Springer Nature Switzerland AG 2021 J. González Enríquez 等人（eds.）商业流程管理：区块链与机器人流程自动化论坛  Lecture Notes in Business Information Processing 428 [`doi.org/10.1007/978-3-030-85867-4_5`](https://doi.org/10.1007/978-3-030-85867-4_5)

# 以太坊中基于智能合约的数据质量评估的实证研究

Marco Comuzzi^(1  )，Cinzia Cappiello^(2  ) 和 Giovanni Meroni^(2  )(1)韩国乌山国家科学技术院，乌山，韩国共和国(2)米兰理工大学，米兰，意大利 Marco Comuzzi (通讯作者)邮箱： mcomuzzi@unist.ac.krCinzia Cappiello 邮箱： cinzia.cappiello@polimi.itGiovanni Meroni 邮箱： giovanni.meroni@polimi.it

## 摘要

交易负载中携带的数据在基于智能合约的区块链系统中起着至关重要的作用。因此，区块链应配备控制其数据质量的机制。然而，实际上，这些机制目前尚缺失。尽管在我们的前期工作中已经提出了如何将数据质量控制作为智能合约来实现，但本文我们将重点放在它们执行开销（时间和成本）的评估上。评估这一开销对于理解在何种情况下，可以通过区块链系统承受控制交易负载数据质量的成本至关重要。我们在以太坊上实现了两个近似真实场景，覆盖了我们前期工作中定义的区块链中所有类型的数据质量控制，并为每个场景评估了时间和成本开销。结果显示，对于涉及调用链外数据的控制和需要关联不同交易数据的控制，开销可能会特别高。

关键词区块链、数据质量、成本、智能合约、以太坊

## 1 引言

启用智能合约的区块链越来越多地支撑着健壮且无需信任的分布式信息系统 implementation。此类系统的例子包括供应链管理平台、开放数据注册表以及智能电网中的电力交易和计费平台[[12(#CR12)]]。在这些系统中，交易负载中的数据决定了哪些数据存储在分布式账本中，以及网络中所有节点执行的应用逻辑（智能合约）。

考虑到交易载荷的关键作用，我们期望支持智能合约的区块链能够配备确保这些载荷数据质量的机制，即它们的适用性[6]。例如，在冷链物流场景中，如果传感器报告的温度读数超过之前记录值的 25%或超出可接受温度范围，则表明它传输了一个不准确的数据。这种不准确性可能表明传感器有故障或运输过程存在问题。在这两种情况下，数据质量评估都会突出显示异常值，并在接受前触发进一步分析。因此，应实施机制以实现数据质量控制，并最终丢弃低质量数据。到目前为止，区块链原生仅提供一些原始机制来保证这种质量：在加密货币中，节点仅接收交易来检查用户是否拥有正在转账的硬币[2]。

数据质量严重影响了使用它们的应用程序的可靠性，因此链上执行数据质量控制可以显著增加用户对区块链应用程序的信任。在我们之前的工作中[7]，我们提出了一种使用以太坊中的定制智能合约在链上实现数据质量控制的方法。具体来说，该方法实现了针对不同质量方面（即维度）的数据质量智能合约模板，结合了（i）数据质量控制所需的数据类型，例如，控制是否需要变量的单个值或多个变量的多个时间序列，以及（ii）这些数据如何交付给区块链，例如，是否通过一次或多次交易。

在为区块链实施数据质量评估时，一个关键关注点是评估其执行的*开销*。事实上，特别是公共区块链，可能具有很高的成本和时间开销。例如，用户必须支付使用公共区块链的费用，如在采用工作量证明共识的系统中，用户通过矿工节点支付交易费用。数据质量评估开销的评估仍然是一个开放问题。在本文中考虑的用于数据质量控制的定制智能合约的情况下，数据质量评估的开销可能是执行数据质量评估智能合约所需的费用（例如，在以太坊中运行它们所需的燃料量）和可能需要的额外时间，这会影响交易被挖掘到区块中的时间，进而影响系统吞吐量。

在此背景下，本文的贡献如下：（i）详细介绍两种伪真实场景的智能合约，用于数据质量评估，涵盖了我们的前期研究识别出的所有类型的数据质量评估智能合约模板[7]；（ii）实证评估在以太坊中使用这两种识别出的伪真实场景实施数据质量评估的开销（成本和时间）。获得的结果表明，特别是涉及获取链下数据的控制和需要关联不同交易数据的控制，控制的开销可能会很高。

本文组织如下。第二部分简要回顾了区块链上的数据质量相关研究。第二部分讨论了相关工作。第三部分介绍了数据质量模型，同时也概述了我们的前期研究。评估中考虑的场景和智能合约在第四部分中详细介绍，而评估结果在第五部分中讨论。最后在第六部分中得出结论。

## 2 背景及相关工作

数据质量（DQ）通常被定义为满足用户需求的数据的能力[6]。作为一个多维概念，DQ 是通过考虑不同的 DQ*维度*来评估的。最常用的维度包括*准确性*——数据值正确程度的度量——*完整性*——衡量所需数据在数据集中存在的程度——*及时性*——衡量数据的时效性——以及*一致性*——根据定义的规则（如功能依赖或业务规则）衡量数据的有效性。用于评估 DQ 维度的*指标*可能会因数据类型和数据源的不同而有所变化。例如，评估字符串的准确性需要一个与评估数字准确性不同的指标。

数据质量评估可以*在线*或*离线*进行。在线 DQ 评估发生在新的数据被保存到存储系统时。在这种情况下，目标是对低质量数据立即进行处理，例如，通过拒绝它们以避免降低存储系统中数据的整体质量。相反，离线 DQ 评估在数据被存储后进行，可以是定期进行，或在存储系统被查询时进行。本文关注的是在线评估交易载荷的 DQ 质量。

第二代区块链，如以太坊和 Hyperledger Fabric，支持所谓的*智能合约*[10]，这是一种广义上捕捉组织间如何进行业务（例如，在满足条件后转移数字资产）的可执行代码。节点可以通过发出指定要调用合同的操作和可选参数在有效载荷中的交易来调用智能合约。至于激励措施，当处理新交易时，发出它的节点会根据交易中包含的数据量和调用的智能合约操作的复杂度进行比例计费。

区块链应用的质量研究关注于*软件质量*。例如，Atzei 等人[3]对以太坊智能合约中的代码漏洞进行了分类。Wohrer 和 Zdun [11]概述了智能合约的安全模式。Bartoletti 和 Pompianu [5]基于应用类型，识别了以太坊智能合约中的常见编程模式。

鉴于它们能在多个节点上以一致、不可变和持久的形式存储数据，区块链通常被视为能够有效提高数据质量的系统[9, 13]. 然而，区块链研究常常假设存储在区块链上的数据是正确的。虽然这一假设对于从区块链本身创建的数据成立（即，加密货币），但区块链外创建的数据质量可能会有所不同，我们的工作旨在确保只有可靠的数据在区块链系统中分享。因此，在文献中，区块链研究中的数据质量问题尚未被深入探讨。Chen 等人[9]认为，在大多数应用场景下，仅使用区块链可能已经可以增加数据完整性和质量。这一观点得到了 Azaria 等人[4]的支持，他们讨论了使用区块链实现医疗记录管理系统的情况，观察到用于医疗研究的存储数据的质量和数量都有所提高。Casado-Vara 等人[8]研究了物联网应用中区块链的数据质量。尽管上述研究提到了这一点，但仍然缺少一个通用的、与应用无关的数据质量控制方法，该方法 specifically 考虑了区块链的优势和局限性。

## 3 数据质量评估模型

本节介绍了一个区块链中的数据质量（DQ）控制模型（节[3.1]）然后概述了我们之前基于智能合约的数据质量评估工作（节[3.2]）。

### 3.1 区块链中的数据质量控制

正如第二部分所讨论的，数据质量（DQ）可以通过不同的 DQ 维度来评估，每个维度都可以与多个评估指标相关联。在给定的上下文中，DQ 评估逻辑取决于数据源的类型和数据的类型，并且可能需要附加的元数据（例如，预期值，一致性规则）。考虑到这样的信息需求，在我们之前的工作中，我们定义了可能发生四种情况（见图 1）：

+   单变量，单值（SS）：变量的质量评估不需要附加数据；

+   单变量，多值（SM）：值的品质评估依赖于同一变量的一个或多个历史值的可获得性；

+   多变量，每个变量单值（MS）：一个值的质量依赖于其他多个变量的单值；

+   多变量，每个变量多个值（MM）：一个值的质量依赖于其他多个变量的多个值。

![../images/509088_1_En_5_Chapter/509088_1_En_5_Fig1_HTML.png](img/509088_1_En_5_Fig1_HTML.png)

图 1.

评估 DQ 时变量和值之间的依赖关系。改编自[7]。

这些情况影响了我们建模交易和 DQ 控制的方式，如下所述。

关于交易，我们考虑使用客户端生成的 nonce 来排序交易的工作量证明区块链系统，如以太坊。交易由客户端应用程序提交到区块链网络的一个节点。它们携带数据项，即键值对。因此，交易 ![$$t=\langle n, [d_i], c \rangle $$](../images/509088_1_En_5_Chapter/509088_1_En_5_Chapter_TeX_IEq1.png) 由一个 nonce *n*，它携带的键值对集合 ![$$d_i$$](img/509088_1_En_5_Chapter_TeX_IEq2.png) 以及一个关联 id *c* 定义。每个 ![$$d_i$$](img/509088_1_En_5_Chapter_TeX_IEq3.png) 是一个与值 ![$$v_i$$](img/509088_1_En_5_Chapter_TeX_IEq4.png) 相关联的键。nonce *n* 是由交易发行人指定的递增值，用于排序交易。只有当它的 nonce 尚未被同一发行人使用时，交易才被认为是有效的，否则将被丢弃。另外，只有在当前 nonce 低于当前 nonce 的所有其他发行人的交易都接收完毕后，才会处理交易。所需的关联 id *c* 用于在需要多个值时匹配指向相同有状态数据质量控制实例的数据项。

质量控制被定义为![$$dqc=\langle logic, [input_j], action \rangle $$](../images/509088_1_En_5_Chapter/509088_1_En_5_Chapter_TeX_IEq5.png)，其中*logic*包含了考虑的 DQ 维度的评估逻辑，![$$[input_j]$$](../images/509088_1_En_5_Chapter/509088_1_En_5_Chapter_TeX_IEq6.png)是评估逻辑的输入参数列表，即一系列数据项和*action*定义了在质量较差时执行的任务。输入参数作为交易中的数据项![$$d_i$$](img/509088_1_En_5_Chapter_TeX_IEq7.png)传递。数据质量控制可以是*无状态*的或*有状态*的。在无状态*dqc*中，数据项![$$input_j$$](img/509088_1_En_5_Chapter_TeX_IEq8.png)通过单个交易传递。因此，一旦收到这个交易，*dqc*就可以运行。在有状态*dqc*中，数据项![$$input_j$$](img/509088_1_En_5_Chapter_TeX_IEq9.png)通过不同的交易传递。因此，只有当传递了所需![$$input_j$$](img/509088_1_En_5_Chapter_TeX_IEq10.png)的所有交易都接收完毕后，*dqc*才能运行。

具体来说，当第一个数据项![$$d_i \in input_j$$](img/509088_1_En_5_Chapter_TeX_IEq12.png)通过具有相关 ID*c*的交易*t*传递时，会创建一个新的有状态质量控制实例![$$dqc_c$$](img/509088_1_En_5_Chapter_TeX_IEq11.png)。相关 ID*c*用于匹配不同交易中指向同一质量控制实例的数据项。例如，一个*dqc*可能检查传感器连续三次测量的压力精度，在这种情况下，可以生成一个包含传感器 ID 和读取时间戳的关联 ID^(1)。当每个输入参数在传递相同关联 ID*c*的交易中接收到一个数据项时，*dqc*可以进行评估。评估可以是积极的也可以是消极的。我们称当它被用于其评估时，一个数据项![$$d_i$$](img/509088_1_En_5_Chapter_TeX_IEq13.png)针对一个*dqc*。例如，要求温度值在一定范围内的质量控制是无状态的，因为它只需要当前交易中的数据，而前面提到的要求温度值不超过前值的 25%的质量控制是有状态的，因为它需要当前交易和前一个交易。

本文考虑的基于智能合约的数据质量评估受到 DQ 控制的应用*逻辑*的影响较小。在检测到质量较差时执行的动作是拒绝携带低质量数据的交易（讨论更精细化的政策来定义动作）。

### 3.2 基于智能合约的数据质量评估

为了使本文自包含，本节将简要概述文献[7]中描述的方法。简而言之，在基于智能合约的数据质量评估中，评估交易载荷的 DQ 被委托给即兴创建的运行 DQ 控制的智能合约。*功能型*智能合约，即被携带数据项![$$input_j$$](img/509088_1_En_5_Chapter_TeX_IEq14.png)的交易调用，负责在执行任何其他使用数据项![$$input_j$$](img/509088_1_En_5_Chapter_TeX_IEq15.png)作为参数的功能逻辑之前，调用实现*dqc*的 DQ 智能合约。

在这种方法中，数据质量（DQ）控制的逻辑被实现为智能合约的功能。由于智能合约可以被区块链上的所有节点调用，这个解决方案使得每个节点都能够根据它们特定的需求来评估交易载荷的质量，例如，使用它们的客户端应用程序的 DQ 要求。DQ 控制函数要么是无状态的，要么是状态 ful 的，这取决于它们实现的 DQ 控制类型。状态 ful 的函数在需要时利用关联 id，并需要内存来存储不同交易接收到的值。这两种类型的函数都可以使用预言机来获取评估 DQ 控制所需的链下数据。

我们之前的工作[7]识别了一组模板，以支持数据质量智能合约的实现，这些合约服务于数据质量控制（DQ 控制）所需的数据项（见图 2）可以通过四种可能的方式交付给区块链：

+   单交易（ST）：所有 DQ 控制所需的数据包含在一个单独交易的载荷中；

+   有序交易（OT）：DQ 控制所需的数据包含在不同的交易中，所有节点以相同的顺序接收这些交易。当交易在时间上足够间隔时，这种情况发生，例如，可以假设^(2)所有节点将以它们发起的相同顺序接收它们；

+   交织交易（IT）：一个 DQ 控制所需的数据包含在不同的交易中，这些交易可能不会按相同的顺序被所有节点接收。在这种情况下，我们假设交易载荷还包含 DQ 智能合约所需的信息，以了解何时收到了所有所需的数据，例如一个计数器或一个关联 id；

+   链下（Off）：DQ 控制所需的数据可在链下获取，并通过预言机注入到区块链中。

![../images/509088_1_En_5_Chapter/509088_1_En_5_Fig2_HTML.png](img/509088_1_En_5_Fig2_HTML.png)

图 2。

数据质量评估的可用性和相关性（使用多变量/单值配置进行展示；其他配置类似）。节选自[7]。

考虑到图 1 中描述的依赖关系，很清楚，单一变量、单一值（SS）的情况只能与单一交易（ST）场景相关联。当评估逻辑基于多值时，将使用有序交易和交织交易，而链下数据可用于检索多个变量的单一值。

## 4 数据质量评估的两个场景

接下来讨论我们为 DQ 评估开销评估创建的两个场景。对于每个场景，我们都创建了一组 DQ 控制智能合约变体。这些变体根据前一部分中提到的模型维度进行分类（表 1 展示了模型中定义的不同组合如何被智能合约变体覆盖）。表 1.

数据质量（DQ）智能合约变体在 DQ 模型维度上的分布。根据评估的数据质量维度，一个智能合约可能属于不同的类别。

|  | (SS) 单一变量 | (SM) 单一变量 | (MS) 多变量 | (MM) 多变量 |
| --- | --- | --- | --- | --- |
| 单值 | 多值 | 单值 | 多值 |
| --- | --- | --- | --- |
| **(ST) 单一交易** |  | SC1-1b |  | SC1-1a |
| SC1-2c, SC1-2d |  | SC1-2a, SC1-2b |  |
| **(OT) 有序交易** | N.A. |  |  | SC1-1c |
|  | SC1-2c | SC1-2e | SC1-2a, SC1-2e |
|  |  |  | SC2a, SC2b | SC2a, SC2c |
| **(IT) 交织交易** | N.A. | SC1-2d | SC1-2f | SC1-2b, SC1-2f |
| **(Off) 链下数据** | N.A. | N.A. | SC2c, SC2d | SC2b, SC2d |

### 4.1 场景 1：药品运输

在欧盟，人类使用的药品运输受到 GDP 规定 C343/01 的约束，该规定指出 *“供应批发分销商有责任保护药品免遭损坏、掺假和盗窃，并确保在运输过程中保持可接受的温度条件……应当能够证明药品未暴露于可能损害其质量和完整性的条件”*.

遵守此规定要求运输商在运输的所有阶段收集数据，并以安全和持久的方式存储这些数据。我们考虑使用带有测量其温度的传感器的温控卡车运输药品的情况。实际上，如果存储温度超过一定范围一段时间，产品的质量可能会受到影响。在这种情况下，区块链支持实施监控系统：如果存储在区块链上，从卡车和仓库收集的数据不会丢失或被篡改，帮助运输商避免因未达到所需的运输标准或隐藏员工疏忽而承担责任。

在此场景中，对传感器温度读数的质量评估涉及以下 DQ 维度：准确性、及时性、完整性和精确性。每个传感器读数都有一个布尔值，用于指示该读数是否满足其对应维度的 DQ 要求。为每个维度实现的 DQ 控制需要附加的 DQ 参数（元数据），例如准确性的可接受值范围、温度读数的最大可接受延迟（及时性）、以及精确性 DQ 维度的精度范围。请注意，准确性和及时性的评估只需要当前的传感器读数，而完整性和精确性还需要一组先前的传感器读数（考虑的前一个传感器读数的数量是一个额外的 DQ 参数）。

此场景下的 DQ 评估智能合约的 11 种变体如下总结。

**SC1-1**：每个交易包含了一组传感器读数及其时间戳。这是其中一个基准场景，其中未执行数据质量（DQ）评估。

**SC1-1a** [(MM,ST)]：每个交易包含了一组传感器读数（MM）、其时间戳以及运行 DQ 控制所需的 DQ 参数。在这种情况下，所有 DQ 控制都在一个交易内（ST）找到了所有所需的数据项。因此，当这个交易被挖掘到一个新的区块时，所有 DQ 维度都会立即评估。

**SC1-1b** [(SM,ST)]：每个交易包含了一组传感器读数及其时间戳（SM），而运行 DQ 控制所需的 DQ 参数在智能合约实例化时是不可变的。在这种情况下，所有 DQ 控制都在一个交易内（ST）找到了所有所需的数据项。因此，当交易被挖掘到一个新的区块时，所有 DQ 维度都会立即评估。

**SC1-1c** [(MM,OT)]：每个交易包含了一组传感器读数及其时间戳，而运行 DQ 控制所需的 DQ 参数在另一种不同类型的交易中发送，即调用 DQ 智能合约的另一个函数的交易（MM）。因此，所有 DQ 控制需要分析当前包含传感器读数的交易，以及接收到的最后一个带有参数值的交易。我们假设这个交易在包含要评估的读数批的交易之前被所有节点接收（OT）。当交易被挖掘到新的区块时，所有 DQ 维度都会立即评估。

**SC1-2**：每个交易包含了一个传感器读数及其时间戳。这是另一个未执行 DQ 评估的基准场景。

**SC1-2a** [(MS,ST),(MM,OT)]：每个交易包含单个传感器读数、其时间戳以及运行 DQ 控制所需的 DQ 参数（MS）。在这种情况下，准确性和及时性 DQ 控制在交易中找到所需的所有数据项（ST）。相反，完整性和精确性 DQ 控制需要分析前一个交易，这些交易之间的时间足够长，以至于可以被所有节点以相同的顺序接收（OT）。当交易在新块中被挖掘时，所有 DQ 维度都立即评估。

**SC1-2b** [(MS,ST),(MM,IT)]：每个交易包含单个传感器读数、其时间戳、一个 nonce（每次提交新交易时递增），以及控制操作所需的 DQ 参数。与 SC1b 相比，这种情况并不假定交易可能以发送的相同顺序被挖掘，而是依赖于 nonce 来排序交易（IT）。因此，如果一个交易在被前一个交易挖掘之前就被挖掘了，完整性和平准性 DQ 控制将延迟到前一个交易被挖掘时才执行（MM, IT）。为了准确性和及时性，DQ 控制可以在接收到交易时立即运行（MS,ST）。

**SC1-2c** [(SS,ST),(SM,OT)]：每个交易包含单个传感器读数和其时间戳，而运行 DQ 控制所需的 DQ 参数在智能合约实例化时是不可变地设定的。在这种情况下，准确性和及时性 DQ 控制在交易中找到它们所需的所有数据项（SS,ST）。相反，完整性和精确性 DQ 控制需要分析前一个交易，我们假设这些交易以正确的顺序被挖掘（SM,OT）。当一个交易被挖掘到新的区块时，所有 DQ 维度都立即评估。

**SC1-2d** [(SS,ST),(SM,IT)]：每个交易包含单个传感器读数、其时间戳和一个 nonce，而运行 DQ 控制所需的 DQ 参数在智能合约实例化时是不可变地设定的。就准确性和及时性而言，这种变体与 SC1-2c 等效（SS,ST）。关于精确性和完整性，相对于 SC1e，这种变体并不假定交易可能以发送的相同顺序被挖掘（IT），而是依赖于 nonce 来排序交易。因此，如果一个交易在被前一个交易挖掘之前就被挖掘了，完整性和精确性控制将延迟到前一个交易被挖掘时才执行。

**SC1-2e** [(MS,OT),(MM,OT)]：每个交易包含单个传感器读数及其时间戳，而 DQ 控制运行所需的 DQ 参数在另一种不同类型的交易中发送。与 SC1-2d 相比，完整性性和精确性 DQ 控制还需要分析包含先前传感器读数的交易。准确性性和及时性 DQ 控制所需的数据项都包含在单个交易中。我们假设所有节点以相同的顺序接收交易（OT）。当交易在一个新块中挖矿时，所有 DQ 维度都立即评估。

**SC1-2f** [(MS,IT),(MM,IT)]：每个交易包含单个传感器读数、其时间戳和一个 nonce，而运行 DQ 控制所需的 DQ 参数，连同 nonce 和时间戳，在另一种不同类型的交易中发送。这是最复杂的变体，因为它需要关联可能不会以正确顺序到达的不同类型交易（传感器读数和 DQ 参数）。为此目的，nonce 用来排序交易，而传感器读数的时间戳和参数的时间戳作为相关识别符。值得注意的是，只有在所有交易按正确顺序挖矿的情况下，DQ 维度才能立即评估，且仅针对在最后 DQ 参数更新之前执行的传感器读数。在其他所有情况下，DQ 控制都会延迟。

### 4.2 场景 2：药物处方

全科医生（GP）每天为他们的病人开出处方数十种药物。病人有他们的临床背景和（可能）正在进行的治疗列表，因此对于 GP 来说，判断新的规定药物是否可能对他们造成伤害可能很困难，例如因为它与正在进行的治疗不兼容。

我们假设处方记录在调用智能合约功能的区块链系统中。每个新处方都包含患者的 SSN 和一种规定药物。在这种情况下，智能合约的 DQ 控制功能可以被 GP 手动调用，为每个处方逐一检查（i）患者 SSN 是否存在（资格），以及（ii）是否已经开出了与当前处方不兼容的药物（兼容性）。

该场景的 DQ 控制智能合约的 5 个变体接下来总结如下：

**SC2**：这是未执行 DQ 评估的基本场景。

**SC2a** [(MS,OT)(MM,OT)]：药物不兼容信息和符合条件的患者信息都存储在链上。更详细地说，每次注册新患者时，都会提交包含患者 SSN 的交易。同样，当引入新药物时，会提交另一种包含药物 ID、类别和不兼容性的交易。当创建一个新的处方时，会提交另一种包含患者 SSN 和所开药物的交易。由于当这个交易被提交时，区块链上已经有了 DQ 控制所需的所有信息，所以一旦交易被挖掘，DQ 控制就会立即执行。

**SC2b** [(MS,OT),(MM,Off)]：符合条件的患者信息存储在链上，而药物不兼容信息存储在链下。相对于 SC2a，只提交与新患者和新技术处方相关的交易。相反，药物列表、它们的类别和它们的不兼容性存储在一个发布在面向互联网的服务器上的 XML 文件中。因此，每当创建一个新的处方时，智能合约必须调用一个 oracle 来读取 XML 文件，获取与所开药物相关的信息，并通知智能合约。结果是，一旦交易被挖掘，资格控制就会立即执行。相反，兼容性控制会在 oracle 回调智能合约并提供不兼容性列表之前暂停。

**SC2c** [(MS,Off),(MM,OT)] 符合条件的患者信息存储在链下，而药物不兼容信息存储在链上。相对于 SC2a，只提交与新药物和新技术处方相关的交易。相反，符合条件的患者信息存储在一个发布在面向互联网的服务器上的 XML 文件中。因此，每当创建一个新的处方时，智能合约必须调用一个 oracle 来读取 XML 文件，查找患者是否存在于该文件中，并将这一信息通知给智能合约。结果是，一旦交易被挖掘，兼容性控制就会立即执行。相反，资格控制会在 oracle 回调智能合约并通知患者是否存在之前暂停。

**SC2d** [(MS,Off),(MM,Off)]: 药物不兼容性和符合条件的患者信息都存储在链下。与 SC2a 相比，只有与新处方相关的事务会被提交。相反，符合条件的患者列表以及药物、它们的类别和它们的不兼容性信息存储在发布在面向互联网的服务器上的 XML 文件中。因此，每当创建新处方时，智能合约必须调用一个预言机来读取 XML 文件，查找患者是否存在于该文件中，检索与所开药物相关的信息，并通知智能合约。因此，所有的数据质量（DQ）控制都会在预言机回调智能合约并通知患者是否存在以及如果存在的话提供不兼容性列表之前暂停。

## 5 数据质量评估开销评估

我们使用 Remix IDE 编写了 Solidity 语言的智能合约，实现了前述部分讨论的数据质量评估变体。这些智能合约已经被部署在以太坊 Ropsten 测试网络上，这是一个以太坊公共网络，在该网络中以太币是虚拟的，使得智能合约的调用免费。

对于场景 1，我们模拟了一个每 6 分钟执行一次读数的传感器的行为。特别是，对于 SC1-1 及其变体，每 30 分钟提交一个事务，因此每个事务预期包含 5 个传感器读数。相反，对于 SC1-2 及其变体，每次执行传感器读数时提交一个事务。此外，对于 SC1-2f，为了触发在那个事务之前接收的传感器读数的 DQ 控制，每 30 分钟提交一个包含更新 DQ 参数的事务。最后，对于 SC1-2b、SC1-2d 和 SC1-2f，我们故意将每 5 个事务中的 1 个延迟 12 分钟提交，以测试智能合约处理交错事务的能力。

对于场景 2，我们考虑了 8 种可能被开给 3 位符合条件的患者的药物。对于 SC2a 和 SC2b，在药物可以被开给患者之前，需要为每位患者提交一个事务（以通知智能合约患者是符合条件的）。另外，对于 SC2a 和 SC2c，在药物可以被开给患者之前，还需要为每种药物提交一个事务（以通知智能合约哪些药物之间是不兼容的）。相反，对于 SC2b、SC2c 和 SC2d，我们依靠预言机来访问链下数据，以检查药物是否存在（SC2b 和 SC2d）以及检索药物所属的类别和与之不兼容的药物（SC2c 和 SC2d）。这些预言机是使用 Proovable([provable.​xyz](http://provable.xyz/))实现的，这是一个在线服务，提供了一系列函数库，供程序员调用以从外部源读取数据并将它们推送到智能合约中。

为了评估数据质量（DQ）智能合约的开销，我们考虑了以下指标：

+   **设置气体**。使智能合约运行所需的气体量，这是智能合约复杂性和部署成本的衡量标准。事实上，这个指标包括部署智能合约所需的气体以及为传递智能合约执行 DQ 评估所需的所有数据调用函数所花费的气体总和。例如，在 SC1g 中，后者包括用于调用传递 DQ 参数的函数的气体花费，例如用于计算精度的预期温度，而在 SC2a 中，它包括用于调用函数的气体花费，用于在智能合约中存储合格患者和药物不相容性。

+   **处理气体**。将收集到的数据存储到智能合约中所需的平均气体量，这是智能合约复杂性和执行所需成本的衡量标准。例如，在 SC1g 中，它包括用于提交新一批传感器读数的气体消耗。在 SC2a 中，它包括用于提交新处方的气体消耗。

+   **处理时间**。在收集到的数据存储到智能合约之前需要等待的时间量。对于这个指标，计算算术平均值和标准偏差。

+   **DQ 验证延迟**。一旦收集到的数据存储在智能合约中，需要等待的时间量，直到评估其质量。对于这个指标，计算算术平均值、标准偏差、绝对最大值和绝对最小值。

表 2。

实验结果（时间以 mm:ss 报告）。

| 智能合约 | 设置气体 | 处理气体 | 处理时间 | DQ 验证延迟 |
| --- | --- | --- | --- | --- |
| 值 | 增量 | 值 | 增量 | AVG | 增量 | STDEV | AVG | STDEV | MIN | MAX |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| SC1-1 | 482785 | N/A | 324958 | N/A | 01:00 | N/A | 01:16 | N/A | N/A | N/A | N/A |
| SC1-1a | 1016659 | +111% | 333817 | +3% | 00:31 | –48% | 00:15 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC1-1b | 1184398 | +145% | 346425 | +7% | 00:29 | –52% | 00:27 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC1-1c | 1243773 | +158% | 346425 | +7% | 00:35 | –42% | 00:22 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC1-2 | 401441 | N/A | 104387 | N/A | 00:17 | N/A | 00:08 | N/A | N/A | N/A | N/A |
| SC1-2a | 838387 | +109% | 135331 | +30% | 00:45 | +165% | 00:43 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC1-2b | 923172 | +130% | 140929 | +35% | 00:22 | +29% | 00:15 | 00:37 | 01:54 | 00:00 | 06:35 |
| SC1-2c | 1011508 | +152% | 147850 | +42% | 00:59 | +247% | 03:43 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC1-2d | 1092466 | +172% | 152611 | +46% | 00:20 | +18% | 00:10 | 00:37 | 01:52 | 00:00 | 06:27 |
| SC1-2e | 1070942 | +167% | 147850 | +42% | 00:23 | +35% | 00:15 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC1-2f | 1526459 | +280% | 132418 | +27% | 00:21 | +24% | 00:11 | 18:02 | 08:38 | 06:48 | 30:40 |
| SC2 | 2748971 | N/A | 184566 | N/A | 00:22 | N/A | 00:25 | N/A | N/A | N/A | N/A |
| SC2a | 4342274 | +58% | 507400 | +175% | 01:17 | +250% | 01:37 | 00:00 | 00:00 | 00:00 | 00:00 |
| SC2b | 5251579 | +91% | 685506 | +271% | 00:24 | +9% | 00:19 | 00:26 | 00:17 | 00:01 | 00:56 |
| SC2c | 6112655 | +122% | 270056 | +46% | 00:28 | +27% | 00:29 | 00:06 | 00:13 | 00:00 | 00:40 |
| SC2d | 5249786 | +91% | 813988 | +341% | 00:36 | +64% | 00:26 | 00:33 | 00:14 | 00:12 | 00:57 |

智能合约的代码可在[`​bitbucket.​org/​polimiisgroup/​dq-solidity`](https://bitbucket.org/polimiisgroup/dq-solidity)找到。为了最小化 Ropsten 测试网络拥塞的影响，这会导致交易挖掘所需时间出现显著变化，我们重复了 7 个不同日子里的测量，工作日内进行了 5 次，周末进行了 2 次，根据我们收集的数据，周末的流量较低。我们所报告的性能是这 7 次执行中记录的性能值的平均值。

表 2 展示了实验结果，允许比较每个智能合约及其实现第四部分的 DQ 控制的变体。

关于处理时间的结果必须仔细解释。实际上，我们发现，尽管处理时间高度依赖于网络条件（见表 2 中的标准差值，通常比相应的平均值高），DQ 控制对处理时间的影响是可以忽略不计的。也就是说，有无 DQ 控制的处理时间通常是可以相比较的，并且它遵循测试网络中的交易处理时间波动。

关于场景 1，DQ 控制对设置气体影响很大，因为它导致 SC1-1 的增加范围从 111%到 158%，SC1-2 的增加范围从 109%到 280%。相反，DQ 控制对处理气体的影响对于 SC1-1 来说相当小，因为增加的范围从 3%到 7%，而对于 SC1-2 来说则更为显著，增加的范围从 27%到 46%。值得注意的是，DQ 验证延迟只发生在 SC1-2b、SC1-2d 和 SC1-2f 中，因为这些是唯一会延迟 DQ 控制以考虑交错交易的智能合约。特别是，对于 SC1-2b 和 SC1-2d，最大延迟对应于延迟交易被挖掘的时间与后续交易被挖掘的时间之间的差值。相反，对于在延迟交易应提交之前提交的交易，以及在延迟交易提交之后提交的交易，最小延迟为 0。对于 SC1-2f，最大延迟对应于最后更新 DQ 参数后第一个被挖掘的交易时间与之前 DQ 参数更新后第一个被挖掘的交易时间之间的差值。而最小延迟对应于最后更新 DQ 参数后第一个被挖掘的交易时间与最后 DQ 参数更新前最后一个被挖掘的交易时间之间的差值。因此，在 SC1-2f 中，DQ 验证延迟取决于 DQ 参数更新的频率。

关于场景 2，DQ 控制对设置气体和处理气体的影响都很大，因为它导致前者增加的范围从 58%到 122%，后者增加的范围从 46%到 341%。值得注意的是，DQ 验证延迟只发生在 SC2b、SC2c 和 SC2d 中，因为它们需要外部数据被 Proovable 获取。另外，DQ 验证时间平均等于处理时间。这可以归因于 Proovable 的调用方式。确实，当被调用时，Proovable 检索链下数据并将它们提交给合约，通过提交一个调用智能合约回调函数的交易。因此，为了进行 DQ 控制，必须提交两个后续交易，一个带有数据以进行评估，另一个带有链下元数据用于 DQ 验证算法。

总结来说，结果显示在智能合约中添加数据质量控制对使用的燃料（gas）和与部署及调用相关的时效性影响显著。特别是在使用的燃料方面，这种开销与 DQ 控制功能的代码复杂性严格相关。因此，通过应用智能合约代码优化技术（例如[1])，这种开销可以最小化，而这些技术并不特定于 DQ 控制。如果使用预言机获取 DQ 控制所需的上链数据，这种开销会以不可预测的方式大幅增加。然而，值得注意的是，尽管使用 Proovable 的 SC2 变体在燃料方面是最昂贵的，但在这个实验中患者和药物的数量相当小。在实际场景中，合约可能需要处理成千上万的病人和药物，如果不依赖上链数据和预言机，可能会变得不方便甚至不可能。

## 6 结论

我们已经对基于智能合约的 DQ 评估方法在以太坊中的交易载荷进行了实证评估。为了评估，我们开发了一组 DQ 评估智能合约的变体，涵盖了不同类型的 DQ 控制，并在以太坊 Ropsten 测试网络上测量了与它们执行相关的开销。

获得的结果表明，如果 DQ 控制不依赖预言机，验证交易所需的时间很短。相反，执行 DQ 控制所需资源的 impact 可能会相当高，尤其是当智能合约部署在需要加密货币才能运行的公链上。依赖预言机的 DQ 控制对所需资源的影响很大。在我们的实验中，与没有预言机的情况相比，它们需要花费双倍的时间。实际上，访问预言机需要提交两次后续交易：一次与智能合约调用相关，一次与预言机调用相关。

还值得指出的是，DQ 控制对网络问题的弹性越强，例如交错交易，智能合约的成本就越高，执行 DQ 控制所需的时间也会越长。因此，DQ 控制的准确性与执行这些控制所需的时间和成本之间存在权衡。

我们计划以几种方式扩展这项工作。可以实施更多场景和实验，以更彻底地评估开销，例如考虑所考虑的数据质量控制类型。更一般地说，现有的数据质量管理方法论可以扩展到以区块链作为实现应用逻辑和/或存储数据的核心技术。基于智能合约的方法也可以在其它区块链上进行测试，以检查这里呈现的结果可以在何种程度上通用。

致谢

作者感谢 Lorenzo Maria Bonelli 在智能合约的初步实施中提供的帮助。

© Springer Nature Switzerland AG 2021 J. González Enríquez et al. (eds.) 业务流程管理：区块链与机器人流程自动化论坛  Lecture Notes in Business Information Processing 428 [`doi.org/10.1007/978-3-030-85867-4_6`](https://doi.org/10.1007/978-3-030-85867-4_6)

# 区块链作为医疗应用安全威胁的对策解决方案

Mubashar Iqbal^(1  ) 和 Raimundas Matulevičius^(1  )(1) 塔尔图大学计算机科学系，塔尔图，爱沙尼亚 Mubashar Iqbal（通讯作者）电子邮件： mubashar.iqbal@ut.eeRaimundas Matulevičius（通讯作者）电子邮件： raimundas.matulevicius@ut.ee

## 摘要

医疗行业正在数字化其医疗操作，并生成大量的敏感医疗数据，以便在患者的健康诊断和护理中做出迅速和有根据的决策。医疗行业面临着各种安全威胁*（例如，数据篡改、盗窃和假药）*。区块链正在获得关注，以解决这些安全威胁并通过将医疗操作转变为去中心化、透明和不可篡改的方式，提高数据完整性。然而，关于区块链作为医疗安全威胁对策解决方案的概念模糊和语义上的空白。在本研究中，我们使用网络本体语言创建基于区块链的安全本体（HealthOnt），以消除概念上的模糊性和语义上的空白。HealthOnt 提供了连贯和正式的信息模型，展示了区块链作为对策解决方案，应对传统医疗应用的安全威胁。

关键词区块链医疗应用安全威胁区块链对策解决方案安全风险管理

## 1 引言

医疗应用正在整合技术基础设施，以赋予患者和整个医疗部门权力。这种变化使得医疗部门能够更加迅速和有根据地使用数字医疗数据做出决策。医疗数据是敏感的、机密的且不可或缺的，它在患者的健康诊断、治疗中发挥着重要作用，并减少了医疗错误。日益增长的医疗数据增加了对其安全性的关注，以抵御各种安全威胁（例如，数据篡改、盗窃、假药）。区块链技术正在医疗领域崭露头角，以克服这些安全挑战，提高数据完整性，并将交易过程转变为去中心化、透明和不可篡改的方式。例如，本研究[1]展示了基于区块链的医疗应用程序，并结合云计算保护医疗数据免受篡改、盗窃和未经授权的使用。

区块链是一种去中心化、分布式且不可篡改的账本技术，运行在点对点（P2P）网络上[2]。账本包含每一笔交易的确切且可验证的记录[1]。区块链技术正在进入各个领域，医疗保健领域走在前列[3]。基于区块链的应用程序的成功取决于医疗数据是否准确、可验证且未被篡改。

在医疗保健领域，数据是最宝贵的资产之一。医疗保健应用程序受到各种安全威胁[4–6]的影响，这些威胁可能会破坏医疗数据的机密性、完整性和可用性。篡改的医疗数据可能会在患者治疗过程中引起重大问题。此外，数字健康记录增加了未经授权访问、信息泄露以及各种内部和外部威胁的风险。该研究[7]调查了医疗保健应用程序的安全性，发现结果显示，组织在设计医疗保健应用程序时并不遵守最佳实践。此外，技术基础设施与提供设计中的安全措施不兼容。

区块链技术的出现为医疗保健领域的几个研究课题开启了大门，以保存医疗数据、确保数据完整性、保障患者对自己数据的所有权、便于医疗数据的交换以及无缝的医疗保险理赔。然而，关于区块链作为传统医疗保健应用程序的对抗措施解决方案，存在概念上的模糊性和语义上的缺口[1, 8, 9]。因此，我们通过调查传统医疗保健应用程序的安全威胁以及如何利用区块链来减轻这些安全威胁，构建了一个本体论。这项工作的贡献有两个方面：

+   一个解释安全威胁和基于区块链的对抗措施以保护医疗应用程序的框架

+   基于区块链的医疗保健安全本体论的构建*(HealthOnt)*

我们遵循安全风险管理（SRM）领域模型[10, 11]，并开发了一个框架来探讨传统医疗应用的安全威胁。该框架协助我们构建基于区块链的医疗安全本体（HealthOnt）。HealthOnt 可能支持安全专家在设计医疗应用时选择区块链。此外，HealthOnt 将传统医疗应用的信息安全编码为基于动态本体的知识，这些知识可以被扩展、重复使用或与其他安全本体集成。本文结构如下：第二部分讨论了区块链、研究方法和相关工作。第三部分介绍了医疗应用的安全风险分析以及区块链作为对策解决方案。第四部分概述了本体论的发展。第五部分是本体评估，第六部分总结了本文。

## 2 背景

### 2.1 区块链

区块链创建了一个块链，并从交易过程中移除了可信赖的中介。每个块之前都有一个独特的加密哈希链接。区块链可以被分类为无需许可的（例如，以太坊）或需要许可的（例如，Hyperledger Fabric）。无需许可的区块链是完全去中心化的，并可供所有人使用。相反，需要许可的区块链是部分去中心化的，对谁可以加入和访问操作有限制。区块链包括共识机制（例如，工作量证明（PoW），权益证明（PoS））来维护账本状态。区块链中的智能合同是一段代码，当满足某些条件时可以自主执行。智能合同消除了可信赖的中介，减少了人为干预，降低了执行成本，防止了恶意或无意的安全威胁[12]。表 1。

区块链特性

| 特性 | 详情 |
| --- | --- |
| 不可篡改性 | 一旦记录添加到区块链上，它就不能被更改或删除 |
| 去中心化 | 区块链没有集中的单一管理机构或个人。一群分布式节点维护网络 |
| 分布式 | 运行在 P2P 网络上，网络中的参与者节点拥有相同的权力，共享分布式计算能力 |
| 共识 | 有助于维护账本的状态和不可篡改性 |
| 源起 | 每一项活动都被记录在区块链上，使得所有人都能验证其真实性 |
| 可追溯性 | 区块链检测到任何对内容的干扰/篡改 |
| 密码学 | 允许块以安全的方式连接，确保存储在区块链中的数据的完整性和不可篡改性 |
| 分布式访问控制 | 基于区块链的访问控制提供了去中心化和分布式的资源授权 |
| 权限控制 | 将某些动作分类为只能由某些参与者执行 |
| 伪匿名 | 区块链隐藏用户身份，不包含任何可识别信息 |

区块链具有多种特性（表 1），使其在各种应用领域成为一种不可抗拒和新兴的技术。这些特性带来了透明度、信任和防篡改的特性，这些特性是使商业和交易程序更加安全、高效和有效的支柱。

### 2.2 研究方法

本文旨在呈现一个基于 SRM 领域模型的本体框架，以展示区块链作为减轻传统医疗应用程序各种安全威胁的对策。在这种情况下，系统性文献回顾（SLR）是合适的，因为它允许对相关文献进行系统分析。我们遵循了 Kitchenham [13]的回顾指南，并具体化了回顾协议^(1)，以识别相关论文并开展这项研究。

SRM 领域模型[10, 11]帮助我们结构化区块链作为对策解决方案的知识。与其他 SRM 方法[15]相比，SRM 领域模型符合 ISO/IEC 27001 标准，并在信息系统开发的早期阶段探索三个方面*（例如，资产-、风险-和风险处理-相关）*。资产可以是系统或业务资产。业务资产有价值，系统资产支持它。安全标准（机密性-C、完整性-I、可用性-A）区分了安全需求。风险结合了风险事件和影响。风险事件构成威胁和一种或多种漏洞。威胁针对系统资产并利用漏洞。漏洞与系统资产相关，描绘它们的弱点。影响损害业务资产并否定安全标准。风险处理实施安全要求作为对策，以提高系统安全性。

### 2.3 相关研究

使用区块链来确保医疗应用程序的安全性是一个新兴的研究方向。一些研究评估了传统医疗应用程序的不同安全方面以及区块链缓解它们的作用。

萨哈等人[1]回顾了基于区块链的医疗解决方案，以防止数据篡改和数据泄露。该研究对使用区块链的不同医疗应用文献研究进行了比较分析。调查[8]探讨了医疗领域的安全和隐私问题。作者研究了针对医疗数据的安全攻击的时间线以及各种传统安全算法来防御它们。传统的网络安全算法被证明是无效的，区块链被用作先进的架构，以确保医疗交易的安全和数字医疗记录的保密和安全。

研究文献 9 描述了区块链的基本原则，以解决传统医疗应用程序的安全和隐私问题。该研究还讨论了区块链在医疗领域的技术优势（例如，更快的互操作性）。文献 16 提出了不同的用例，以解决传统医疗应用程序的安全和互操作性挑战。

Chukwu 等人[17]进行了一种结构化文献回顾（SLR），探讨了传统数字健康记录的信任、安全和隐私约束以及区块链如何克服它们。该研究评估了 61 篇文章，以解决传统医疗应用程序的安全挑战和医疗研究中区块链支持的新兴趋势。SLR[18]调查了用例和安全挑战，包括区块链如何保护医疗数据免受潜在的数据丢失、损坏或故意的安全攻击。Jin 等人[12]提出了区块链在医疗领域的应用，以实现安全和隐私保护的医疗数据共享。该研究认为，区块链的篡改证据和去中心化特性可以帮助建立一个安全的医疗数据共享网络。

相关研究讨论了特定的安全方面，而没有解决漏洞、需要保护的资产、区块链特性，也没有遵循任何 SRM 领域模型。相比之下，我们的研究汇集了传统医疗应用程序的安全威胁以及区块链如何作为对策解决方案来减轻它们。此外，我们利用 SRM 领域模型，开发了一个本体框架，提供了一个动态的知识库，以促进使用区块链的安全医疗应用程序。

## 3 医疗应用程序的安全风险分析

我们使用 SRM 领域模型分析文献研究，构建了一个框架（表 2），展示了安全威胁、它们的漏洞、需要保护的资产以及基于区块链的对策。在本节中，我们仅讨论表 2 中的前五个安全威胁。剩下的安全威胁*（例如，单点故障、否认、保险欺诈、临床试验欺诈、篡改设备设置、社会工程学）*在文献 14 中讨论。

### 3.1 数据篡改

传统方法缺乏对数据安全的控制，这对于医疗组织来说是一个主要担忧，因为它可能会危及患者生命。

**漏洞：**在传统医疗应用中，访问控制由指定机构/个人管理，可能存在误差。*集中式访问控制薄弱* [4, 19–21] 描述了一种情况，即医疗应用未能限制对资源的未授权访问。攻击者破坏了安全性并执行了未授权的操作，从而破坏了医疗记录的完整性以及患者数据的机密性。攻击者利用未授权访问获得了提升的特权，执行命令或绕过安全机制来篡改医疗数据。此外，传统医疗应用通常依赖于手动技术或第三方提供商来进行数据验证和校验。这些技术*缺乏验证和校验数据真实性的适当机制* [2, 22, 23]。因此，攻击者可以提交恶意内容，系统可以处理这些内容，从而破坏医疗记录的完整性以及患者数据的机密性。

**对策：**区块链允许基于智能合约的分布式访问控制[24]，可以调节用户对存储的医疗数据的访问。系统根据部署在去中心化和分布式环境中的访问权限 authenticates 和 identifies 相关用户。此外，强加密原语（例如，基于属性的加密）[25]有助于构建细粒度的访问控制。由于账本冗余和只追加结构，记录难以修改/删除[26]。在无需许可的区块链上的医疗应用使用 PoW 共识来验证执行的交易和数据验证，在保存到账本之前不要求第三方[22]。此外，使用 SHA-256 哈希算法，区块链计算原始数据唯一的哈希 ID，可用于验证数据的真实性[21]。Hyperledger fabric 使用可信授权节点来验证和校验数据的真实性[2]。区块链是篡改可察觉[20, 21]的，因此可以检测到任何未授权的修改。区块链通过在不可变账本中保留每个执行操作的日志[20]，随时间构建强大的审计线索，这些审计线索可用于验证和校验数据的真实性。表 2。

传统医疗应用的安全风险分析

![../images/509088_1_En_6_Chapter/509088_1_En_6_Tab2_HTML.png](img/509088_1_En_6_Tab2_HTML.png)

### 3.2 数据盗窃

在医疗行业，过去十年数据盗窃事件一直在增加，2020 年美国就报告了 642 起数据盗窃事件[5]。

**漏洞：**数据库是最常被攻克的资产之一[8]，并且集中式数据库存在*不适当的安全控制*，无法抵御内部或外部威胁[25, 26]。这种漏洞带来的威胁包括：i)滥用提升的权限，ii)未授权访问，iii)备份存储暴露，iv)数据库注入，v)默认的数据库账户和配置，vi)恶意软件和 vii)人为因素[5, 8]。总体上，它破坏了医疗系统的完整性以及医疗数据的机密性。

与数据篡改类似，由于*弱集中式访问控制*，攻击者可以窃取医疗数据[25, 27]，这导致攻击者获得未授权访问、提升权限或绕过安全机制。结果，它破坏了医疗数据的机密性。传统的医疗保健应用程序使用密码学来安全地保存数据并实现信息安全目标。然而，它*缺乏对数据的密码学控制* [27]，因为集中式权威/个人负责数据库的管理（保持提升的权限、加密/解密密钥）。如果系统的安全被攻破，那么攻击者可以窃取医疗数据。

**对策：**区块链在基于 P2P 的分布式网络上运行，节点既作为服务器也作为客户端直接与其他节点发送和接收数据。这种机制有助于保护数据不被未经授权的网络用户泄露[2]。在[26]中提出的解决方案使用了投票过程（例如，QuorumChain 算法）来确定哪些节点被允许访问某些类型的数据。受权限的区块链定义权限设置，以限制数据访问仅限于授权节点[21, 27]。与数据篡改对策类似，使用强加密原语（例如，基于属性的加密）[25]和基于智能合约的分布式访问控制机制[22]，只允许授权用户访问医疗数据。Ancile 框架[26]使用代理重加密来加密数据并在链上/链下存储哈希数据，[25]建议使用数据混淆来保护链上/链下的数据。

### 3.3 医疗记录处理不当

医疗人员必须确保医疗记录保持私密和安全的保管。但是，医疗记录处理不当是常见的 HIPAA 违规行为[6]。

**漏洞**：医疗机构控制和管理着患者的医疗数据，而与之无关的个体也能访问这些数据。因此，患者对自己医疗记录*的控制力较弱* [28]。此外，患者对自己的数据如何处理或与谁共享并不清楚。在某些情况下，医疗机构的个体涉及非法医疗数据交易[29]，从而否定医疗记录的完整性和机密性。

医院和医疗保健应用*依赖第三方* [23, 25] 供应商（如 IT 供应商、药店、保险公司等）来进行日常运作。这些第三方供应商可以访问患者的医疗数据。他们可能故意将医疗数据出售给数据经纪人，或者成为数据泄露的源头，从而否定医疗数据的机密性。

此外，医疗数据由指定的机构或个人管理，系统管理员的权限较高，负责管理整个系统。如果这些环节中的任何一个被攻破，攻击者可以在不留下痕迹的情况下操纵和否定医疗数据的真实性。因此，传统的医疗保健应用*无法保证数字病历的真实性* [23]。

**对策**：权限设置和分布式访问控制使得患者能够处理自己的医疗数据 [19, 30]。在区块链达成共识过程中，区块链会在将数据保存到账本之前进行数据验证。例如，区块链提供了一个透明的平台，以定义数据验证规则，这些规则由去中心化和分布式的网络节点达成一致[31]。然后，所有节点都遵循这些规则来验证数据。基于区块链的应用程序能够在网络的大部分节点诚实的情况下检测并丢弃所有未经授权的数据更改[30]。这个过程建立了一个防篡改的环境[32]。

### 3.4 假药（假冒药品）

多年来，药品供应链一直在努力监测其产品，避免假药的出现。据[19, 28]，每年全球销售的药物中有 10-30%（价值 2000 亿美元）是假冒的。

**漏洞**：假药的出现日益增多，给健康带来重大风险。在制药行业，生产后，药品从生产库存转移到批发分销商，然后再到零售公司。客户从零售商那里购买药品。由于药品供应链中的*追溯控制薄弱*（例如，数据共享无效，没有可追溯的记录）[3, 19, 28]，在这个过程中引入假药的风险很高。

**对策：** 区块链提供了解决方案，通过创建日志来跟踪每个步骤，从而实现药品可追溯性、实时数据访问和供应链验证 [3, 19, 28]。例如，IBM 研究部门利用区块链技术减少或消除了肯尼亚的药品造假问题 [28]，通过在药品供应链的每个阶段使用不可变且可追溯的日志。

### 3.5 中间人攻击（Man in the Middle Attack）

中间人攻击在医疗保健系统中呈上升趋势，以获取敏感信息 [33]。

**漏洞：** 攻击者可以利用传统医疗保健应用程序中安全通信的*弱控制* [4]，否定通信资产的完整性。例如，未能正确实施（或拥有）加密功能，或缺乏细粒度的访问控制机制。此外，由于*患者病历匿名化不足* [34]，医疗数据直接与患者身份相关联。攻击者可以获取数据触发勒索软件攻击，将其在线发布或拒绝访问。

**对策：** 作者 [4] 引入了分布式星际文件系统（IPFS）进行存储，并结合区块链和基于区块链的数据加密，以减少通信和计算开销，建立一个安全的通信通道。区块链在一个基于 P2P 的分布式网络上工作，节点既作为服务器又作为客户端，直接与其他节点交换加密数据。区块链的这个特性使得攻击者难以拦截通信或数据分析/嗅探 [2, 19]。区块链保持伪匿名性，患者及其医疗数据与公共地址相关联。另外，区块链上的数据处理是匿名的 [19]，并且区块链匿名化了医疗数据以隐藏真实身份 [34]。

## 4 医疗保健安全本体论（Healthcare Security Ontology）

本体论阐明了一个领域内概念的意义，以克服误解的后果。研究表明 [35] 了激励本体论发展的原因。例如，本体论使得 i) 共享共同的理解，ii) 重用领域知识，iii) 使领域假设明确，iv) 区分领域知识与操作知识，v) 分析领域知识。

HealthOnt 基于 Web 本体语言（OWL）和万维网联盟（W3C）。OWL 是一种语义网语言，用于说明关于事物及其关系的丰富和复杂知识[36]。我们使用 SPARQL（SPARQL 协议和 RDF 查询语言）作为语义查询语言[37]从本体中获取结果。我们利用**本体构建方法**[38]，该方法包括五个阶段：i)确定目的和范围，ii)构建本体，包括捕获、编码和集成阶段，iii)评估，iv)文档编写，以及 v)指南。在[39]中，我们遵循相同的本体构建方法来探索并构建针对 Corda 基于金融应用的安全威胁的本体论。

**范围和目的：**在[35]中提供的说明帮助我们定义本本体论的范围和目的。目的是构建一个针对医疗应用的基于区块链的对抗措施的知识库。本体论的范围涵盖了*本体论的领域*（例如，将区块链作为对抗措施解决方案），*本体论的应用*（例如，医疗应用的安全风险管理），*本体论回答的问题*（例如，保护哪些资产，威胁、漏洞和对抗措施是什么），以及*谁将维护本体论？*（例如，安全专家）。

**构建本体论：**我们使用 Protege 来捕获和编码领域知识（例如，概念及其关系）并将其分类。分类细化了属于资产、安全风险、漏洞、对抗措施以及与对抗措施相关的区块链特性的概念。

***资产分类：***资产被划分为业务资产和系统资产（见图 1）。安全标准是业务资产的约束，而系统资产支持业务资产。例如，业务资产“病历记录”具有完整性约束，而系统资产“访问控制”支持“病历记录”。![../images/509088_1_En_6_Chapter/509088_1_En_6_Fig1_HTML.png](img/509088_1_En_6_Fig1_HTML.png)

图 1。

业务及系统资产分类

资产类别定义解释了子类别（例如，BusinessAsset 和 SystemAsset）以及限制“hasConstraint”和“supports”。![../images/509088_1_En_6_Chapter/509088_1_En_6_Figa_HTML.png](img/509088_1_En_6_Figa_HTML.png)**威胁分类：**安全威胁分类（图 2）是基于使用区块链减轻的威胁构建的。在传统的医疗保健应用中，安全威胁利用漏洞并针对某些系统资产。威胁类别对某些 ValuesFrom 漏洞有一个限制“exploits”。另一个限制“targets”某些 ValuesFrom SystemAsset。![../images/509088_1_En_6_Chapter/509088_1_En_6_Figb_HTML.png](img/509088_1_En_6_Figb_HTML.png)![../images/509088_1_En_6_Chapter/509088_1_En_6_Fig2_HTML.png](img/509088_1_En_6_Fig2_HTML.png)

图 2。

安全威胁分类

例如，在传统的医疗保健应用中，攻击者可以通过利用“ErrorProneAuthenticityOfData”或“WeakAccessControl”漏洞来触发“DataTampering”威胁。该“DataTampering”威胁针对系统资产（例如，AccessControl、HealthcareDatabase 或 MedicalTransaction）。

**漏洞分类：**这个分类（图 3）是基于医疗保健应用中的弱点，这些弱点使某些安全威胁得以实现。![../images/509088_1_En_6_Chapter/509088_1_En_6_Fig3_HTML.png](img/509088_1_En_6_Fig3_HTML.png)

图 3。

漏洞分类

漏洞类别定义解释了各种特征于系统资产的漏洞，并抵消了业务资产的安全标准。![../images/509088_1_En_6_Chapter/509088_1_En_6_Figc_HTML.png](img/509088_1_En_6_Figc_HTML.png)

例如，访问控制实施的薄弱之处提供了攻击者可以利用的弱点，从而获得未授权的访问。一个“WeakAccessControl”漏洞是“SystemAsset”（AccessControl、HealthcareDatabase）的特征，并抵消了一些（完整性或机密性）。

**对策分类：**对策分类（图 4）展示了减轻漏洞并提高系统安全性的对抗措施。这些对策属于区块链特性。![../images/509088_1_En_6_Chapter/509088_1_En_6_Fig4_HTML.png](img/509088_1_En_6_Fig4_HTML.png)

图 4。

对策分类

对抗措施类别定义解释了它包含属于区块链特性的各种对抗措施，并减轻各种漏洞。例如，对抗措施“分布式访问控制机制”属于“分布式访问控制”特性，并减轻传统医疗应用中的“弱访问控制”漏洞。![../images/509088_1_En_6_Chapter/509088_1_En_6_Figd_HTML.png](img/509088_1_En_6_Figd_HTML.png)***区块链特性分类:**区块链特性分类（图 5）展示了与基于区块链的对抗措施相关联的特征（表 1）。例如，对抗措施“分布式访问控制机制”属于“分布式访问控制”区块链特性。![../images/509088_1_En_6_Chapter/509088_1_En_6_Fige_HTML.png](img/509088_1_En_6_Fige_HTML.png)![../images/509088_1_En_6_Chapter/509088_1_En_6_Fig5_HTML.png](img/509088_1_En_6_Fig5_HTML.png)

图 5。

区块链特性分类

**文档和指南:** HealthOnt 可以在网上获得（表 3）我们使用 Protege 注释来文档化概念和关系。此外，我们利用 Protege OntoGraf 插件来生成分类图和 Pellet reasoner 来验证我们本体的连贯性。表 3。

HealthOnt 资源

| 资源 | 资源 URL |
| --- | --- |
| HealthOnt | [`​mmisw.​org/​ont/​~mubashar/​HealthOnt`](https://mmisw.org/ont/%257emubashar/HealthOnt) |
| GitHub | [`​github.​com/​mubashar-iqbal/​HealthOnt`](https://github.com/mubashar-iqbal/HealthOnt) |
| Protege | [`​protege.​stanford.​edu/​`](https://protege.stanford.edu/) |
| OntoGraf | [`​protegewiki.​stanford.​edu/​wiki/​OntoGraf`](https://protegewiki.stanford.edu/wiki/OntoGraf) |
| Pellet Reasoner | [`​protegewiki.​stanford.​edu/​wiki/​Using_​Reasoners`](https://protegewiki.stanford.edu/wiki/Using_Reasoners) |

## 5 本体评估

我们使用基于任务的[40]评估技术。这种技术允许了解 HealthOnt 适用性。高效的评估技术有助于本体的科学价值。例如，考虑医疗安全专家正在从事医疗应用工作或医疗组织寻找可行的解决方案来应对与医疗数据篡改和盗窃相关的安全威胁。由于概念上的模糊性和语义上的差距，医疗安全专家和组织都不了解区块链的对抗措施，这些措施可以减轻两种安全威胁。

在此案例中，HealthOnt 支持选择区块链以减轻传统医疗应用的安全威胁并确定要保护的资产。此外，HealthOnt 还可以协助安全威胁的概念设计和技术实现。例如，HealthOnt 有助于识别安全威胁的漏洞、要保护的资产（业务和系统资产）以及基于区块链的对抗措施。

SPARQL 查询从 HealthOnt 检索信息。以下代码是每个 SPARQL 查询头部必需的，以成功执行它。![../images/509088_1_En_6_Chapter/509088_1_En_6_Figf_HTML.png](img/509088_1_En_6_Figf_HTML.png)

**查询#1** 检索与数据篡改和盗窃相关的安全威胁、它们的漏洞以及需要保护的资产。该查询根据定义的关系 *(利用和目标)* 编译结果。例如，**威胁** (DataTampering) *利用* **漏洞** (WeakAccessControl)，并且 **漏洞** (WeakAccessControl) *目标* **系统资产** (AccessControl 或 HealthcareDatabase 或 MedicalTransaction)。类似的结果对于 DataTheft 和其他安全威胁（参考表 2）。

**查询#1**![../images/509088_1_En_6_Chapter/509088_1_En_6_Figg_HTML.png](img/509088_1_En_6_Figg_HTML.png)

**查询#2** 检索与数据篡改和盗窃相关的对抗措施和漏洞。查询基于关系 *(减轻)* 获取结果。例如，**对抗措施** (DistributedAccessControl) *减轻* **漏洞** (WeakAccessControl)。类似的结果对于 DataTheft 和其他安全威胁（参考表 2）。

**查询#2**![../images/509088_1_En_6_Chapter/509088_1_En_6_Figh_HTML.png](img/509088_1_En_6_Figh_HTML.png)**本体验证**是确保本体知识正确性和本体推理意义的重要部分。我们使用文献 40, 41]的 criteria 进行 HealthOnt 的定性评估（表 4）。表 4.

HealthOnt 验证

| 标准 | 详情 |
| --- | --- |
| --- | --- |
| 准确性 | 我们利用科学文献来定义类、属性和个体 |
| 适应性 | HealthOnt 为一系列预期任务（如威胁、漏洞和对抗措施）提供了概念性基础 |
| 清晰性 | 与 HealthOnt 概念和关系相关的定义已记录 |
| 完整性 | SRM 领域模型使 HealthOnt 具有丰富性和粒度 |
| 计算效率 | 我们使用 Pellet 推理器处理 HealthOnt，以及 SPARQL 查询结果。Pellet 推理器和 SPARQL 是快速且计算效率高的工具 |
| 简洁性 | HealthOnt 只包含必要的术语，并解释威胁有效性的弱点 |
| 一致性 | 我们使用 Pellet 推理器来检查 HealthOnt 的一致性，避免在本体概念和关系中出现矛盾 |
| 组织适宜性 | 我们遵循定义良好的本体构建方法。HealthOnt 在线可用，可以扩展、重用或与其他安全本体集成 |

## 6 讨论和结论

在本工作中，我们利用 SRM 领域模型通过探索传统医疗应用的安全威胁来构建 HealthOnt。我们定义了我们本体的范围并开发了与资产、安全威胁、漏洞、对策和区块链特性相关的分类。HealthOnt 是公开可用的，并把信息编码成动态基于本体的知识，可以扩展、重用或集成到其他安全本体中。HealthOnt 可以支持 SRM 的迭代过程，当出现新的安全威胁或对策时，可以持续更新 HealthOnt。为了确保经验研究的质量，我们通过概述未来工作和威胁有效性 [42] 来扩展我们的讨论。

**未来工作：** 在我们的研究中，我们发现区块链被认为是医疗应用的安全工具 [21, 28]。然而，基于区块链的医疗应用并没有完全证明能保护数据免受各种安全威胁。实际上，有许多方法可以抵消基于区块链应用的安全性 [43, 44]。在未来的工作中，我们正在通过包括在区块链基础上医疗应用可能出现的*安全威胁*来扩展 HealthOnt。另外，*本体验证需要进一步工作* 来确定是否开发了正确的本体，以及本体是否准确地模拟了为其开发的真实世界。在通信中，我们将使用传统医疗应用的真实世界案例来验证和展示 HealthOnt 的适用性。此外，需要基于本体领域专家的评估来感知 HealthOnt 贡献的重要性，推导出所缺少的内容，并确定 HealthOnt 的准确性、全面性和技术正确性。

**有效性威胁：** 我们通过映射来解决有效性威胁 [42]。相关的威胁包括受限的时间跨度、出版偏差、主观解释以及缺乏专家评估。**受限的时间跨度** 是研究者无法预测超出时间跨度的其他适用研究。例如，区块链相对较新但正在不断演变。因此，未来将出现各种应对措施。**出版偏差** 是相关研究更可能报告积极结果而不是消极结果。存在**主观解释**的威胁，因为我们可能对识别的威胁、漏洞和应对措施有不同的解释和观点。此外，**缺乏专家评估**也可能导致主观解释和错误结论。这些威胁以及没有使用现实世界医疗应用的案例进行验证，引发了关于**本体评价薄弱**的担忧。例如，在将 HealthOnt 应用于现实工业环境时，可能会发现错误或局限性。然而，在我们未来的工作中，我们正专注于克服这些威胁。

致谢

本工作部分得到了 ERASMUS+部门联盟计划在区块链技能与发展方面的合作（CHAISE）的支持，该计划号为 621646-EPP-1-2020-1-FR-EPPKA2-SSA-B。欧盟委员会对这本出版物的支持并不构成对其内容的背书，这反映的只是作者的观点，委员会不能为其中可能产生的任何使用负责。

© Springer Nature Switzerland AG 2021 J. González Enríquez 等人（编辑）商业流程管理：区块链与机器人流程自动化论坛  Lecture Notes in Business Information Processing 428 [`doi.org/10.1007/978-3-030-85867-4_7`](https://doi.org/10.1007/978-3-030-85867-4_7)

# 研究比特币隐私攻击及其对基于比特币身份方法的影响

Simin Ghesmati^(1, 2  )，Walid Fdhila^(1, 3  ) 和 Edgar Weippl^(1, 3  )(1) SBA Research，维也纳，奥地利(2) 维也纳技术大学，维也纳，奥地利(3) 维也纳大学，维也纳，奥地利 Simin Ghesmati（通讯作者）电子邮件： sghesmati@sba-research.orgWalid Fdhila 电子邮件： wfdhila@sba-research.orgEdgar Weippl 电子邮件： eweippl@sba-research.org

## 摘要

比特币区块链是第一个公开可验证且分布式账本，人们可以下载并检查从创世区块开始的所有数据记录的完整历史。这些特性促使新类型的应用程序的出现，以及不再适应当前商业需求的传统系统的重新设计（例如，透明度、抵御审查、去中心化）。其中一个特别应用是使用区块链技术来启用去中心化和自主权身份，包括创建、解决和吊销它们的新机制。数据记录的公开可用性，反过来又为结合复杂启发式和辅助信息以损害用户隐私和去匿名化身份的新类型攻击铺平了道路。在本文中，我们回顾并分类了比特币隐私攻击，研究了它们对基于比特币的身份方法之一即 did:btcr 的影响，并分析了其隐私特性。

关键词：去中心化标识符 DID、隐私、BTCR、区块链、比特币

## 1 引言

比特币区块链[1]是一个不可篡改且防篡改的分布式账本，其中地址被用作化名（公钥的哈希值），最终与可以通过相应私钥兑换的比特币金额相关联。除了加密货币，区块链技术已经催生了许多新应用，这些应用范围从协调和监控跨组织业务流程[2–4]到设计新的分布式身份管理方法[5, 6]。例如，业务流程自动化需要不同的参与者（如客户、员工、商业伙伴）、资源和服务的可信交互。这种可信赖的通信，反过来又要求实体能够建立可信赖的通信通道，确信他们正在与真实的实体交互。在这方面，身份继续作为这种可信赖通信的推动者发挥着原始作用。身份是一组数据，它定义了主体的属性，例如建立通信的密码学材料（公钥）、证明身份所有权的验证方法或服务端点。传统系统通常依赖于孤岛式、集中式或联合式架构来管理身份。在孤岛式模型中，每个第三方服务/商业本身就是身份提供者 IDP（即负责存储和管理身份数据），而集中式和联合式模型都将身份管理委托给单独的 IDP，分别在孤立或联合的方式下工作。然而，最近的泄露事件（例如，5 亿个 Facebook 账户，以及 7 亿个 LinkedIn 账户泄露^(1))暴露了这些系统的局限性，呼吁采用更加去中心化的模型，赋予用户对自己数据的控制权。随着区块链的出现，现在可以创建和解决去中心化标识符（DIDs）而不必依赖集中式权威。这为众多提案（DID 方法）打开了大门，这些提案使去中心化创建、解决、更新和吊销 DIDs 变得可能。值得注意的是，这些 DID 方法依赖于不同的区块链技术和架构设计。第一种提出的 DID 方法特别使用了比特币区块链，被称为 did:btcr [7]。

在我们之前的研究 [8]中，我们展示了如何将复杂的启发式方法与辅助信息（例如地址标签数据库）相结合，以关联比特币地址与其相应的真实身份，这可能会使用户的隐私受到风险。在本文中，我们回顾并分类了针对比特币区块链的隐私攻击，这些攻击不仅可能揭示地址与现实世界身份之间的联系，还可能将不同的身份关联起来。接下来，我们讨论了比特币隐私攻击对 DID 方法 did:btcr 的影响。为此，我们采用了 RFC 6973 [9]中的术语。本文的贡献分为两个方面：(i) 分类比特币隐私攻击，(ii) 调查 did:btcr 的隐私问题。

本文的其余部分组织如下：在第二部分中，我们描述了主要概念，而在第三部分中，我们介绍了方法论，分类了比特币隐私攻击并解释了它们可能如何影响用户的隐私。在第四部分中，我们调查了 DiD BTCR 方法的隐私问题，在第五部分中，我们总结了本文并提供未来的研究方向。

## 2 背景

### 2.1 比特币

在比特币中，交易由输入和输出地址组成。输入指的是之前交易的一个输出。矿工费通常作为交易的一部分包含在内，以增加其被矿工考虑的机会。这解释了为什么输入的总和应该总是大于输出的总和。另外，每当输入加上费用的总和大于应花费的金额时，就会创建一个新的地址，即变化地址，以将剩余金额发送给发送者 [10]。图 1 展示了比特币交易的简化形式。在第一个交易中，爱丽丝(![$$A_1$$](img/509088_1_En_7_Chapter_TeX_IEq1.png))将比特币发送给鲍勃(![$$B_1$$](img/509088_1_En_7_Chapter_TeX_IEq2.png))，并将剩余金额退回到她的变化地址(![$$A_2$$](img/509088_1_En_7_Chapter_TeX_IEq3.png))。在接下来的交易中，鲍勃将从他的地址(![$$B_1$$](img/509088_1_En_7_Chapter_TeX_IEq4.png))发送比特币到他的另一个地址(![$$B_2$$](img/509088_1_En_7_Chapter_TeX_IEq5.png))，同时额外指定一个可选的![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq6.png)输出。![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq7.png)是一个操作码，它使得能够在交易中嵌入少量数据。![../images/509088_1_En_7_Chapter/509088_1_En_7_Fig1_HTML.png](img/509088_1_En_7_Fig1_HTML.png)

图 1。

比特币交易

比特币是一个公开的账本，因此，包括发送者和接收者地址、交易价值以及相应的时间戳在内的所有交易细节都是可见的，并且任何人都可以进行核查。尽管区块链具有很好的属性，但它也为攻击者创造了一个市场，攻击者可以利用这些公开的数据进行恶意操作。之前和正在进行的研究已经确定了几种可能泄露身份并有效找到比特币地址与相应身份之间关系的问题[11–14]。

### 2.2 分布式身份标识符（DIDs）

实体，包括用户和组织，使用全球唯一标识符来应对各种用例，比如电话号码、身份证号码或 URL。这些标识符通常由中心机构发行和管理。然而，之前的数据泄露事件削弱了对这种中心化架构的信任，呼吁对身份进行去中心化管理，在这种管理模式下，用户成为自己的身份提供者。因此，基于区块链的去中心化标识符[15]已经被提出，它们依赖于区块链和额外的加密技术来证明标识符的所有权，而不需要依赖可信赖的实体。

一个**分布式标识符（DID）**是一个包含三个主要部分的字符串：方案、DID 方法和 DID 方法标识符，这些标识符在 DID 方法中应该是唯一的。根据 W3C 建议的语法[2]如下所示。

![$$方案：DID 方法：DID\_ 方法\_ 标识符$$](img/509088_1_En_7_Chapter_TeX_IEq8.png)

分布式身份标识符通常与**DID 文档**相关联；即，包含有关验证方法（例如，加密公钥）和服务端点信息的文档，这些信息是用来与 DID 主体进行交互的。DID 主体是由 DID 标识的实体，可以是个人、物体或组织。除了底层基础设施（例如，比特币、以太坊），一个**DID 方法**定义了 DID 是如何创建、解析、更新和吊销的。

尽管分布式身份标识符（DIDs）与 DID 文档一起使得创建值得信赖的通信变得可能（如何与身份所有者进行通信），**可验证凭证（VCs）** 则代表关于身份所有者的信息和声明（例如，姓名、年龄、毕业证书）[16]。这些凭证可以由不同的发行者（例如，大学、雇主）发行，并且可以被任何第三方通过加密技术验证，而无需联系相应的发行者。

### 2.3 BTCR

**BTCR** 方法 [7] 利用比特币区块链来管理 DID（去中心化身份识别）。在 **did:btcr** 中，DID 是通过使用一旦交易确认后才能知道的交易引用 *TXRef* 创建的。下面是一个 **did:btcr** 的示例（取自 [7]），其中 did 是方案部分，btcr 是 DID 方法部分，xyv2-xzpq-q9wa-p7t 是标识符，即交易引用。交易引用遵循 BIP 0136，在比特币区块链中编码交易的位置（包括链、区块高度和交易索引）：

![$$did:btcr:xyv2-xzpq-q9wa-p7t$$](img/509088_1_En_7_Chapter_TeX_IEq9.png)

如前所述，使用 **did:btcr** 创建 DID 只需创建一个比特币交易。此 DID 创建交易可能引用一个包含 DID 文档的 URL，使用 ![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq10.png) 构造。后者可能存储在单独的存储上，例如第三方服务器（在撰写本文时，IPFS 还不支持）。如果第一个交易没有指定 ![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq11.png)，则默认从交易本身创建 DID 文档。然而，对 DID 的后续操作（例如更新交易）必须指定 ![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq12.png)，否则，DID 被认为是撤销的 [17]。例如，更新操作包括更新 DID 文档并创建新交易，消耗所有之前的 UTXO，并在 ![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq13.png) 中嵌入新的链接到更新的 DID 文档。

再次说明，DID 文档包含加密材料和方法，用于与 DID 控制器建立通信。一个可验证的凭证发行者（例如，一所大学）可以发布他们的 DID，并使用它来签署凭证（例如，毕业证书）。验证者（例如，雇主）可以通过解析发行了凭证的 DID，并验证它是否被比特币区块链撤销，来检查凭证的真实性。因此，验证者无需与发行者沟通即可检查给定凭证的有效性，这有助于避免可链接性。

## 3 比特币隐私攻击

### 3.1 研究方法

本节描述了收集和选择相关文献的方法，该方法遵循四个主要步骤；（i）研究问题识别（见第一部分），（ii）文献搜索，（iii）文献选择，（iv）数据提取。**文献搜索。** 通过手动搜索和引文搜索的三角测量方法收集相关文献。科学数据库如 DBLP、IEEE xplore、ACM、usenix 和 Springer 以及分布式账本技术和去中心化身份领域的顶级会议都被搜索。**搜索查询。** 用于搜索相关文献项目的查询包括并组合以下关键词：“Bitcoin”、“blockchain”、“分布式账本技术”、“DLT”、“隐私”、“攻击(s)”、“匿名性”、“去匿名化”、“相关性”和“可链接性”。只考虑 2009 年至 2021 年的论文。**文献选择。** 搜索结果共有 479 篇论文，其中与主题不相关的论文根据标题和摘要被排除。另一轮快速筛选剩余的论文，得出 14 篇关注比特币区块链中隐私攻击的论文。表 1 列出了按 h5-index 和 h5-median 排序的确定会议。表 1.

计算机安全和密码学顶级出版物

|  | 出版物 | h5-指数 | h5-中位数 | 出版商 |
| --- | --- | --- | --- | --- |
| 1 | ACM 计算机与通信安全研讨会 | 88 | 140 | ACM |
| 2 | ieee transactions on information forensics and security | 86 | 118 | IEEE |
| 3 | USENIX Security Symposium | 80 | 129 | USENIX |
| 4 | ieee 安全与隐私研讨会 | 74 | 142 | IEEE |
| 5 | 网络与分布式系统安全研讨会（NDSS） | 71 | 111 | NDSS |
| 6 | 国际密码技术理论与应用会议（EUROCRYPT） | 61 | 89 | Springer |
| 7 | 计算机与安全 | 59 | 90 | Elsevier |
| 8 | ieee transactions on dependable and secure computing | 54 | 77 | IEEE |
| 9 | 国际密码学会议（CRYPTO） | 52 | 87 | Springer |
| 10 | 国际金融密码学与数据安全会议 | 46 | 74 | Springer |
| 11 | 国际密码学与应用会议（ASIACRYPT） | 42 | 61 | Springer |
| 12 | 安全与通信网络 | 40 | 51 | Wiley |
| 13 | 密码学理论 | 38 | 58 | Springer |
| 14 | ACM 亚洲计算机与通信安全会议 | 37 | 55 | ACM |
| 15 | 隐私增强技术会议论文集 | 35 | 55 |  |
| 16 | ieee 欧洲安全与隐私研讨会 | 34 | 74 | IEEE |
| 17 | 设计、代码与密码学 | 34 | 50 | Springer |
| 18 | 欧洲计算机安全研究会议 | 34 | 43 | Springer |
| 19 | ieee 安全与隐私 | 31 | 53 | IEEE |
| 20 | 信息安全与应用期刊 | 31 | 40 | ELSEVIER |

许多选定的研究已经确定了隐私攻击，这些攻击可能揭示了身份与比特币地址之间的联系。在下面，我们将对选定的论文中应用的可能攻击进行分类和解释（表 2）。根据论文目的，我们将选定的论文分为五个类别，包括隐私挑战、分类、非法活动（追踪暗网中的比特币使用、勒索软件和庞氏计划）、将匿名与 IP 关联以及模式检测（发现与用户在交易系统中的行为和报酬模式相关的特定模式）。一些论文提出了不特定于比特币的攻击。在本文中，我们只考虑分析比特币区块链中的隐私攻击，因为我们只在 BTCR 中解决比特币隐私攻击。此外，我们采用了[18]中确定的四种主要隐私攻击类别；（i）启发式，（ii）侧信道攻击，（iii）流量分析，（iv）辅助信息，这些将在下一节中解释。表 2。

选定的论文

| 类别 | 论文 | 年份 | 发表期刊 | 目的 | 区块链 |
| --- | --- | --- | --- | --- | --- |
| 隐私挑战 | [19] | 2018 | IEEE S& P | 访问隐私挑战 | BTC, ZEC |
| 分类 | [20] | 2014 | FC | 用户分类 | BTC |
| [21] | 2020 | USENIX | 分析工具 | BTC, BCH, BSV, LTC, 和 ZEC |
| 非法活动 | [22] | 2018 | 计算机与安全 | 追踪勒索软件 |   |
| [23] | 2018 | IEEE S& P | 追踪勒索软件 | BTC |
| [24] | 2019 | NDSS | 暗网中的加密货币 | BTC |
| [25] | 2020 | Asia CCS | MMM 庞氏骗局检测 | BTC |
| 将匿名与 IP 关联 | [26] | 2014 | FC | 将匿名与 IP 关联 | BTC |
| [27] | 2014 | CCS | 将匿名与 IP 关联 | BTC |
| [28] | 2017 | FC | 集群启发式+网络层信息 | BTC |
| [11] | 2019 | EuroS& P | 将匿名与 IP 关联 | BTC, ZEC, XMR, Dash |
| 模式检测 | [12] | 2017 | EuroS& P | 报酬检测 | BTC |
| [13] | 2019 | CCS | 追踪交易交易 | BTC |
| [14] | 2019 | USENIX | 追踪交易交易 | ETH, BTC, LTC, BCH, Doge, Dash, ETC, ZEC |

### 3.2 比特币区块链启发式

表 3 总结了应用于比特币协议的模式，以识别地址之间的关系（常见输入所有权、改变地址检测、地址重用、单向输入单向输出和特定模式）。其中一个启发式（集群增长）防止假阳性[10, 21]。表 3。

比特币区块链启发式

|   | 多输入 | 改变地址 | 地址重用 | 单向输入单向输出 | 集群增长 | 模式 |
| --- | --- | --- | --- | --- | --- | --- |
|  [20] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figa_HTML.gif](img/509088_1_En_7_Figa_HTML.gif) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figb_HTML.gif](img/509088_1_En_7_Figb_HTML.gif) |   |   |   |   |
|  [19] |   |   |   |   |   |   |
|  [21] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figc_HTML.gif](img/509088_1_En_7_Figc_HTML.gif) (excluding CoinJoin) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figd_HTML.gif](img/509088_1_En_7_Figd_HTML.gif) |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Fige_HTML.gif](img/509088_1_En_7_Fige_HTML.gif) |   |   |
| [22] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figf_HTML.gif](img/509088_1_En_7_Figf_HTML.gif) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figg_HTML.gif](img/509088_1_En_7_Figg_HTML.gif) |   |   |   |   |
| [23] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figh_HTML.gif](img/509088_1_En_7_Figh_HTML.gif) （不包括 CoinJoin） |   |   |   |   |   |
| [24] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figi_HTML.gif](img/509088_1_En_7_Figi_HTML.gif) （不包括 CoinJoin） | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figj_HTML.gif](img/509088_1_En_7_Figj_HTML.gif) |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figk_HTML.gif](img/509088_1_En_7_Figk_HTML.gif) |   |
| [25] |   |   |   |   |   |   |
| [26] |   |   |   |   |   |   |
| [27] |   |   |   |   |   |   |
| [28] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figl_HTML.gif](img/509088_1_En_7_Figl_HTML.gif) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figm_HTML.gif](img/509088_1_En_7_Figm_HTML.gif) |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Fign_HTML.gif](img/509088_1_En_7_Fign_HTML.gif) |   |
| [11] |   |   |   |   |   |   |
| [12] |   |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figo_HTML.gif](img/509088_1_En_7_Figo_HTML.gif)  收益概况 |
| [13] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figp_HTML.gif](img/509088_1_En_7_Figp_HTML.gif) |   |   |   |   |   |
|  [14] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figq_HTML.gif](img/509088_1_En_7_Figq_HTML.gif) |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figr_HTML.gif](img/509088_1_En_7_Figr_HTML.gif) |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figs_HTML.gif](img/509088_1_En_7_Figs_HTML.gif) 常见关系 |

**多/常见输入所有权。** 启发式方法假设一个交易的所有输入由同一个实体控制并将所有输入关联到该实体。由于一个交易的输入只能通过提供其签名来赎回，所以不同用户联合创建交易的可能性不大 [18]。图 2 说明了该启发式方法，其中假设所有地址（![$$A_1$$](img/509088_1_En_7_Chapter_TeX_IEq14.png), ![$$A_2$$](img/509088_1_En_7_Chapter_TeX_IEq15.png), ![$$A_3$$](img/509088_1_En_7_Chapter_TeX_IEq16.png)) 由一个实体（爱丽丝）控制。为了防止误报，分析中排除了 CoinJoin 交易 [21]。CoinJoin [29] 是实践中采用的最著名的混淆技术之一。在混淆技术中，用户将他们的未花费交易输出（UTXOs）与其他用户的 UTXOs 混合，以模糊输入和输出之间的关系。在 CoinJoin 中，用户共同创建和签署交易以模糊常见输入所有权启发式方法。CoinJoin 交易应以等值输出形式创建，以防止链接输入和输出地址，这使得它们在区块链中可区分。

**变化地址。** 启发式方法假设交易的 change address 由输入的所有者控制 [10]。下面是一份用于识别变化地址的常见启发式方法的列表。

+   **新地址：** 如果另一个地址在区块链中出现过，一个新地址的输出可以是变化地址 [10]。

+   **脚本类型：** 如果所有输入具有相似的脚本（例如，Pay-to-PubkeyHash (P2PKH)，Pay-to-Script-Hash(P2SH)），则唯一的输出具有相似脚本的地址可以是变化地址 [30]。

+   **相同的输入和输出：** 一个既是交易输入地址又是输出地址的地址可以是变化地址 [30]。

+   **最优变化：** 所有输入金额都比它少的输出地址可以是一个变化地址 [30]。

+   **精确数值：** 非精确数值的输出值可以是变化地址 [30, 31]，因为付款金额通常是精确数值。

+   **钱包指纹：** 钱包以不同方式创建交易，这可以用来揭示变化地址 [31]（例如，变化输出索引、锁时间行为匹配 [30]）。

+   *剥离链：*在剥离链交易中（一个地址有大额支付到其他地址的交易），继续剥离的输出可以是找零地址[30]。

![../images/509088_1_En_7_Chapter/509088_1_En_7_Fig2_HTML.png](img/509088_1_En_7_Fig2_HTML.png)

图 2。

多/常见输入所有权启发式

**地址复用。**每次使用同一个地址时，它都会将当前交易与该地址之前出现的所有交易关联起来。这导致所有使用相同地址的交易之间可能存在相关性[32]。还有强制地址复用，其中攻击者向目标的已使用地址支付一小笔比特币，并跟随区块链中的地址以找到属于用户的其它未使用的交易输出（UTXO），如果目标将这个 UTXO 与她在后续交易中的其他 UTXO 结合[31]。

**单输入单输出。**只有一个输入和一个输出的交易被视为自付交易，输入和输出地址可以与一个实体关联。实际上，在大多数情况下，支付交易包括多个输入和输出[21]。

**聚类增长。**聚类通常以小步骤增长，如果应用启发式创建了一个大聚类，那将是由于假阳性[28]。

**特定模式。**可以采用基于从用户和交易行为中提取的模式的新启发式。例如，[12]通过分析他们的真实情况找到了报酬模式。在[14]中，他们发现了交易服务中地址之间的常见关系，其中从同一个地址接收硬币或向同一个地址发送硬币可以表明共同的社交关系。

### 3.3 侧信道攻击

在分叉的区块链中，信息如时间、金额、网络信息或用户行为的相关性可能被用来揭示用户或交易行为，从而泄露他们的隐私。表 4 总结了此类侧信道攻击，我们将在下面进行解释。

**时间相关性。**攻击者可以将一个交易被确认的时间（考虑适当的阈值）与用户与其他服务互动的时间相关联。在提供的表格中，我们列出了使用这种攻击来查找交易服务中的交易并将它们与区块链数据关联以找到相关交易的研究[13, 14]。

**金额相关性.** 攻击者可以将区块链上转移的金额与在其他服务中支付的金额（无论是法定货币还是其他加密货币）相关联，后者可以通过网站或应用程序编程接口（API）公开看到。在 [13, 14] 中，交易服务中可用的公共交易金额被用来找到与区块链上相应的交易。攻击者还可以获取法定货币（如果用法定货币支付）的汇率，以及交易确认的时间和日期，并在这一时间段内查找。

**网络层信息.** 节点间交易的传播可以揭示网络层的数据。研究 [11, 26–28] 表明可以将节点的 IP 地址与交易联系起来。为此，他们连接到比特币节点并监听网络，以找到最初传播交易的节点。还提到，访问模式可以用来将用户与加密货币地址相关联。例如，访问带有捐赠地址的网页，然后进行交易并在区块浏览器中查看确认，可以提供一个将 IP 地址与该交易关联的访问模式 [19]。

**分叉处提现.** 跨链聚类可以根据从分叉链聚类中获得的信息创建基于单一链的聚类。这种攻击基于分叉链中地址的活动，将一个链中的地址相关联 [21]。研究者 [21] 结合了比特币和比特币现金的聚类，并发现几乎 5% 的比特币交易的隐私受到基于他们在比特币现金中的提现行为威胁。

### 3.4 流量分析

攻击者可以通过交易图、用户图和污染分析追踪资金流向。表 4 列出了应用图进行分析的出版物。

**交易图.** 在交易图中，地址是节点，交易是边，攻击者可以通过这个图找到前驱和后继 [20]。图 3 展示了一个示例交易图，其中 Alice 持有 6 BTC，并通过交易 T[1] 从她的地址 A[1] 向 Bob 的地址 B[1] 发送 2 BTC，因为她地址里有 6 BTC，所以在找零地址 A[2] 收到了 4 BTC。然后 Bob 通过交易 T[2] 向 Carol 发送 3 BTC，使用了之前从 T[1] 的输出接收的 2 BTC 和另一个交易的输出中的 2 BTC。如图所示，T[2] 有两个输出，Bob 用其中一个作为找零（B[3]）并获得 3 BTC，支付给 Carol。![../images/509088_1_En_7_Chapter/509088_1_En_7_Fig3_HTML.png](img/509088_1_En_7_Fig3_HTML.png)

Fig. 3.

交易图，取自 [33]

**污染分析。** 此分析跟踪资金从一个地址流向另一个地址[10]。它被定义为输出地址余额中来自输入地址的百分比[18]。

**用户图。** 在用户图中，用户是节点，交易是边，通过创建聚类（例如，使用启发式方法），此图可以发现区块链中不同用户之间的关系。表 4。

侧信道攻击和流量分析

|   | 时间相关性 | 金额相关性 | 网络层 | 在分叉中兑现 | TX 图/用户图 | 污染分析 |
| --- | --- | --- | --- | --- | --- | --- |
|   |   |   | *将 IP 映射到伪名* | *访问模式/*用户行为模式 |   |   |   |
| --- | --- | --- | --- | --- | --- | --- | --- |
|  [20] |   |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figt_HTML.gif](img/509088_1_En_7_Figt_HTML.gif) |   |
|  [19] |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figu_HTML.gif](img/509088_1_En_7_Figu_HTML.gif) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figv_HTML.gif](img/509088_1_En_7_Figv_HTML.gif) |   |   |   |
|  [21] |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figw_HTML.gif](img/509088_1_En_7_Figw_HTML.gif) (BCH&BTC 结合) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figx_HTML.gif](img/509088_1_En_7_Figx_HTML.gif) |   |
|  [22] |   |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figy_HTML.gif](img/509088_1_En_7_Figy_HTML.gif) |   |
|  [23] |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figz_HTML.gif](img/509088_1_En_7_Figz_HTML.gif) |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figaa_HTML.gif](img/509088_1_En_7_Figaa_HTML.gif) |   |
|  [24] |   |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figab_HTML.gif](img/509088_1_En_7_Figab_HTML.gif) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figac_HTML.gif](img/509088_1_En_7_Figac_HTML.gif) |
|  [25] |   |   |   |   |   |   |   |
|  [26] |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figad_HTML.gif](img/509088_1_En_7_Figad_HTML.gif) |   |   |   |   |
|  [27] |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figae_HTML.gif](img/509088_1_En_7_Figae_HTML.gif) |   |   |   |   |
|  [28]  |  |  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figaf_HTML.gif](img/509088_1_En_7_Figaf_HTML.gif)  |  |  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figag_HTML.gif](img/509088_1_En_7_Figag_HTML.gif)  |  |
|  [11]  |  |  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figah_HTML.gif](img/509088_1_En_7_Figah_HTML.gif)  |  |  |  |  |
|  [12]  |  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figai_HTML.gif](img/509088_1_En_7_Figai_HTML.gif) (BTC in $)  |  |  |  |  |  |
|  [13]  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figaj_HTML.gif](img/509088_1_En_7_Figaj_HTML.gif)  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figak_HTML.gif](img/509088_1_En_7_Figak_HTML.gif)  |  |  |  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figal_HTML.gif](img/509088_1_En_7_Figal_HTML.gif)  |  |
|  [14]  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figam_HTML.gif](img/509088_1_En_7_Figam_HTML.gif)  | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figan_HTML.gif](img/509088_1_En_7_Figan_HTML.gif)  |  |  |  |  |  |

### 3.5 辅助信息

攻击者可以通过搜索互联网、与目标互动、使用服务 API 等方式给地址打标签。前述启发式、侧信道攻击和流量分析找到了地址之间的关系，因此，如果攻击者给一个地址打标签，他就能够给与这个地址相关的其他地址打标签。攻击者不仅可以给地址打标签，在某些情况下，还可以获取有关位置、电子邮件、用户名等信息。表 5 显示了在选定的论文中用于标记地址的资源。一些实体在论坛、社交网络和网站上发布他们的地址。如表 5 所示，Bitcointalk、Reddit、Twitter 是找到比特币地址知名资源 [13, 20, 22]。发布在网站上的地址，以及可以在搜索引擎中查询的地址可以识别关于地址的信息。服务的 API 还提供一些与地址相关的额外信息（例如，来自交易服务的信息，如 Localbitcoins、Changelly、Shapeshift） [13, 14, 20]。一些攻击者与服务互动以获取属于特定服务的地址 [23]，这也被称为神秘购物支付 [31]，其中攻击者支付一小笔钱，并跟随与服务相关的区块链上的地址。它们是非商业和商业数据库，根据他们发现的事实提供地址标签，Walletexplorer、Chainalysis、blockchain.info，以及一些发布他们地址标签的研究人员是使用标记地址的数据库的例子 [14, 23, 25]。表 5 提供了先前研究用于标记地址的资源。表 5.

辅助信息资源

|   | 论坛 | 网站 | 搜索引擎 | 社交网络 | 服务 API | 互动 | 地址标签数据库 | 其他 |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
|  [20] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figao_HTML.gif](img/509088_1_En_7_Figao_HTML.gif) BitcoinTalk,Bitcoin-OTC | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figap_HTML.gif](img/509088_1_En_7_Figap_HTML.gif) Casasciusphysical coins | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figaq_HTML.gif](img/509088_1_En_7_Figaq_HTML.gif) Google | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figar_HTML.gif](img/509088_1_En_7_Figar_HTML.gif) Reddit | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figas_HTML.gif](img/509088_1_En_7_Figas_HTML.gif) Mt.Gox |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figat_HTML.gif](img/509088_1_En_7_Figat_HTML.gif) blockchain.info |   |
|  [19] |   |   |   |   |   |   |   |   |
|  [21] |   |   |   |   |   |   |   |   |
|  [22] |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figau_HTML.gif](img/509088_1_En_7_Figau_HTML.gif) BleepingComputer，MalwareTips，2-spyware | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figav_HTML.gif](img/509088_1_En_7_Figav_HTML.gif) Google，Yahoo | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figaw_HTML.gif](img/509088_1_En_7_Figaw_HTML.gif) Reddit |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figax_HTML.gif](img/509088_1_En_7_Figax_HTML.gif) ![$$^\dagger $$](img/509088_1_En_7_Chapter_TeX_IEq17.png) |
|  [23] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figay_HTML.gif](img/509088_1_En_7_Figay_HTML.gif) BleepingComputer![$$^{\pm \pm }$$](img/509088_1_En_7_Chapter_TeX_IEq18.png) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figaz_HTML.gif](img/509088_1_En_7_Figaz_HTML.gif) ID 勒索软件 |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figba_HTML.gif](img/509088_1_En_7_Figba_HTML.gif) ![$$^{\star \star }$$](img/509088_1_En_7_Chapter_TeX_IEq19.png) | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbb_HTML.gif](img/509088_1_En_7_Figbb_HTML.gif) Chainalysis | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbc_HTML.gif](img/509088_1_En_7_Figbc_HTML.gif) 人造地址 ![$$^{\dagger \dagger }$$](img/509088_1_En_7_Chapter_TeX_IEq20.png) |
|  [24] |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbd_HTML.gif](img/509088_1_En_7_Figbd_HTML.gif) Ahmia,FreshOnions,Google |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbe_HTML.gif](img/509088_1_En_7_Figbe_HTML.gif) Walletexplorer, |   |
|  [25] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbf_HTML.gif](img/509088_1_En_7_Figbf_HTML.gif) BitcoinTalk ![$$^\star $$](img/509088_1_En_7_Chapter_TeX_IEq21.png) |   |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbg_HTML.gif](img/509088_1_En_7_Figbg_HTML.gif) Walletexplorer,blockchain.info |   |
|  [26] |   |   |   |   |   |   |   |   |
|  [27] |   |   |   |   |   |   |   |   |
|  [28] |   |   |   |   |   |   |   |   |
|  [11] |   |   |   |   |   |   |   |   |
|  [12] |   |   |   |   |   |   |   |   |
|  [13] | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbh_HTML.gif](img/509088_1_En_7_Figbh_HTML.gif) BitcoinTalk | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbi_HTML.gif](img/509088_1_En_7_Figbi_HTML.gif) Localbitcoins |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbj_HTML.gif](img/509088_1_En_7_Figbj_HTML.gif) Twitter | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbk_HTML.gif](img/509088_1_En_7_Figbk_HTML.gif) Localbitcoins |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbl_HTML.gif](img/509088_1_En_7_Figbl_HTML.gif) Walletexplorer, |   |
|  [14] |   |   |   |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbm_HTML.gif](img/509088_1_En_7_Figbm_HTML.gif) Changelly,Shapeshift |   | ![../images/509088_1_En_7_Chapter/509088_1_En_7_Figbn_HTML.gif](img/509088_1_En_7_Figbn_HTML.gif) Walletexplorer,研究人员数据， |   |

![$$^{\pm \pm }$$]在 Bleeping 计算机论坛上的勒索地址。

![$$^\dagger $$]勒索软件知识库，YouTube 视频，来自威胁对策单位（CTU），事件响应（IR）和安全运营中心（SOC）的报告。

![$$^{\dagger \dagger }$$]通过运行勒索软件二进制文件。

![$$^\star $$]提取庞氏地址、个人资料、年龄、性别、地点等信息...

![$$^{\star \star }$$]向勒索地址支付少量资金。

## 4 BTCR 隐私问题及可能的对策。

在本节中，我们根据 RFC 6973 采纳的标准[9]，包括监控、误归因、关联、识别、二次使用和披露，研究基于方法 did:btcr 的隐私。

### 4.1 监控

任何对用户的观察和监控都被视为监控，无论用户是否意识到这种监控，它都可能影响用户的隐私[9]。在上一节中，我们展示了监控用户并将现实世界身份与比特币地址关联的可能性，这可能会泄露用户的活动和他们的经济状况。在比特币区块链上对 DID 的监控可以从不同方面进行调查。通过与使用 DID 的服务进行互动，可以获得辅助信息。因此，服务提供商能够利用比特币隐私攻击跟踪用户在区块链上的活动资金流。例如，一个支付服务，用户使用 DID 对设备进行身份验证，然后使用属于她的另一个比特币地址进行支付，将 DID 与那个比特币地址关联起来。此外，当用户使用不可变的区块链创建 DID 时，应考虑的隐私问题起着重要的作用。意识到这些问题存在的用户可以采用保护隐私的技术来防御这类隐私攻击。先前的研究[34, 35]指出人们对比特币区块链的隐私存在误解，这可能会对使用区块链技术的应用程序造成严重问题。使用 Tor 服务[15]，在使用 DID BTCR 之前混合 UTXO[8]，以解除 BTCR UTXO 与其他属于用户的 UTXO 之间的关系，并防止将来将作废的 DID BTCR 与其他 UTXO 结合使用，从而花费与 UTXO 相关的金额，这些可以作为对抗 DID BTCR 监控的可能对策。

### 4.2 误归因

每当用户的数据或通信被错误地归因于他人时，就认为是误 attribution，这可能会随后影响用户的声誉 [9]。一些不可区分的混合技术，如 PayJoin [36] 可以将用户的 UTXOs 关联到其他人，使用常见的输入所有权启发式 [37]。PayJoin [36] 是 CoinJoin 技术的继承者之一，用户通过交易接收者创建一个 CoinJoin 交易。接收者将她的币作为交易的一个输入，这会增加支付金额。因此，这种技术不需要等额输出，在区块链上是不可区分的。这会对使用 PayJoin 作为隐私技术或与实现 PayJoin 的服务（例如，商家、交易所）交互的用户造成隐私问题，这些用户没有意识到这个问题。因此，在 did:btcr 中使用比特币区块链进行 DIDs 可能会让用户面临这种隐私误 attribution 的风险。为用户提供信息，让他们了解使用特定混合技术（如 PayJoin）可能导致的误 attribution，可以在一定程度上预防这个问题。

### 4.3 相关性

相关性被认为是不同信息的组合，这些信息与同一用户相关联 [9]。我们从三个不同的角度讨论相关性，包括 DID 与 DID 文档的相关性、时间相关性和网络相关性。 (i) 使用相同的 DID 或 DID 文档与不同服务互动可以帮助追踪和关联用户活动 [5, 15, 38]。此外，不同 DID 文档中使用相同的公钥可以揭示相应 DID 之间的联系，例如，使用相同 DID 与不同服务互动，同时展示不同的身份证明(VC)。反之，如果每个服务都使用不同的 DID，而使用相同的 DID 文档，那么这些服务可以将这些多个 DID 关联到同一用户。基于每种关系发行的成对唯一 DID，无法相互关联或一次性标识符，一旦交换就会被丢弃，可用于减轻此问题 [39]。另一个问题是 DID 文档包含验证 DID 及其属性的方法，包括“也称为”和“控制器” [15]。使用“也称为”，可以指定属于同一用户的另一个标识符。这对于使用多个 DID 的企业可能有用，但如果不是必需的，应避免使用。使用“控制器”，可以指定另一个实体，该实体随后被允许更改 DID 文档或进行身份验证。如果它们不同，这可能会揭示主题与控制器 DID 之间的关系。 (ii) 考虑网络层相关性，实体的 IP 地址可能泄露共同控制的关系，其中攻击者可以根据客户端的 IP 地址识别不同 DID 之间的联系 [39]。此外，通过检查对 DID 文档的访问历史进行流量分析，可能有助于将 IP 地址与 DID 文档关联。使用 TOR 或代理可以提供额外的隐私 [15]。 (iii) 通过使用相同的服务的终端节点来实现时间相关性，可以用来发现共同控制的关系 [39]。例如，可以通过分析用户在 DID 文档中使用相同服务终端节点时的活动时间来关联用户活动。将各种由不同实体控制的 DID 之间共享服务终端节点 [15] 可以视为一种可能的应对措施。

### 4.4 识别

身份识别被认为是将信息与特定用户相关联以获取其身份[9]。在区块链中存储任何类型的个人可识别信息（PII），即使它是加密或散列的，也有可能将用户隐私置于风险之中，因为这些信息可能被破解并公开可用[5, 7, 15, 38]。尽管支持 DID 撤销，但不可变性属性阻止了删除现有 BTCR DID 的日志。因此，如果与 DID 关联的比特币地址后来使用其他输入而不使用混合技术（也将被视为撤销），它可以根据他 uristic 的公共输入所有权将 DID 使用的地址与其他用户拥有的地址关联。此外，如果 BTCR 中的交易（当它被撤销时）包含一个变化地址，它可以与输入的所有者关联。因此，建议创建不包含变化地址的交易。不仅区块链分析可以识别现实世界的身份并将它们与 DID 相关联，而且 DID 文档中的元数据跟踪也可以提供实体识别的信息。DID 文档的可见性可能会泄露关于属性的元数据[6]并提供有关服务端点的信息。在 BTCR 中，攻击者可以查询比特币区块链以识别所有具有![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq27.png)的交易，该交易指定对 DID 文档的链接，从而启用访问元数据和相关服务端点。为了防止任何隐私泄露，服务端点的 URL 不应包含任何个人信息（例如用户名）。通常，DID 文档存储在服务器上。如果 DID 文档存储在第三方服务器上，后者可能会识别真实的 DID 所有者。如果 DID 文档存储在用户自己的服务器上，则可以将用户 IP 地址与 DID 文档相关联。在这种情况下，可以使用 IPFS（星际文件系统）[3]作为对策。

### 4.5 二次使用

二次使用被认为是未经用户同意收集其信息，并将其用于除了收集时所声明的目的之外的其它用途[9]。我们在 did:btcr 中从三个方面调查二次使用。（i）读取/解析功能使得如果一个 DID 被第三方服务（例如，通用 DID 解析器，简化支付验证（SPV）客户端的朴素实现[40]，在区块浏览器上检查 DID）访问，追踪 DID 的使用变得可能，在这种情况下，攻击者可以找到解析模式。为了防止第三方服务收集关于用户的信息，用户可能会运行自己的比特币全节点。（ii）验证者能够追踪交易流程，检查 UTXO 的历史（例如用户活动），如果它们被花费（意外地或者为了改变所有权，或者吊销），监控下一笔交易的流程。验证者还可以看到与该地址关联的所有金额。（iii）如果 DID 在需要了解其信息或活动的服务中被使用（例如，社交网络），那么 DID 的真实身份可能会被泄露。

### 4.6 信息公开

信息公开被认为是违反了共享数据保密性，暴露了关于用户的信息[9]。前几节中提到的所有隐私攻击都可以应用于在 did:btcr 中作为 DID 使用的地址。如果不熟悉比特币区块链中的隐私问题，用户可能会遇到一些严重问题，如果他们的 DID 地址链接到区块链中的其它地址。这可能会导致他们在使用 DID 进行身份验证的服务中失去经济活动的隐私。为了在 BTCR 中创建第一个 DID，用户应该提供一个地址，她可以在该地址从交易所购买比特币。交易所可以访问与所有者相关的信息（如电子邮件地址等），在某些情况下，当应用 KYC（了解你的客户）时，还可以访问所有者的真实身份。用户可以预先使用混淆技术[8]，使 UTXO 在 BTCR 中的使用与属于她的其它 UTXO 之间的关系变得模糊。BTCR 更新需要包含![$$OP\_RETURN$$](img/509088_1_En_7_Chapter_TeX_IEq28.png)字段；因此，用户无法利用当前的混淆技术为与其关联的地址提供更好的隐私。这使得 BTCR 更新在比特币区块链上可追踪。因此，BTCR 中的每一次更新不仅揭示了先前 DID 的公钥，还指示了访问控制的更新或更改。

## 5 结论

在本文中，我们呈现了对比特币隐私攻击的回顾，我们将这些攻击分成了四大类。然后，我们调查和分析了可能对 DID 方法 did:btcr 构成威胁的六种隐私风险。特别是，我们展示了如何利用复杂的启发式方法分析比特币公共记录，并结合辅助信息揭示或关联用户的事务、身份或地址。这些信息反过来又可能被恶意行为者和网络犯罪分子用于实施例如勒索或勒索软件攻击。本研究证明，尽管 BTCR 提供了诸如抵抗审查、保护完整性、提供访问和一定程度的去中心化等优势，但它仍然缺乏解决本文指出的隐私问题的方法。未来的研究将致力于阐述和发展新方法，或使用现有的隐私增强技术（例如，混合技术，零知识证明）来解决上述隐私问题。

致谢

这项研究部分得到了以下机构的支持：(1) SBA Research (SBA-K1); SBA Research 是 COMET 中心的一部分，COMET – 卓越技术竞争力中心计划由 BMK、BMDW 和维也纳联邦州资助。COMET 计划由 FFG 管理。(2) FFG ICT 未来项目 874019 dIdentity & dApps。(3) FFG 小型项目计划 39019756 数字身份的的去中心化市场。

© Springer Nature 瑞士 AG 2021J. González Enríquez 等人（编辑）商业流程管理：区块链与机器人流程自动化论坛讲座笔记在商业信息处理 428[`doi.org/10.1007/978-3-030-85867-4_8`](https://doi.org/10.1007/978-3-030-85867-4_8)

# 用去中心化预言机增强基于区块链的流程

达维德·巴齐莱^(1  )，瓦莱里奥·戈雷蒂^(1  )， Claudio·迪·西西奥^(1  ) 和 Sabrina·基兰^(2  )(1)罗马“Sapienza”大学，罗马，意大利(2)维也纳经济大学，维也纳，奥地利达维德·巴齐莱电子邮件: basile.1810355@studenti.uniroma1.it 瓦莱里奥·戈雷蒂电子邮件: goretti.1811110@studenti.uniroma1.it Claudio·迪·西西奥（通讯作者）电子邮件: claudio.diciccio@uniroma1.itSabrina·基兰电子邮件: sabrina.kirrane@wu.ac.at

## 摘要

通过基于区块链的系统实现业务流程的自动化，可以实现执行过程中的信任、可靠性和可追溯性。连接在链上模块和链下世界的链接至关重要，因为流程通常涉及实体物理对象的处置和外部服务。创建此链接的组件被称为预言机。文献中关于预言机及其实现的研究越来越多。然而，如果采用集中式架构，它们的可用性、完整性和信任可能会受到威胁，因为控制预言机可能会对整个系统产生供应链攻击的效果。有一些解决方案正在出现，它们通过将预言机下方的架构转变为分布式来克服这个问题。在本文中，我们研究了预言机的设计和应用，区分了它们在信息流入或流出时的采用情况，以及根据交易所的发起者（因此，基于拉取或推送）。

关键词 去中心化应用 业务流程管理 分布式架构

## 1 引言

自从区块链世界相关的技术诞生以来，它们一直在不断演变。特别是，其去中心化的方面为去中心化应用程序（DApp）提供了一个发展环境，其中数据完整性和一致性是关键因素 [12]。然而，在这样平台上开发的应用程序无法从链下世界获取信息，也不能直接改变外部世界的状态 [3, 5]。因此，为了将区块链与现实世界连接起来，引入了名为预言机的中间组件 [18, 25]。

在多个方之间协调业务流程是 DApps 展示潜力的一个用途 [8, 16]。特别是在这种场景下，预言机代表了与外部信息源的信任链接。错误信息或假冒信息的可能性可能会对各方产生重大的财务影响 [13, 23]。通过分布式和去中心化传输的信息，并使用冗余程序，大大降低了这类问题的发生概率——这也是区块链核心驱动因素之一。实际上，去中心化通过消除与单点故障相关的问题，增加了传输操作的健壮性和安全性 [11]。

本文研究了去中心化区块链预言者架构在可用性、完整性和信任方面的效果。特别是，我们检查了以太坊平台上的去中心和集中预言者的设计和实现，按照[18]中描述的模式进行分类。与预言者的典型场景不同，我们考虑了不同离线源保留待收集信息的独立部分，或不同的目标从区块链接收信息的情况。随后，我们根据延迟和成本对所提出的实现进行了评估。

本文的其余部分结构如下。第二部分介绍了区块链平台、以太坊生态系统以及区块链预言者的必要背景知识。第三部分引入了引导我们工作的激励性用例场景。第四部分概述了我们的区块链预言者概念框架。第五部分提供了我们性能评估的概览，而第六部分则识别了开放挑战和机遇。最后，在第七部分我们提出了结论和对未来工作的计划。

## 2 背景

以下内容将简要介绍区块链的背景知识，特别关注以太坊生态系统和区块链预言者。

### 2.1 区块链：定义和应用

区块链是一种分布式数据结构管理的协议，其中交易按顺序存储在只追加列表（账本）中。账本的更新通过构建和验证（即挖矿）的顺序块进行通信，然后广播到网络中的节点。账本在网络的所有节点上复制。节点通过共识算法[26]就下一个区块信息的包含达成一致。其去中心化、持久性和不可变性特点使区块链适合于自动化系统的需求，其中记录了多个不可信方之间的交互[10]。这种系统长期以来主要用于通过加密货币交易进行支付，因为其基础设施允许在没有外部权威实体仲裁的情况下存储和调节交换[19]。

随着以太坊的诞生[5]，第二代区块链平台应运而生，区块链从主要作为电子现金分布式管理系统转向成为去中心化应用（DApps）[17]的基础分布式编程平台。特别是，以太坊通过以太坊虚拟机（EVM）使智能合约（即暴露变量和可调用方法的具有状态的软件工件）在区块链环境中得以部署和运行。部署的智能合约代码存储在区块链本身中。每当用户与智能合约方法交互时，都会生成一条新交易。由于代码是由 EVM 执行而非本地执行，用户需要支付费用（所谓的“燃料费”）作为计算力使用的补偿。用户可以指定他们愿意支付的最高限额以及每单位燃料的价格，以以太坊原生加密货币（以太币）计价。需要支付的燃料费与代码的复杂性和涉及的操作成比例。

请注意，智能合约可以从链下调用，在方法执行期间，与其他智能合约在链上领域内交换消息。然而，为了保持一致性和确定性，链上代码不能直接调用链下程序。以太坊智能合约可以发射所谓的事件[7]，即开发人员指定的包含在交易中的数据字段，通常标记执行的相关阶段。链下软件工件可以订阅这些事件，以对信号的状态做出反应。

新能力解锁了区块链的一系列新应用领域，包括保险和音乐等行业，以及物联网和网络安全等领域[1, 20]。正如 Tareq Ahram 等人[23]所强调的，区块链的一个关键应用领域是供应链管理。在这种场景下，区块链用于记录供应链每一步产生的数据，通过创建生产的产品或提供的服务的不可变历史。这样，区块链可以极大地简化资产记录和发票、支付和订单的跟踪。第三部分中的激励用例场景就是源于这个领域。表 1.

预言机分类[18]

| 信息流动方向 |   | 信息交换发起者 |
| --- | --- | --- |
|   | 拉 | 推 |
| 入 | 链上组件需要从外部世界获取信息 | 链下组件初始化流程并将数据从区块链外发送 |
| 出 | 链下组件需要从区块链获取信息 | 链上组件初始化流程并将数据从区块链发送到外部世界 |

![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig1_HTML.png](img/509088_1_En_8_Fig1_HTML.png)

图 1.

用例场景的 BPMN 图表

### 2.2 区块链预言机

以太坊区块链上开发的 DApp 多样性凸显了确保区块链数据健壮性、一致性和持久性的需求，这需要定义一个结构化上下文，使得该技术作为一个封闭和自包含系统无法与外部世界通信 [17, 25]。智能合约无法访问未存储在链上的数据，这可能是许多应用场景（如多方业务流程）的制约因素。解决这一问题的方法就是预言机 [24]。预言机可以被视为一座桥梁，允许链上与链下世界之间的通信。DApp 应该能够像信任链上信息一样信任预言机。预言机的可靠性是关键 [2, 15]。此外，预言机肩负着在区块链应用与不同外部实体之间充当链接的艰巨任务，这些实体可能具有不同的技术和机制。因此，指定并共享一个定义良好的协议对于服务的正常运行至关重要。Mühlberger 等人 [18] 描述了考虑两个维度的预言机模式：信息方向（入站或出站）和信息交换的发起者（基于拉取或推送）。入站预言机从外部将数据注入区块链，而出站预言机将从区块链传输信息到外部。基于拉取的预言机是指信息发起者是信息的接收者，而基于推送的预言机是指信息发起者是信息的发送者。通过结合基于推送/拉取和入站/出站的分类，他们定义了四种预言机设计模式。表 1 总结了这些类型的预言机：基于拉取的入站预言机（以下简称*拉取入*预言机）用于当链上组件启动程序并将现实世界的数据注入。基于推送的入站（简称*推入*）预言机是由链下组件用来向区块链发送数据。基于拉取的出站（简称*拉取出*）预言机用于当链下组件需要从区块链检索数据。最后，基于推送的出站（简称*推出*）预言机允许链上组件将信息传输到区块链之外。除了信息方向，Beniiche [3] 根据信息的来源（人类、软件或硬件）以及它们的集中或去中心化架构，将现有的预言机解决方案进行分类。本文关注的是去中心化预言机的设计和使用，这些预言机在基于区块链的流程执行上下文中实现上述四种模式之一。

## 3 激励性用例场景

图 1 展示了涉及供应链的多方订单到收款业务流程，该供应链以 BPMN 协作图的形式表示[9]。本文将以此流程作为一个持续的例子，并指出去中心化预言的使用。我们回顾一下，根据 Mühlberger 等人[18]的分类，预言根据信息流的方向分为入站或出站，根据信息交换的发起者分为基于拉或基于推。

工作流程的第一部分中，供应商想要验证客户的信用状况。这一验证是基于使用拉入预言。如果验证结果为阳性，供应商下订单并安排发货。如果验证失败，则拒绝订单。预言的去中心化架构允许检索关于信用状况的分布式信息，因为客户在多个信贷机构有开立的账户。我们假设关于客户的敏感信息通过使用现有的隐私保护记录链接技术[21]得到妥善保护，防止恶意处理或泄露。一旦订单下单，并将产品交给快递员，发运程序就开始启动。与此同时，供应商通过推出预言将购买订单的数据记录到一个外部的分布式数据库中。预言的去中心化架构符合向由多个节点组成的目标发送数据的需求，在我们的场景中，分布式数据库求助于物理实例。之后，供应商在区块链上注册发票。与此同时，快递员交付订购的产品。在客户一方，质量控制专家检查委托商品是否符合标准。如果是这样，推入预言利用区块链作为证明手段记录交货成功。请注意，这段文字需要三个参与者基于三个不同的信息位给出他们的确认：快递员（对于托运货物）、质量控制专家（对于委托材料的状况）和客户（对于货物的接收）。因此，推入预言也是去中心化的，因为它需要多个参与方的确认。最后，银行可以解锁支付。在接到订单处理完成的通知后，银行验证发票是否存储在区块链上。作为一种连续的安全层，它从多个物理上不同的区块链节点检索数据——从而使用一个去中心化的基于拉的预言。

在接下来的部分，我们将展示一个可能适用于上述预言机类别的去中心化版本的参考架构。![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig2_HTML.png](img/509088_1_En_8_Fig2_HTML.png)

图 2。

大规模的去中心化预言机架构

## 4 去中心化预言机

标志着中心化预言机的主要限制是存在一个唯一的操作单元，该单元负责在区块链与外部环境之间实现信息流动。这一特殊方面可能会导致几个关键问题，从而将整个生产链置于风险之中。第一个问题是可能存在单点故障的问题，因为预言机可能是网络攻击的薄弱环节。有趣的是，注意到注入恶意代码的受信任软件组件的攻击被称为（软件）供应链攻击 [22]。确实，由于架构只提供一个操作单元，潜在的故障决定了（可信）通信的结束和可用性的潜在损失。此外，集中化需要对传输的信息有更大的保证。负责通信的单一组件不能容忍错误或不一致的数据。

相反，去中心化的预言机依赖于多个独立组件来发送和接收信息。在这种情况下，预言机变成了一个由内部协议（如自己的共识机制或激励策略）调节的信息分发网络 [14]。可能采用不同的方法来解决预言机的共识问题。例如，市场上一些现有的系统，如 Gnosis^(1)和 Augur^(2)采用投票机制与人工预言机相结合。其他系统，如 Chainlink，^(3)提出了一种完全自动化的多数方法。那些网络的管理细节超出了论文的范围。我们参考[4]，以了解一个设想中的去中心化预言机网络背后的机制。

在不失一般性的假设下，我们假设预言机的行为公平，并且内部共识算法基于所有参与组件的协议。在其余部分，我们将展示如何将去中心化应用于预言机。![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig3_HTML.png](img/509088_1_En_8_Fig3_HTML.png)

图 3。

与去中心化拉入预言机的交互序列图

### 4.1 架构概述

无论考虑的是哪种类型的数据，预言机（oracles）都可以分为两个主要层次，如图 2 所示。链上层次负责预言机系统与链上世界之间的交互。在其内部有一个单一的软件组件，即一个功能完备的智能合约，可以被视为希望使用该特定预言机系统的去中心化应用（DApp）的入口点。DApp 与链上层次的交互由预言机自身的交互协议定义。离线层次用于管理现实世界与预言机之间的交互。预言机的两个组件可以通过向对方发送数据来进行通信。在以太坊生态系统中，当链上层次向离线层次发送数据时，它会生成一个新的事件，其中包含相关信息，然后在离线层次中被捕获。离线层次可以通过使用后者的智能合约公开的方法，通过带有必要输入的交易向链上层次发送数据。架构的去中心化发生在离线层次内部，因为多个外部模块与链上世界交互并独立操作，以从离线环境获取数据或向其发送数据。

以下内容将详细介绍我们为描述在[18]中的四个类别中的每一个而去中心化的预言机架构的设计。为了简洁起见，我们将预言机的链上组件称为链上预言机，将离线层次内的组件称为离线预言机。![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig4_HTML.png](img/509088_1_En_8_Fig4_HTML.png)

图 4。

与去中心化推出预言机的交互序列图

### 4.2 去中心化拉入预言机

在拉取 Oracle 中，交互始于智能合约（实现流程逻辑）对链上 Oracle 的调用，如图 3 的序列图所示。考虑到第三部分的运行示例，拉取 Oracle 的目的是将去中心化应用与多个信贷机构连接起来，以验证客户的信用状况——只有在所有信贷机构都同意的情况下才会得到确认。运行检查活动的智能合约与 Oracle 的链上组件交互，生成一个新的验证请求。然后，链上组件发出一个包含离线 Oracle 将要处理的数据（例如，客户个人信息）的新事件。此时，离线 Oracle 捕获到事件的发出，并根据不同的数据源通过专用 API 调用（信贷机构）执行它们的业务逻辑（例如，信用状况验证）。一旦离线 Oracle 完成了它们的计算，它们调用链上 Oracle 的回调方法，通过交易返回答案。在我们简化的共识机制中，我们假设当所有离线组件都将它们的答案发送到链上智能合约时，它使用去中心化应用的回调方法，进而返回聚合结果。

### 4.3 去中心化推送 Oracle

图 4 展示了通过去中心化推送 Oracle 实现信息交换的交互过程。与拉取 Oracle 不同，信息的来源在于区块链内部，而区块链本质上是一个去中心化系统。推送信息的流程始于智能合约创建一个新的数据外传请求。链上 Oracle 生成一个包含待暴露数据的新事件。当链下组件捕获到这个事件时，它们都会独立操作，调用外部 API。在我们这个场景中，采购订单数据存储在一个外部的分布式数据库中。为了用新的订单更新数据库，执行活动的基础智能合约使用推送 Oracle，而每个链下 Oracle 都与分布式数据库的不同实例交互。

### 4.4 去中心化拉取 Oracle

![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig5_HTML.png](img/509088_1_En_8_Fig5_HTML.png)

图 5。

与去中心化拉取 Oracle 的交互序列图

图 5 展示了分布式推送预言机介导的信息传输到区块链。我们假设一个 off-chain interface gathers data from various sources and sends it to the off-chain oracles. In turn, the off-chain oracles send the transaction with those data to the on-chain oracle, which is responsible for the collection of the different pieces of information, their aggregation and final communication with the smart contract. In our scenario, a decentralized push-in oracle is used to confirm that the delivery was successful, upon the notification from three different off-chain information providers, namely the carrier, the customer and the quality control specialist. Each of those information providers would interact with a dedicated off-chain oracle and a positive input from all of them would trigger the successful delivery confirmation to the smart contract.

### 4.5 分布式拉出预言机

分布式拉出预言机允许多个外部系统在需要时检索链上信息，如图 6 所示。不失一般性，我们假设外部系统 collectively represented by an off-chain interface for the sake of readability, as in the case of push-in oracles. Our running example employs a decentralized pull-out oracle when the banking system retrieves the data related to the invoice, stored in the blockchain. A centralized oracle would obtain the information to return to the bank by accessing the blockchain through a single node. If that particular node was on an incoherent or corrupted fork of the blockchain, the retrieved information could be misleading.

此处使用的分布式预言机通过其自身的分布式特性来克服区块链数据的潜在不一致性，即通过诉诸于多个独立的组件，这些组件通过不同的节点监视区块链。当 off-chain interface (invoked, e.g., by the banking system) requests data (e.g., the invoice information) to multiple off-chain oracles. Each of them generates a new query towards different nodes of the blockchain. In every node, the on-chain oracle would return the current response based on the local view of the blockchain, in turn given back to the requesting off-chain interface.![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig6_HTML.png](img/509088_1_En_8_Fig6_HTML.png)

Fig. 6.

分布式拉出预言机的交互序列图

## 5 实现

在本节中，我们简要描述了一个实现分布式预言机架构的证明-of-概念原型，并报告了与之一致的实验结果，以初步评估其在执行成本和延迟方面的性能。

### 5.1 原型和实验设置

我们基于以太坊区块链实现了我们的系统。我们将我们原型链上的组件用目前用于以太坊智能合约最广泛的语言 Solidity 进行了编码。我们使用 Node.js 脚本来实现链下组件，并使用 Web3 库让它们与区块链交互，即用于订阅事件发布和将交易发送到区块链。产生的代码公开发布在 GitHub 上。^(4)

为了运行我们的测试，我们在 Ropsten 上部署了我们的原型的链上组件，这是一个以太坊的公共测试网络，以执行测试并获得所需的关于延迟和成本的信息。测试阶段通过四个不同的账户进行，这些账户用于部署智能合约和从链下组件发送交易。我们实验中涉及的交易通过与以下合约的互动来标识，并可以通过 Etherscan 检索：[0xd7c351Eb1DfaFC​f19bf47D3fe55a9D​761a274bd7](https://ropsten.etherscan.io/address/0xd7c351Eb1DfaFCf19bf47D3fe55a9D761a274bd7); [0xA6a80830855c81​b472A6aa9efb36bB​A0fF36A5e4](https://ropsten.etherscan.io/address/0xA6a80830855c81b472A6aa9efb36bBA0fF36A5e4); [0x7Cc2d01fb411b9​E59924f2Bc79002f​93E9A44ddB](https://ropsten.etherscan.io/address/0x7Cc2d01fb411b9E59924f2Bc79002f93E9A44ddB); [0xAF69860c860A00​d723fc0651f22637​aF3b1B0d6D](https://ropsten.etherscan.io/address/0xAF69860c860A00d723fc0651f22637aF3b1B0d6D)。

### 5.2 性能测试

使用我们的原型演示实现，我们初步评估了其性能，包括延迟和成本，试图对中心化和去中心化预言机架构之间的差异进行大致估计。一个全面的比较研究超出了本论文的范围，我们认为这是未来研究的 relevant aim。

我们首先考虑的一个重要问题关于出链（拉入和推入）预言者。尽管每个链上计算都需要触发一个交易，但当我们衡量出链预言者的性能时，我们并不考虑这个交易，因为这些交易本身并不直接与预言者操作本身相关，而是与智能合约的前处理相关。实际上，链上计算可能需要产生稍后由拉出预言者检索的数据，或产生由推出预言者离链传输的信息。然而，从抽象角度来看，这取决于所需的数据处理类型，而不是信息交换本身。在这两种情况下，数据都是由离链组件通过捕获事件的发射获得的，而这个动作对预言者系统来说没有成本。这个方面有两个重要的后果。首先，与出链预言者的交互不一定涉及任何燃气消耗。此外，这两种预言者的交易延迟是无关紧要的。区块链生态系统以任何方式都不影响全局延迟，因为没有涉及区块挖掘。然而，我们指出，区块链是一个分布式系统，因此，延迟可能发生在网络内信息分发本身，除了区块时间或交易延迟。这是在进行链上操作的过程感知系统设计者需要考虑的一个关键因素：尤其是如果涉及众多软件组件，变量延迟甚至可能出现超时，这可能会影响系统的整体稳定性。![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig7_HTML.png](img/509088_1_En_8_Fig7_HTML.png)

图 7。

拉入预言者的延迟测量

入链实施可以提供有趣的定量信息，这些信息可以用于对成本和延迟进行初步性能评估。我们用燃气单位来量化预言者的花费以及其等同的欧元金额。实验时考虑的汇率为每以太坊（ETH）495 欧元，而用于 ETH/燃气转换的平均燃气价格考虑为每燃气单位 8 Gwei（0.000000008 ETH）。关于延迟实验，我们的目标是测量从启动交互事件到达目的地（即，区块链）信息的时间间隔。

图 7 说明了我们对拉入 Oracle 的时间测量方案。考虑我们运行的示例，启动脚本代表供应商请求验证客户的信用。拉入 Oracle 一旦接收到其请求的挖矿收据就开始执行——然后我们开始计时。此时，链下组件由链上组件激活，并在从链下环境检索到所需数据后，将带有该信息的交易发送到链上 Oracle。测量的结束时间对应于接收到输入的计算结束的瞬间。在去中心化方案中，Oracle 采用独立的链下组件独立工作。因此，只有当最新的链下组件交易了其数据后，链上组件的信息处理才能开始。![../images/509088_1_En_8_Chapter/509088_1_En_8_Fig8_HTML.png](img/509088_1_En_8_Fig8_HTML.png)

图 8。

去中心化推入 Oracle 的延迟测量

图 8 描述了去中心化推入 Oracle 的测量方案（在我们的运行示例中用于交货确认）。开始时间对应于其中一个链下组件发送的第一个交易。结束时间是在接收到最新的确认收据，确认从链上组件发送聚合数据时。注意，在中心化情况下，只有一个初始交易和一份最终收据。

表 2 报告了实验结果。对于每个测试，我们执行了 50 次运行，总共 200 次运行（即，集中式情况下 100 次，去中心化情况下 100 次）。表 2(a) 展示了集中式实现的实验结果，报告了平均值、最小值、最大值和标准差。结果显示，最快的实现是拉入 Oracle，其平均延迟值为 18.24 秒，标准差为 15.23 秒。相反，推入 Oracle 平均需要 23.54 秒，标准差为 16.56 秒。至于成本，最昂贵的实现是拉入 Oracle（平均为 42000.98 气单位，而推入 Oracle 需要 39505.47 个单位）。

我们评估了 oracle 的执行成本，既包括了单一的离线组件（我们将其表示为节点 1、节点 2 和节点 3），也包括了整个 oracle 系统。考虑到激励场景，无论是拉入 oracle 还是推入 oracle，都采用了三个独立工作的离线组件。单次交互的成本由每个独立组件（在图 7 和 8 中分别表示为“C1”...“Cn”）产生的所有交易成本之和给出。表 2(b)展示了去中心化情况的结果。如表中所见，在两种情况下，同一系统的独立节点确定了不同的平均成本。测试表明，尽管它们属于同一个 oracle，但有些节点平均消耗的 gas 比其他节点多。换句话说，三个离线组件的 gas 消耗并不平衡。这可以由离线节点将其交易发送到链上组件的顺序来解释。实际上，当所有离线组件都发送了它们的交易后，链上组件才向去中心化应用提供数据。考虑单一运行，最后发送包含数据的交易的离线节点会花费更多。在这种情况下，交易执行的代码具有更高的计算复杂性，因为它还包括了将数据传递到 DApp 的智能合约的操作。最慢的去中心化实现是拉入 oracle，平均为 34.56 秒，而推入 oracle 平均需要 27.78 秒。关于成本，测试显示，拉入 oracle 消耗了 179175 个单位的 gas，而推入 oracle 消耗了 115667 个单位的 gas。表 2.

延迟和成本测试结果

![../images/509088_1_En_8_Chapter/509088_1_En_8_Tab2_HTML.png](img/509088_1_En_8_Tab2_HTML.png)

## 6 机遇与挑战

所提出的去中心化架构的一个主要方面是可用性。通过去中心化 oracle 的结构，我们消除了单一故障点。在中心化情况下，如果负责信息流的唯一控制实体失败，整个系统 oracle 将停止工作，通信结束。相反，在所提出的去中心化架构中，没有中心权威，因为每个离线组件都独立地与链上组件交互，而链上组件又部署在一个去中心化系统（区块链）上。这样，整个系统的故障风险降低了。

另一个受到去中心化影响的是数据的完整性。依赖预言的多方过程可能需要执行涉及大量资源的复杂操作，并且它们无法容忍错误或被篡改的数据。信息不由一个实体维护降低了伪造数据注入的风险（例如，在多个节点确认发票已注册后解锁资金）。这样，可靠性和信任就可以产生。当然，有必要定义内部机制，以便不同组件之间达成一致。这一特定方面可能会增加整个预言系统的复杂性，因此在某些场景中，可能会更倾向于使用集中式版本。

集中式和分布式实现让我们能够对不同架构类型的入链预言的性能（延迟和成本）进行初步分析。如表 3 所示，在所有情况下，分布式原型所需的成本更高，造成的延迟也比其集中式版本多。表 3.

集中式和分布式实现的比较表格

![../images/509088_1_En_8_Chapter/509088_1_En_8_Tab3_HTML.png](img/509088_1_En_8_Tab3_HTML.png)

这可以通过分布式版本中存在多个交易来解释。实际上，我们的用例涉及定义三个链下组件，每个组件都会生成一个交易。与仅对每个信息交换定义一个交易的集中式版本不同。这样，系统的平均成本会随着涉及的链下组件数量的增加而增长。另外，去中心化系统可以在现实世界中检查链下组件之间的协议，这样只生成一个包含最终数据的交易。因此，它可能是一个可行的替代方案。然而，如果负责发送最终交易的实体失败，整个系统将停止工作，且单点故障问题仍然存在。

关于延迟，两种架构之间的差异并不明显。在拉入预言的情况下，集中式的平均结果为 18.24 秒，而分布式版本的平均结果为 34.56 秒。相反，推入式的集中式版本生成的平均结果为 23.54 秒，而分布式版本的平均结果为 27.78 秒。

## 7 结论和未来工作

在本文中，我们研究了在业务流程背景下，使用和发展去中心化预言机作为增强区块链与外部环境之间信息交换的可用性、完整性和信任的手段。我们首先设计和开发了与在集中式版本中开发的链下模块通信的链上组件。随后，我们将预言机架构转变为去中心化，并将其与之前版本进行了比较。我们的原型在执行成本和延迟方面进行了评估。

本文重点关注了以太坊区块链。我们的研究将通过开发与其他区块链平台兼容的预言机得到补充，然后研究去中心化预言机在多个区块链之间进行通信的用途。此外，Solid Web^(6) 最近被提出作为 web 应用程序的数据所有权和隐私保护的新范式。据报道，区块链可以是这一新颖范式的关键推动者 [6]。因此，我们将研究采用去中心化预言机将去中心化系统、信息生产者和消费者与 Solid Web 链接起来。此外，在本文中，我们设计了一种在链上操作，用于与多个链下组件交换信息并进行合并和一致性检查的方法。虽然这种方法更加健壮，但可能比纯粹的链下机制成本更高。因此，分析两种解决方案在负载均衡和安全方面的最佳权衡是我們设想中的未来工作的一部分。最后，我们将对架构的可扩展性和健壮性进行深入研究，并调查潜在的安全威胁。

致谢

作者们感谢审稿人提供宝贵的反馈。C. Di Ciccio 的工作部分得到了意大利教育、大学和研究部（MIUR）在“2018–2022 年优秀 departments”项目的部分资助，以及 Sapienza 研究项目“SPECTRA”。

© Springer Nature 瑞士 AG 2021J. González Enríquez 等人（编辑）商业流程管理：区块链与机器人流程自动化论坛讲座笔记在商业信息处理 428[`doi.org/10.1007/978-3-030-85867-4_9`](https://doi.org/10.1007/978-3-030-85867-4_9)

# 去中心化身份方法：评估与洞见

瓦利德 法西拉^(1, 2  )，尼古拉斯 斯蒂弗特^(1, 2)，克里斯蒂安 科斯塔尔^(3)，西哈恩 萨格兰姆^(4) 和 马库斯 萨巴代洛^(4)(1) 奥地利安全商业奥地利（SBA-Research），维也纳，奥地利(2) 维也纳大学，维也纳，奥地利(3) 斯洛伐克布拉迪斯拉发技术大学，布拉迪斯拉发，斯洛伐克(4) 奥地利维也纳 DanubeTech GmbH，维也纳，奥地利瓦利德 法西拉 电子邮件: wfdhila@sba-research.org.com

## 摘要

近期的技术变革迫使企业重塑其运营和交易方式。在这重构的核心，身份管理确立了自己作为 B2C 和 B2B 商业模式中一个必不可少的构建模块。可信身份可能指的是客户、企业、供应商或资产，并允许不同参与者之间的可信通信。不幸的是，传统的身份管理系统依赖于集中式架构和对第三方服务的信任。随着区块链技术的出现，新的身份管理方法应运而生，它们承诺实现更好的去中心化和自我主权。本文对一系列分布式身份方法进行了评估，并基于 W3C 推荐框架中指定的分类对其特性进行了分析。

关键词：区块链、分布式身份、自我主权身份、DID 方法

## 1 引言

在当今的互联网中，像 Google、Facebook 或 Amazon 这样的组织集中管理和控制着大量关于个人及其身份的交叉关联数据。用户对这类集中式系统的信任已经减弱，最近的泄露事件曝光了他们的私人数据大规模被滥用，这迫切需要新的*去中心化*方法，以完全控制他们的数据。

通过提供必要的基础设施和对拜占庭容错（BFT）的重新关注[11]，区块链技术的出现为建立不依赖于中央实体的可信分布式身份的新式去中心化方法铺平了道路，这种方法被称为自主主权身份（SSI），在 SSI 中，实体或个人成为自己的身份提供者，从而创建和控制一个或多个（i）去中心化标识符（DID）和（ii）可验证凭证（VC）[6]。 （i）DID 是一个唯一的标识符，通常与 DID 文档（也称为继续文档）相关联，该文档指定了加密材料、验证方法和对于证明 DID 所有权和服务至关重要的服务。 （ii）可验证凭证是身份提供者发行的关于特定主题的身份属性和断言。 与传统凭证不同，依赖方（第三方服务）可以不与发行方互动即可验证 VC 的有效性。 另一方面，DID 方法定义了 DID 如何创建、解析、更新和吊销。 目前，存在超过一百种依赖不同架构设计或基础设施的 DID 方法。 因此，开发使用去中心化标识符用例需要充分理解这些方法的特性和它们在治理、安全或操作方面提供的优势。 在本文中，我们根据 W3C DID 方法大纲提供了六个 DID 方法的定性评估。^(1)

本文的其余部分结构如下。第二部分介绍了基本概念，而第三部分概述了研究方法。第四部分评估了不同的双重差分法（DID），第五部分讨论了研究结果并总结了本文。

## 2 背景

*去中心化标识符（DIDs）。* DIDs 是唯一标识符，其目的是确保实体之间可靠和持久的通信渠道。与由第三方发布和控制的常见标识符（如 URI、电话号码或社交媒体标识符）不同，DIDs 使个人和组织能够发布和控制自己的标识符。根据 W3C 建议草案（2），DIDs 具有以下格式：![$$did:{&lt;}did\_method{&gt;}: {&lt;}method\_specific\_identifier{&gt;}$$](img/509088_1_En_9_Chapter_TeX_IEq1.png)，其中*did*是前缀，![$$did\_method$$](img/509088_1_En_9_Chapter_TeX_IEq2.png)指的是定义创建、解析、更新和吊销特定 DID 的精确操作的方法规范，而![$$method\_specific\_identifier$$](img/509088_1_En_9_Chapter_TeX_IEq3.png)是在该方法中的唯一标识符。使用*btcr*方法在比特币区块链上创建的 DID 示例：![$$did:btcr:8kyt-fzzq-qpqq-ljsc-5l$$](img/509088_1_En_9_Chapter_TeX_IEq4.png)。

*DID 文档*. 类似于 DNS 解析，其中 URL 作为输入，相应的 IP 地址作为输出，DID 解析以 DID 作为输入，返回一个 DID 文档作为输出。后者包括，例如加密材料（用于身份验证、授权和交互的公钥），证明 DID 所有权的验证方法，以及用于与主题进行可信通信的服务端点，例如交换可验证的凭证。

*DID 方法*. 区块链生态系统的多样性导致了创建和解析 DID 的各种不同方法。尽管大多数这些方法符合 W3C DID 规范，但每一种方法都有特定的属性，根据底层技术或治理框架提供不同的保证。因此，每个 DID 方法都指定了如何创建、解析、更新和停用相应的 DID（CRUD）。

## 3 方法论

### 3.1 DID 方法选择

在撰写本文时，存在超过 100 种在各种方面不同的 DID 方法，如（i）底层基础设施（ii）治理（iii）操作和（iv）安全。不幸的是，其中大量的方法要么是概念性设计，未实施的建议，或者是不再维护的过时项目。此外，通常重点关注操作元素如 CRUD，而方法的其他方面则受到相对较少的关注和文档，使得评估变得困难。

基于 SSI 领域内作者的专业知识和他们参与实施的用于 DID 的通用注册器和解析器的经验^(4)![$$^,$$](img/509088_1_En_9_Chapter_TeX_IEq5.png)^(5)，选择了 6 种 DID 方法进行评估，这些方法涵盖了不同的架构设计：(i)基于区块链的 (ii)非区块链 based，(iii)公共授权，(iv)公共无授权和(v)对等 DIDs。这一选择，即{did:btcr, did:v1, did:ethr, did:sov, did:web, did:peer}为公平评估提供了充分的文档和实现细节，并涵盖了目前 SSI 社区广泛接受的方法。

### 3.2 评估过程

在本论文中，使用 W3C DID 方法大纲 V1.0（2021 年 1 月 6 日）^(6)和从 SSI 原则中衍生出的额外标准进行定性评估。因此，本文为 DID 方法提供了全面和比较性的研究，并对每个评估标准考虑了以下三个重叠维度：

1.  (i)

    网络是底层通信层，即用户需要与谁通信以调用方法的操作。

1.  (ii)

    注册表是一个根据规范通过通信层管理的已记录状态变化的具体实例。

1.  (iii)

    规范是该方法的管理文档，定义并概述了特定方法如何实现 DID 核心规范的必需和任何可选组件。

评估标准。这些标准分为四类，每一类都关注方法的特定方面：

1.  (1)

    规则制定捕捉了 DID 方法治理中的去中心化程度。它涵盖了谁可以定义规则以及如何根据上述每个维度定义规则。例如，DID 方法背后的经济利益可能会影响其集中化，如果目标是支持某一特定群体的利益。

1.  (2)

    操作重点关注 CRUD 操作，并评估规则是如何执行的。它还解决了操作的*开放性*，即它是否限制在特定群体（授权）或对任何人开放（无授权）。授权操作可能会影响网络对各种参与者的可用性，从而影响对服务不足或脆弱人群的包容性。它还可能使授权者面临法律后果。

1.  (3)

    安全性涵盖了通过方法设计选择和采用技术可能针对用户的安全性、正确性、隐私性和自主性产生的潜在攻击向量。

1.  (4)

    实现触及了实际实施和实践中对应 DID 方法的具体方面和挑战。

评估由五位具有分布式账本技术（特别是自主身份主权）的多样化和理论背景的专家进行。其中一些评估者还参与了 W3C 对去中心化标识符和可验证凭据的标准化工作，此外还包括支持大约 50 种 DID 方法的通用 DiD 注册器和解析器的项目实施。如前所述，所选的 DID 方法旨在覆盖不同的架构设计，并依赖于遵守不同治理规则的各种基础设施。

## 4 评估的 DID 方法

### 4.1 did:btcr

**描述。** DID:btcr 使用比特币区块链上的交易来注册、更新和吊销身份。DID 对应于交易引用 *TxRef*^(7)，它编码了详细信息（即，链、区块高度、交易索引和可选的输出点索引）。该交易可以选择包含一个 ![$$OP\_RETURN$$](img/509088_1_En_9_Chapter_TeX_IEq6.png) 作为交易输出的一部分，以引用一个 DID 文档，否则，将自动创建一个默认文档。![$$OP\_RETURN$$](img/509088_1_En_9_Chapter_TeX_IEq7.png) 是比特币脚本操作码 [2]，可用于在交易中嵌入最多 80 字节的数据显示。通过花费当前的输出点并设置 ![$$OP\_RETURN$$](img/509088_1_En_9_Chapter_TeX_IEq8.png) 以引用更新的 DID 文档来更新 DID。读取 DID 需要查询 *TrxRef* 并跟随支出交易的链，直到找到最后一个未花费的输出点。如果最后一个交易没有 ![$$OP\_RETURN$$](img/509088_1_En_9_Chapter_TeX_IEq9.png)，这意味着 DID 已被吊销。

**规则制定。** *网络和注册表。* 对于 did:btcr，网络和注册表实际上是相同的，对应于比特币协议。协议的更改需要起草一个比特币改进提案（BIP），然后社区内部公开讨论。因此，网络治理参与是开放的，任何人都可以加入、发表评论和贡献公开辩论（开放贡献）。BIP 接受的流程遵循 BIP:2 中定义的指导原则，其中建议 BIP 的接受至少需要最后 2016 个区块的矿工的![$$95\%$$](img/509088_1_En_9_Chapter_TeX_IEq10.png)接受率，除非有理由。决策组不是封闭的，包括已知和未知的实体/矿工（权限范围）。然而，治理参与不能被认为是公平的，因为算力更高的矿工在决策中有更大的影响力。在 DID:btcr 中，尽管矿工收到区块奖励和交易费，但 DID 方法本身的治理是去中心化的，因此，是为了公共利益而设立的。

**规格说明。** DID:btcr 的规格说明由一组封闭的贡献者创建和维护。对规格说明的评论和建议是开放的，但决策权掌握在一组封闭且已知的人手中。尽管参与规格说明治理需要时间和精力，但没有定义对规格治理实体的激励措施，从而证实了先前的关于该方法财务目标的结论，即该方法是为了公共利益而设立，不提取租金或报酬。

**运作。** 由于比特币区块链是公开的且无需权限，任何人都可以参与、阅读和写入（交易）账本，did:btcr 的操作也不需要任何权限。然而，不依赖权威中介来解析 DID 需要运行一个完整节点，这可能阻止资源受限的边缘设备直接解析 DID。除非指定了续篇文档，否则边缘设备注册 DID 是足够的，这需要额外的资源来托管它（例如，一个服务器）。请注意，did:btcr 支持创建通用和对配的 DID。尽管比特币是公开的，原则上任何人都可以解析 DID，但也可以创建一个默认 DID（不设置![$$OP\_RETURN$$](img/509088_1_En_9_Chapter_TeX_IEq11.png)），这样它与正常交易无法区分，因此可以成对使用。任何人都可以检索历史变更（交易）的加密证明，从而理论上实现公共可审计性。然而，引用存储在可变存储上的续篇文档可能会阻碍这些好处。

-   **安全性。** 虽然使用比特币交易作为 DID 确保了完整性和持久性，但参考继续文档引发了关于审查和可变性的担忧。存储提供商或管理机构可能会审查托管继续文档的服务器访问权限，导致在更新之前无法解决相应的 DID。除了审查之外，主机服务器的故障也会直接影响 DID（用于解决）的可用性，除非实现了缓存机制。继续文档的完整性可以通过它使用交易输入密钥进行签名来检查。然而，当前规范文档与设计决策文档之间的不一致性使得不清楚应该使用哪个输入密钥来签名继续文档，即（i）DID 创建输入密钥，还是（ii）用于更新的密钥。后一种情况将开启在某些条件下声称他人 DID 的可能性 [4]。

-   **实施。** 实施 btcr DID 的一个挑战是缺乏一个权威的、完整的、更新的规格说明。实施者必须结合不同来源的信息，向社区提问，分析现有示例和代码以构建兼容的实现。当需要继续 DID 文档时，对 btcr DID 进行 CRUD 操作可能会很困难，因为这需要访问网页服务器，以及访问比特币区块链。解决 btcr DID 的主要挑战是“跟随尖端”，即在更新或停用 btcr DID 后查找交易未花费输出点的进程，这并非所有比特币实现都易于支持。最后，btcr DID 在创建过程中，实际的 DID 只有在区块挖矿并得到足够确认后才能完全知晓和稳定。这要求实现者维护某种内部状态和监控过程。

### 4.2 did:sov

-   **描述。** Sovrin 是一个私有的非盈利基金会，其 DID 方法依赖于一个专门且唯一针对自主身份的公共许可区块链 [10]。Sovrin 的技术基础源自 Hyperledger 的 Indy 项目，并采用议会协议，这是对 RBFT（冗余拜占庭容错）的改进 [1]。

-   **规则制定。**

*网络与注册表。* 在 did:sov 中，网络和注册表都与 Sovrin 网络相对应。治理权受到限制，由董事会（BoT）决定（i）网络如何发展，以及（ii）由 Sovrin 治理框架工作组（SGFWG）批准新的守护者或治理提案。守护者是独立的实体（例如，大学、组织），负责背书交易并向账本写入，必须遵守董事会批准的治理框架。所有治理文件都向公众开放，供审查和评论，但最终决策权限于一个封闭的团体（即董事会）。与 DNS 治理类似，尽管 Sovrin 基金会是一个非营利性公共组织，但它收取费用和租金，以确保基础设施的经济可行性。此外，尽管 Sovrin 基金会内存在多个不同的治理机构（例如，SGFWG、STGB、EAC），任何人都可以加入，但最终的治理审批仍然控制在董事会手中。要想成为董事会的一员，首先应由提名/过渡委员会提名，然后由现任董事会投票通过。参与治理显然受到限制，并在努力和时间上需要付出一定的成本。

*规格说明。* 规格说明由 Sovrin 技术治理委员会通过 Sovrin 信任框架管理，修订（称为受控文件）应经过董事会批准。

**运作方式。* 与 did:btcr 相反，虽然任何人都可以从 Sovrin 账本中读取信息，但写入操作是受权限限制的，仅限于交易背书者（例如守护者）。Sovrin 公开分享其年度财务报告，任何人都可以查阅，从而使其财务问责制变得透明。为了解决 DID，did:sov 不需要实现完整节点，而是可以依赖状态证明，使使用资源有限的边缘设备成为可能。然而，不依赖中介注册 DID 是不可能的，因为它必须通过一个背书者来实现。最后，Sovrin 的公共性质使任何人都能够检索到 DID 文档所有变化的密码证明，从而使系统可审计。

**安全性。** 在实践中，did:sov 由于依赖于来自世界各地的分布式节点（监护人）网络，这些节点负责访问和向账本写入内容，因此具有抗审查性。因此，如果一个用户被监护人审查，他们可以轻松地使用另一个不同的监护人注册一个 DID。然而，这并不能防止 BoT 发布新的背书政策，审查特定类型的用户，背书者必须遵守这些政策。账本的安全性由多样化的监护人和观察节点维护，也可以使用例如锚定状态证明等方法公开验证。尽管机密性不是必需的属性，但在 did:sov 中创建未存储在账本上的成对 DID 是可能的。此外，Sovrin 还支持使用零知识证明创建盲 DID。根据 Sovrin 的 GDPR 合规政策，个人数据不得写入账本（数据最小化），即只有公共 DID 及其相应的 DID 文档、凭证定义和撤销注册表存储在账本上。Sovrin 还使用软件代理（例如，边缘代理、云代理）来存储和管理凭证和密钥，并使用 didcomm 协议以对等方式与其他代理进行通信。

**实施情况。** 该方法是为 Sovrin 设计的，Sovrin 广为人知，许多实施者和实际项目都在使用它。它还隐式地为 Hyperledger Indy 的其他账本实例设计了。然而，在实践中，构建在这些账本之上的应用程序和服务使用自定义的标识符和发现格式，而不是实际的 DID 和 DID 文档，这使得这个 DID 方法难以理解。虽然存在 DID 方法规范，但已经过时了。因此，sov DID 的实现目前大部分基于社区知识和未记录的假设。账本本身提供了诸如 NYM 和 ATTRIB 等基本操作，这使得在上面构建 DID 和 DID 文档成为可能。随着新的 Indy DID 方法的到来，预计解决 sov DID 实现中的不足和混淆。

### 4.3 did:ethr

**描述。** did:ethr 方法与 did:btcr 相似，都是基于区块链技术构建的，此例中是以太坊。然而，比特币采用基于 UTXO 的账本设计，以太坊则采用基于账户的模型，并支持准图灵完整的*智能合约* [7]。did:ethr 利用这些特性，通过将外部拥有的以太坊账户地址（由 ECDSA Secp256k1 非对称密钥对的公钥导出）映射到身份。did:ethr 的一个重要设计决策是，创建 DID 不必向以太坊网络提交交易。相反，任何常规生成的外部拥有账户地址都被视为 DID。此外，利用以太坊智能合约功能实现 CRUD 操作的注册表，并允许委托对身份的控制。因此，基于智能合约的注册表遵循以太坊改进提案 EIP-1056 中定义的初步 ERC-1056 标准，并继承了不可变性、无信任执行和去中心化等底层平台的有益特性。尽管 did:ethr 看似提供了一种创建 DID 的轻量级且成本效益高的方法，但设计选择引入了关于 DID 的创建和撤销的一些不明确的特性，这些特性从未通过区块链上的交易提交。

**规则制定。**

**网络与注册表。** 与 did:btcr 相似，此方法中的网络和注册表也是通过底层区块链系统提供的。然而，did:ethr 依赖于一个由智能合约管理的注册表，可以通过任何以太坊账户或其他智能合约代码公开交互。关于规则制定，当前基于智能合约的注册表规范使功能*不可变*，因为这是底层账本的特性。然而，目前草案的 ERC-1056 注册表设计是否会更改以包括治理能力尚不清楚，一旦草案完成。对于基本网络（区块链），虽然原则上任何人都可以全面参与，但要实质性参与以太坊的共识协议需要显著的算力，因此需要大量的财务资源。在实践中，像比特币和以太坊这样高算力的工作量证明区块链更像是由授权的共识网络，因为普通用户没有影响共识决策的现实可能性。在以太坊中，治理权力是一个开放的多方集合，过程类似于比特币的 BIPs，通过以太坊改进提案（EIPs）进行治理。注册表的运营成本完全透明，因为它们在区块链上是公开可见的，网络成本如挖矿奖励和算力也可以从链上数据推断出来。

**规格说明.** did:ethr 规格最初是由 uPort 创建的[9]，但它不是针对特定用例或旨在提取租金并作为公共物品确立的。它公开发布在 GitHub 上，目前由去中心化身份基金会管理，然而没有理由认为这排除了其他人积极参与。注册表的智能合约代码也是公开的，可以与部署的合约进行核对。

**操作.** 创建 ethr DID（去中心化身份标识）不需要任何权限，特殊硬件要求，甚至不需要访问整个区块链账本，特别是如果不需要向注册表（例如，用于委派控制）发送交易的话。对于一些 CRUD（创建、读取、更新、删除）操作，可能需要通过需要向矿工支付交易费用的交易与链上智能合约进行交互。这些交易成本是公开的，并记录在区块链上。总体而言，以太坊中矿工的报酬高度透明，因为所有加密货币资金的链上流动都是公开可访问的。任何人都可以阅读注册表（无论是通过轻节点、完整节点还是第三方服务）。该方案旨在不同的 EVM（以太坊虚拟机）兼容网络上运行（例如，以太坊测试网、Rootstock 等），并允许指定替代的注册表地址。类似于 did:btcr，如果所有的 DID CRUD 操作都是通过交易完成的，任何人都可以检索到这些变化的加密证明，从而实现公开可审计性。另一方面，如果 DID 不是通过交易添加到注册表，它们可以成对使用，也可能提供一定程度的隐私，例如，对抗元数据收集。

**安全性。** did:ethr 的优势在于其设计中无需在交易中注册 DID，除非所有者希望这样做，或者希望包括将 DID 控制权委托给另一个地址等属性。然而这意味着，一旦被删除/吊销且从未使用过注册表的 DID 将无法与未吊销的 DID 区分开来。通过区块链共识和使用 established 算法确保了完整性，这些算法用于非对称加密和散列函数。用户可以生成一个 Secp256k1 密钥对，无需信任地创建自己的 DID。只要底层账本保持“无需许可”，即交易不由矿工审查且经济上可行，注册表的使用就是无需信任的。在注册表中更新 DID 是公开可见的，原则上个人身份信息也可以编码在 DID 条目中，这可能会引入潜在的隐私问题。可以通过运行自己的完整或轻量级以太坊节点，或者，在更多信任假设的情况下，通过第三方提供者的 API 来做到这一点，从而以良好的保密性进行 DID 解析和读取注册表。与 did:btcr 中的继续文件类似，该方法允许“服务端点”，它们可以引用外部可变的资源，如 URL，从而打开潜在的审查、持久性和隐私问题。

**实施。** 此方法可以使任何人创建 DID 的成本效益变得有效，因为创建步骤仅需要生成一个加密密钥对，而无需执行区块链交易。解析 ethr DID 需要对位于注册表智能合约中的以太坊或相应网络执行读操作，这可以通过任何标准以太坊工具轻松实现，并且只会带来适度的资源要求。一旦需要更新和停用操作，实施者需要能够向区块链写入数据，这需要适当的基础设施（与其他基于区块链的 DID 方法类似）并且受到交易费用的限制。

### 4.4 did:web

did:web 是一种使用域名作为标识符的方法。DID 是一个指向存储在网络主机上并注册在 DNS 注册商中的 DID 文档的 URI。要解析 DID，需要对生成的 DID 的 HTTPS URL 进行 HTTP GET 请求。通过替换/更新托管位置上的 DID 文档来更新 DID。如果从网络主机中删除 DID 文档，则吊销发生。

**规则制定。**

*网络与注册表。* 因为 did:web 方法使用域名来表示 DID，所以 DID 网络和注册表对应于运行域名服务器的注册表和注册商。因此，评估治理方面需要深入了解这样一个传统 DNS 系统是如何治理的。DNS 的治理主要是由一个多利益相关方、私有的、非盈利组织 ICANN 负责的，该组织遵循自下而上、基于共识的模型来协调互联网域名和 IP 地址的分配[5]。尽管每个 DNS 注册表/注册商可能有各自的内部规则，并负责分配/销售相应的域名，但最终它们必须遵守并履行 ICANN 的协议和政策。DNS 模型结合了公有和私有经济。ICANN 本身是一个非盈利组织，为了公共利益而行动，但要从注册表、注册商和间接的注册用户那里收取注册费，以覆盖组织的运行成本。然而，从注册表和注册商的角度来看，它们提取租金以增加自己的利润。

*规格说明。* 规格说明是由凭证社区组发布的。任何人都可以通过规格说明的 GitHub 仓库发表评论和提出问题，但决策过程并不明确，似乎是由规格说明的作者进行的。

**运作方式。** 虽然任何人都可以阅读，但向注册表/DNS 服务器写入操作是受权限控制的。创建 DID 需要在注册商/注册表内或第三方卖家处订阅，此外还需要一个 web 主机来存储 did 文档（除非用户自己托管 web 服务器）。因此，要想不依赖中介使用 did:web 方法解析 DID，用户必须是认证的注册表。此外，尽管域名旨在普遍使用（除非使用本地/私有网络和 DNS 服务器），但 DID 文档存储在 web 主机上，没有手段通过加密方式证明其更改的历史，因此使得可审计性几乎不可能。

**安全性。** 在 did:web 中，审查可以在不同层面发生：(i) DNS 或(ii) Web 主机。虽然迁移到新的 Web 主机可以解决后者的场景（针对迁移和更新费用），但注册表仍然可以完全控制删除或审查特定的 DID。尽管也可以将 DID 转移到另一个注册商，但注册表（例如，对于.com 的 Verisign）仍然有权拒绝用户请求。在当前的 did:web 规范中，不清楚如何处理完整性，尽管建议使用 hashlinks。另一方面，机密性取决于在注册商内部注册是否是私人的。如果不是，用户必须透露她的基本信息，从而使注册商能够将实际身份与相应的 DID 相关联。

**实施。** 仅解决网络 DID 就需要一个简单的 HTTP GET 操作，这在任何编程语言或操作系统中都可以轻松实现。创建、更新和停用只需要在 Web 服务器上存储和更新一个文件。

### 4.5 did:v1

**描述。** Veres One^(9) 是一个专门针对 DID 创建和管理的项目。v1 规范由 Digital Bazaar 的成员起草，由 W3C 信誉社区小组托管/维护。它依赖于自定义的分布式账本技术，基于“Continuity”^(10) BFT 共识协议，似乎专门针对 Veres One 的应用。该方法旨在为操作员提取租金和报酬，并指定一个详细的治理结构，用于定义相关的操作实体、管理机构以及方法规范如何更新。在撰写本文时，关于 did:v1 的规范和设计细节显得具有挑战性，因为文档和代码散布在多个 GitHub 存储库和网站上，并没有形成一个清晰的画面。此外，尽管项目管理、治理及其目标已经概述，但呈现的结构相对复杂，并且不清楚如何轻松验证项目是否遵循规范及其声称的实际目标。

**规则制定。**

*网络和注册表。* v1 旨在使用一个公共账本，原则上任何人都可以在此创建和解决 DID。为了与 GDPR 规定保持一致，DID 的某些元素可以存在于链下。虽然声称网络是无许可的，但操作细节表明这一特性可能只延伸到读取账本的能力。特别是，所采用的新型共识协议及其支持开放参与模型的能力尚未收到足够的同行评审，以允许进行客观评估。参与 Veres One 网络节点的成本尚不完全清楚，但至少涉及一些适度的成本。

-   **规格说明。** 看起来感兴趣的各方可以通过承担治理角色或评论公共 GitHub 仓库来参与和贡献。然而，最终对规格说明的控制权由 Veres One 治理机构和控制这些仓库的实体持有。

-   **操作。** 运行客户端所需的软件是开源的，需要的资源最少，并且可以查询网络节点的信息。对于无需信任的 DID 解析，用户必须自己运行一个网络节点。在创建或更新 DID（向账本写入）方面，did:v1 遵循一种模型，用户支付一个*加速器费用*，该费用分布在网络的维护者和参与者之间。因此，did:v1 提供了一个更受限制的需权限模型，类似于 did:sov。然而，似乎可以通过执行工作量证明或作为共识节点参与协议来绕过加速器。

-   **安全性。** 在 did:v1 中，目前尚不清楚该方法在实践中是否能够在其声明的属性中实现“无需权限”的设置，因为共识协议尚未得到充分分析。一方面，在假设账本及其共识协议完全无需权限的情况下，它可以实现抗审查。公共可验证性也是可能的，但该方法还支持可能无法验证或可能受到审查的外部资源。另一方面，如果共识仅通过假设一组受限的参与者来实现，即它需要权限，这将打开审查的可能性。根据方法规范，实现了 GDPR 合规性，但尚不清楚实践中如何强制执行这一属性。更具体地说，为了完全符合 GDPR，共识节点需要验证 DID 中没有编码任何可识别的个人数据，无论是故意的还是非故意的。与被遗忘权相关，可能需要删除区块链历史中的条目。然而，在无需权限的设置中，安全的可编辑区块链仍然是正在进行的研究主题 [3]。

-   **实现方法。** did:v1 方法直接建立在 JSON-LD 和链接数据证明之上，这可以为实施者提供一些熟悉度。解析 v1 DID 相对直接，因为每个网络节点都暴露了一个 HTTP GET 接口，用于检索一个完全符合规定的 DID 文档。目前仍有一个主要问题尚待解决，那就是 Veres One 账本的未来发展和实施情况。这包括两个方面：一是是否能够实现规范中提出的技术目标；二是治理和网络参与（例如，无需权限或需要权限）如何根据这些技术来实现。

### 4.6 did:peer

**描述。** did:peer 规范背后的核心概念在于一个洞见：存在两种 DID，即*任何 wise DIDs*和*N-wise DIDs*。前者旨在与未知数量的各方一起使用，而后者只打算被恰好*N*个枚举的参与者所知，did:peer 方法针对的就是这种 DID。一个*成对 wise DID*是当![$$N \! = \! 2$$](img/509088_1_En_9_Chapter_TeX_IEq12.png)的特殊情况。N-wise DIDs 只与其相应的成员相关，例如解析等只应关心涉及的各方。因此，大部分交互可以移至链下进行，如有需要，可以连接到基于链的生态系统。

**规则制定。**

**网络和注册表。** 没有特定的网络用于规则制定，通信可以通过任何网络渠道进行。选择特定网络的决定取决于参与 did:peer 的各方和注册表，注册表只在对等方本地持有。如果对等方决定更改网络选择和规则或注册表，那由他们自己决定。DID 的创建者只是一个对等方或一对同意某些规则的对等方，一切都与对等方有关。因为网络和注册表是在一组对等之间创建的，所以它只是为了这些参与者的共同利益。

**规格。** did:peer 规范在 Github 上公开可用，任何人都可以提出改进或更改，然而能够接受此类更改的贡献者小组似乎是一个封闭的群体。规范似乎不是为了提取租金，而是为了公共利益。

**操作。** 原则上，任何人都可以参与，只要她是 peers 之一。然而，网络或通信层仅对参与操作的对等方可见，除非涉及的对等方另有决定。注册表在通信对等方之间建立并本地持有，要求很少的开销或不必要的数据。网络和注册表可以是 peers 达成一致的任何内容。DID 可以在任何一组各方之间创建和使用。操作的可审计性取决于底层注册表和网络的具体能力，这是各方达成一致的。

**安全性.** 在 did:peer 中的相应 DID 是通过一个安全随机的进程生成的。这阻止了攻击者发现可能侵犯隐私的点对点 DID 中的模式。通常，点对点 DID 不会在任何中心系统中持久化，因此没有需要保护的宝藏。然而，在与动态对等体通信时，有一个特殊的分层机制，用于将其他点对点 DID 文档持久化到备份存储中，这可以是一个账本。在这个协议中的消息是加密的，按照指定的 DIDComm 加密信封格式。这为交换数据的机密性和完整性提供了强有力的保证。由于通信主要是两个对等体之间进行的，所以从网络角度来看，所需的安全措施部分地被最小化了。

**实施.** 实施点对点识别身份（DID）对实现者来说需要付出相当大的努力，因为这种 DID 方法引入了许多许多开发者可能不熟悉的新概念。另一方面，这种 DID 方法使得逐步实现更多功能成为可能。生成一个点对点 DID 只需要生成一对密钥，而其他操作则通过代理之间的点对点协议进行。目前尚不完全清楚点对点 DID 如何与其他社区发展，例如 Hyperledger Aries 和 DIDComm 相结合。

## 5 讨论和结论

区块链技术为实现不需要依赖中心化实体的 SSI 系统开辟了多种可能性。虽然部分是通过这些技术固有的属性实现的，例如不可变性、抵抗审查和去中心化，但一个 DID 方法的分散程度或安全性还取决于许多其他方面和设计选择。不能假设仅仅因为一个 DID 方法基于区块链技术，它就隐含地是分散的。实际上，考虑所有维度非常重要，即（i）网络，（ii）注册表，和（iii）规格说明，并针对每个这些维度评估方法的基本属性（例如，治理、经济模型或安全性）。表 1 提供了所调查方法的比较概览。*保护*决定了方法对审查的抵抗力，*持久性*评估了去中心化标识符的寿命。*完整性*确保 DID 和相应的 DID 文档没有被篡改，而*机密性*意味着 DID 方法提供了在需要时保护 DID 或 DID 文档免受未授权披露的选项。最后，*去中心化*通过评估 DID 方法的基础网络、注册表和规格说明治理以及操作的去中心化程度来检查 DID 方法的去中心化程度。例如，我们的评估已经显示，尽管 did:btcr 依赖于去中心的比特币网络来创建 DIDs，相应的 DID 文档仍然托管在可变存储上，从而阻碍了区块链的好处，并引入了审查、可用性和持久性方面的新风险。同样，尽管 did:ethr 也是建立在公共无权限的区块链（以太坊）之上，但其设计依赖于链上的 ERC-1056 智能合约来管理和治理 DID 注册表。这样做的话，信任就转移到了智能合约实现以及 underlying Ethereum 区块链。请注意，在两种方法中，对规格的更改无法防止对 DID 的操作也遵循之前的规格版本。解决它们将需要 DID 解析器维护所有先前的解析实现版本。值得注意的是，大多数评估的方法在版本控制/迁移机制方面存在明显的不足，以防止旧的 DID 变得无法解析或过时。如何升级方法规格以及评估其对当前实现的影响的清晰定义，对于引入新功能和减轻安全性或性能问题显然是有益的。

在基于身份特定账本的方法与依赖公共区块链的方法之间，以及在底层账本的许可与非许可操作之间存在安全性、可用性和可扩展性的权衡。依赖于 BFT 共识机制的身份特定许可账本（例如，Sovrin 和 Veres One）相较于传统区块链设计（例如，比特币和以太坊）提供了更好的可扩展性和性能，然而这以减少去中心化和增加运营商审查风险为代价。这是因为负责向账本写入的实体必须遵守背书协议，最终可能会被管理实体更改，这在一定程度上减少了去中心化，可能服务于特定利益。表 1.

比较 DID 方法的表格

|  | 规则制定 | 运行 | 安全性* |
| --- | --- | --- | --- |
| 网络     | 注册表     | 规格     | 网络     | 注册表    |  Pro     | Per     | Int     | Conf |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| did:btcr | ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq13.png) ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq14.png) | ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq15.png) ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq16.png) | ![$$\Circle $$](img/509088_1_En_9_Chapter_TeX_IEq17.png) | ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq18.png) ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq19.png) | ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq20.png) ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq21.png) | ![$$+$$](img/509088_1_En_9_Chapter_TeX_IEq22.png) | ![$$+$$](img/509088_1_En_9_Chapter_TeX_IEq23.png) | ![$$+$$](img/509088_1_En_9_Chapter_TeX_IEq24.png) | ± |
| did:v1 | ![$$\RIGHTcircle ^\dagger $$](img/509088_1_En_9_Chapter_TeX_IEq25.png) | ![$$\RIGHTcircle ^\dagger $$](img/509088_1_En_9_Chapter_TeX_IEq26.png) | ![$$\Circle $$](img/509088_1_En_9_Chapter_TeX_IEq42.png)   ![$$\blacksquare $$](img/509088_1_En_9_Chapter_TeX_IEq43.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq44.png)  ![$$\blacksquare $$](img/509088_1_En_9_Chapter_TeX_IEq45.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq46.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq47.png)   ![$$\blacksquare $$](img/509088_1_En_9_Chapter_TeX_IEq48.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq49.png)  ![$$\blacksquare $$](img/509088_1_En_9_Chapter_TeX_IEq50.png) | − | ± | ![$$+$$](img/509088_1_En_9_Chapter_TeX_IEq51.png) | ± |
| did:web | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq52.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq53.png) | ![$$\Circle $$](img/509088_1_En_9_Chapter_TeX_IEq54.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq55.png)   ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq56.png) | ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq57.png)   ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq58.png) | − | − | − | ± |
| did:peer | ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq59.png) | ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq60.png) | ![$$\Circle $$](img/509088_1_En_9_Chapter_TeX_IEq61.png) | ![$$\RIGHTcircle ^\dagger $$](img/509088_1_En_9_Chapter_TeX_IEq62.png) | ![$$\RIGHTcircle ^\dagger $$](img/509088_1_En_9_Chapter_TeX_IEq63.png) | ± | − | − | ![$$+$$](img/509088_1_En_9_Chapter_TeX_IEq64.png) |
| *****安全性 - 优点：保护  缺点：持久性  特点：完整性  特点：保密性 |
| ![$$\CIRCLE $$](img/509088_1_En_9_Chapter_TeX_IEq65.png)  完全去中心化  ![$$\RIGHTcircle $$](img/509088_1_En_9_Chapter_TeX_IEq66.png)  部分去中心化  ![$$\Circle $$](img/509088_1_En_9_Chapter_TeX_IEq67.png)  集中式  ![$$N/A ^\dagger $$](img/509088_1_En_9_Chapter_TeX_IEq68.png)  不适用 |
| 所需资源：  ![$$\blacksquare $$](img/509088_1_En_9_Chapter_TeX_IEq69.png)  适度  ![$$\square $$](img/509088_1_En_9_Chapter_TeX_IEq70.png)  大量 |
| ![$$\dagger $$](img/509088_1_En_9_Chapter_TeX_IEq71.png)在撰写本文时，方法如何满足标准不清晰或定义不当 |

所选方法有趣地依赖于不同的经济模型，范围从从非营利组织抽取 DID 方法的租金到完全开放和免费（不考虑网络费用）的社区项目。这创造了一个项目可持续性和增长与系统信任之间的权衡。实际上，参与治理和维护通常需要大量努力和时间。因此，如果在方法的经济学模型中未能考虑激励措施或覆盖运营成本，可能导致项目停滞不前或规格过时。另一方面，激励措施不应仅服务于特定实体的经济利益，从而降低系统的信任度、开放性、透明度和责任感。

我们在此指出在进行这项评估时遇到的一些挑战。首先，可用文档的数量和质量，以及某些方法规范与其实际对应实现之间的不一致性，带来了如何公平评估方法特定属性的不确定性。此外，在评估过程中和之后，一些规范可能发生了变化，因此需要不断修订评估。最后，一些特定方法的构造和目标在实践中难以验证或尚未实现，使得它们是否能实现所承诺的保证仍然不清楚。

总结来说，在评估的 DID 方法中并没有明确的胜者。每种方法都有其优点和缺点，选择哪种方法在很大程度上取决于用例（例如，供应链、KYC、汽车工艺）和期望的属性。一些应用领域可能需要可扩展和私有的系统，而其他领域可能需要关注分发和信任。此外，尽管区块链为 DID 方法提供了独特的安全和去中心化特性，但它并不能防止不完善的规范和治理设计引入可能危害潜在好处的漏洞。

致谢

这项研究部分基于以下工作：(1) 基督教多普勒实验室在生产系统生命周期中的安全与质量改进；感谢奥地利联邦数字与经济事务部、国家研究、技术和发展基金会以及维也纳大学计算机科学系安全与隐私组的财政支持；(2) SBA 研究（SBA-K1）；SBA 研究是 COMET 中心，属于 COMET——卓越技术竞争力中心计划，由 BMK、BMDW 和维也纳联邦州资助。COMET 计划由 FFG 管理。(3) FFG ICT 未来项目 874019 dIdentity & dApps。(4) FFG 工业博士项目 878835 SmartDLP。(5) 美国国土安全部科学和技术局硅谷创新计划（SVIP）下 OTA 70RSAT20T00000030 的资助。文中的任何观点均不代表国土安全部科学和技术局的立场。
