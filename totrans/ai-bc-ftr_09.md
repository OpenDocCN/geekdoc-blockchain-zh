© 作者，独家许可给 Springer Nature Switzerland AG 2021 年。 Maleh 等人（编辑）人工智能和区块链未来网络安全应用研究数据 90 [`doi.org/10.1007/978-3-030-74575-2_7`](https://doi.org/10.1007/978-3-030-74575-2_7)

# 重新审视检测安卓恶意软件的方法、数据集和评估参数：来自最新研究的比较研究

阿布·巴卡尔·西迪克（第一作者，1，3  ）、Md。 法希姆·蒙塔斯尔（第一作者，1，3  ）、Rifat 乔汉·利亚（第一作者，1，3  ）、谢赫·沙阿·穆罕默德·莫提乌尔·拉赫曼（第一作者，1，3  ）、Takia 伊斯兰（第一作者，1，3  ） 和 Mamoun Alazab（第二作者，2  ）（1）软件工程系，孟加拉达卡国际大学，达卡，孟加拉国（2）工程、信息技术和环境学院，查尔斯达尔文大学，达尔文，澳大利亚（3）未来研究实验室，达卡，孟加拉国阿布·巴卡尔·西迪克（通讯作者）电子邮件：abu35-1994@diu.edu.bdMd。 Fahim Muntasir 电子邮件：fahim35-1900@diu.edu.bdRifat Jahan Lia 电子邮件：rifat35-1845@diu.edu.bdSheikh Shah Mohammad Motiur Rahman（通讯作者）电子邮件：motiur.swe@diu.edu.bdTakia Islam 电子邮件：takia35-1014@diu.edu.bdMamoun Alazab 电子邮件：alazab.m@ieee.org

## 摘要

随着对安卓操作系统（OS）的认可，安卓恶意软件的数量正在增加。网络犯罪分子正在使用不同的技术为安卓设备开发恶意软件。此外，恶意软件作者正在努力制作严重破坏传统恶意软件检测器潜力的恶意安卓应用程序。本章的主要目的是分析并从不同角度审视各种研究文章中的安卓恶意软件检测技术。然而，本章提供了对各种安卓恶意软件检测方法的分析，并将它们与支持的各种参数进行比较，如检测技术、分析方法、提取的特征等。实验基于大量的恶意软件数据集、评估参数，本研究采用了各种机器学习技术，包括决策树和随机森林、支持向量机、逻辑模型树和人工神经网络，还有深度学习技术。这是一个比较分析，对研究人员在这一领域应该是有用的。分析显示，基于简单标准，已发表的重要研究在准确性方面的相似性和差异。因此，本章旨在研究各种安卓恶意软件检测技术，并确定可能的研究方向。研究结果显示，机器学习具有更高的检测准确率，是一种更有前景的方法。未来的研究人员可以追求使用大型数据集的深度学习方法以实现更高的准确率。

关键词：安卓恶意软件、深度学习、机器学习、恶意软件检测、最新技术

## 1 引言

术语恶意软件是恶意软件的缩写。恶意软件是指任何有意编写的软件，旨在损坏设备、窃取数据，并且通常会造成混乱。安卓操作系统会告诉用户应用将访问的系统和数据，但是操作系统不会在安装后阻止任何应用活动。因此，每台安卓设备都应该有一个安卓恶意软件防护程序。应用给设备带来的风险取决于其来源。根据王等人提出的基于 LightGBM 的安卓恶意软件检测模型[7]，提出了一种 LightGBM 的模型用于机器学习，他们在笔记本电脑上运行了这个模型，并发现从百度应用商店和谷歌应用商店下载了 2000 个良性样本，再次从 VirusShare ([www.​virusshare.​com](http://www.virusshare.com)) 下载了 2000 个恶意软件样本。他们发现 LightGBM 的准确率为 96.4%。因此，LightGBM 可以减少执行时间。丹尼斯等人[1] 提出了 IMCFN 方法。它主要分为两部分：恶意软件图像生成和 CNN 通过反向传播技术微调。为了评估，他们使用了两个数据集来发现安卓恶意软件，即 Malimg 恶意软件数据集（9,435 个样本）和 IoTandroid 移动数据集（14,733 个恶意软件样本和 2,486 个良性样本），他们主要关注深度学习。

恶意软件检测方法可以是静态的或动态的[33, 37, 41]。静态恶意软件检测依赖于从可执行文件提取的特征，如操作码、字节码、字节级别或字符串，而动态技术[12, 24]则基于系统调用和沙箱的行为特征。例如，包国等人[8] 使用了两个数据集，一个在微软上，另一个在 Drebin 数据集上。在 Drebin 数据集中，选择了前 10 个恶意软件家族，并使用了总共 4020 个安卓恶意软件样本进行了基于静态和动态特征的实验。此外，许多研究人员正努力使用各种工具和技术来检测安卓恶意软件，以实现他们的目的，如下所示。

研究人员提出了几种检测安卓恶意软件的方法，如下所示：- VizMal [9] 操作在一个安卓应用的执行跟踪上，并将其可视化为执行持续时间的每秒一个彩色方框的序列。诚然，经常倾向于通过对误分类的应用进行细粒度分析来调试恶意软件检测方法。

MaMaDroid [36] 以马尔可夫链的形式构建了 API 调用序列的模型，这些调用序列被依次用于提取特征，以便机器学习算法对应用程序进行分类为良性或恶意。马尔可夫链是一种无记忆模型，其中从一个状态转移到另一个状态的概率仅取决于当前状态。这通常表示为一组节点，每个节点对应一个特定的状态，以及一组连接一个节点到另一个节点的边，其转换的概率。

DroidSieve [34] 依赖于已知的一些特征，这些特征是 Android 恶意软件的特征，包括 API 调用。它对应用程序进行了完全独特的深度检查，以识别由现有技术遗漏的区分特征，包括本地组件、混淆工件和在混淆下不变的特征。评估其在一组超过 100K 个良性和恶意 Android 应用程序上的鲁棒性。对于检测，他们达到了高达 99.82 的准确率，零误报。等效特征允许使用 99.26% 的准确率进行家族识别。他们对一组超过 100K 个良性和恶意 Android 应用程序的鲁棒性进行了评估。对于检测，他们达到了高达 99.82% 的准确率，零误报。同样的特征允许使用 99.26% 的准确率进行家族识别。

本章的主要目标可以描述如下：

+   最广泛使用的恶意软件检测技术（机器学习和深度学习）已经从不同的顶级出版商进行了分析。

+   确定用于检测 Android 恶意软件的最常用数据集，以提供一个综合解决方案。

+   为了找出最优化的算法，以有效地检测 Android 恶意软件。

+   检测生成恶意软件检测结果所需的最优化参数。

+   已分析了发表了最多与 Android 相关的恶意软件论文的顶级出版商（IEEE、Springer 等）。

本章的其余部分组织如下：在本章中，试图展示从 2015 年到 2020 年关于 Android 恶意软件检测的统计分析的最佳出版论文，来自所有最佳出版商（IEEE、Springer、Elsevier 等）。在第二部分 2 中，简要回顾了关于恶意软件 Android 检测的统计和动态分析。在第三部分 3 中，尝试解释使用所提出的方法论进行此工作的过程。在第四部分 4 中，展示了基于这项研究进行理解 Android 恶意软件的分析结果报告等。最后，本文以第五部分 5 呈现最终结果而结束。

## 2 用于检测 Android 恶意软件的最流行方法

为了获得特征，存在一些命名为静态分析、动态分析和混合分析的方法，用于 Android 恶意软件检测。

### 2.1 静态分析方法

静态分析依赖于所有未执行代码收集的功能。在本研究中，包括[45–50]等几项研究进行了静态分析，这些研究中的 150 篇论文均已收集自 IEEE、Springer 等知名出版商的网站。Mahindru 等人[10]执行了一个近似模式，用于检查任何程序的属性，以在正确检查准确性和方法性数值分析之间取得平衡。Alazab 等人[10]讨论了 2011 年至 2016 年期间的论文的静态分析。它展示了不同算法的检测准确率以及应用程序分类率。Taheri 等人[11]展示并分析了使用静态方法的不同技术，例如 Drebin、StormDroid 和 DroidSIFT、ANASTASIA、AndroSimilar、SDHash 等，这些技术应用于 Android 应用程序。Lopes 等人[16]提到了一些静态恶意软件检测方法，例如 Android 资产打包工具（AAPT）。它从 APK 中提取文件。它还提到了一个使用权限和 API 调用作为特征的恶意软件检测框架。Yen 等人[17]谈到了静态分析的一些基本知识以及一些方法和技术。零日攻击和逻辑使静态方法更难完成其工作。如今，大多数静态恶意软件检测技术都是基于内容签名的。调用图、系统调用、dendroid 等是一些技术。A. Saracino 等人[18]提到了一个名为 Alterdroid 的工具，用于比较原始应用程序之间的行为差异。MADAM 是第一个旨在检测并在运行时停止任何类型的恶意软件的系统，而不专注于特定的安全威胁，它使用基于行为的多级方法。不仅 MADAM 的运行时检测准确率非常高，而且它还实现了低性能（1.4％）和能耗开销（4％）。赵等人[20]提到了 Android 应用程序安全身份验证机制（ASCAA）、Drebin 和基于 API 调用和 Android 应用程序中权限的使用的模型等内容。Wang 等人[39]谈到了静态分析的两种主要技术，即数据流跟踪和反编译，并讨论了一些静态分析工具，如 Smali 和 Apktool。

### 2.2 动态分析方法

在运行时，动态分析将识别应用程序行为，并通常在沙盒环境中执行。

动态分析通常逐步引导性，因为它只分析基本执行的代码。基于动态分析的恶意软件检测方法具有很高的性能。但是，与静态方法相比，动态分析方法更加耗时和资源消耗。然而，动态分析方法对最新恶意软件的检测更为简单，即使对现有恶意软件也是如此。Lopes 等人[16]表示与静态分析相反，动态分析包括在沙盒环境中执行给定应用程序，以监视其行为。它被检测到未知的恶意软件，并且还开发了一种使用运行时调用频率作为特征的 android 恶意软件检测方法，该方法使用了在模拟器中受损的恶意样本和良性样本的数据集，并使用了一个名为 Monkey 的工具。Yene 等人[17]说这种方法挑选出 android 恶意软件的执行程序整个 apk 文件，它需要一些内容与应用程序相关，并等待触发时刻。赵等人[20]提到行为基础检测技术在处理代码混淆加密方面取得了出色的成就。特征数据库很小，不需要频繁更新。因此，它更有可能检测到类似于已知行为模式的未知应用程序。

异常行为方法和使用设备调用日志常用于动态分析方法。在异常行为方法中，基于不遵循根深蒂固的合法活动的特定数据集中的模式的识别。虽然这种技术能够有效地检测未知应用程序，但误报率很高。系统调用日志是一个过程，其中软件请求从基本操作系统的内核中提供服务。在内核级别，恶意检测以高检测精度进行，误报率很低。

## 3 方法论

本文采用了一种完成集成技术的方法。初始化、预处理、最终选定手稿、提取细节、比较分析和发现是六个阶段。这些都是逐步进行的。通过遵循这些措施，本文顺利地完成了所有操作，并且在短时间内完成。这也使得分析能够从论文中收集和提取所有重要材料。通过这种技术，这项研究工作还能够简单地收集数据，并且将是安全的。

### 3.1 初始化

用于搜索所需信息的关键词是在最初定义的。为本研究确定的关键词是 Android 恶意软件检测、深度学习和机器学习。然后，搜索过程根据这些关键词开始。本文根据列出的关键词迅速收集了 250 篇论文。

### 3.2 预处理

在预处理中，将 250 篇无关的论文排除，列表减少了 210 篇，因为有几篇论文重复，并且不符合关键词和目标。然后，对最近的出版物进行分类，并列出名称。Springer、IEEE、ACM、Elsevier 等是一些已在预处理中确定的知名出版物。最后，只选择了 2015 年至 2020 年关于使用深度学习或机器学习识别安卓恶意软件的论文，并且论文数量再次减少到了 150 篇。

### 3.3 最终选定的手稿

因此，基于搜索文章后，深度学习和机器学习在安卓恶意软件检测上聚焦于关键词。然后，在识别常见出版物并删除过时论文甚至只选择 2015 年至 2020 年的论文后，论文数量减少了。因此，最终选定的手稿数量为 150 篇，涵盖了 2015 年至 2020 年的论文。

这里是方法论的图示（图 1)-![../images/507793_1_En_7_Chapter/507793_1_En_7_Fig1_HTML.png](img/507793_1_En_7_Fig1_HTML.png)

图 1

方法论图示

### 3.4 提取信息

在这一步中，从所有 150 篇论文中收集了所有必要的数据。收集的基本数据包括出版商名称、论文类型、出版年份、评估参数、使用的数据集、使用的算法和主要贡献。因此，这 150 篇论文的出版商名称主要是 IEEE、Springer、ACM 和 Elsevier。所有论文中发现了三种类型的论文，分别是期刊、会议和书章节。2015 年至 2020 年的论文已经被安全地收集和按年份排列。根据收集的数据，证明了不同的论文使用了不同的评估参数。一些评估参数包括召回率、准确率、精确率、F-度量、真阳性率、假阳性率、ROC 等。一些数据集包括 VirusTotal、Drebin、AMD、ImageNet、AndroZoo 等。本文收集了使用深度学习算法和机器学习算法的论文。一些在收集的论文中使用的深度学习算法包括卷积神经网络（CNN）、深度信念网络（DBN）、受限玻尔兹曼机（RBM）、长短期记忆网络（LSTM）、深度神经网络（DNN）、循环神经网络（RNN）、多模态神经网络（MNN）等。还使用了一些机器学习算法，称为支持向量机（SVM）、K 最近邻（K-NN）、K 均值、随机森林（RF）、朴素贝叶斯（NB）、部分决策树（PART）、神经网络算法（NNA）、多层感知器（MLP）、决策树（DT）等。本文还提取了每篇论文的其他技术，如数据流图、控制流图、N-gram 等。

### 3.5 对比分析

在收集所有文档的数据后，对它们进行了比较分析。例如，所有算法的名称及其类型都已经确定（深度学习和机器学习）。经过对列表的分析，结果表明，支持向量机（SVM）是安卓恶意软件检测中使用最多的算法，而机器学习是使用最多的算法类型。因此，从比较研究中可以明显看出，相比深度学习，机器学习更多地用于检测安卓恶意软件。对于这项研究工作，还确定了所有论文的评估参数。这意味着最常用的测量参数是准确性。

### 3.6 发现

在完成所有先前步骤后，此分析将验证先前步骤的结果。对于本文，从 2015 年至 2020 年收集了 150 篇论文的出版商名称和论文类型。从先前的步骤中，还发现了算法及其形式以及最常用的算法。数据集和评估参数，以及最常用的数据集和最常用的评估矩阵，也在结果列表中。 

## 4 结果与讨论

在本节中，尝试通过比较研究提供基于比较研究的比较分析，并最终在本报告中给出了结果。该研究的目的，本文通过分析当前与安卓恶意软件识别或检测相关的各种重要术语来呈现，包括 150 多篇论文。有关我们关键词的信息考虑到的文章可以在**https://doi.org/10.6084/m9.figshare.12520007.v2**。在这篇研究论文中，显示大多数研究人员使用了比较研究的机器学习方法（ML），不仅用于检测安卓恶意软件，还用于分类几种安卓数据集[10, 42, 43]以找出安卓恶意软件。

### 4.1 最适用的技术

根据比较研究，在过去几年中，提出了大量基于机器学习的安卓恶意软件检测技术，直到现在都有。许多研究人员，包括[2, 6, 13–15, 19, 21–23, 25–32, 35, 38, 40]，在 2015 年至 2020 年期间使用了机器学习方法，这些都在研究中涵盖了。因此，该研究发现，安卓恶意软件检测中的机器学习技术具有重要的贡献，并且这一贡献日益增加。![../images/507793_1_En_7_Chapter/507793_1_En_7_Fig2_HTML.png](img/507793_1_En_7_Fig2_HTML.png)

图 2

ML：-机器学习方法；DL：-深度学习方法

机器学习技术在应用于真实世界数据时存在一些假阳性。因此，大多数研究人员调查了恶意软件机器学习方法的使用[33]。图 2 显示，许多研究人员多年来使用机器学习（ML）技术来识别 Android 恶意软件，并且研究人员期望这种情况在未来会继续存在。

### 4.2 最常用的评估参数

如图 3 和图 6 所示，大多数研究人员通过在评估矩阵中定义召回率百分比来获得评估参数的结果。总的来说，由于评估的性能，模型、算法和许多方法的表现非常好。![../images/507793_1_En_7_Chapter/507793_1_En_7_Fig3_HTML.png](img/507793_1_En_7_Fig3_HTML.png)

图 3

TPR：真阳性率；TNR：真阴性率；FPR：假阳性率；FNR：假阴性率；AUC：曲线下面积；ROC：接收者操作特征

基于 2015 年至 2020 年的比较分析，本文中的所有研究人员提供的最大增强均在召回率上达到了所有评估指标之间的最大增强，以展示和增强他们的模型或方法。Alzaylaee 等人[3]建议使用召回率、一致性、准确性等一种或多种方法来评估设备性能。自 2015 年至 2020 年，在此评估中发现了召回率，它最常用于执行他们提出的方法来评估数据集并找出数据集检测 Android 恶意软件的性能。

### 4.3 算法分析

不同的研究人员在不同时间使用不同类型的算法来检测 Android 恶意软件，如下图所示图 4。从 2015 年至 2020 年的 Android 恶意软件检测相关论文搜索中发现，大多数研究人员在论文中将 SVM（支持向量机）作为最优先选择。其次，他们优先考虑了 RF（随机森林）算法，并且他们显著使用了 NB（朴素贝叶斯）、FNN（前馈神经网络）、DBN（深度信念网络）、CNN（卷积神经网络）、DT（决策树）、MLP（多路径学习）、DNN（深度神经网络）、NNA（最近邻算法）。研究人员使用了两种方法来检测 Android 恶意软件，一种是通过机器学习，另一种是通过深度学习。从 2015 年至 2020 年的 Android 恶意软件检测相关论文搜索中发现，大多数研究人员更倾向于使用机器学习算法来检测 Android 恶意软件。![../images/507793_1_En_7_Chapter/507793_1_En_7_Fig4_HTML.png](img/507793_1_En_7_Fig4_HTML.png)

图 4

AM：Android 恶意软件；SVM：支持向量机；CNN：卷积神经网络；NB：朴素贝叶斯；RF：随机森林；DBN：深度信念网络；DNN：深度神经网络；GAN：生成对抗网络；NNA：最近邻算法；RBM：限制性玻尔兹曼机；MPL：多路径学习；RT：实时；FNN：前馈神经网络；WANN：权重不可知神经网络；RNN：循环神经网络；J-48：决策树类；BN：贝叶斯网络；IBK：k-最近邻算法类；DT：决策树；MLP：多层感知机；RR：轮询；INN：增量最近邻；SDG：随机梯度下降；NLP：自然语言处理；RD：真实道路网络；BRF：平衡随机森林

从最后的刺激讨论中可以得出结论，SVM 是用于 Android 恶意软件检测的广泛使用的机器学习算法。

### 4.4 出版商

根据比较分析，IEEE、Elsevier、Springer、ACM、IOPScience、Arxiv、IET 是所有这些论文的出版商。图 5 表明 IEEE 在所有知名出版商中发表的论文数量最多。在 2015 年至 2020 年期间，72%的论文都发表在 IEEE。因此，其他出版商发表的论文数量较少。因此，比较分析显示，IEEE 在 2015 年至 2020 年期间基于深度学习和机器学习的 Android 恶意软件检测领域发表了最多的论文。![../images/507793_1_En_7_Chapter/507793_1_En_7_Fig5_HTML.png](img/507793_1_En_7_Fig5_HTML.png)

图 5

不同类型出版物的比较分析

### 4.5 数据集

通过这种比较分析，发现了许多数据集，许多研究人员使用不同的数据集来检测入侵 Android 恶意软件，并展示了数据集的性能，以便给出完美或准确的结果来检测 Android 恶意软件。如图 6 所示，自 2015 年至 2020 年分析了许多论文。在所有 150 篇论文中，发现大多数都使用了 Drebin 数据集来查找恶意软件和良性软件。因此，现在的趋势是使用 Drebin 数据集来检测恶意软件或良性软件。Drebin 数据集有很多信息，有助于检测 Android 恶意软件的入侵。![../images/507793_1_En_7_Chapter/507793_1_En_7_Fig6_HTML.png](img/507793_1_En_7_Fig6_HTML.png)

图 6

不同数据集和数据集类别上的分类。

表 1

Android 恶意软件检测中最常用的出版商、算法、数据集、分类器、性能指标和年度选定研究的统计数据。

![../images/507793_1_En_7_Chapter/507793_1_En_7_Tab1_HTML.png](img/507793_1_En_7_Tab1_HTML.png)

Alazab 等人[44]在深度学习在网络安全中的应用一书的各章节中提出了 Drebin 数据集，其中包含了大量的安卓应用程序和恶意软件，使用了各种深度学习应用。除了[3–5]之外，也使用了 Drebin 数据集。Drebin 因其可扩展性和可解释性的检测而闻名。

表 1 解释主要被出版商使用，按年份发表的文章，基于分类器的算法，数据集，最常用的分类器以及 2015 年至 2020 年间各年度的研究预测指标。此表的数据在上面已经使用了几个图表进行部分呈现。在这个表中，“Name”、“No”和“%”分别指组件的名称，使用该组件的文章总数以及其百分比。请注意，所有给定信息均收集自**2015 年至 2020 年**的**150**篇研究文章。首先，表 1 解释了在研究中使用的最常见的出版商安卓恶意软件检测。根据这项研究，**IEEE**是这项研究中最多的出版商，几乎有 72 篇文章发现了安卓恶意软件检测论文的出版，其次是 Elsevier 和 Springer。对于这项研究，这篇论文的标题 Android 恶意软件检测在**2016 年**发现了最多，其中共有 37 篇论文。其次是从 2017 年发现的，第三是 2015 年，为了进行对比研究而发现了 27 篇相关论文。这篇论文基于机器学习和深度学习算法，表 1 解释了使用机器学习检测安卓恶意软件的最大数量的算法，其中百分比为 83.7%，第二大使用率的是深度学习算法，百分比分别为 15.2%。之后，提出了安卓恶意软件检测研究中最常用的数据集列表。Drebin 数据集是安卓恶意软件检测中使用最多的数据集，在所有论文中被认为有 33.0%的使用了 Drebin 数据集来检测安卓恶意软件，谷歌商店（18.8%）是第二高使用的数据集。接下来是安卓恶意软件检测研究中最常用的分类器。支持向量机（SVM）是该领域中使用最多的分类器，由各位作者在 18.9%的文章中考虑到。第二和第三使用最多的分类器分别是随机森林（12.9%）和朴素贝叶斯（12.6%）。最后是安卓恶意软件检测文章中使用最多的性能指标。最常用的三个性能指标分别是**召回率**（17.6%）、准确率和 F-度量（16.1%）以及准确性（15.5%）。此外，这是一个巨大的平台，可以利用机器学习和深度学习算法来研究安卓恶意软件的检测。

## 结论

本文对安卓恶意软件的方法、数据集、评估参数和趋势进行了比较研究，并对深度学习和机器学习方法进行了入侵检测研究。具体来说，这项研究工作分析了七种深度学习方法，除此之外，本文还分析了七种机器学习方法。本文研究了包括 Drebin、病毒总量、病毒共享[www.​virusshare.​com](http://www.virusshare.com)、基因组、Contagio 等在内的数据集。

从这项研究和分析中可以得知，机器学习是检测安卓恶意软件最常用的技术，而 Drebin 是最常用的数据集，用于帮助检测安卓恶意软件入侵，因此可以说，Drebin 数据库和机器学习是当前的趋势。因此，现今大多数研究者使用 Drebin 数据集和机器学习方法来收集恶意软件样本，并考虑一些重要的性能指标，例如召回率、准确率、精确率、误报率、检测率等等。最后，发现绝大多数关于安卓恶意软件检测的论文都发表在 IEEE 出版物上。

为了实现这一目的，研究人员需要在机器学习领域寻找改进机制，通过深入学习技术更全面地探索检测安卓恶意软件的方法，并使用大量的 Drebin 数据集训练算法以充分利用模型。
