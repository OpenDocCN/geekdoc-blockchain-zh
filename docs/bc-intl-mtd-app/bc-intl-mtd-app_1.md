© 作者（们），在 Springer Nature 新加坡私人有限公司独家授权下 2021Z. Zheng 等人（编辑）区块链智能[`doi.org/10.1007/978-981-16-0127-9_1`](https://doi.org/10.1007/978-981-16-0127-9_1)

# 1. 区块链智能概述

郑子宾^(1, 2  )，戴红宁^(3  )和吴佳静^(2, 4  )（1）中山大学，广州，中国（2）中山大学数字生活国家工程研究中心，广州，中国（3）澳门科技大学，澳门，中国（4）中山大学数据与计算机科学学院，广州，中国郑子宾电子邮件：zhzibin@mail.sysu.edu.cn 戴红宁（通讯作者）电子邮件：hndai@ieee.org 吴佳静电子邮件：wujiajing@mail.sysu.edu.cn

## 摘要

我们已经经历了各种区块链平台的 proliferation，包括加密货币以及私链。在本章中，我们提供了区块链智能的概述。我们首先简要回顾了区块链和智能合约技术。然后我们介绍了区块链智能，这实际上是区块链和人工智能的融合。特别是，我们讨论了区块链智能解决区块链和智能合约局限性的机会。

## 1.1 概述

区块链的概念最早由 S. Nakamoto 于 2008 年正式提出，尽管在 1990 年代也有一些类似的概念被提出（Zheng 等人 2017）。由于技术限制，这一概念直到数字货币如比特币和以太坊的出现才得到了足够的关注，这些数字货币极大地推动了区块链技术的发展。区块链本质上由多个区块组成，这些区块存储了交易记录以及其他与交易相关的数据字段。为了帮助区块链网络中的节点在分布式和不可信的环境中达成共识，我们需要共识算法。区块链数据本质上是不可变的、可审计的、可追溯的。

区块链的出现使得*智能合约*成为可能，这一概念本质上是由 N. Szabo 在 1990 年代构思并提出的（Szabo1997）。特别是，合同条款或条件可以用计算机语言编写，如 Java、Solidity 和 Python。这些程序代码在达到某些条件时可以自动执行。因此，传统的商业程序可以自动化，从而大大节省官僚成本。然而，智能合约必须在一个或多个区块链上的虚拟机或容器中执行。因此，智能合约与区块链实际上是不可分割的（Zheng 等人 2020）。

来自区块链及其智能合约的大量异构数据已经产生。区块链数据包含宝贵的信息，区块链系统的运营信息，区块链中发生的异常行为，潜在的恶意攻击，诈骗分析以及交易追踪。最近人工智能（AI）的进步，特别是在机器学习和深度学习方面，为分析区块链数据并提取有价值的信息带来了机会。此外，AI 技术还可以促进智能区块链的运行或维护。我们称 AI 赋予区块链的智能功能为*区块链智能*。

本章在 1.2 节中概述了区块链技术，1.3 节中讨论了支持智能合约的区块链，1.4 节中介绍了区块链智能。

## 1.2 区块链

图 1.1 展示了一个区块链的例子。区块链是不断增长的。当生成一个新的区块时，将会有一个验证过程，这个过程需要区块链网络中的所有节点参与。如果验证成功，这个新区块将被添加到区块链中。这样，所有已提交的交易都无法被篡改。![../images/506524_1_En_1_Chapter/506524_1_En_1_Fig1_HTML.png](img/506524_1_En_1_Fig1_HTML.png)

图 1.1

区块链的例子由一系列区块组成，每个区块都存储交易和相关信息，并指向前一个区块的逆向哈希。

共识算法的重要功能是验证区块的可靠性。最具代表性的共识算法包括工作量证明（PoW）(Nakamoto 2008)，权益证明（PoS），以及实用拜占庭容错（PBFT）(Castro et al. 1999)。在 PoW 和 PoS 中，共识过程通常由用户（俗称矿工）完成，他们首先解决一个计算复杂问题，也称为谜题。与 PoW 和 PoS 相比，PBFT 有不同的共识过程。特别是，PBFT 让区块链节点通过多轮投票达成共识。总之，与银行和汇款等传统交易系统相比，因为共识算法可以确保在没有第三方（如银行）的情况下进行交易，区块链可以大大节省交易成本。此外，区块链还可以保证用户 pseudonymity，因为用户可以使用虚拟地址进行交易，而不是他们的真实身份。

区块链系统产生了大量的区块链数据。例如，根据 Statista 报告，2020 年 3 月，比特币的数据量达到了 263.5 GB([`​www.​statista.​com/​`](https://www.statista.com/)). 区块链数据包含了大量的商业价值和关键信息。例如，在分析区块链系统数据之后，我们可以找到可能的故障并识别性能瓶颈。

区块链技术具有去中心化、不可篡改性、不可抵赖性和可追溯性等关键特性（Li 等 2019; Zheng 等 2018b）。去中心化特性使得交易能够由整个系统中的大多数节点进行验证，而无需中央机构。这样，可以节省官僚成本并提高系统可靠性。不可篡改性意味着存储在区块链上的数据篡改非常困难，因为任何微小的修改都可能导致数据无效（散列值无效）。通过数字签名、非对称加密算法和分布式共识机制，可以确保交易的不可抵赖性。可追溯性意味着可以通过分析带有时间戳的公开可用区块链数据来追踪数据的来源。

区块链系统通常可以分为三类（Ahmed 和 Pathan 2020）：(1) 公共（无需许可）区块链；(2) 私有（需许可）区块链，以及(3) 联盟区块链。公共区块链包括比特币、以太坊和 EOSIO，用户可以公开访问区块链网络中的每一个节点，而私有区块链则对访问进行严格的控制。联盟区块链介于无需许可和需许可的区块链之间。通常，公共区块链的可扩展性不如私有区块链，因为共识算法的吞吐量较低，吞吐量指的是每秒确认的交易数量。联盟区块链的性能虽然低于私有区块链，但高于公共区块链。

## 1.3 智能合约

智能合约的概念最早是由 N. Szabo 在 1990 年代提出的（Szabo 1997）。特别是，智能合约被设计为一种交易机制，可以执行用计算机语言编写的合同条款或条件。尽管智能合约并不是什么新事物，但直到区块链技术的出现和成熟，智能合约才得到了充分实现。智能合约本质上是在区块链上实现的。首先，各方可以就合同条款达成一致，然后将这些条款转换成用计算机语言编写的程序，如 Java、Solidity 和 Python（郑等人 2020）。通过程序中的逻辑流程，很好地保留了智能合约中合同条款之间的逻辑连接，例如 if-else 语句或 if-else-if 语句。程序的机器码（或字节码）也持久地存储在区块链中；它们也可以被其他人访问。

智能合约可以有效地确保合同的执行。例如，如果满足智能合约中指定的某个条件，触发的语句将自动以可预测的方式执行相应的功能。以图 1.2 为例。在这个例子中有两个智能合约：（1）买方和供应商之间的合同 1（Contract 1）以及（2）买方、供应商和承运人之间的合同 2（Contract 2）。如图 Contract 1 所示，供应商向买方提供产品目录，其中包括详细的产品描述，如价格、库存和产地。买方可以然后下订单，指定数量、付款日期和预计交货日期。所有数据记录实际上都保存在区块链中。这个过程构成了购买合同，即 Contract 1。除了买方和供应商，Contract 2 还涉及承运人，承运人将从供应商处将产品运送到买方。同样，运输条款（或条件）也规定在合同中。一旦供应商接受承运人给出的合同条款，产品将被发送到承运人。然后承运人将产品运送给买方。程序构建了合同 2。请注意，Contract 1 和 Contract 2 的执行可以完全自动完成，无需任何第三方介入。![../images/506524_1_En_1_Chapter/506524_1_En_1_Fig2_HTML.png](img/506524_1_En_1_Fig2_HTML.png)

图 1.2

买方、供应商和承运人之间的智能合约示例

在合同 1 和合同 2 完成后，将进行并行支付程序。特别是，在合同 2 完成后，供应商将向承运人支付运费（即从供应商的应付账户向承运人的应收账户转移数字货币）。同样，在合同 1 完成后，买方将向供应商支付款项（即从买方的应付账户向供应商的应收账户转移数字货币）。因为没有第三方（如银行），整个过程都是以对等方式完成的。因此，可以大大节省回款时间和交易成本。

图 1.3 展示了智能合约的整个生命周期：（1）智能合约的*创建*涉及多方，他们可以进行几轮谈判并最终达成协议。然后，在程序员或软件开发者的帮助下，协议将被转换成计算机程序。（2）智能合约的*部署*主要集中在实现和实际放置智能合约上。值得注意的是，一旦智能合约被写入区块链，就无法对其进行修改。（3）智能合约的*执行*将在区块链之上进行评估和运行。当达到预定义的条件时，合同条款（即程序中的一个函数）将自动触发并执行。（4）智能合约的*完成*意味着智能合约的终止。特别是，部署、执行和完成阶段都涉及将数据（即交易）写入区块链，如图 1.3 所示。![../images/506524_1_En_1_Chapter/506524_1_En_1_Fig3_HTML.png](img/506524_1_En_1_Fig3_HTML.png)

Fig. 1.3

智能合约的生命周期

## 1.4 区块链智能

### 1.4.1 区块链和智能合约的限制

尽管区块链和智能合约带来了诱人的机遇，但区块链系统固有的局限性提出了几个研究挑战（郑等人 2019）。我们如下描述它们。

1.  (1)

    运营维护。由于区块链系统的去中心化和异构性，很难识别影响区块链性能的潜在因素。例如，Hyperledger Fabric 的交易吞吐量瓶颈与比特币和以太坊不同，因为采用了不同的共识算法。此外，与其他软件系统一样，智能合约由许多计算机程序组成，这些程序可能存在软件漏洞、恶意代码和运行环境不兼容的问题。因此，实现复杂区块链系统的智能和健壮运营维护至关重要。

1.  (2)

    -   智能合约的质量保证。智能合约存在许多软件漏洞，例如*重入*漏洞（Li 等人 2017）、过度收费问题（Chen 等人 2017）、随机性控制（Bonneau 等人 2015）以及去中心化自治组织（DAO）攻击。^(1) 此外，智能合约的正确性对智能合约至关重要，因为一旦它们部署在区块链之上，几乎不可能进行任何修订。然而，与软件系统类似，智能合约中通常包含编程错误，这些错误可能导致崩溃或不当行为，但由于智能合约的复杂性，检测和识别这些错误具有挑战性。

1.  （3）

    -   恶意行为检测。除了合法商业活动外，区块链可能被用于进行恶意行为，而这些行为由于区块链的*匿名性*（即匿名区块链地址）而难以被检测到。另一方面，加密的区块链数据也导致了仅通过数据分析难以检测和识别恶意行为的问题。此外，区块链数据的大规模和异构性以及用户行为的多样性使得问题变得更糟。因此，传统的基于分类的方法（例如，机器学习方法）不能直接应用。

1.  （4）

    -   交易跟踪与挖掘。对于监管机构来说，基于区块链的加密货币平台的交易跟踪对于调查金融犯罪、追回非法资金和改进监管体系具有重要意义。据报道，一家名为 Chainalysis 的区块链分析公司帮助联邦调查局（FBI）通过交易跟踪确定了两名腐败指控的代理人，他们从在线毒品市场运营商那里窃取了比特币（O'Neill2017）。另一方面，对于投资者来说，智能跟踪资金流向和从交易记录中挖掘知识可以帮助他们检查资金是否与非法身份有关或通过可疑路径污染，从而减轻潜在的金融风险。然而，由于交易记录的极其庞大和各种货币混合服务的存在，在区块链加密货币平台上实现高效的交易跟踪和挖掘是一项具有挑战性的任务。

1.  （5）

    市场分析和预测。基于区块链的加密货币市场一直是一个新兴市场，其表现与传统的法定货币或黄金和原油等金融资产完全不同。它一直在快速增长，近年来一直在上升。与相对成熟的其它市场相比，加密货币市场已经证明具有相对较高的价格波动和较高的投资风险。因此，对于投资者和监管机构来说，分析市场动态，检测非法市场行为，并进行市场预测是非常重要的。由于加密货币市场在市场行为和成熟度方面与传统市场非常不同，传统的分析预测方法不能直接用于加密货币市场的分析，因此我们需要结合这个新市场的独特属性来系统地分析和预测。

人工智能（AI）作为一个涵盖机器学习和认知计算的广泛领域，是智能体执行智力任务的能力。最近大数据、AI 技术（如深度神经网络）和通用计算机硬件（如图形处理单元 GPUs）的进步极大地推动了 AI 的发展。因此，我们见证了各种 AI 应用（如计算机视觉、自然语言处理、语音识别和情感分析）的激增。大数据在推动 AI 以及 AI 应用方面发挥着关键作用。例如，主要基于深度神经网络（DNNs）的深度学习已经取得了卓越的性能，这要归功于大量数据的可用性，使得 DNNs 能够从大量数据中提取（或学习）足够的特征。

各种区块链系统的出现产生了大量的区块链数据，这些数据对每个人都是公开的。以比特币为例。根据 Statista([`​www.​statista.​com/`](https://www.statista.com/)在 2019 年第三季度末的报道，比特币包含近 242 GB 的数据。对大量区块链数据进行分析不仅能够提取巨大的商业价值，也能为克服区块链系统的上述挑战带来巨大的机遇。近年来，AI 的进步也极大地推动了大数据分析的发展（Dai 等人 2019）。因此，AI 和区块链技术的结合有望克服区块链系统的上述挑战，从而形成智能区块链系统。我们将区块链与 AI 相结合称为*区块链智能*。值得一提的是，有一些研究努力（Dinh 和 Thai2018 ，Nassar 等人 2020）致力于将区块链与 AI 相结合，而大多数主要集中在利用区块链克服 AI 新兴的安全和隐私漏洞。与这些研究相反，本书中我们的工作主要集中在利用 AI 技术解决区块链的内在问题。

### 1.4.2 区块链智能带来的机遇

我们总结了 AI 增强现有区块链系统的机遇如下（如图 1.4 所示）。

1.  (1)*区块链的智能运维。*区块链实时生成大量数据。分析区块链数据，我们可以检测可能的故障，预测故障，并识别性能瓶颈，从而调整或优化区块链系统的性能。数据分析包括描述性分析、诊断性分析、预测性分析和规范性分析四个不同层次。一个有价值的通用平台来自于 Dinh 等人(2018)的工作，他们发现并证明了区块链数据的描述性分析能够有效评估三种代表性区块链系统（以太坊、Parity 和 Hyperledger Fabric）的性能。同时，一些可能的故障和区块链系统的实时性能也可以得到很好的监控（Zheng 等人 2018a）。除了对区块链数据的诊断性分析外，预测性分析也是必要的，以预测区块链系统的性能瓶颈。与诊断性和预测性分析不同，规范性分析可以通过模拟和优化区块链系统，从而提高区块链系统的可靠性。![../images/506524_1_En_1_Chapter/506524_1_En_1_Fig4_HTML.png](img/506524_1_En_1_Fig4_HTML.png)

    图 1.4

    人工智能解决区块链挑战的机遇

1.  (2)

    智能合约的质量保证。就像计算机软件一样，智能合约可能存在缺陷或者编程代码错误，这些缺陷容易导致崩溃和恶意攻击。检测和识别智能合约中的缺陷对于实现智能合约质量保证的最终目标至关重要。Luu 等人(2016)的工作提出了一个名为 Oyente 的符号执行平台来检测和识别潜在的缺陷。同时，智能合约本质上是一种对执行成本（例如，在以太坊中，智能合约的执行是通过燃料费来计费的）敏感的程序代码。因此，识别燃料费高昂的模式并纠正这些脆弱的智能合约是一个必要的需求。在 Chen 等人(2017)中，Chen 等人开发了一个名为 GASPER 的工具，通过分析以太坊智能合约的字节码来识别和定位七种燃料费高昂的模式。机器学习方法可以用来自动检测和识别智能合约中的脆弱缺陷。此外，智能合约数量的增加也带来了自动化多个合约组合的机会。特别是，我们可以找到和识别满足用户需求的合约，并将它们组合在一起以实现更全面的应用。与传统的分布式软件系统（如 Web 服务（Rodriguez-Mier 等人 2015））不同，智能合约缺乏语义描述和服务质量（QoS）评估指标。因此，预计将出现新的基于 AI 的方法来自动化标签智能合约的语义并提供数据驱动的智能合约 QoS 评估。

1.  （3）

    自动化恶意行为检测。去中心化的区块链系统使得审计诸如洗钱、钓鱼、赌博和发生在区块链平台上的诈骗等恶意行为变得困难。区块链系统产生了大量的交易数据，这些数据本质上对每个人都是可见的，而历史交易数据通过匿名化账户地址是伪匿名的。大量的区块链数据带来了审计和检测恶意行为的机会。对大量区块链数据的大数据分析可以帮助识别恶意用户，识别行为模式，分析市场操纵行为，并检测诈骗。陈等人（2018a[CR6]）对以太坊数据进行了跨图分析，并确定了在以太坊区块链平台发生的几项主要活动。正如陈等人（2018b[CR8]）所提出的那样，采用基于机器学习的方法来检测和捕捉在以太坊上发生的庞氏骗局。陈等人（2019[CR7]）分析了 Mt. Gox 比特币交易所泄露的交易历史，并通过奇异值分解（SVD）方法识别出多种市场操纵模式。此外，恶意用户可能利用多个匿名账户组成犯罪团伙，在区块链系统上进行非法活动。预计会有新的机器学习方法以及对多个账户的关联分析来解决这一问题。

1.  （4）

    复杂网络启发式的交易追踪。复杂网络是分析各种现实系统的通用工具，最近在模型化和分析基于区块链的加密货币的巨大交易网络方面展示了其有效性。一个有加密货币交易记录作为节点的有向交易网络通常需要根据复杂网络的概念进行建模。这个网络的边至少包括一个账户或地址之间的转移，节点是系统中的唯一账户或地址。基于区块链的加密货币系统的交易追踪包括两部分，追踪和预测。一方面，追踪问题关注通过研究交易记录来了解加密货币如何积累和流动。在 Lin 等人(2020)中，Lin 等人提出将以太坊交易记录建模为时间加权的*MultiDiGraph*，这可以表示比简单图更详细的交易细节信息。此外，为了从巨大的交易网络中提取每个以太坊账户最相关信息，该工作提出了*K*阶子图的概念来构建局部图，并为基于随机游走的图表示设计了几种灵活的时间游走策略。来自 Wu 等人工作的时间加权 MultiDiGraph 嵌入（T-EDGE）是一种新兴的图表示方法，创新地结合了来自时间域和金额域的交易信息，并仔细分析了真实以太坊数据的钓鱼检测实验以评估效果。

1.  （5）

    数据驱动的市场特征与分析。由于缺乏监管机构且起步相对较晚，基于区块链的加密货币非常波动和具有投机性。由于加密货币市场不依赖于任何银行或授权机构的政策，这个市场对真实（例如，经济、社会和政治）和虚假（例如，谣言）新闻都相当敏感。之前对比特币市场（Bariviera 等人 2017）和以太坊市场（Han 等人 2020）的研究已经证明，由于长距离记忆的存在，比特币和以太坊市场都与有效市场假说相矛盾。货币市场应该是一个基于实时价格数据映射到时间序列的非线性系统。通过这种方法，可以更有理由地假设这些加密货币市场与更广泛的分数市场假设一致，并且价格之间的潜在内部相关性也已经被成功证明。此外，Kondor 等人(2014)采用了主成分分析（PCA）方法来提取比特币交易特征，Chen 等人(2020)进一步探讨了比特币价格与其影响因素之间的依赖结构。

前述的区块链挑战似乎在人工智能、机器学习和大数据分析等其他领域的进步中找到了新的解决方案。接下来，我们将通过具体案例来阐述区块链智能的价值。

## 1.5 总结

本章概述了区块链、智能合约和区块链智能。区块链以其去中心化、不可篡改性、不可抵赖性和可追溯性为特点，有潜力重塑现有的工业和商业系统。同时，区块链启用的智能合约可以自动化业务流程，无需第三方，从而降低管理成本和减少周转时间。此外，区块链系统和智能合约产生了大量的区块链数据，其中包含巨大的商业价值。将人工智能、机器学习、深度学习和大数据技术集成在一起可以处理、探索和从异构区块链数据中提取有价值的信息。区块链所引入的智能能力被称为区块链智能，这可以极大地推动区块链生态的发展。区块链智能的广泛应用将在接下来的章节中进一步阐述。
