© 作者（们），在独家授权下由 APress Media, LLC 出版，该公司是 Springer Nature 的一部分 2023 B. Wu, B. Wu 给青少年的区块链[`doi.org/10.1007/978-1-4842-8808-5_8`](https://doi.org/10.1007/978-1-4842-8808-5_8)

# 8. 去中心化金融 (DeFi)：重塑金融服务

Brian Wu^(1  ) 和 Bridget Wu^(1)(1) 新泽西州 Livingston

全球金融体系包括许多机构，如银行、保险公司、证券交易所以及各种政府机构，这些机构负责监管上述机构。传统金融服务是集中的。中央当局发行货币并控制经济的燃料——货币的供应和分配。集中的金融机构通过集中的系统管理资产并执行交易，以减少欺诈。然而，这些过程也增加了系统内的复杂性，并导致了高额的中介费用以及缓慢的交易时间。此外，这些交易对所有参与方来说并不完全透明。

加密货币的采用在近年来加速发展，交易数字资产的去中心化网络市场无需第三方中介。因此，这些市场的流行正在重塑全球金融业。

去中心化金融（DeFi）代表了一种创新的方式来重建传统的金融服务。金融产品是围绕公共或联盟区块链和智能合约构建的。用户在 DeFi 系统中交易时控制自己的资产和个人数据。随着加密行业的成熟，更多的投资将用于建立 DeFi 解决方案。因此，自 2020 年以来，全球去中心化金融市场经历了巨大的增长。预计从 2022 年到 2030 年，它将以稳定的复合年增长率（CAGR）43.8%增长。

DeFi 生态系统包括各种产品，包括基础设施、去中心化交易所（DEXs）、借贷和借款、稳定币、保险、支付、去中心化自治组织（DAO）和托管服务。

本章的目的是向您介绍 DeFi。我们将概述 DeFi 的核心概念和结构，并对 DeFi 中的特定产品进行深入探讨，如去中心化稳定币（例如，MakerDAO 的 DAI）、去中心化交易所（例如，Uniswap）和去中心化借贷与借款（例如，Aave）。最后，通过提供使用 DeFi 产品的分步指南，本章将帮助您获得在现实世界中进行 DeFi 投资和交易所需的知识。

本章将帮助您了解以下实践主题：

+   去中心化金融（DeFi）是什么？

+   DeFi 的结构

+   去中心化稳定币

+   去中心化交易所 (DEXs)

+   去中心化借贷和借款

+   去中心化保险

## 去中心化金融（DeFi）是什么？

去中心化金融，也称为 DeFi，使用加密货币和区块链技术提供从日常支付、借贷和借款到复杂的衍生品和保证金交易的全方位金融服务。

传统的、中心化的金融系统通过他们的中心化服务控制用户交易。这些服务由于涉及第三方的交易过程，为资金在各方之间的流动和合规提供便利，因此收取高额交易费。2021 年，银行行业估计从透支收入中赚取了约 334 亿美元。

用户必须信任中心化系统来管理他们的资金。金融服务要求客户在与银行和其他金融机构进行交易时提供个人身份信息以验证身份。这个过程是因为政府规定银行必须执行 KYC（了解你的客户）和 AML（反洗钱）的复杂合规程序。金融机构使用 AML 来防止洗钱。

然而，不断增加的银行要求正在增加保护客户数据的复杂性。因此，金融行业不得不维护和升级其系统，以确保业务服务正常运行，并确保客户数据在实施新技术时安全。

由于金融机构涉及保护客户的资金和高度敏感的个人信息（PII），它们制定了非常高的保护标准，将安全问题放在首位。此外，网络犯罪分子通常会根据最大影响和利润来选择他们的目标。金融行业完美符合这些条件，一直是网络攻击者激励攻击的首选目标。

现代软件系统通常非常复杂，涉及许多计算机基础设施、软件和组件，如开源库、数据库、云生态系统、容器、网络、操作系统等。黑客使用漏洞搜索工具，如 Nmap、勒索软件、特洛伊木马和蠕虫，来寻找易受攻击的计算机系统、软件、服务器等。要保持最高级别的数据安全往往非常昂贵和具有挑战性，许多金融机构不得不在 IT 支出上收紧预算。

全球大约有 44,000 家银行和信贷联盟。不幸的是，并非每家公司都能妥善照顾他们的客户的用户数据。如今，银行和金融数据泄露频繁发生。因此，银行和金融数据泄露经常发生。

近年来，金融系统的网络安全风险有所增加。图 8-1 展示了从 2018 年 1 月至 2022 年 6 月的金融数据泄露情况。![](img/535492_1_En_8_Fig1_HTML.png)

条形图和折线图展示了 2018 年 1 月至 2022 年 4 月间数据泄露次数及其影响记录数。条形图在 2020 年 10 月达到最高峰，高达 37%。而折线图在 2019 年 7 月至 2019 年 10 月间数值最高，达到 1 亿条。

图 8-1

2018 年 1 月至 2022 年 4 月金融数据泄露事件

2018 年 1 月至 2022 年 6 月间发生了 982 起金融数据泄露事件，这些事件影响了大约 1.53 亿条个人记录。数据泄露从 2019 年到 2020 年增长了 13%，从 2020 年到 2021 年增长了 11%。

2019 年 3 月，超过 1 亿 Capital One 银行客户的信用卡信息遭到泄露，包括*社会安全号码*、出生日期、信用卡号码、信用评分、信用额度和余额。因此，银行不得不支付 1.9 亿美元来解决集体诉讼。

在 DeFi 中，金融协议可以在智能合约中定义。金融服务运行在去中心化的区块链网络上，任何有互联网连接的人都可以使用。没有传统的中心化权威、中介和信任机制。用户可以在安全的数字钱包中完全控制自己的资产，而不是在银行管理它们。2022 年 11 月 11 日，FTX，“期货交易所”，作为第二大加密货币交易所，申请破产。2022 年 11 月初，FTX 的估值超过 300 亿美元。作为一个中心化交易所，FTX 持有用户的钱包和私钥，管理用户资金。然而，交易所错误地将客户资金贷款给了 Alameda Research，当 FTX 遇到“流动性危机”时导致了问题。FTX 的崩溃提醒投资者“没有你的钥匙，就没有你的币”，并激发了对于去中心化金融平台兴趣的增加。

由于公共区块链的透明性，数据隐私已成为区块链上 DeFi 系统日益突出的担忧。区块链上已经有很多关注隐私的解决方案，包括安全多方计算（MPC）、零知识证明、联邦机器学习、离线数据存储等。

DeFi 正在蓬勃发展。DeFi 的总锁定价值或 TVL 在过去两年中从 2020 年初的 6 亿美元激增了近 40000%，到 2022 年达到 2390 亿美元。全球金融服务市场规模达到 23.32 万亿美元，而 2021 年 DeFi TVL 为 2400 亿美元。DeFi 仅占全球金融服务市场的 1%。在这个领域，它仍然处于非常早期的阶段，有很大的创新空间。DeFi TVL 在未来几年应该会继续激增。

## 去中心化金融（DeFi）结构

DeFi 服务基于分层架构构建，包括多个层次和组件的逻辑分离。每一层的组件与另一层的组件通信以执行其功能。通信通过预定义的接口进行。

DeFi 生态系统由五个不同的层次组成，包括聚合层、应用层、协议层、资产层和结算层，如图 8-2 所示。![](img/535492_1_En_8_Fig2_HTML.png)

一个具有 5 层结构的去中心化金融结构示意图。它包括聚合层、应用层、协议层、资产层和结算层。每个因素包括涉及各层的函数和过程。

图 8-2

DeFi 的结构——五层

### 第 1 层：结算层

结算层为所有 DeFi 交易提供基础——公共区块链及其原生加密货币构成结算层。结算层的例子之一是以太坊及其原生代币以太币（ETH）。

区块链交易数据永久存储在网络中。因此，任何资产所有权状态的改变都将遵循网络的共识机制、智能合约条件和其他规则，以确保交易执行只会按照既定协议进行。

由于这一层基本上是由区块链和分布式账本技术组成的，用于无信任执行，因此它作为结算层。

在撰写本文时，大多数 DeFi 应用程序都是基于以太坊网络构建的，该网络拥有超过 25%的所有去中心化金融协议。以太坊有 358.1 亿美元，占整个 DeFi TVL 的 58%。所有与 EVM 相关的 DeFi TVL 价值 508.5 亿美元，约占整个 DeFi TVL 的 82%。图 8-3 展示了区块链的顶级 DeFi 协议和 TVL。![](img/535492_1_En_8_Fig3_HTML.png)

饼图和 3D 柱状图展示了 DeFi 协议的区块链以百分比和 TVL（总价值锁定）以十亿计。饼图的数据如下。以太坊，25%。币安，20%。波场，13%。 fantom，12%。雪崩，11%。 Arbitrum，5%。 Cronos 和 solana，4%。 Optimism 和 hormony，3%。柱状图最高值约为 35%，属于以太坊。

图 8-3

Blockchains 的顶级 DeFi 协议和 TVL

### 第 2 层：资产层

资产层位于结算层之上。这一层包括所有代币，包括原生协议代币资产如以太坊和任何额外的代币，如 ERC-20、NFT 等，这些代币是在区块链上发行的。在这一层中，值得提及的是稳定币。

在第一章中，我们了解到加密货币市场的较高波动性为许多金融产品和个人消费带来了风险。稳定币通过提供稳定价值来最小化价格波动，为投资者提供了一个安全的避风港。它们的值与另一个波动性较小的资产挂钩，通常是一种流行的货币，如美元或英镑。稳定币作为交换媒介，在 DeFi 中广泛用作日常交易的货币。我们将在后面的去中心化稳定币环节中讨论更多内容。以下是在 DeFi 中一些流行的稳定币：泰达币、USD Coin、币安 USD、TrueUSD、DAI 和 Pax Dollar。

### 第三层：协议层

协议层为特定行业提供一套原则和规则，参与方已同意遵循。这些协议被编写在智能合约中，用以管理去中心化金融（DeFi）交易，且能在没有中心权威或第三方干预的情况下，以预定义的方式自主执行。许多 DeFi 协议通常由去中心化自治组织（DAO）进行管理。

去中心化自治组织（DAO）是一个没有中心权威的组织——没有首席执行官、没有董事会、没有需要服从或服务的经理，是自主和自我管理的模型。决策自下而上制定，并分布在整个社区代币持有者之间，这些代币持有者参与并投票。用户必须购买加密货币才能成为会员并成为代币持有者。DAO 的所有投票都发布在区块链上，使所有行为都可追溯。智能合约建立了 DAO 的规则，并在满足一组条件时自动执行。DAO 的整个过程完全透明且自主。

2020 年，DeFi 借贷协议 Aave 推出了自己的治理代币，以实现自主和去中心化治理。DAO 社区投票将决定 Aave 市场政策协议和协议政策，具体化为 Aave 改进提案（AIPs）。此后，其他 DeFi 项目采用了该模型，并正在向 DAO 迈进。流行的 DeFi 项目使用 DAO，如 Uniswap、Maker DAO、BitDAO、Aragon、Decred、0X、Dash、Compound 和 Curve DAO。

该层定义的所有协议都具有高度互操作性，可以被同时构建的任何 DApp 使用，并为 DeFi 生态系统提供流动性。该层的主要协议包括借贷、交易、保险、资产管理等。我们将在 DeFi 产品部分提供详细的 DeFi 用例。

### 第四层：应用层

应用层运行特定于用户的应用程序，这些应用程序连接到个人协议。这些应用程序作为 DeFi 服务，通常构建去中心化应用（DApps），以与协议层的一组智能合约功能进行交互，例如，资产管理、贷款和保险应用。

### 第五层：聚合层

随着 DeFi 的指数级增长，DeFi 生态系统中新的平台和协议数量迅速出现。因此，跟踪所有即将推出的 DeFi 产品变得越来越具有挑战性。

聚合层利用应用层聚合各种应用和协议，提供更广泛的服务和工具，并允许用户通过连接多个协议和应用高效执行复杂任务。DeFi 聚合器平台提供了一个简单的一站式解决方案，使用户能够通过一个聚合仪表板执行多种 DeFi 交易。这些聚合平台在活跃的 DeFi 用户中非常受欢迎。2020 年中，约 20%的去中心化交易是通过 DeFi 聚合器完成的。

顶级 DeFi 聚合器之一的例子是 1 英寸。它被设计为价格聚合器，提供提取在去中心化多个交易所（DEX）上交易的多种代币价格数据的工具。1 英寸聚合器使用自定义包装智能合约，在当前交易所汇率下包装/解包代币。交易员可以探索并在 DEX 之间交易加密货币。聚合器支持在以太坊、Binance Smart Chain、Polygon、Optimistic Ethereum、Arbitrum、Avalanche、Gnosis Chain 以及其他许多区块链上的流行 DEX 上进行加密货币交易所。图 8-4 展示了 1 英寸聚合器界面。![](img/535492_1_En_8_Fig4_HTML.png)

来自 1-英寸聚合器界面的两张屏幕截图展示了选择代币屏幕，其中包含以太坊和美元硬币。连接钱包选项有术语和网络及钱包列表。

图 8-4

1 英寸聚合器界面

DeFi 产品旨在通过提供各种去中心化金融服务，如借贷、支付、保险、交易、信贷、风险和其他许多金融产品，重塑传统行业。这些产品在无需许可的对等网络中消除了中心化的第三方公司。此外，DeFi 产品采用模块化设计，使应用程序有更大的自由度将这些开放的 DeFi 服务集成到其产品中。

## 去中心化稳定币

加密货币行业仍处于初级阶段。与传统的全球金融市场相比，数字资产的流动性仍然相对较小。此外，任何流动性较低的新兴市场都伴随着波动。

所有这些都导致了稳定币的兴起。稳定币是一种加密货币，旨在提供一种安全的数字资产以保持价值稳定。它将价格与其他类型的货币挂钩，如法定货币（如美元）或商品货币（如黄金或石油）。在过去的几年里，稳定币在加密货币市场上受到了广泛关注，许多稳定币项目已经推出。

### 稳定币历史

第一个稳定币 bitUSD 是在 2014 年 7 月发行的。bitUSD 与美元挂钩，可以在 BitShares 上自由交易。另一个稳定币 Tether (USDT)于 2014 年 10 月推出，与 bitUSD 一样，泰达币也绑定美元。如今，USDT 是市值最大的稳定币。

图 8-5 展示了近年来主要稳定币的发布时间线：![](img/535492_1_En_8_Fig5_HTML.png)

主要稳定币的发布时间线图。bitUSD 于 2014 年推出，随后是 2017 年的 DAI，2018 年的 trueUSD，2019 年的 BUSD，2021 年的 FEI，以及 2022 年的 USDD。

图 8-5

稳定币时间线

### 稳定币类型

稳定币可以分为几类。

#### 商品抵押稳定币

商品抵押稳定币是指那些用黄金、石油和房地产等实物资产支持的稳定币。最流行的商品抵押稳定币是泰达币黄金（XAUT）和 Paxos Gold（PAXG）。

#### 法币抵押稳定币

法币抵押稳定币绑定法币的价值，如美元、欧元或英镑，这是由政府发行的真实货币。通常情况下，法币是美元。例如，泰达币（USDT）和 USD Coin（USDC）是法币抵押稳定币的例子。

#### 加密资产抵押稳定币

加密资产抵押稳定币是指那些由现有数字货币（如 BTC 或 ETH）支持的稳定币。一个例子是 MakerDAO 的稳定币 DAI。DAI 是一种与美元挂钩的 ERC-20 代币，通过智能合约和激励机制在链上实现 1:1 的比率。稳定币的供应通过智能合约和 DAO 在链上进行调控。

#### 无抵押稳定币

无抵押稳定币这个术语指的是那些价格绑定在 1 美元，没有抵押支持的稳定币。它通常使用智能合约中的算法来控制稳定币的货币供应并稳定价格。无需抵押即可发行代币。

Neutrino USD 和 USDD 是算法加密资产抵押稳定币的例子。所有操作，包括发行、抵押、质押和奖励支付，都是透明的，由智能合约和流动性池进行管理。

### A Deep Dive into Stablecoins—Maker (DAI)

让我们深入研究流行的稳定币示例 Maker (DAI)，以了解更多。MakerDAO 是一个在以太坊区块链上运行的去中心化自治组织（DAO），采用两代币模型设计——治理代币和稳定币。Maker 平台上有三种货币：Maker 币（MKR）、Sai（SAI）和 DAI（DAI）。

MKR 是由社区参与者用于在 Maker 平台上进行投票权的治理代币。MKR 不是稳定币。第二种代币是稳定币，称为 DAI。DAI 是多抵押品 DAI，用于支付、抵押、交换资产、与许多协议集成，以及 DeFi 生态系统中的许多其他服务。DAI 目前由以太坊 (ETH) 和 Basic Attention Token (BAT) 支持。第三种代币是 Sai，它是支持 DAI 的单一抵押品类型。在 Sai 中支持的抵押品是 ETH 仅有。

#### DAI 如何工作

DAI 目前市值为 69.3 亿美元，DAI 供应量为 69 亿。DAI 的总供应量没有上限，供应是基于 Maker Vault 管理的。在 2019 年 11 月发布多抵押品 DAI (MCD) 之前，它被称为有抵押债务头寸 (CDP)。

Maker Vault 是 MakerDAO 中的核心智能合约组件，在为 Maker 系统持有抵押品（以太坊）后，将创建 DAI。一旦借出的 DAI 被归还，Maker Vault 将释放锁定的抵押品并燃烧这些 DAI。

DAI 是高抵押的，需要锁定抵押品价值的 150%来应对恶名昭彰的波动性。例如，如果你在以太坊中存入 100 美元，你将获得 50 美元的 DAI。假设 1 Ethereum 是 1439.685 DAI。100 DAI 由 0.104 ETH (ETH) 支持。

让我们通过一个类比例子来了解 Maker Vault 是如何管理 DAI 挂钩美元的。

想要借 DAI 的投资者创建一个 Maker Vault 并向其中发送 ETH。Maker Vault 生成相应的 DAI 并以池化以太坊 (PETH) 的形式锁定这些 ETH 抵押品。创建的 DAI 数量基于用户投入 Maker Vault 的以太坊数量。随着时间的推移，DAI 将带有利息存入用户的钱包，这称为 DAI 储蓄率 (DSR)。用户可以随时自由地取回他们的托管抵押品。他们需要向 Maker Vault 支付 DAI 以及一些稳定性费用 (MKR)。之后，这些 DAI 被燃烧，Maker Vault 被关闭。

图 8-6 展示了整个 Maker Vault 流程。![](img/535492_1_En_8_Fig6_HTML.png)

流程图用 6 个步骤展示了整个 Maker Vault 过程。它包括存入 1 ETH，开设一个给出 1 个包含 1 ETH 和 1439.685 DAI 的保险库，赎回并返回 1439.685 DAI，燃烧 1439.685 DAI 并返回 1 ETH，以及关闭一个给出 1 个保险库的过程。

Figure 8-6

Maker Vault Flow Manager DAI Creation and Burn

当任何一个下降，或者 DAI 上升，可能会导致存储在 Maker 库中的抵押品以太价值低于 DAI 原始支持的金额。然而，由于 DAI 是通过过度抵押品创造的，Maker 协议将确保 Maker 库持有足够的 Eth 以偿还 DAI，并在账户变得过于危险时清算 Maker 库。例如，如果市场 Ether 价格跌至一定阈值以下，Maker 库将锁定抵押品，直到用户偿还足够的 DAI，或者以最高出价拍卖以太。

#### Maker (MKR)代币供应

MakerDAO 最初推出了 100 万 MKR 代币的供应。截至 2022 年 9 月，Maker 代币的流通供应量为约 977,631 个，市值超过 7.37 亿美元。MKR 的总供应量是一个动态值，取决于市场价格和 Maker 协议系统的整体健康状况。Maker 系统通过发行和移除 MKR 来复杂地管理 DAI 的稳定性。

DAI 的价值由像 ETH 这样的抵押品保证，存储在 Maker 库中。当 ETH 市场价格下跌时，ETH 的价值变得不足以与相应数量的 D A I 保持挂钩。在这种情况下，Maker Protocol 会自动触发库的清算。

Maker Protocol 将创建新的 MKR 代币以增加总供应量。然后，这些新的 MKR 代币将出售并覆盖剩余的价值损失。

另一方面，如果抵押品价格上升，为了保持 D A I 的稳定价值，Maker Protocol 将购回并销毁 MKR 代币。这样，它将减少 MKR 的总供应量，导致过多的 D A I 被拍卖。

一般的流程在图 8-7 中展示。![](img/535492_1_En_8_Fig7_HTML.png)

Maker 代币流通流程图描绘了 Maker Protocol 协议。它包括库和 E T H，随着 E T H 价格上涨，产生更多的 D A I 代币，通过购回并销毁，而 E T H 价格下跌时，产生更少的 D A I 代币，并通过增发和 E T H 价格下跌。

图 8-7

MKR 代币流通

#### MakerDAO 的治理

正如我们所学，MKR 是 DAI 的治理代币。MKR 代币持有者在 MakerDAO 中就任何决策具有投票权，包括：

+   添加一个新的抵押品资产库。

+   调整现有库的风险参数。

+   修改 D A I 储蓄率。

+   触发紧急停机。

+   选择稳定费。

+   选择债务上限。

+   设置 Oracle Feeds 数据集。

+   升级系统。

Maker Protocol 支持链上和链下治理的规则。

包括非 MKR 持有者在内的所有人都可以提出新的治理规则。首先，该提案可以在公开的 MakerDAO 论坛（[`forum.makerdao.com`](https://forum.makerdao.com)）上进行非正式讨论和链下治理投票。然后更正式地，由 MKR 代币持有者在链上投票。

链上投票分为两种形式：治理投票和执行投票。可以通过 Maker 基金会投票门户（[`vote.makerdao.com/`](https://vote.makerdao.com/)）访问链上投票。

#### 治理投票

治理投票，也称为提案投票，衡量 MKR 持有者对提案的态度。它不会执行链上更改。必须在执行投票之前进行治理投票。以下是一些过去的提案示例：

+   社区绿灯投票—Cabot

+   抵押品登錄项目基金融资请求（PFR）

+   修改 DAI 基金会核心单元预算的批准投票

+   哦不，这不应该在这里

+   PPG—公开市场委员会提案 ![](img/535492_1_En_8_Figa_HTML.png)

治理投票的截图显示了发布日期位于顶部。下面的文本 reads，“社区绿灯投票，cobot。对优先登錄 cobot 的支特或反对表明立场。” 下面有中度影响、绿灯、评论和查看详情等选项。

#### 执行投票

执行投票在 Maker 协议上执行技术更改，以及更改协议或整个 DAO 在区块链上的状态。以下是一些过去的执行投票示例：

+   登錄现实世界资产保险库

+   参数更改

+   核心单元预算分配

+   MKR 授予转让

+   在重要的社区目标和目标上形成共识

+   抵押品登錄

投票力通过持有并出席的 MKR 代币数量来衡量。

例如，如果 100 个 MKR 持有者中有 100 个 MKR 投票支持提案 A，而另外 50 个持有者中有 1000 个 MKR 投票支持提案 B，由于有更多的 MKR 代币支持，提案 B 将获胜。

#### 投票支持一个提案

接下来，我们将演示如何在 Maker 基金会的投票门户中投票支持一个提案。

##### 第一步：获取您的 MKR 代币

您可以在 Coinbase、Binance、Kraken、crypto.com 等交易所购买、出售和交易 MKR。

##### 第二步：用钱包连接以太坊主网

在 Maker 基金会的投票门户中点击连接钱包按钮，并选择一个钱包连接以太坊：

![](img/535492_1_En_8_Figb_HTML.png)

用钱包连接以太坊主网的截图显示了选择钱包的选项和一个欢迎回来屏幕。

##### 第三步：选择一个活跃的投票

在投票门户中找到一个活跃的投票并选择投票选项：

![](img/535492_1_En_8_Figc_HTML.png)

活跃投票屏幕的截图显示了一个具体的治理投票、您的投票部分、投票分解百分比和系统信息。

##### 第四步：审查并提交您的投票

![](img/535492_1_En_8_Figd_HTML.png)

审查并提交投票屏幕的截图显示了一个具体的治理投票，带有您的投票和评论框、提交选项，还显示了包含以太坊主网详情的微软通知。

##### 第五步：完成投票

![](img/535492_1_En_8_Fige_HTML.png)

投票完成屏幕的截图显示了文本，你成功地在 1 个投票中投票，带有该投票的详细信息，以及分享你所有投票的选项。

## 去中心化交易所（DEXs）

中心化交易所（CEXs）的运作方式类似于银行。买卖双方都信任这些交易所平台来交易他们的资产。用户可以通过支付一定的交易费用，在交易所的中心钱包中购买、出售和交易比特币、以太币或其他加密货币，并且交易所将通过内部系统控制这些资金和加密交易的执行，然后代表用户在区块链上签署交易。

流动性意味着你可以在不影响其市场价格的情况下，多快地将一项资产兑换成现金。由于中心化交易所受到高度监管，因此吸引了众多活跃用户。这些用户创造了更多的订单，导致交易量增大并且汇率更快，这意味着更高的流动性。

要创建一个中心化交易所账户，用户必须提供有效的政府发行的身份证、银行详情和其他个人信息。注册过程是 KYC（了解你的客户）和 AML（反洗钱）实践的一部分，这些实践是按照法规要求的。此外，它帮助交易所确定客户的风险水平并防止洗钱和资助恐怖主义等犯罪活动。一旦中心化交易所验证并批准了身份，用户可以通过电汇、ACH 转账或存入比特币或以太币等加密货币来向交易所账户存入资金。然后，用户可以开始交易。

Coinbase、Kraken、Crypto.com 和 Binance 是流行的中心化交易所的例子。

尽管中心化交易所（CEXs）目前*处理了大部分*加密货币交易活动，但去中心化交易所（DEXs）越来越受欢迎。去中心化交易所（DEXs）是与中心化加密货币交易所完全相反的，后者管理交易所的代币所有权并持有用户的私钥。去中心化交易所（DEXs）是点对点的交易平台，使用户能够保持对资金的控制，并且无需中介来控制交易过程即可购买或出售基于区块链的代币和加密货币。相反，用户控制钱包的私钥。DEXs 使用智能合约，定义固定的条件来在区块链上执行并记录每笔交易，并收取低交易费。由于 DEXs 不涉及任何中心化权威，意味着 KYC/AML 是不需要的。任何人都可以开设账户，参与到 DeFi 生态系统中进行交易。交易是完全匿名的。

表 8-1 比较了中心化交易所和去中心化交易所之间的区别：表 8-1

比较中心化交易所和去中心化交易所

|   | 中心化交易所 (CEXs) | 去中心化交易所 (DEXs) |
| --- | --- | --- |
| 控制 | 交易所控制资金 | 用户控制资金 |
| 费用 | 需要。较高的交易费用 | 零或非常小的费用 |
| 流动性 | 高流动性 | 低流动性 |
| 监管 | 需要 KYC/AML | 不需要 KYC/AML |
| 用户身份 | 非匿名 | 匿名 |
| 使用情况 | 易于使用（甚至适合初学者） | 不用户友好。需要专业知识 |
| 安全性 | 可能会遭到黑客攻击和服务器宕机 | 无黑客攻击和服务器宕机 |

### 去中心化交易所类型

去中心化交易所（DEX）是去中心化金融（DeFi）的基础，它允许在自动智能合约上交易数字资产。去中心化交易所主要有三种类型：自动化市场制造商、订单簿 DEX 和 DEX 聚合器，如图 8-8 所示。![](img/535492_1_En_8_Fig8_HTML.png)

组织结构图展示了去中心化交易所的三种类型。这些类型包括自动化市场制造商、进一步细分为链上和链下订单簿的订单簿 DEX，以及 DEX 聚合器。

图 8-8

去中心化交易所类型

### 自动化市场制造商（AMM）

在传统的交易所平台上，市场制造商通常是一家经纪公司、大型银行或机构，将“创造市场”，正如其名所示。市场制造商通过在其自己的账户中买卖证券，为市场中的交易对创造流动性。买家和卖家对一项资产提供不同的价格，市场制造商总是为特定资产提供双面市场报价。他们通过提供购买和销售解决方案来补偿市场中的买入价和卖出价之间的差异——即卖出价高于买入价。

交易者 A，Alice，想以 19,600 美元的价格购买 1 BTC。交易所需要找到一个愿意以 Alice 喜欢的交易所范围，例如 19,700 美元的价格出售 1 BTC 的交易者 B，Bob。中心化交易所将充当 Alice 和 Bob 之间的中间人。假设 Bob 接受出价，交易所将向 Bob 提供 19,620 美元。然后，交易所将以 19,660 美元的价格向 Alice 出售 1 BTC。交易所将获得约 40 美元的利润。该过程如图 8-9 所示。![](img/535492_1_En_8_Fig9_HTML.png)

以下是 Alice 和 Bob 在中心化交易所进行交易活动的示意图。Bob 想以 19,700 美元的价格出售 1 BTC，但 Alice 想以 19,600 美元的价格购买。Alice 想以 19,660 美元的价格出售 1 BTC，而 Bob 想以 19,620 美元的价格购买。这些交易所的利润为 40 美元。

图 8-9

市场制造商活动

在自动化市场制造商（AMM）的情况下，有时也称为主动市场制造商，市场制造商被使用智能合约的自主协议所取代。AMM 中的智能合约始终保持两个（或更多）资产之间的报价，并确定数字资产的价格以及提供流动性。

### AMM 基本概念

与 CEX 相比，DEX 中的买家和卖家数量仍然很少。因此，找到足够多的买家和卖家以匹配的价格交易资产将很难。AMM 创建流动性池来解决此问题。AMM 为流动性提供者（LP）提供了一种称为“收益农耕”的做法，通过将适当的资产平衡添加到流动性池中来获得奖金。LP 将自动获得奖励代币，即基于以太坊的 ERC-20 代币，称为流动性提供者（LP）代币。这些 LP 代币代表作为池提供者的 LP 所有权。当 LP 提取存款时，LP 代币将返回 DeFi 系统。在流动性池中每发生一次交易，池将收取交易费用。LP 代币持有者将根据流动性池的增长 proportionality 获得奖励，LP 可以定期领取这些奖励。例如，如果您向 AMM DEX 池（如 Uniswap）贡献了价值 100 美元的代币，该池的总市值为 1000 美元，您将获得该池 10%的 LP 代币。

流动性池中的资产基金被锁定在智能合约中。借助 AMM，交易员可以不需要中心化市场制造商，使用流动性池在平台上无缝交易他们的资产。LP 将根据他们的投资获得手续费和激励措施的一部分。

另一边没有卖家或买家。相反，自动算法在 AMM 智能合约中确定流动性池中代币的价格。AMM 中的智能合约算法将自动化并优化，调整价格以响应市场需求。

#### 现有的 AMM 模型有哪些？

AMM 使用数学公式，根据流动性池中的供应量算法调整价格，以维持流动性池中资产的平衡。Uniswap，Bancor 和 Curve 等流行 AMM 协议使用了几个常数函数市场制造商（CFMM）。CFMM 包括常数产品市场制造商，常数和市场制造商以及常数平均市场制造商。

#### 常数产品市场制造商（CPMM）

CPMM 是由第一个基于 AMM 的 DEX，Uniswap，Bancor 和市场上最受欢迎的 AMM 普及的。CPMM 基于函数 x*y=k，其中 x 是流动性池中一种代币的量，y 是另一种代币的量。两个代币的价格范围取决于每个代币的可用水头。当代币 X 的供应增加时，为了保持常数产品 K，代币 Y 的供应必须减少，反之亦然。

例如（Uniswap V2），一个流动性投票中有 50%的 DAI 和 50%的以太币。假设一个以太币价值 2000 美元，一个 DAI 价值 1 美元。一开始，流动性池中有 9 个以太币和 18000 个 DAI。在这种情况下，一个以太币和 2000 个 DAI 的组合总价值为 4000 美元，可以计算为 2000 + 1 * 2000 = 4000。

流动性提供者将池中资产的 10%投入——一个以太币和 2,000 DAI。存款后，池中有 20,000 DAI 和 10 个以太币，每种代币都有 50%的份额。CPMM 常数 x*y=k 是 20,000 * 10 = 200,000。

现在一个流动性买家想要购买一个以太币。根据以下公式，以太币的价格为 2222 DAI：

(20,000 + x) * (10 -1) = 200,000 → x = 2,222

买家需要支付 2222 DAI 才能获得一个以太币。最后，池中将拥有 9 个以太币和 22,222 DAI。

过程如图 8-10 所示。![](img/535492_1_En_8_Fig10_HTML.png)

一个流程图展示了一个 A M M 常数产品市场商的示例。流动性提供者向池中存入 1 个以太币和 2,000 D A I，流动性买家购买 1 个以太币。交易前后的计算在上方给出。

图 8-10

AMM CPMM 示例

使用 CPMM 的一个去中心化交易所（DEX）示例是 Uniswap V1 和 V2（Uniswap V3 使用不同的函数），Bancor（V1），Sushi Swap，Pancake swap 以及其他衍生品。

#### 常数和市场制造商（CSMM）

常数产品的第二种变体是常数和市场制造商（CSMM），它通过简单地将常数产品中的乘法替换为加法（x + y = k）来持有 X 和 Y 资产的总和（x + y = k）。只要总和保持相同的常数，变量可以多次变化。

这种设计使得价格更容易预测，但当一个代币流动性池被抽干时，剩余的流动性只是一个资产，交易者再也没有流动性了。因此，CSMM 不能提供无限流动性，并且不盈利。因此，CSMM 很少被 AMMs 使用。

#### 常数平均市场制造商（CMMM）

第一个常数平均市场制造商（CMMM）由 Balancer 协议引入，允许投资者使用超过两种代币，并且维持 50/50 之外的平均权重，满足以下方程：

![](img/535492_1_En_8_Figf_HTML.jpg)

大写的π，上限 i 等于 1 到 n，R 下标 i 的 w 下标 i 次方，等于 K。

其中 R[i]是每种资产的储备，W 是每种资产的权重，k 是一个常数。

对于三个锁定资产示例，CMMM 使用如下流动性池公式：

(x *y *z) ^ (1/3) = c

其中 x，y，z 是选择的代币，c 是它们的常数产品。

#### 混合常数函数

如果基础交易对的价格几乎稳定（例如，两个以美元计价的稳定币交易对 DAI-USDC 进入 Uniswap 流动性池），常数产品函数可能不是最佳解决方案，因为滑点很大，回报也很小。因此，曲线金融使用 Stableswap 不变公式，这是常数产品和常数和公式的混合，函数如下所示：

![](img/535492_1_En_8_Figg_HTML.png)

n 的 n 次方，求和 x_i 下标，加上 D，等于 AD_n 的 n 次方，加上 D 的 n+1 次方除以 n 的 n 次方乘以 π x_i。

其中 x 表示每个代币的储备，n 是稳定币的数量，D 是一个代表整个代币储备价值的常数，A 是放大系数，这是一个与资产波动性成正比的调节常数，DAO 可以调整其价值。

在曲线稳定交换论文中，有一个比较稳定交换不变量与 Uniswap（恒定产品）和恒定价格不变量的图表，显示在图 8-11 中！[](../images/535492_1_En_8_Chapter/535492_1_En_8_Fig11_HTML.jpg)

一个图表比较了稳定交换不变量与美元中的 Uniswap 和恒定价格不变量。Uniwasp 曲线通过 (20, 2)、(5, 5)、(1, 30) 绘制。稳定交换曲线通过 (19, 0)、(5, 5)、(0, 30) 绘制。恒定曲线通过 (10, 0)、(5, 5)、(0, 10) 绘制。所有数据都是近似值。

图 8-11

稳定交换不变量与恒定产品和恒定和比较（来自 Curve 稳定交换论文）

稳定交换不变量在投资组合平衡时充当一个恒定和，为 DeFi 用户提供了一个更好的稳定币交换工具。

#### 自动做市商（AMM）的限制

如前所述，去中心化交易所（DEX）通常流动性低于中心化交易所（CEX）。因此，DEX 必须吸引新用户贡献他们的资产以产生更多流动性。有了流动性提供者（LP），交易所无法提供交易服务。由于流动性较低，AMM 通常有两个主要问题：滑点和暂时性损失（IL）。

#### 滑点

在最简单的术语中，滑点是交易预期价格和执行价格之间的差异。使用之前的 CPMM 示例（Uniswap V2），CPMM 常数 x*y=k 是 20,000 * 10 = 200,000。假设一个流动性买家想要购买三个以太币。以太币的价格是 8,571 DAI：

(20,000 + x) * (10 - 3) = 200,000 → x = 8,571

在这种情况下，一个 ETH 的实际价格是 2,000 DAI，但在 AMM 中，用户需要为每个 ETH 支付 8,571 DAI。最后，资金池将拥有 7 个以太币和 28,571 DAI。这就是滑点。

如果三个 ETH 占用了总 ETH 储备的 30%，那么滑点是 42.9%：

(28,571 - 20,000/20,000) → 42.9%。

在这种情况下，没有人愿意多支付 42.9% 的 DAI，实际上，DAI 的价值保持与 1 美元相同。

#### 暂时性损失（IL）

当用户爱丽丝作为流动性提供者时，她将在流动性池中质押她的资产（即 Uniswap V2）。当 Alice 想要从池中提取质押代币时，这些加密资产的市场价格通常会发生变化。流动性池会根据 x*y=k 公式自动调整代币价值。因此，提取的美元价值可能低于她存款的美元价值。如果爱丽丝保持她在池中的股份，不会发生实际损失。这就是为什么它被称为“暂时性损失”。损失可能会减少或完全消失，甚至可能获利，这取决于市场如何变动。让我们看一个例子如下：

1.  1.

    当 ETH 价格为 2,000 美元时，爱丽丝在 Uniswap V2 流动性池中质押了 10 ETH 和 20,000 DAI。增加的常数乘积是 200,000（10 ETH *

    10 ETH * 2,000 + 20,000 DAI * 1 = 40,000

1.  2.

    现在假设 ETH 市场价格变为 1 ETH = 2,500 美元。原始代币价值将是：

    10 ETH* 2,500 + 20,000 DAI * 1 = 45,000

1.  3.

    爱丽丝想要计算如果她提取资金的暂时性损失。假设流动性池开始调整和重新平衡代币价值。在这种情况下，如果池想要保持 50%的 ETH 和 50%的 DAI，DAI 和 ETH 各有 22500 美元。初始重新平衡价值将是：

    (20,000 + 25,000)/2 = 22,500

1.  4.

    在此案例中，ETH 的数量将是 22500/2500=9 ETH。通过应用 x*y = 9 ETH * 22500 DAI = 202,500。这个数字与原始常数 200,000 不同。因此，将继续重新平衡。

然后，可以使用以下公式计算每种资产的新分布：

![](img/535492_1_En_8_Figh_HTML.jpg)

X t 等于 k 的平方根除以 r t。Y t 等于 K 乘以 r t 的平方根。

在此，r 是池中两种代币资产之间的价格，t 是计算 r 的时间，k 是 CPMM 常数（x*y）。

让我们将这些公式应用于我们的示例，看看它是如何工作的。在此，r 是 ETH 价格变动前 2000，k 是 200,000。

![](img/535492_1_En_8_Figi_HTML.jpg)

E T H 减去 X t 1 等于 200,000 的平方根除以 2,000，等于 10。D A I 减去 Y t 1 等于 200,000 的平方根乘以 2,000，等于 20,000。

我们得到池中代币对的相同原始状态—10 ETH 和 20,000 DAI。在 ETH 价格在几天后变为 2500 美元时，r 是 2500。让我们重新应用相同的公式进行计算：

![](img/535492_1_En_8_Figj_HTML.jpg)

E T H，X t 2 等于 200,000 的平方根除以 2,500，等于 8.94。D A I，Y t 2 等于 200,000 的平方根乘以 2,500，等于 22,360.68。

公式显示，池中将包含大约 8.94 ETH 和大约 22,360.68 DAI。因此，我们可以验证它是否与常数 200,000 相匹配：

8.94 * 22360.68 = 199,904 ≈200,000

新代币对的值是正确的。如果爱丽丝继续在池中持有代币，总 DAI 将为 45,000 美元：

10* 2500 + 20000 = $45,000

投资收益回报将达 12.5%：

45,000-40,000/40,000 = 12.5%

我们可以简单地赚取 5,000 DAI（45,000 – 40,000）。

使用这些数据，我们可以计算如果爱丽丝提取代币时的永久性损失：

45,000 - (8.94 * 2,500 + 20,000) = $289.32

289.32/45,000 = 0.64%

爱丽丝的永久性损失为 0.64%和 289.32 DAI。

图 8-12 显示了永久性损失估算的图表。![](img/535492_1_En_8_Fig12_HTML.png)

一张图表显示了以太坊价格的永久性损失百分比。y 轴显示-80.00 至 0.00，x 轴显示 100 至 500。曲线通过（-73, 0），（0, 100），（-20, 400），以及（-25, 500）。所有数据都是近似值。

图 8-12

永久性损失估算（来自 Bancor）

以下是与之前图表相比的损失总结：

+   1.25 倍价格变动=0.6%损失

+   1.50 倍价格变动=2.0%损失

+   1.75 倍价格变动=3.8%损失

+   2 倍价格变动=5.7%损失

+   3 倍价格变动=13.4%损失

+   4 倍价格变动=20.0%损失

+   5 倍价格变动=25.5%损失

从我们的例子中，当价格从 2000 美元上涨到 2500 美元时，损失为 0.64%。有 125%的变化，与上述图表估计相匹配。

减少影响的几种解决方案，包括进行更小的交易、增加价格滑点容忍度以及提高流动性。

#### 订单簿去中心化交易所

订单簿基于当前列表价格级别列出特定金融资产的买入和卖出订单。对于某个资产的市场价格订单，寻求最低的卖出价格或最高的买入价格。价格不断更新，使交易员能够实时查看资产的未完成订单。订单簿通常由三个元素组成：

**买入订单或报价（出价）** – 它显示了交易员制定的所有买入订单，包括购买金额和询问价格。

**卖出订单或 Ask** – 它显示了交易员制定的所有卖出订单，包括卖出金额和买入价格。

**订单历史** – 它显示了交易员过去制定的所有买卖订单。

图 8-13 展示了 Coinbase CEX 和 dYdX DEX 的订单簿。![](img/535492_1_En_8_Fig13_HTML.png)

一对屏幕显示 Coinbase C E X 和 d Y d X D E X 订单簿。除了更新的价格水平外，它还有三个组成部分：买入订单也称为报价，卖出订单或 Ask，以及订单历史。

图 8-13

Coinbase CEX 和 dYdX DEX 订单簿

目前，DEX 上的订单簿有两种类型——链上和链下。

#### 链上订单簿

链上订单簿直接托管在底层区块链上，所有操作都在链上完成，包括订单提交、更新和取消。区块链记录所有订单交易，有效地消除了对中心化方的依赖。另一方面，每个订单都提交给区块链，交易将被广播到所有区块链验证/挖矿节点以验证。这使得订单簿交易缓慢且成本高昂。当价格发生巨大变化时，交易员可能需要更新他们的链上订单。由于速度缓慢，矿工可能会检查订单，然后操纵并验证和确认那些交易之前执行自己的订单。

以下是一些链上订单簿 DEX 示例：ViteX、Demex、Bitshares 和 Stellar 去中心化交易所。典型的链上订单簿过程在图 8-14 中说明。![](img/535492_1_En_8_Fig14_HTML.jpg)

一个典型的链上订单簿过程，制造商和交易者之间进行。制造商和交易者将资金存入智能合约中，制造商在订单簿中放置一个订单。交易者选择一个订单，最后订单在智能合约中结算。

图 8-14。

链上订单簿

市场制造商是提供买入或卖出订单的人，而交易者是立即买入或填充该订单的人。

链上过程可以按照以下步骤描述：

1.  1.

    市场制造商和交易者将资金存入智能合约中。

1.  2.

    制造商在订单簿中放置一个订单。

1.  3.

    交易者然后选择一个订单。

1.  4.

    订单在智能合约中结算。

#### 离链订单簿

离链订单簿是在区块链之外托管和运行的订单簿应用程序。订单数据也存储在一个中心实体中。一旦双边订单配对，离链订单平台将向区块链智能合约发送一个交易以结算。离链订单簿的优点是订单管理更快，费用更低。然而，它可能存在链上和离链之间的差距，并不能完全保证制造商订单仍然有效，这可能会利用订单执行。

离链订单簿的例子包括 dYdX、0x 协议、Loopring、AirSwap、EtherDelta、IDEX 和 Hydro。

典型的离链订单簿过程在图 8-15 中说明。![](img/535492_1_En_8_Fig15_HTML.png)

一个典型的离链订单簿过程，制造商和交易者之间进行。制造商和交易者将资金存入智能合约中，制造商在离线订单簿中放置一个订单。然后交易者选择一个订单，离线服务运行订单匹配，最后订单在智能合约中结算。

图 8-15。

离线订单簿

离链过程可以按照以下步骤描述：

1.  1.

    市场制造商和交易者将资金存入智能合约中。

1.  2.

    制造商在离线订单簿中放置一个订单。

1.  3.

    然后采取订单

1.  4.

    离线服务运行订单匹配

1.  5.

    管理员将订单发送到链上智能合约并结算交易

### 去中心化交易所聚合器

DEX 聚合器使用多种不同的协议和方法来解决与流动性相关的问题。这些平台开发了用于在多个中心化和去中心化加密货币交易所之间聚合流动性的工具。当交易者在某个平台的流动性不足时无法以预期价格交易加密货币时，会发生滑点。通过从不同的 DEX 聚合流动性，DEX 聚合器可以高效地最小化大订单的滑点。加密货币交易者可以从一个仪表板访问各种交易池，并选择特定代币交换的优化费用供应商。

以下是一些顶尖的 DEX 聚合器：1Inch、ParaSwap、Open Ocean、Orion Protocol 和 Matcha。

到目前为止，我们已经学习了很多理论。在下一节中，我们将深入探讨流行的去中心化交易所（DEX）Uniswap，并了解如何创建流动性池、质押和交换代币。

### 深入探讨 AMM DEXs——Uniswap

Uniswap 是最受欢迎的 DEX 和 AMM。该平台于 2018 年 11 月启动。v2 于 2020 年 5 月推出，当前版本是 2021 年 5 月推出的 v3。

Uniswap 平台的使用者可以无缝地交换任何两种不同的 ERC-20 代币，而不会产生太多的滑点。此外，该协议基于一系列智能合约运行，使得平台无需许可且无需信任。Uniswap 协议的原生代币是 UNI，它也作为治理代币，将其代币持有者赋予对协议更改的投票权。

目前，UNI 在以下四个流动性挖矿池中可用：

+   ETH/USDT

+   ETH/USDC

+   ETH/DAI

+   ETH/WBTC

截至 2022 年 9 月，Uniswap 中有超过 50,000 个交易代币对，每个池都有单独的流动性提供者代币。日交易量为 11 亿美元，总锁定价值（TVL）为 121.3 亿美元。Uniswap 用户可以通过多种方式参与 DEX：

+   **创建新池 –** Uniswap 用户可以使用智能合约创建一个用于交换新代币对的池。

+   **通过现有市场交换资产 –** Uniswap 中的代币交换允许交易者直接从一个 ERC-20 代币交换到另一个 ERC-20 代币。

+   **提供流动性并赚取奖励 –** 通过在 Uniswap 平台上质押资金，流动性提供者（LP）将获得 UNI 作为奖励。

+   **参与 Uniswap 治理 –** UNI 代币持有者可以对 Uniswap 平台进行投票并推动变更。

#### 在 Uniswap DEX 上列出您自己的代币

凭借我们学到的 AMM 知识，让我们把理论转化为实践，创建一个 ERC-20 代币，并将其列入 Uniswap DEX。

#### 先决条件

我们必须先处理一些先决条件：

1.  1.

    创建一个 ERC-20 代币。

1.  2.

    将其部署到以太坊网络。我们将使用 Goerli 测试网络。

1.  3.

    将部署的 ERC 代币添加到您的 MetaMask 钱包中。

#### 创建一个 ERC-20 代币

在第五章中，我们简要讨论了 ERC-20 代币。创建 ERC-20 代币有很多方法。如果您是一名有经验的智能合约开发者，可以编写自己的 ERC-20 代币。为了简化，我们将使用一个流行的开源安全智能合约框架 OpenZeppelin 来创建我们的 ERC-20 代币。这非常简单，只需要几行代码：

**第 1 步 –** 在浏览器中打开 Remix IDE ([`remix.ethereum.org`](https://remix.ethereum.org))。

**第 2 步 –** 创建一个名为 DeFiTeenToken 的智能合约。

**第 3 步 –** 我们将导入 OpenZeppelin 的 ERC-20 代币合同。OpenZeppelin 的 ERC-20 代币链接在这里：

[`github.com/OpenZeppelin/openzeppelincontracts/blob/master/contracts/token/ERC20/ERC20.sol`](https://github.com/OpenZeppelin/openzeppelincontracts/blob/master/contracts/token/ERC20/ERC20.sol)

**第 4 步 –** 在合同中，我们定义了 DeFiTeenToken 的初始供应量，在创建代币时。合同名称为 DeFiTeenToken，代币符号为 DFTT。"msg.sender"是当前正在创建此合同的人。在我们这个案例中，它将是一个选定的钱包账户地址来部署 DeFiTeenToken 合同。

这是我们 DeFiTeenToken 智能合约的样子。

![](img/535492_1_En_8_Figk_HTML.png)

一个去中心化金融代币智能合约的屏幕截图。它包含了 9 行代码，包括导入、合同 D e F i ten token 和构造函数。

您还可以从本书的 GitHub 仓库获取此合同——第八章：

[`github.com/Apress/Blockchain-for-Teens.git`](https://github.com/Apress/Blockchain-for-Teens.git)

**第 5 步 –** 编译 DeFiTeenToken.sol 智能合约。

**第 6 步 –** 使用 Remix VM 部署合同。我们将初始供应量设为 100,000,000。

![](img/535492_1_En_8_Figl_HTML.png)

一个去中心化金融代币的屏幕截图，显示了部署和运行交易。它包含了左侧的账户、合同和部署选项以及右侧的编码屏幕。

**第 7 步 –** 在 Remix 的“部署和运行交易”模块下进行一些快速测试。

通过点击名称、符号和总供应量，你应该看到相关的值显示出来：

![](img/535492_1_En_8_Figm_HTML.jpg)

一个屏幕截图显示了三个选项，名称作为去中心化金融青少年代币，符号作为 D F T T，总供应量作为 100000000。

**第 8 步 –** 测试转账功能。从账户下拉列表中复制第二个账户。将此账户地址输入到转账功能的输入字段中，并转账 1000DFTT。一旦交易完成，通过调用 balanceOf 函数并输入第二个账户地址来检查第二个账户的代币。你应该看到第二个账户有 1000 个 DFTT 代币。以下屏幕显示了测试转账功能的过程：

![](img/535492_1_En_8_Fign_HTML.png)

一组三屏幕显示了多个钱包账户的屏幕、将 1000 D F T T 代币转移到第二个账户的屏幕以及验证第二个账户 D F T T 代币余额为 1000 的屏幕。

-   **步骤 9 –** 现在让我们将 DeFiTeenToken 合约部署到 Goerli 测试网络。这次，我们输入 1000000000000000000000（22 位数字），因为代币单位是 18。现在到了部署合约的时候了。MetaMask 将弹出交易确认窗口。点击确认按钮。

![](img/535492_1_En_8_Figo_HTML.png)

分布式金融青少年代币的屏幕截图显示了部署和运行交易屏幕。它有一个账户、合约和部署屏幕，以及左侧的 meta mask 通知和右侧的代码。

注意

要使用 Goerli 获取测试 ETH 代币，你可以前往以下地址请求或挖掘几个代币：

(1) [`goerlifaucet.com/`](https://goerlifaucet.com/); (2) [`goerli-faucet.pk910.de/`](https://goerli-faucet.pk910.de/); (3) [`goerlifaucet.com/`](https://goerlifaucet.com/)

-   **步骤 10 –** 一旦合约部署完成，你就可以通过 MetaMask 中的链接在 Etherscan 上查看已部署的合约：活动 ➤ 合约部署 ➤ 在区块浏览器上查看。你还可以在 Remix IDE 中验证代币名称、符号和总供应量。你应该看到如下类似的结果：

![](img/535492_1_En_8_Figp_HTML.png)

一组三屏幕显示。1. MetaMask 页面突出显示合约部署状态。2. 在 remix 页面中突出显示交易名称、符号和总供应量。3. 合约的 Etherscan 页面。

我们部署的 DeFiTeenToken 地址是 0xbc438759cef061b82abafd95be018128cc4693f5，此合约的 Etherscan 链接 URL 是

[`goerli.etherscan.io/tx/0x242401f79c53764342645058dfa1b05b261deacab2e77267bcde5f0626116f48`](https://goerli.etherscan.io/tx/0x242401f79c53764342645058dfa1b05b261deacab2e77267bcde5f0626116f48)

由于合约部署在公共测试网络上，因此每个人都可以访问。

-   **步骤 11 –** 将 DFTT 代币导入你的 MetaMask 钱包。在 MetaMask 中的客户端资产标签，选择导入代币。它会要求你输入代币地址。你可以从 Etherscan 获取合约地址。输入合约地址后，你点击“自定义代币”按钮来导入 DFTT 代币。

![](img/535492_1_En_8_Figq_HTML.png)

导入 D F T T 代币的屏幕截图显示了 MetaMask 中的客户端资产标签、代币地址详情以及 D F T T 代币的部署。

成功部署我们的 DFTT 代币后，现在该在 Uniswap DEX 上创建一个新的池子了。

##### 在 Uniswap 创建一个新的流动性池

**步骤 1 –** 前往 Uniswap 网站：[`app.uniswap.org/#/swap?chain=goerli`](https://app.uniswap.org/%2523/swap%253Fchain%253Dgoerli)。以下屏幕将出现，点击连接钱包按钮。它将连接您到 Goerli 测试网络。

![](img/535492_1_En_8_Figr_HTML.png)

两组屏幕显示。1.Uniswap 网站页面上的“连接钱包”按钮高亮。2.Goerli 测试网络页面显示取消和下一页按钮，以及取消或通过 MetaMask 连接屏幕。

**步骤 2 –** 一旦连接，Uniswap 将弹出一个屏幕，给您一个地址，显示您在 Uniswap 平台上的所有代币交易。

![](img/535492_1_En_8_Figs_HTML.png)

屏幕显示 Uniswap 平台，有一个地址和所有代币交易细节的列表，以及连接、断开、更改和复制地址选项。

**步骤 3 –** 选择“创建一个池。”

**步骤 4 –** 按下“选择代币”选项。

**步骤 5 –** 在“搜索名称或地址”字段中输入您的代币地址，并从下拉列表中选择您的代币。

**步骤 6 –** 点击“导入”按钮。

**步骤 7 –** 将出现一个导入代币的弹窗。忽略警告。点击“导入”按钮。

你会看到一个类似的过程（从第 3 步到第 7 步），如下所示：

![](img/535492_1_En_8_Figt_HTML.png)

4 个屏幕显示创建池的步骤。1.在池平台上列出创建、移动和 V2 流动性选项。2.创建池页面有一个高亮的“选择代币”选项。3.第三个屏幕标题为添加流动性，有一个导入代币的弹窗，有一些详细信息。4.在选择导入代币后的添加流动性页面。

**步骤 8 –** 输入创建新池所需的信息：

1.  a.

    选择一个费用，从 0.05%、0.3%和 1%中选择。我们选择 0.05%。

1.  b.

    定义 DFTT 代币相对于当前 ETH 价格的价格。输入 0.001，例如。

1.  c.

    设定价格范围。将最小价格输入为 0.00001 ETH，最大价格为 1 ETH。

1.  d.

    存款金额。我们将在这个池中存入 0.01 ETH。Uniswap 应用程序将自动计算 DFTT 的数量，即 0.000000978 DFTT。

填写所有信息后，点击“Approve DFTT”按钮。MetaMask 将弹出并询问您确认交易。点击确认按钮。

![](img/535492_1_En_8_Figu_HTML.png)

两组屏幕。1.添加流动性页面有一个高亮的“Approve D F T T”按钮。其他一些选项包括选择配对和存款选项。2.MetaMask 通知屏幕显示交易费用、一些其他详细信息、拒绝和确认按钮。

**步骤 9 –** Uniswap 将显示一个预览页面。点击预览按钮。

![](img/535492_1_En_8_Figv_HTML.png)

屏幕上显示的是添加流动性页面。在选择配对选项中，0.05% 对稳定对是突出显示的最佳选择，并且已填写存款金额。它包括最小和最大价格的价格范围设置选项，以及批准 D F T T 的按钮。

**步骤 10 –** 将出现一个“添加流动性”弹出窗口。点击添加按钮以添加流动性。Metamask 将显示确认弹出窗口，并点击“确认”按钮。

![](img/535492_1_En_8_Figw_HTML.png)

一组两个屏幕。1\. E T H / D F T T 范围在添加流动性弹出窗口中与添加按钮一起显示。2\. 添加流动性页面有一个等待确认弹出窗口，以及带有拒绝和确认按钮的 Metamask 通知弹出窗口。

**步骤 11 –** 一旦交易在区块链上成功挖矿，您应该在 Uniswap 平台上看到您的新的流动性池，如下所示：

![](img/535492_1_En_8_Figx_HTML.png)

一组两个屏幕。1\. 突出显示池页面中的新位置和关闭位置。2\. Uniswap 页面显示 D F T T 斜杠 E T H 范围、价格范围最小值和最大值、当前价格等。

##### 流动性池中添加流动性

添加流动性与创建流动性池的几个步骤非常相似。整个过程如下所示：

![](img/535492_1_En_8_Figy_HTML.png)

5 个屏幕显示增加流动性的步骤。1\. 增加流动性按钮被标记。流动性、未领取的手续费等被显示 2\. 带有一些详细信息并标记预览按钮的添加流动性页面。3\. 标记添加按钮。4\. 突出显示确认选项。5\. 带有价格详情的新的流动性池页面。

##### Uniswap 中交换代币

**步骤 1 –** 选择交换标签并选择代币对。您可以输入代币地址，从可用的 ERC-20 代币的下拉列表中搜索和选择。

**步骤 2 –** 输入代币交换金额。例如，我们将通过 0.01 ETH 交换 DFTT 代币。

**步骤 3 –** 审查设置并确认交换。

![](img/535492_1_En_8_Figz_HTML.png)

一组 3 个屏幕在 Uniswap 平台上显示交换代币。1\. 突出显示选择代币选项。2\. 输入代币交换金额并选择无论如何交换选项。3\. 突出显示确认交换选项。

**步骤 4 –** 确认并交换。您可以看到从钱包中取出 0.01 ETH 以创建交换的总金额。

![](img/535492_1_En_8_Figaa_HTML.png)

4 个屏幕显示交换屏幕。1\. 等待确认弹出窗口和 Metamask 通知页面。2\. 一个弹出窗口，交易已提交并带有关闭按钮。3\. 显示 1.232 E T H 之前和之后 1.222 E T H 的交换页面。

注意

您可以从钱包地址查看所有最近的交易历史。要设置例如滑点容忍度等的交换交易设置，您可以点击右上角的设置图标。

![](img/535492_1_En_8_Figab_HTML.png)

一套两个屏幕。1.在右上角展示的交换设置选项，包括滑点容忍度、交易截止时间和干扰设置。2.展示最近交易信息的账户详情。

使用类似的步骤，您可以在池中交换任何代币，包括像 UNI 这样的流行代币。这是一个示例：

![](img/535492_1_En_8_Figac_HTML.png)

5 个屏幕显示了在池中交换代币的步骤。1.具有 E T H 和 U N I 范围的交换选项。2.带有 E T H、U N I、价格更新选项等的确认交换屏幕。3.确认交换弹窗突出显示确认交换按钮。4.带有 MetaMask 通知页面的交换屏幕，带有确认选项。

##### 从流动性池中领取奖励

最后，让我们看看作为 LP 持有者如何领取评论。

**步骤 1 –** 点击 DEFT/ETH 池，在“未领取费用”面板中有收集费用按钮。我们将选择 WETH 作为回报。点击按钮。

**步骤 2 –** 将出现一个领取费用弹窗，点击收集按钮。

**步骤 3 –** 接下来，MetaMask 将要求确认交易。点击确认按钮。

**步骤 4 –** 它将完成您的收藏奖励。

![](img/535492_1_En_8_Figad_HTML.png)

4 个屏幕显示了领取奖励的步骤。1. D F F T 斜杠 E T H 池页面突出显示收集费用按钮。2.包括价格范围和收集按钮的领取费用页面。3.带有拒绝和确认按钮的 MetaMask 通知页面。

**步骤 5 –** 将 WETH 地址导入您的 MetaMask。Goerli 网络地址的 WETH 地址是 0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6。您可以从互联网或 Etherscan 获取。

**步骤 6 –** 现在，您将看到您领取的奖励：

![](img/535492_1_En_8_Figae_HTML.png)

两个屏幕显示了已领取奖励的步骤。1.Goerli 测试网络页面包括导入代币的选项。2.在 Goerli 测试网络页面上，展示了带有 0.00001 W E T H 圈出的资产。

## 去中心化借贷和借款

DeFi 借贷协议与传统借贷平台类似。借贷协议使贷款人能够将资产借给借款人，借款人则以额外利息费用将资产归还给贷款人。DeFi 协议在区块链上运行，消除了第三方参与的需要，贷款人和借款人都是匿名的。

由于加密货币市场的波动可能会突然导致抵押品价值下降，借款人通常必须过度抵押贷款以提高信用，减少贷款人的风险。正如我们在稳定币部分所看到的，DAI 通过创建一个 Maker Vault，将过度抵押的价值锁定以对抗波动。借款人通常需要始终保持 150%的抵押品比例，以避免无法支付。

以下是一些最受欢迎的 DeFi 借贷平台列表：Aave、Maker 和 Compound。

我们在稳定币部分讨论了 Maker 协议。在本部分，我们将探讨 Aave 借贷。

### DeFi 借贷平台概览—Aave

Aave 是一个 DeFi 货币市场协议，允许用户使用变量和稳定利率借出和借入加密货币，而无需使用中介。2017 年，Aave 的原始版本作为 ETHLend 推出。2020 年，ETHLend 重新品牌为 Aave。

#### Aave 代币

Aave 有两枚代币，“AAVE”代币和“aToken”。

#### AAVE

在 Aave 借贷协议中的原生代币是 AAVE，一种治理代币。与 Maker 的治理代币一样，AAVE 允许持有者对 Aave 社区提交的提案进行投票。

#### aToken

aToken 代表了以利息供应或借用的加密资产的数量。aToken 的价值与相应供应资产的价值挂钩，比例为 1:1。

随着 Aave 流动性池的持续增长，aToken 的累积利息会增加。aToken 持有者可以直接将他们的质押奖励转到同一个钱包地址，或者将他们的利息支付转到另一个以太坊地址。

例如，爱丽丝提供了一个 aETH 代币供应，年化收益率（APY）为 5%。假设 1 ETH 是 2000 美元。总资产价值为 2000 美元。在爱丽丝持有她的 aETH 代币一年后，她赎回了她所有的 aETH，假设 1 ETH 是 3000 美元。aETH 的价值将是 1 + 1* 0.05 = 1.05 ETH，换算成美元将是 1.05 * 3000 = 3150 美元。投资收益回报将是 57.5%。

当一个贷方在流动性池中供应加密货币资产时，Aave 借贷池将在用户账户中铸造 aToken。当贷方决定提取他们的资产时，aToken 合同将调用赎回功能，计算利率返回资产给贷方，并燃烧相关的 aToken。aToken 合同赎回过程如图 8-16 所示。8-16

在 A A V X 智能合约中的代币决策图显示了代币合同赎回过程，以区块计算赎回功能，最终将资产的代币转让给用户。

图 8-16

在 AAVX 智能合约中赎回 aToken

#### 如何在 Aave 上存款

**步骤 1** – 访问 Aave 网站：[`aave.com/`](https://aave.com/)。点击启动应用程序按钮。然后选择并连接您的钱包到 Aave 平台。在我们接下来的逐步指南中，我们将使用 USDT 代币。您可以在流行的加密货币交易所购买 USDT。

![](img/535492_1_En_8_Figaf_HTML.png)

Aave 平台的两屏显示了连接钱包页面。它包括浏览器钱包、Coinbase 选项等。以太坊市场页面展示了供应资产和借款资产选项。

**第 2 步** – 在“资产供应”面板中点击 USDT 供应按钮。一个弹窗会要求你输入要供应的金额。在我们这个例子中，我们使用 10 USDT。交易概览部分会给你供应 APY 信息，这个供应例子中为 1.24%。点击“批准以继续”按钮。确认 Metamask 交易确认。

![](img/535492_1_En_8_Figag_HTML.png)

一组两个屏幕显示了展示 USDT 供应详情的以太坊市场页面。1\. USDT 供应弹窗中有 10 的金额输入，以及批准以继续按钮。2\. 供应 USDT 预览页面带有 Metamask 通知以确认。

**第 3 步** – 一旦供应得到批准，“供应 USDT”按钮将可用。交易完成后点击它。将出现一个“已完成”确认窗口。接下来，您将被要求添加 aToken—aUSDT 到您的钱包中。

![](img/535492_1_En_8_Figah_HTML.png)

一组两个屏幕的以太坊市场。1\. 它显示了所有详情的 USDT 供应弹窗，并且 USDT 供应选项已启用。2\. 带有其他一些详情的“已完成”确认窗口。

**第 4 步** – 将 aUSDT 代币添加到您的钱包中。

![](img/535492_1_En_8_Figai_HTML.png)

一组两个屏幕。1\. 显示 Metamask 通知页面的屏幕，以及添加建议代币的选项，以及带有添加到钱包详情和确定关闭按钮的“已完成”弹窗。2\. 在以太坊主网上突出显示带有 USDT 详情的资产。

**第 5 步** – 关闭“已完成”窗口并返回仪表板。仪表板将在“您的供应”部分显示供应的 USDT 信息。对于已供应的 USDT 资产有一个可用的提现按钮：

![](img/535492_1_En_8_Figaj_HTML.png)

一个屏幕显示了在您的供应和资产供应部分下的 USDT 信息。对于已供应的 USDT 资产有一个可用的提现按钮。对于资产供应有一个可用的供应按钮。

#### 如何在 Aave 上提现

**第 1 步** – 继续上述过程。接下来，点击已供应 USDT 资产的提现按钮。提现窗口将弹出。输入您想要提现的金额。然后点击“提现 USDT”按钮。确认 Metamask 交易。

**第 2 步** – 一旦交易完成，关闭“已完成”窗口并返回仪表板。仪表板将显示更新的 USDT 信息：

![](img/535492_1_En_8_Figak_HTML.png)

三个屏幕显示了在 Aave 上提现的步骤。1\. 带有金额输入在金额列中的 USDT 提现窗口，以及选中的提现按钮。2\. USDDT 提现弹窗和带有确认的 Metamask 通知。3\. 带有确定关闭按钮的“已完成”窗口。

#### 如何在 Aave 上交换

由于其治理结构，Aave 平台将 USDT、sUSD 和 SNX 代币视为重大的集中风险。它们的对手方风险过高，无论是在集中度还是信任方面。因此，USDT 作为抵押品选项在平台上被禁用：

![](img/535492_1_En_8_Figal_HTML.png)

一个屏幕显示了 Aave 平台，带有泰达币选项。它在标题栏中包括储备大小、可用流动性和其他详细信息。下面是储备状态和配置供应信息，带有绘制供应 APR 和圈出的抵押品使用的图表。

在此情况下，我们将把集中的 USDT 稳定币转换成去中心化的稳定币 DAI。我们将使用 Aave 的交换功能。

**第一步** – 点击供应的 USDT 资产中的“交换”按钮。一个交换窗口将弹出。输入您想要交换的金额，并选择目标交换代币。在这种情况下，将是 DAI。页面将显示当前市场条件下的价格影响，并提供选择最大滑点率的机会。然后点击“批准继续”按钮。

**第二步** – 一旦交换获得批准，"交换"按钮将被启用。交易完成后点击它，会出现一个“全部完成”的确认窗口：

![](img/535492_1_En_8_Figam_HTML.png)

一套三张屏幕。1. 以太坊市场页面，展示了供应和资产供应选项，分别启用了提现和供应按钮。2. 带有价格影响和启用批准按钮的“交换 USDT”页面。3. 全部完成的窗口。

**第三步** – 关闭“全部完成”的窗口，返回仪表板。仪表板将在“您的供应”部分显示带有抵押品启用的交换后的 DAI 代币：

![](img/535492_1_En_8_Figan_HTML.png)

一个屏幕显示了供应选项，展示了 DAI 和 USDT 资产、余额、APY 和抵押品详情。DAI 资产通过抵押按钮启用。

#### 如何在 Aave 上借入资金

现在我们已经将 DAI 作为抵押品存入，我们可以从 Aave 借入一些资产。在这个演示中，我们将借入 BUSD（币安 USD 稳定币）：

**第一步** – 点击“资产借入面板”中的 BUSD“借入”按钮。将弹出“借入 BUSD”窗口。输入您想要为 BUSD 借入的金额。页面上有健康因子信息。健康因子是借款人的贷款价值比率，表示您的清算阈值，或贷款被定义为不足抵押的比例。它用来衡量您的资金风险。值越高意味着资金状态越安全，您需要保持它高于 1.0 以避免失去资金。

点击“借入 BUSD”按钮。确认 Metamask 交易。

![](img/535492_1_En_8_Figao_HTML.png)

一套三个窗口。1. 启用抵押品 D A I 资产的供应面板。2. 借款面板中有 B U S D 资产的借款和详情按钮。3. B U S D 借款弹窗已启用借款按钮，并显示借款金额选项。

**第二步** – 一旦借款交易完成，会出现一个“已完成”的确认窗口。接下来，系统会要求您将 BUSD 代币添加到您的钱包中。将 BUSD 添加到您的钱包。

![](img/535492_1_En_8_Figap_HTML.png)

一套两个屏幕。1. 屏幕显示带有添加到钱包和确定关闭按钮的“已完成”窗口。2. “已完成”窗口和将 B U S D 代币添加到钱包的选项在 MetaMask 通知窗口中显示。

#### 如何在 Aave 上偿还

我们从 Aave 平台借了两个 BUSD。在本节中，我们将演示如何偿还 BUSD。

**第一步** – 为了偿还贷款，您只需前往仪表板上的“您的借款”部分，并点击 BUSD 的“偿还”按钮。

![](img/535492_1_En_8_Figaq_HTML.png)

两个屏幕显示您的供应和借款。供应屏幕具有提现和交换按钮以及其他详细信息。借款屏幕具有偿还和借入 B U S D 的按钮以及其他详细信息。

**第二步** – 将弹出“偿还 BUSD”窗口。输入您想要借入的 BUSD 金额。页面将显示您的剩余债务和健康因子信息。接下来，点击“批准继续”按钮。

**第三步** – 一旦偿还获得批准，“偿还 BUSD”按钮将被启用。交易完成后点击它。将出现一个“已完成”的确认窗口。您的 BUSD 现在已偿还：

![](img/535492_1_En_8_Figar_HTML.png)

三个屏幕显示偿还 B U S D 的步骤。第二屏幕上有使用钱包余额或抵押品在顶部的偿还选项。下面是金额输入，显示交易概要。在第一和第二屏幕上分别启用“批准继续”和“偿还 B U S D”。完成交易的“已完成”屏幕将显示已偿还的金额。

## 去中心化保险

在现实世界中，保险是一种保护您的健康和防止宝贵资产损失的方式。当意外事情发生时，如车祸、长期疾病、火灾、失业、受伤或死亡，它减少了财务苦难的风险。大多数支付保险的人不会遭受损失，保险公司赌的是大多数人支付保险的人不会遭受损失。因此，他们从个人那里收取的金额将涵盖有损失的人的损失。剩下的就是保险公司的利润。

有许多不同类型的保险，如金融保险。它保护公司免受各种损失，包括财产损害、诉讼、数据泄露、股票价值大幅下跌或商业伙伴破产。

近年来 DeFi 的指数级增长是显著的。作为一种相对较新的基于区块链的金融方法，DeFi 绕过了传统的中心化中介和不效率。然而，与此同时，这些也带来了风险。这些风险包括

**智能合约风险** – DeFi 项目是开源的，通常建立在复杂的智能合约之上。智能合约的逻辑错误或漏洞可能会导致软件故障。一旦合约部署到公共区块链上，几乎不可能修复错误。尽管治理协议可以升级协议变更，但通常在做出任何更改之前需要完成投票过程。

**DeFi 技术非常新颖** – DeFi 协议相当复杂，投资者完全理解智能合约设计通常是非常具有挑战性的。因此，只有在事情发生时，DeFi 产品的风险才可能被理解。

**监管风险** – 去中心化金融（DeFi）协议在没有 KYC 和 AML 监管的情况下蓬勃发展。然而，这也意味着当事情出错时用户无法获得保护，并且没有金融法规强制 DeFi 提供商保持资本储备。此外，政府可能会在未来实施对 DeFi 协议的监管，这将影响 DeFi 投资。

**私钥要求** – 在区块链中，如果您丢失了钱包的私钥，您将丢失其中的资金。因此，用户必须保护他们的钱包以保护他们的加密货币资产。

**无常损失** – 我们在 DEX 部分讨论过。这是由提供给流动性池的代币之间的价格波动引起的。

随着 DeFi 行业的快速增长和潜在风险，对于那些希望在购买保险以防范可能遇到的大部分潜在风险的同时参与 DeFi 的人来说，这是必需的。去中心化保险为 DeFi 行业提供了一张安全网。这个行业仍处于非常早期的阶段，并且正在快速发展并改进其协议。通过去中心化保险，用户不一定需要与中心化保险公司打交道。相反，一个去中心化的承保商池将通过收取加密服务费来保护某些事件的发生。一些承保范围包括：

+   DeFi 协议的攻击

+   钱包保护

+   智能合约失败

+   加密资产的波动性和闪崩

+   DeFi 存款

### 流行的 DeFi 保险平台

#### Nexus Mutual

Nexus Mutual 是一个去中心化保险平台，在以太坊区块链上创建了一个互助风险共享池。NXM 是 Nexus Mutual 的原生代币，在 Nexus Mutual 协议中充当治理代币。该协议由其持有 NXM 代币的社区推动。

每个 NXM 代币持有者都有会员权利。他们有权进行以下行为：

+   购买智能合约保险。

+   向互助基金存入资金并持有 NXM 代币。

+   与其他成员分享风险。

+   扮演风险评估员。

+   扮演索赔评估员。

+   提交治理提案。

+   投票表决提案。

Nexus Mutual 的主要产品是智能合约保险。

Nexus 可以保护数字资产的三种方式：

**收益代币覆盖**——这种覆盖保护代币脱钩。脱钩是指稳定币与其预期挂钩值偏离，例如，与美元挂钩的 1:1 稳定币。当其价值低于 1 美元时，该币被认为“脱钩”。

**协议覆盖**——这种覆盖保护针对特定项目的协议黑客。

**托管覆盖**——这种覆盖保护暂停提款和投资者存储在中心化交易所上的资金削减。

#### InsurAce Protocol

InsurAce 是一个去中心化多链协议，为去中心化金融（DeFi）社区成员提供保险服务。InsurAce 协议保护资金免受各种风险。

InsurAce 开发了广泛的加密货币保险产品，覆盖了在以太坊、Binance Chain (BSC)、Polygon 和 Avalanche 区块链上运行的许多协议。

InsurAce 协议提供了基于投资组合的以下覆盖：

**智能合约漏洞风险**——黑客正在利用智能合约中的漏洞窃取资金。

**托管风险**——托管人因犯罪、欺诈或其他类似情况至少失去其用户资金的 20%，或者在没有提前通知的情况下至少 120 天冻结提款。

**IDO 事件风险**——黑客通过利用智能合同中的漏洞从 IDO 平台窃取资金。

**稳定币脱钩风险**——稳定币的价格低于其挂钩价值。

#### Etherisc

Etherisc 是一个基于区块链的平台，用于构建去中心化保险产品。通用的基础设施、产品模板以及保险许可即服务（LaaS）使得社区用户可以不投资必要的时间和金钱从头开始创建自己的保险产品。由 Etherisc 社区创建的产品包括：

#### 作物保险

当政府机构报告干旱或洪水事件时，智能合约协议会通过平台自动向购买了作物保险的农民支付赔偿。

#### FlightDelay 保险

FlightDelay 是一个在 Gnosis Chain Mainnet 上运行的去中心化应用程序。FlightDelay 应用程序中的智能合约利用 Chainlink 或 acle 数据馈送自主发行和支付旅行者因航班延误或取消而产生的保险政策。因此，自动化的航班保险政策现在可以更快地结算，由于减少了人力和技术开销，成本更低，并且由于其运行在区块链网络上，更加透明。

## 摘要

本章旨在让您熟悉其生态系统中的流行去中心化金融（DeFi）产品，您在参与 DeFi 项目或投资时应该了解这些产品。

本章首先讨论了去中心化金融的概念。然后您被介绍到去中心化金融服务结构的五层。此外，通过详细介绍去中心化稳定币，我们深入探讨了 Maker 稳定币，了解其如何运作，并展示了如何在 Maker Foundation 的投票门户上对提案进行投票。接下来，在去中心化交易所（DEXs）部分，我们讨论了不同类型的 DEX，特别是针对自动化市场制造商（AMMs）的。我们学习了许多去中心化金融世界中的流行概念，包括收益农业、滑点、临时损失和流动性池。后来，我们还探索了最受欢迎的 DEX—Uniswap。最后，我们提供了一个实用的端到端指南，向您展示如何在公共区块链上部署您自己的 ERC-20 代币，在 Uniswap 平台上创建流动性池、添加流动性、交易您的自定义代币并获得质押奖励。

在去中心化借贷部分，我们概述了最受欢迎的去中心化借贷平台—Aave。然后我们展示了如何在 Aave 平台上借贷、提现、交易、借款和还款加密货币资产。

本章还讨论了去中心化保险。下一章将是我们的最后一章；我们将讨论区块链的未来。
