© Chris Dannen 2017Chris Dannen《以太坊与 Solidity 入门》10.1007/978-1-4842-2535-6_1

# 1. 弥合区块链知识鸿沟

Chris Dannen^(1 )(1)美国纽约布鲁克林区区适应快速发展的区块链世界可能具有挑战性。本书是您的指南。在我们开始之前，让我们定义一些您将在前面遇到的术语。区块链是一个完全分布式的点对点软件网络，利用密码学来安全地托管应用程序、存储数据，并轻松转移代表现实世界货币的数字工具。密码学是通过编码消息进行通信的艺术。在比特币和以太坊中，密码学被用来将数千台相似的计算机组成一个安全的计算环境，而这些计算机没有中央权威和单一所有者。有了这种潜力，很明显为什么这项技术会受到空前的猜测、炒作、混乱和预测。术语“以太坊”可以用来指代三件不同的事物：以太坊协议、使用该协议的计算机创建的以太坊网络，以及资助开发前述两者的以太坊项目。在比特币之后，以太坊已经成为自己的宇宙，吸引了来自众多行业的爱好者和工程师。许多文明中最令人讨厌的缺陷可能成为区块链杀手应用程序的领域，以太坊协议（从比特币衍生并扩展而来）被广泛认为是这些“分布式”应用程序将涌现的网络。对于开发人员、设计师和产品经理来说，现在是开始为以太坊网络原型化应用程序的最佳时机。

## 区块链点名！

有两大群体的思想家对区块链系统以及更具体地对以太坊感兴趣：一是对构建产品和服务感兴趣的应用程序开发人员，二是对以太坊潜力感到好奇的非程序员，这可能是因为工作或对金融服务、咨询、保险、法律、游戏创作、政府、物流、产品设计或信息技术感兴趣。¹ 这本书同样跨学科。它为程序员和非程序员提供了一个背景指南，帮助他们构思要构建什么，以及如何构建。它填补了计算机科学、经济学、金融服务之间的空白，必要时还有银行历史。对于程序员来说，以太坊的挑战通常不在于代码；像大多数开源软件项目一样，这个项目为已经在其他环境中编程的人提供了入口。相反，挑战在于理解“加密经济学”的概念，即确保网络安全的激励和惩罚系统。对于非程序员来说，挑战在于猜测生态系统将如何发展以及您如何融入其中。声称区块链将使银行系统现代化、革新保险业，并彻底消灭伪造可能言之过早——但程度如何？²

## 以太坊的功能

在摘要中，像以太坊和比特币这样的开源区块链网络是一种工具包，可以让你在软件中弹出一个经济系统，包括账户管理和一种在账户之间传递的本地货币单位。有点像游戏《大富翁》。人们将这些本地货币单位称为硬币、代币或加密货币，但它们与其他系统中的代币没有任何区别：它们是一种只能在该系统内使用的货币形式（或票据）。区块链的工作原理有点像网状网络或局域网（LAN）；它们只是连接到运行相同软件的其他“对等”计算机。当你想要通过 web 浏览器使其中一个这样的对等计算机网络可访问时，你需要使用特殊的软件库，如 Web3.js，通过 JavaScript API 将应用程序的前端（在浏览器中看到的 GUI）连接到其后端（区块链）。在以太坊中，你可以进一步地将这个概念扩展，通过与系统内的其他用户轻松编写金融合同。正如你将看到的，这些金融合同被称为智能合约。

> 关键组件是图灵完备的区块链这个想法。... 作为一种数据结构，它的工作方式与比特币的工作方式有点类似，但以太坊的区别在于，它具有这个内置的编程语言。——以太坊发明者 Vitalik Buterin ³

在以太坊中，智能合约是用 Solidity 编写的，你将在第四章中了解到这一点。图灵完备性是许多开发者迅速抓住的优势，但更重要的是以太坊的状态保存能力。在计算中，状态系统的一个简单定义是可以检测信息变化并随时间记住它们的系统。想象一台没有硬盘的电脑；你无法做太多事情。它就像一个计算器，内存内容瞬息即逝。在未来和在特定条件下工程化用户之间的交互能力，是区块链的一个强大补充。它允许开发者在加密货币交易编程中引入控制流程。这是以太坊和比特币之间最大的区别，但并不是唯一的区别，你将会看到的。控制流程指的是计算指令执行或评估的顺序。例子包括条件语句（如果这样，那么那样）和循环（在满足某些条件之前重复运行）。在比特币中，所有交易尽可能快地发生。由于比特币缺乏状态性，它必须一次性执行所有交易。比特币的创造者设想的区块链是一个分布式交易分类帐，它在网络中记录了每个人的比特币余额的总计。（对于细心的读者的风格说明：比特币网络写作大写字母，而代币比特币写作小写字母。）在以太坊中，类似的系统以标准化的方式被扩展。其次，这种通用脚本语言使得共享以太坊协议的区块链更容易共享数据，使得使用不同区块链的团体能够相互分享信息和价值。什么是协议？如果你是软件开发的新手，在这里了解一下信息技术（IT）的 10 秒钟速成课程将会很有用。IT 可以定义为研究计算机系统以存储、编辑、检索和发送信息。信息如何在时间上表示和更新，以反映内部和外部的变化，取决于使用哪个技术系统。在电信背景下，协议是一组规则，描述了计算机（及其程序员）如何连接到、参与其中并在系统或网络上传输信息。这些指令定义了系统期望的代码语法和语义。协议可以涉及硬件、软件和明文指令。以太坊不需要特殊的硬件，而且软件完全免费。在以太坊中，协议旨在构建分散应用程序，强调快速开发时间、安全性和互动性。

## 区块链的三个部分

区块链可以被认为是一个分布式或复制的数据库，存在于许多计算机之间。区块链这个词所代表的创新是这个网络数据库具有的特定能力，即使在网络上的一些节点以各种顺序接收到交易时，也能够调和交易的顺序。这通常是由于网络延迟引起的，由于物理距离，例如，一个用户在东京购买热狗的交易首先会被发送到日本的节点。几毫秒后，纽约的节点得知这笔交易时，布鲁克林附近的交易会“超前”于东京的交易。由于分布式系统中的主观视角造成的这些不一致性是使它们难以扩展的挑战所在。区块链系统的力量在于它们代表了我们可以部署来解决这个问题的技术的结合。通常所说的区块链实际上是三种技术的组合，这是比特币匿名创造者首次构想出的配方。这三种成分如下：

+   点对点网络：一组计算机，例如比特流网络，它们可以在彼此之间通信，而不依赖于单一的中央机构，因此不会出现单点故障。

+   非对称加密：这些计算机发送一条加密消息给特定的接收者，以便任何人都可以验证发送者的真实性，但只有预期的接收者可以读取消息的内容。在比特币和以太坊中，非对称加密用于为您的账户创建一组凭据，以确保只有您能够转移您的代币。

+   加密哈希：一种为任何数据生成小而独特“指纹”的方法，允许快速比较大型数据集，并安全地验证数据是否已被篡改；在比特币和以太坊中，Merkle 树数据结构用于记录交易的规范顺序，然后将其哈希成一个“指纹”，作为网络中计算机进行比较的基础，并围绕其进行快速同步。⁵

这三个元素的组合源于上世纪 90 年代和 21 世纪初数字货币的实验。2002 年，亚当·贝克发布了 Hashcash，开创了利用挖矿发送交易的先河。假名为中本聪的人在 2009 年创建比特币时，将分布式共识加入了这一创新。这三个元素共同模拟了一个简单的分散式数据库，存储在网络节点中。就像一群蚂蚁构成了一个功能正常的群体一样，你可以将比特币视为一台机器。在计算机术语中，它是一台虚拟机器，我们稍后会详细讨论其中的细节。以计算机科学的术语来说，以太坊在比特币虚拟机建立的范式上增加了一个可信任的全局对象框架消息系统。以太坊最早是在 2014 年提出的，详见以太坊白皮书。⁶

### 以太坊假设许多链

我们今天所知道的比特币并非唯一一种大规模部署比特币软件的例子。例如，莱特币使用了修改后的比特币软件，还有数十种其他的币种也是如此。以太坊的建立是基于一个假设：模仿者是一个不可避免的结论，可能会有很多个区块链，因此应该有一套协议可以让它们进行通信。**注意：** 了解以太坊协议需要掌握经济和编程概念。本书在必要时提供了这两方面的定义。以与比特币创作者截然不同的视角来看，以太坊的创作者们暗示着这样一种立场：如果加密货币在未来存在，那么它不会是一个去中心化的系统。相反，它将是一个分布式的去中心化系统网络，可以轻松快速地定义和实现许多不同用途和解释的加密价值代币。

### 这是一个骗局，就像比特币一样！

如果你在金融服务行业工作，或者你学过经济学，那么在谷歌上搜索更多信息可能会让你得出这样的结论：比特币本质上是一个全球性的庞氏骗局。让我们结束这个论断。你有一半是正确的：比特币的价值是由比特币市场决定的。当然，某些持有比特币的实体已经获得了国内货币传输许可，并将您的比特币兑换成美元、欧元、黄金或其他法定货币。但这些实体是私营企业，收取费用，并且随时可能破产。因此，比特币和类似的网络只有在没有“最后的救赎者”，没有可以确保将来能兑换您的比特币或以太币为美元的信任（政府或公司）实体的情况下才会受到影响。除了支付私人货币兑换商之外，将比特币转换为真正价值的唯一选择是连接到在线交易所，并将硬币交易为法定货币，从而找到另一位买家。就像比特币网络移动比特币代币一样，以太坊网络移动以太代币。以太与比特币的工作方式不同，正如你所看到的，可以更准确地称为加密商品而不是货币。让我们看看以太坊的经济学如何与基础技术相关联。

## 以太作为货币和商品

人们常说比特币没有任何支撑，这是真的。当然，现代法定货币也没有任何支撑。但它们是不同的：作为政府的认可，法定货币默认由任何缴税和购买政府债券的人持有。一些国际商品销售也以美元计价（例如，石油），这给了人们另一个持有美元的理由。对于加密货币来说，采用仍然存在挑战。如今，这些数字代币仍然是现有法定货币系统中快速、安全、公开的支付层；这是一种实验性的部署，可能有一天会取代像 Visa 和 MasterCard 这样的公司今天使用的集中式支付网络技术。然而，随着政府和私人机构投资者开始在加密货币中创造大型金融产品和服务市场，令人难以置信的可能性就在眼前。中央银行甚至可能采用这种技术。截至撰写本文时，至少有一个国家使用比特币软件发行了数字美元：巴巴多斯。其他国家正在积极研究这一前景。

### 格雷舍姆定律

加密货币作为金融产品、合同、保险单（等等）的计价单位有何意义？这与以太坊有什么关系？一种能购买大量有价值的证券和资产的货币是值得保存的货币。以太坊网络允许任何人编写可信赖的、自动执行的金融合同（智能合同），将在未来转移以太币。理论上，这可以实现面向未来的金融合同，使合同利益相关者有理由持有和使用以太币作为价值存储。最初应用于黄金和白银货币，格雷欣定律规定在一个经济体中，“坏”货币会挤出“好”货币。换句话说，人们储蓄和囤积他们预计会升值的货币，而花费他们预计会贬值的货币。虽然该定律以 16 世纪英国金融家的名字命名，但这一概念似乎可以追溯到中世纪的著作，甚至可以追溯到古代文献，包括阿里斯托芬的诗篇《青蛙》，通常被认为是公元前 405 年左右的作品：

> 未接触合金、黄金或白银的硬币，每一枚都精心铸造，每一枚都经过测试，响亮清晰。然而我们从不使用它们！其他人的手中不断流通……

数千年来，人们一直在一种货币工具中保存他们工作成果的价值，这种货币工具将保持稳定、升值，或者通胀——而不是易于贬值。如今，加密货币价格波动大，并且截至目前只有少数几个政府和跨国公司接受。在商业中几乎没有使用分散式智能合同。但同样，中央银行发行的法定货币有着可怕的历史记录，明显容易泡沫化、萧条化和操纵。加密货币能否成为真正的货币？它是否会比我们习惯的货币更好呢？

### 通往更好货币的道路

今天，比特币（以记号符号 BTC 表示）被人们、政府和公司用来转移价值和购买产品或服务。每当他们发送比特币时，他们都要向网络支付一笔小费，这笔小费以比特币计价。以太币，以记号符号 ETH 表示，可以类似地使用。要理解前进的道路，您需要了解一些事情。首先，以太币还有另一个用途：它可以用来支付在以太坊网络上运行程序。这些程序现在可以移动以太币，或者在未来或满足某些条件时移动。由于它可以支付未来交易执行的能力，以太币也可以被认为是一种商品，就像为网络运行应用程序和服务提供燃料一样。因此，它在比特币之上具有额外维度的内在价值；它不仅仅是一种价值储存。今天，法定货币的压倒性使用可能表明，加密货币是更糟糕的货币——即，在长期内更容易贬值。然而，截至目前，比特币和以太币被持有者广泛囤积，甚至被至少一家公司信托：灰度，数字货币集团的子公司。与此同时，西方各国央行尝试采用接近零利率和量化宽松，也就是印钞，以更加危险和拼命的尝试来控制通货膨胀和通货紧缩。随着比特币每四年减半一次的奖励，全球货币政策问题，普遍经济不确定性以及对法定货币信心的减弱，巨额潜在的“囤积”加密货币正在被更高的价格吸引到市场中以满足真正的需求。这反映在大多数加密令牌价格不断上升，尽管它们的价格在一天之内波动很大。囤积者、投机者和消费者之间的这种平衡创造了一个蓬勃发展、健康的加密货币市场，并暗示着加密令牌作为一种资产类别已经在服务于货币的目的，以及更多。

### 加密经济学和安全性

讨论智能合约时提及货币和商品的一个原因是训练自己以纯软件的形式构建经济系统的思维方式。这就是以太坊的承诺。在这本书中，我们将讨论软件系统设计与博弈论规则的结合，构成了新兴的加密经济学领域的技术课程。乍一看似乎简单的东西——比如权益代币——当以代码形式呈现时会产生复杂的世界。事实上，使以太坊和比特币等系统如此安全的原因在于它们不是基于任何防黑客技术，而是依赖于强大的财务激励和惩罚来阻止恶意行为者。这些都是吸引人的价值主张，每位工程师和软件设计师都应该为此感到兴奋。但是，引导货币（或票据）代币是一项完全不同的、额外的挑战，让人们对终端用户应用感到兴奋。这本书解决了这个挑战的两个方面。尽管这种软件最明显的应用可能在金融服务中找到，但未来的应用也可能使用相同的杠杆——信任、交易、货币和脚本——来实现完全不同的目的。就像命令行最终导致了图形用户界面(GUI)，现在又是虚拟现实（VR）应用程序，你可以决定用以太坊创建什么。但是我们会讨论一些例子。

### 回到美好的过去

毫无疑问，比特币和以太坊给编写软件程序增加了一些复杂性——经济方面的复杂性。但从某些方面来说，它们也更简单；与去世纪七十年代的计算机工作方式相似，使用去中心化协议就像使用那些庞大而昂贵的共享资源一样。它们是巨大而昂贵的共享资源，个人可以从拥有这类计算机的大学或公司租用机器时间。以太坊网络充当一个执行程序的大型计算机；它是由其他计算机组成的网络“虚拟化”的机器。由许多私人计算机组成，以太坊虚拟机（EVM）本身可以说是一个无主的共享计算机。对 EVM 的更改通过硬分叉来实现：说服整个节点运营社区升级到以太坊软件的新版本。网络的变化不能简单地由核心开发团队推动。它们涉及说服和阐明的政治过程。这种无主配置旨在最大化正常运行时间和安全性，同时最大程度地减少了暗中活动的动机。

### Cryptochaos

此时，你可能会感到头晕。别担心——当你深入后面章节的具体内容时，所有这些信息都会更加清晰。但是，永远不要害怕：每个第一次接触区块链开发的人都会感到不知所措。这是一种新技术，事物变化迅速，对去中心化系统的专业知识很少。没有人知道接下来会发生什么，但很明显，这项技术正在发挥作用——截至本文撰写时，市值已超过 260 亿美元，大约是所有加密货币的市值总和。大大小小的零售商，线上和线下开始接受数字货币支付。（请注意，除非另有说明，所有金额均以美元计价。）所以，即使你以前从未编程过，也不要停在这里。以太坊项目是为新开发人员而建立的，并为你提供了创建前所未有的解决方案的工具。你要想好用这个强大的新工具集建造什么。如何建造它，以及为什么你应该学习区块链开发是本书的其余部分的主题。

## 协议的力量在于其中。

在当今的技术行业中，应用层占据主导地位：这是所有用户数据所在之处。像谷歌、Facebook 和 Twitter 等几十亿美元的公司已经建立了庞大的基础设施，以支持国际用户群。所有这些都建立在传输控制协议/互联网协议（TCP/IP）、超文本传输协议（HTTP）、简单邮件传输协议（SMTP）以及少数其他协议之上。在以太坊和比特币中，至少目前，应用层相对较薄，因为协议为您提供了很多。事实上，迄今为止，许多基于比特币的公司都相对较少，因为它们已经是一个非常有效的支付网络的顶层。【⁹】注意：市值是对一个组织或生态系统价值的衡量。它是通过将一个股权的价格（例如，一个以太币）乘以流通中的股份数量来计算的。市值被广泛引用为加密货币采用的指标；然而，使用货币基数可能更为合适。货币基数是公众流通的货币总额，或由使用该货币的机构所持有的货币总额。因此，五六年前许多风险投资家预期的比特币创业潮从未到来。相反，比特币行业迅速进入了整合阶段。【¹⁰】但是，比特币作为一个网络的市值在不到十年的时间里膨胀到了近 190 亿美元。以太坊的市值约为 10 亿美元。这是一种前所未有的、快速的新方式，用于启动一个新的网络协议。【¹¹】传统的网络应用程序在很大程度上是昂贵的，因为它们必须被设计来存储和交换用户数据，因此必须有系统来隔离不良行为者以获得信任。许多私人数据中心都在防爆防御景观和一层层的铁丝网后面运作。当安全性可以被一个安全的去中心化网络所超越时，在线业务的运营商将经历大幅降低的运营成本，他们可以将这些成本转嫁给顾客以打破传统玩家。基于区块链的应用程序和服务之所以具有颠覆性，不仅是因为它们的安全性，还因为它们在大规模运营时的经济性。

### 你可以构建无需信任的系统

一旦你学会了 Solidity 语言，你会很快开始思考你可以写什么样的程序——这就是真正的学习曲线所在。本书项目的目标是准确展示区块链如何改善或自动化各种类型业务的最终用户体验，并促使新型产品和服务的创造。你将看到银行产品和服务如何改变，受益，或者通过无需信任的分布式或半分布式系统扩展。在这里，“无需信任”是指“不需要相信交易对方会诚实无欺地操作，从而无法受到欺诈和其他交易对方风险的影响。”网上已经有一些关于以太坊和 Solidity 的好信息，供软件开发人员入门学习。然而，如果你读过这些文档，你可能会发现比回答更多的问题。接下来，我们将澄清一些行话。

## 智能合约（真正）的作用

即使在这几页中，你可能已经遇到了一些全新的概念。但在以太坊中将会一直出现的一个术语是智能合约：一些在网络上运行的业务逻辑，半自主地移动价值并在各方之间执行支付协议。智能合约经常被等同于软件应用程序，但这是一个简化的类比；它们更像是传统面向对象编程中的类的概念。当开发人员谈论“编写智能合约”时，他们通常指的是使用 Solidity 语言编写的代码在以太坊网络上执行的实践。当代码被执行时，价值单位可以像数据一样轻松传输。正如本章已经提到的，数字货币的前景是巨大的。但它到底是如何工作的呢？在去中心化系统中，数据如何充当货币呢？对这个问题的答案取决于你的技术水平。所以让我们来看一个相当深入的例子。

### 价值的对象和方法

在计算机中，对象通常是一小块数据——信息——封装在特定的结构或格式中。通常，这些数据具有称为方法的关联指令，指示对象如何使用或访问。现在让我们想象一下，这个对象中保存的信息对某人很有价值，这个人愿意付费来触发显示它的方法。在下面的示例中，让我们假设一个用户想要支付一小笔费用来使用他或她在网上发现的蛋糕食谱。这个食谱是我们示例中的数据对象。在最字面的层次上，蛋糕对象的特征，称为属性，以及方法与计算机内存中的某个地址存储在一起。下面的对象代表了蛋糕的属性，并包含一个方法，通过这个方法，计算机可以显示如何组合这些成分制作蛋糕的说明。以这种方式存储信息使得程序和程序员可以轻松地在不需要更改显示说明代码的情况下替换和更换属性。换句话说，对象是可组合和重新组合的模块化信息块。当我们讨论构成区块链的块的解剖结构时，这一点在后面的章节中将是重要的。在 JavaScript 中，你可以将一个蛋糕对象写成如下形式：`var cake = {firstIngredient: "milk",secondIngredient: "eggs",thirdIngredient: "cakemix",bakeTime: 22bakeTemp: 420mixingInstructions: function() {return "Add " this.firstIngredient + " to " + this.secondIngredient + " and stir with " + this.thirdIngredient + " and bake at " + bakeTemp + " for " + bakeTime + " minutes." ;}};`这是计算机如何“移动”数据以向其人类用户显示有用结果的示例。在以太坊中，你可以编写发送资金的函数，就像这个小对象的方法称为 mixingInstructions，当执行时，它可以显示蛋糕的混合说明。

### Just Add Commerce

正如你将在第四章中看到的，Solidity 代码可以在应用程序的后端使用，以添加微支付、用户账户和功能，即使是简单的计算机程序，也无需第三方库或高级编程知识。想象一下，如果执行 mixingInstructions 函数需要花费几分钱的以太币。在从用户的以太坊钱包余额中扣除蛋糕配方的价格后——这需要几秒钟时间，平均而言——你的智能合约将调用 mixingInstructions 方法，并向用户展示如何制作蛋糕。所有这些都可以在没有认证、支付 API、账户、信用卡、广泛的 Web 表单以及构建电子商务应用程序所需的所有典型工作的情况下完成。事实上，您的 JavaScript 应用程序需要与全球公共以太坊链进行交互的唯一软件库就是之前提到的 Web3.js。

### Content Creation

在本章中，我们迄今为止关注了以太坊的金钱用途，但是蛋糕配方的例子展示了以太坊的另一个巨大潜力领域：知识产权、许可和内容版税。如今，在 Web 或应用程序上销售内容意味着必须与强大的分销商合作，包括苹果、谷歌和亚马逊，他们对数字内容销售制定了惩罚性规定并收取大额费用。以太坊使得可以实现微交易，用户仅支付，比如说，$0.25 就可以获得一个食谱，这是使用费用高昂的信用卡网络支付不切实际的金额。今天，内容创作者以这种方式经营业务面临着挑战，包括以太币代币价格的波动性，但正如你将在后续章节中看到的，随着网络的成熟，这些问题将得到解决。

## Where’s the Data?

等等：如果网络协议在开箱即用的同时提供了如此多的功能，并且这是一个分布式系统，那么用户数据存储在哪里？确切地说，以太坊网络的工作原理是下一章的主题，但为了首先解决令人困扰的问题，让我们先快速了解一下以太坊中如何记录交易：所有交易都存储在网络的每个节点上。以太坊中的所有交易都存储在区块链上，这是每个以太坊节点上存储的状态变化的规范历史。当你在以太坊网络上支付计算时间时，这包括运行交易的成本以及存储在智能合约中包含的数据的成本。（如果执行后您的合约变小，您将以减少的交易费形式获得部分退款。）当您执行智能合约并从您的以太坊余额中支付费用后，这些数据将包含在下一个区块中。由于以太坊网络要求所有节点保留所有合约的完整状态数据库，因此任何节点都可以在本地查询数据库。如果听起来不可扩展，那么您正在认真关注。以太坊版本 1.5 和 2.0 定义了一项解决这个可扩展性问题的路线图。我们将在下一章更深入地了解以太坊区块链的工作原理。

### 什么是挖矿？

因为分布式系统没有单一所有者，机器可以自由加入以太坊网络并开始验证交易。这个过程被称为挖矿。但是为了什么？挖矿节点会会商以达成关于系统中交易顺序的共识，这对实时记录每个人的账户余额是必要的，即使许多交易经过网络。这个过程消耗电力，这需要花费金钱，所以矿工会因每挖掘一个区块而获得奖励：约 5 个以太。

### 以太和电价

矿工们会因为挖矿而获得以太币的报酬，也因为在网络上运行脚本而得到报酬（以气体的形式，稍后将进行解释）。以太坊网络上运行的服务器的电费支出成本是赋予以太币作为加密商品其内在价值的因素之一，也就是说，某人支付了真金白银给他们的电力公司来运行他们的挖矿机。专门的挖矿设备利用图形卡阵列来增加完成一个区块和获得报酬的几率，可以使每台机器的电费支出在每月 100 到 300 美元之间，具体取决于你所在地区的费率。挖矿对比特币和以太坊都是至关重要的，在原理上两个网络的工作方式都类似，但也有一些注意事项。以太坊在这方面也进行了修订，特别是围绕以太币的发行。这究竟是如何运作的，将在第五章中讨论。

## 进入以太坊虚拟机

本书的目标是教导程序员和产品所有者如何编程以太坊虚拟机（EVM）——即刚才描述的系统的名称——以及为何要这样做。它的写作方式应该对金融和技术思维者都有意义，以便开发人员和领域专家更容易达成对他们应该共同构建什么以及哪些工具适合他们项目的共识。但首先，我们需要花些时间了解如何使用和持有以太币。注意：如果你不确定什么是虚拟机，不用担心；它将在后面变得明显。现在，你可以将其视为由许多其他计算机组成的计算机。

### Mist 浏览器

在这个阶段，部署应用仍然很困难，但有办法简单地原型化智能合约，只需使用 Solidity 脚本即可。为此，您将使用原生的以太坊浏览器，昵称 Mist。这个浏览器也保存着你的以太币。第二章会更多地介绍钱包、浏览器、命令行工具和区块链浏览器，但首先需要注意术语问题。

### 浏览器 vs. 钱包或钥匙链

Mist 有时被称为钱包，这个术语是从比特币术语中借来的。为什么比特币应用被称为钱包？不是因为它们保存你的钱，尽管钱包应用确实可以让你发送和接收支付。这些应用在你的手机上安装后，会发放给你密码学密钥，使你能够读写数据到分散式数据库。因此，尽管钥匙链可能是一个更好的隐喻，但钱包是我们得到的术语。如果你想提前试用 Mist，请访问 Ethereum GitHub 项目的 Mac、Windows 和 Linux 下载链接：[`github.com/Ethereum/mist/releases`](https://github.com/Ethereum/mist/releases) 。通过 Mist 和以太坊命令行工具，可以使用虚假以太币测试示例合约，以确保在调试时不会丢失任何真钱。尽管如果你使用过现代开发环境，这样做会感觉有点原始，但对于非技术型学习者来说，这是一个很好的起点，因为它迫使他们学习网络和低级计算机系统知识，以制作一个简单的演示应用程序。

### Solidity 类似于 JavaScript，但……

大部分 Solidity 写在真空中，对于熟悉 JavaScript、Java 或 C 语言的任何人来说都很直观。虽然以太坊应用程序不托管在任何单一服务器上，但以太坊应用程序的核心是一系列（相对）简单的智能合约文件，看起来像 JavaScript。你在本地创建它们，然后部署它们以在整个网络中传播，以分散的方式进行托管。在这个意义上，以太坊开发将网络、应用程序托管和数据库结合到了一起。像许多新技术一样，部署这些系统是具有挑战性的。我们将谈论一些简化这一过程的方法。但在创建了你的第一个最小功能应用程序后，你很快就会进入有趣的部分：想象用你的新技能可能创造的新应用程序和系统。

## 以太坊的用途

以太坊适合构建纯软件中的经济系统。换句话说，这是用于业务逻辑的软件，人们（用户）可以以我们通常通过数据获得的速度和规模移动资金（代表价值的数据）。而不是商业银行系统中获得的三到七天的浮动期。或者像 Visa、MasterCard 和 PayPal 这样的供应商所带来的费用。例如，通过一个简单的以太坊应用程序，相当轻松地可以每隔几分钟向数十万人，分布在数百个国家，支付小额款项，而在传统银行系统中，你需要一个整个工资部门加班工作，不断重新平衡你的账户总账，并处理跨境问题。

### 一种批判性观点

如果你看过以太坊的营销资料，你可能对这个软件可以创造什么有了一个稍微夸张的想象。以下是一些关于以太坊和区块链的充满憧憬的宣言，以及明显而常见的反驳。

#### “没有任何可能发生停机、审查或第三方干预”

如果你不熟悉开源开发领域，那么代码库的治理方式起初会显得晦涩难懂。尽管以太坊协议是由一小群核心开发者编写的，但要改变网络运行方式，必须有许多利益相关者合作。随着网络的发展，这些所谓的硬分叉将变得不太可行、不太必要，因此出现的频率会降低。请记住，以太坊网络尚未完全完成。它今天已经运作，但要等到 2019 年某个时候才算完全完成。继续开发的资金由瑞士非营利组织以太坊基金会提供。

#### “一个安全、自由和开放的物联网平台”

智能合约的执行者可能是许多机器，这是人们的想法。假设你漫步进入一个你从未去过的街区，而且失去了手机信号。你的手机可能会自动从另一个网络的附近微小蜂窝中“租用”一些时间，并支付路由器微小费用，而无需征求你的许可。价格和速度可能是由路由器编写的智能合约中的变量，几乎像一个服务级协议 (SLA)，当你同意时可以转移资金。

#### “为社区和企业实现透明治理”

这个有点棘手：透明的公司是一个可能的结果。但是去中心化自治公司（也可以称为 DAO 或 DAC）可能还有很长的路要走。这本书中使用的术语似乎是行业正在确定的：去中心化组织，或称为 DO。在这个领域的进展很棘手。通过加密工具进行治理受到了长久以来困扰民主制度的所有操纵的影响。一个钱包地址一票？那么谁拥有钱包地址呢？如果一枚硬币就是一票，那么富人统治吗？这个讨论大多超出了这本书的范围，但是任何向你兜售完全自治的组织，无论是企业还是政府，的概念的人可能还有一座桥你可能会感兴趣。

#### “为您处理用户身份验证和安全支付，以及消息传递甚至去中心化存储”

当以太坊在其路线图上进一步发展时，这一点将完全成立。当您连接到以太坊区块链时，用户身份验证和安全支付确实在其中，但点对点通信和去中心化存储（自身是区块链软件业务的新兴领域）目前仅可通过第三方集成使用。然而，以太坊路线图中确实包括这些元素，计划使用 Swarm 和 Whisper 这两个名称。目前，它们都以有限的实验版本提供。

#### “无需注册或支付应用程序主机费用；世界上第一个零基础设施平台”

在技术上确实如此，但时间就是金钱，当我们讨论托管和部署时，很明显，在这个新的软件世界中，免费和简单可能是互斥的术语。

### 智能合约开发现状

目前可用的 Solidity 开发样本项目并不多。如果你打算部署一个完整的最终用户应用程序，你将不会有太多竞争。然而，区块链的大部分力量在于创建能够让用户进行交易的应用程序：购买、出售、许可、交易、流媒体等等。这意味着人们需要持有一些以太币，或者是属于你的项目的本地币。这种本地币的流通和可用性被称为其流动性。高流动性也可能导致货币价格更稳定，并具有网络效应。通常，有创业精神的开发人员会尝试启动他们的币以实现流动性的好处。事实上，以太坊虚拟机（EVM）和以太币正是以这种方式工作的。以太坊基金会在 2014 年推出时通过众筹筹集了 1800 万美元。以比特币支付的贡献被以太币返还，并且形成了一个社区。

#### 模仿币

替代币是使用比特币代码库的比特币复制品。开始一个替代币可能有合理的原因；它们并不总是试图强制用户群体存在的尝试。以太坊保留了比特币的许多基本概念，但可以被认为是一个全新的网络，因为它的关键组成部分是不同的。

#### 资助您的项目

众筹是创业者对抗实时测试和筹款的痛苦和费用的一种方式，通过向潜在用户出售产品或服务的早期访问权来进行。在加密货币领域，这被称为代币发布。一些公司采用了所谓的首次代币发行（ICO）这个术语，因为这听起来像华尔街的首次公开发行（IPO）一样。然而，这个术语很误导，因为代币并不总是代表股权。这适用于以太坊和比特币，它们都不代表任何股权。如果你想筹集资金来资助你的以太坊项目，你不需要在夜晚飞行。资产管理者和高管们正在迅速意识到这项技术的力量，无论你是在寻找就业、投资还是业务发展，它们正在这里（或者很快会出现）。寻找本地的比特币或以太坊活动，加入 Meetup（[www.meetup.com](http://www.meetup.com)）寻找其他加密货币爱好者并组建团队。

## 确定您适合的位置

除了涵盖以太坊的技术方面，本书还提供了更广泛的背景信息，可以帮助您决定 Solidity 编程和分布式应用程序应该如何融入您的职业生涯。本书还旨在确定关于软件创新思维的新向量。举例来说，长寿是一个例子。在传统的网络服务中，实时性取决于开发人员是否支付了他们的托管费用并维护了他们的服务器。因此，很少有人构建旨在在 30 年内执行命令的软件应用程序。以太坊网络也是一个完全冗余的分布式数据库，在每个节点上都有副本。这意味着当满足某种条件时，即使条件是在未来的几十年内发生，甚至即使节点全都发生了变化，您也可以信任您的应用程序触发一个调用。去除旧的软件和银行业的限制，并引入新的限制，这是接下来每一章的不断主题。

### 给新程序员的一封信

了解现有货币、银行和保险系统的运作方式将对想象以太坊应用程序具有巨大优势。如果你能将这些与一些技术知识结合起来，那就更好了。请注意：你不必在本书中标记 URL 或引用。你可以在[`eth.guide`](http://eth.guide) 找到所有引用的最新链接，按章节索引。因此，即使你不是程序员，也没有意向成为程序员，也请跟着讨论代码的章节走一遍。这将帮助你了解可能性的限制。如果你决定从零开始学习 Solidity 编程 —— 即使你以前从未编程过 —— 本书的教训也适合你。在某些方面，学习以太坊开发可能比从零开始学习 Web 开发更容易、更直观。

### 以太坊是自由开源的。

以太坊可以被分叉并复制到其他兼容的系统中。在未来，甚至可能实现跨链转账。尽管这并不是一件简单的事情，但关于如何实现这一点的学术论文已经开始涌现。值得注意的是，对于非程序员来说，免费和开源不是同义词。开源是一种创建软件的方法论；自由是一种社会构造。根据 GNU 基金会的说法，“当我们称软件为自由时，我们指的是它尊重[用户的基本自由](https://www.gnu.org/philosophy/free-sw.html)：运行它的自由，学习和更改它的自由，以及在有或无更改的情况下重新分发副本的自由。”（13）

## EVM 将永远存在。

正如你所看到的，以太坊有着雄心勃勃的路线图，甚至更加宏大的目标。无论它是否按照核心开发团队的计划发展，它对区块链发展的持久贡献可能是以太虚拟机（EVM）。Solidity 语言可能会成为编译为 EVM 字节码的众多语言之一。Solidity 本身无疑会不断发展和变化，今天还远非完美或完整。但它允许我们现在就以加密货币构建和测试用例，这在比特币社区中可能会更慢地发生。简言之，以太坊试图创建一个经济模型可以尝试和证明的系统。目前来看，只要它们在诸如 EVM 之类的全球虚拟机上运行，Solidity 似乎将成为这些模型的事实标准语言。

## 今天你可以构建什么

足够谈论潜力了；今天可能发生什么？相当多，但让我们将事情分为两类：私有和公共。到目前为止，以太坊既被描述为单一公共区块链，又被描述为许多区块链的创建协议。了解不同领域的潜力（以及它可能如何显现）主要是了解公共链与由公司或其他独立社区部署的私有以太坊链之间的区别的问题。

### 私有链和公有链

由于任何人都可以分叉以太坊项目，可以“制作您自己的以太坊”，而不是在公共链上构建。这被称为私有区块链，就像比特币的替代币一样，它代表了现有以太坊开发社区的一种重复努力。正如您将在本书末尾发现的那样，对于初创企业的产品或服务来说，私有链通常是一种糟糕的做法，但这并没有阻止一些公司尝试启动一个。与重新发明轮子不同，对于企业家来说，更好的想法是在公共以太坊链上构建。正如您将看到的，公共链有大量的计算能力专门用于其安全性，使得小公司可以启动大规模安全的网络服务。然而，今天的公共以太坊区块链完全是公开的，一些公司可能选择将其敏感交易保留在私有链上，并与公共链建立一些桥梁。在企业软件环境中，企业利益相关者被赋予了某些权利和特权，以读写公司链，这种部署被称为权限区块链。对于权限区块链，钱包地址通常由一个可信的第三方颁发，该第三方验证您进入系统的权限，就像办公楼的安全通行证允许您在建筑物内进行交易一样。以同样的比喻，公共链将被视为城市公园或其他公共空间。区块链规模与其可信度之间的正相关关系将在后面的章节中变得明显。然而，我们将在第九章中介绍私有链的设置，以更好地理解区块链和数据库之间的相似性。在公共或私有以太坊链中，您可以执行以下操作：

+   发送和接收以太币

+   编写智能合约

+   创建可证明公平的应用程序

+   基于以太币启动您自己的代币

下面的小节将对每个进行描述。

#### 发送和接收以太币

你可以发送和接收以太币，尽管在私有链上，你拥有的是一种价值为零的私有以太币。任何人都可以通过下载 Mist 钱包获得一个公共以太坊钱包地址，我们将在下一章中介绍。另外，移动钱包应用程序可在 iOS 应用商店和 Google Play 上找到。要将美元兑换成以太币，你需要加入一个加密货币交易所，或者从商业汇款人（例如 Coinbase）那里购买。大多数人只是购买比特币（比特币更容易通过 ATM 形式获得，并且还可通过 LocalBitcoins.com 现金交易网络获得），然后通过交易所或者通过 ShapeShift.io 等加密货币兑换服务将它们转换成以太币。

#### 编写智能合约

即使存在许多不确定因素，或者延伸到遥远的未来和跨越国界，你也可以控制帐户之间（甚至是其他合同之间）的支付和转账。这里真正的潜力取决于公共链的不可阻挡程度，这取决于谁参与以及有多少恶意参与者进入系统。另外，私有链可能允许拥有资源的群体获得相同的功能，只是私有的。

#### 创建可证明公平的应用程序

创建可证明公平的应用程序对于游戏和赌博尤为重要。预计视频游戏和虚拟现实游戏将引入代表真实货币并可以在现实世界中使用的点数。

#### 发行你自己的代币

在实际操作中，自行创建代币类似于创建一个用户账户系统。通过以太坊代币合约，你可以为在私人交易分类帐中使用的子货币创建一个子货币，只有你和你的私人团队可以访问，但在所有其他方面都使用公共链——省去了分叉或维护自己的挖矿机网络的需要。对于大多数开发者和组织来说，这是一种便利且更优越的方法。代币和区块链的动态将在第五章和第九章变得更加清晰。

### 分布式数据库的诺言

像所有的数据库一样，区块链有一个模式：规则定义、约束和执行实体之间的关系。跨行业寻找破坏或改变这些关系的动机，导致贿赂和腐败，使得区块链的无信任特性比之前的软件和网络更具吸引力。¹⁴在所有数据库中，共享的读/写访问会产生巨大的复杂性。全球各地的机器可能会遇到不同的延迟，这取决于数据库的物理位置，导致一些写入操作到达的顺序不一致。如果几方应该平等共享一个数据库，例如，几家公司组成一个行业贸易团体，情况会变得更加困难。这使得大型组织与其他组织启用共享读/写状态变得极为昂贵，如今，客户信息泄露已经司空见惯。如今，企业 IT 部门已经找到了基本确保这些系统按计划运行的方法。但随着它们的规模扩大，一些恶意行为者利用的机会变得太大而无法忽视。

### 接下来是什么：新的工作方式

在 2016 年 9 月，数千名富国银行的员工因操纵账户数据库以突出销售数据并触发旨在奖励开设新账户销售人员的奖金而被解雇[¹⁵]。这些判断错误的成本将是巨大的，同样巨大的是构建软件的成本，该软件可以在某种程度上阻止管理员进行错误更改。以太坊为企业和消费者提供了一个新的机会，可以在比今天基于 HTTP 网络的应用数据层更可信的环境中进行互动。

## 摘要

在本章中，你学到了以太坊提供了另一种构建软件的方法，其中安全性和信任被固化在协议级别。这可能会对全球产生重大影响。随着世界数字化，大规模系统对各种组织变得日益关键，不仅仅是银行和保险业，还有城市服务、零售、物流、内容分发、新闻业、服装制造以及任何涉及溯源或支付的行业。¹⁶接下来，你将通过创建用于访问以太坊区块链的密钥来实践以太坊。下一章将介绍如何使用 Windows、macOS、Linux、iOS 和 Android 的以太坊客户端应用程序。脚注 1 以太坊博客，“愿景，第一部分：区块链技术的价值”，[`blog.Ethereum.org/2015/04/13/visions-part-1-the-value-of-blockchain-technology/`](https://blog.ethereum.org/2015/04/13/visions-part-1-the-value-of-blockchain-technology/)，2015 年。2 美国银行家，“区块链不会让银行变得更灵活”，[www.americanbanker.com/bankthink/blockchain-wont-make-banks-any-nimbler-1079190-1.html](http://www.americanbanker.com/bankthink/blockchain-wont-make-banks-any-nimbler-1079190-1.html)，2016 年。3YouTube，“将分散世界的技术”，[www.youtube.com/watch?v=er-k3ehpFaM&feature=share](http://www.youtube.com/watch%3Fv=er-k3ehpFaM%26feature=share)，2016 年。4 哈佛商业评论，“1980 年代的管理”，[`hbr.org/1958/11/management-in-the-1980s`](https://hbr.org/1958/11/management-in-the-1980s)，1953 年。5 维基百科，“默克尔树”，[`en.wikipedia.org/wiki/Merkle_tree`](https://en.wikipedia.org/wiki/Merkle_tree)，2016 年。6GitHub，“以太坊白皮书”，[`github.com/ethereum/wiki/wiki/White-Paper`](https://github.com/ethereum/wiki/wiki/White-Paper)，2014 年。7Coindesk，“Bitt 在区块链上推出巴巴多斯元”，[www.coindesk.com/bitt-launches-barbados-dollar-on-the-blockchain-calls-for-bitcoin-unity/](http://www.coindesk.com/bitt-launches-barbados-dollar-on-the-blockchain-calls-for-bitcoin-unity/)，2016 年。8 维基百科，“格雷姆定律”，[`en.wikipedia.org/wiki/Gresham%27s_law`](https://en.wikipedia.org/wiki/Gresham%27s_law)，2016 年。9USV 博客，“Fat Protocols”，[www.usv.com/blog/fat-protocols](https://www.usv.com/blog/fat-protocols)，2016 年。10 每日金融科技，“比特币市场在产品市场适应之前进入整合阶段”，[`dailyfintech.com/2016/02/03/bitcoin-market-going-into-consolidation-before-product-market-fit/`](https://dailyfintech.com/2016/02/03/bitcoin-market-going-into-consolidation-before-product-market-fit/)，2016 年。11Coinbase 博客，“应用币和去中心化商业模式的黎明”，[`medium.com/the-coinbase-blog/app-coins-and-the-dawn-of-the-decentralized-business-model-8b8c951e734f#.cweqnimd2`](https://medium.com/the-coinbase-blog/app-coins-and-the-dawn-of-the-decentralized-business-model-8b8c951e734f#.cweqnimd2)，2016 年。12 以太坊博客，“以太坊愿景背后的商业必要性”，[`blog.Ethereum.org/2015/05/24/the-business-imperative-behind-the-Ethereum-vision/`](https://blog.ethereum.org/2015/05/24/the-business-imperative-behind-the-ethereum-vision/)，2015 年。13GNU 基金会，“为什么开源忽略了自由软件的要点”，[www.gnu.org/philosophy/open-source-misses-the-point.html](https://www.gnu.org/philosophy/open-source-misses-the-point.html)，2016 年。14Nesta.org.uk。“为什么你应该关心区块链：区块链技术的非金融用途”，[`​www.​nesta.​org.​uk/​blog/​why-you-should-care-about-blockchains-non-financial-uses-blockchain-technology`](http://www.nesta.org.uk/blog/why-you-should-care-about-blockchains-non-financial-uses-blockchain-technology)，2016 年。15CNN Money，“5300 名富国银行员工因涉嫌开设 200 万个虚假账户而被解雇”，[`money.cnn.com/2016/09/08/investing/wells-fargo-created-phony-accounts-bank-fees/`](http://money.cnn.com/2016/09/08/investing/wells-fargo-created-phony-accounts-bank-fees/)，2016 年 16 每日金融科技，“区块链技术如何整合金融和实体供应链并改变小企业融资”，[https://dailyfintech.com/2016/06/14/how-blockchain-technology-could-integrate
