© 作者，独家许可给 APress Media, LLC，属于 Springer Nature 2022。J. T. George 介绍区块链应用[`doi.org/10.1007/978-1-4842-7480-4_12`](https://doi.org/10.1007/978-1-4842-7480-4_12)

# 12. BLOCKLY 4SOS

Joseph Thachil George^(1  )(1)意大利罗马

BLOCKLY 是一个允许您制作块编程应用的库。即使用户实际上不了解编程语言，块编程也允许他们使用图形块构建脚本和程序。在拖放编辑器中，BLOCKLY 包括定义和渲染块所需的所有内容。每个块代表一行代码，可以轻松堆叠并转换为代码。它可用于让用户个性化应用程序的元素并向其添加动作。

## 12.1 SOS 建模

在使用该工具时，它会生成一个名为 ex-abundant block 的标准 SoS 块，以作说明。左侧的工具箱包含构建 SoS 设计所需的所有块。这个概念模型将协助 SoS 设计者。此外，BLOCKLY 中的每个导出块都连接到一个透视块，因此所有连接到视角的通信点的块都可以在 Toolkit 的通信类别下找到。

用户必须从 flyout 或工具箱中点击并拖动块，以在 BLOCKLY 中生成新的块。为了提高可用性和准确性，为 BLOCKLY 设计了一个 API。Field Dropdown() 提供了一个适当的块列表，可以与某个块链接，使用户轻松构建块。

添加 Technique 块后，该工具会显示如何添加其他适当的块：故障预测、故障预防、故障排除和故障容忍。Technique 块是一个在 profile 中的抽象块，上述四个块都继承了它。

一个块可以有三个阶段，如下所示：

+   压缩视图

+   部分压缩视图

+   未压缩的视图

通过减少屏幕上的块数量，压缩显示使用户可以看到当前编辑的块（参见图 12-1）。用户可以选择仅查看指定的属性，因为部分折叠的块仅显示块的非空特性。使用全视图/未压缩视图来检查块的所有属性。用户可以通过两次单击块来在三个视点之间切换。参见图 12-2。

图 12-1

SysML 导入到 BLOCKLY

![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig2_HTML.jpg](img/520777_1_En_12_Fig2_HTML.jpg)

图 12-2

用户可以使用下拉菜单添加块

此外，如图 12-3 和 12-4 所示，可以显示与所选构建块相关联的特性。通过在每个块的左上角放置一个突变按钮来实现这一点。

支持设施使用一个名为 Type-Indicator 5 的免费开源插件创建直观的建模环境。此插件在移动当前块时突出显示所有与当前块兼容的块（以黄色显示）（块 cs4）。

在 SoS 项目中必须检查和管理需求的可追溯性，因此需求管理至关重要。需求可以根据观点和构建组件（如架构、通信和可靠性）的要点分解成不同类别。

因此，提供了完整的可追溯性，因为每个构件块都满足其满足的一系列标准，并且每个需求构件块都控制着维护其的构件块集合。为了使设计更加明显，BLOCKLY 允许您向块添加注释。

图 12-3

块可以以三种不同的方式查看：折叠、部分折叠和未折叠

约束使用示例如图 12-4 所示。约束可用于查找可能在 SoS 的新阶段中容易出现的异常变化。您可以通过在模型中使用适当的查询来获取这些情况。当处理大型模型时，可能很难看到整个 SoS，需要使用专门的视图。

BLOCKLY 使用 *折叠* 方法来隐藏 SoS 模型的复杂性，而不是使用线来显示块之间的连接。模型查询用于查找满足一组要求的块。

图 12-4

块的构建块可以被激活或禁用

它还可以用于以传统视角查看模型（例如通过线显示块与其他块之间的关系）。

要查询特定模型，用户可以右键单击工作空间并选择显示查询图。在查询图中，用户可以为查询模型创建过滤器。^(1)

返回 true，例如，表示不需要过滤（即在图 12-5 中显示模型的所有块）。该查询生成图 12-5，突出显示使用过滤器的所有 RUMI 类型的块：

*return b. of type == RUMI*

模型查询有助于可视化自定义 SoS 视图，并有助于发现设计问题。

向块添加新连接是一个简单的过程。使用连接到现有块的连接是构建 SoS 的一种方法。创建连接/链接可以让您重用可用的块，但这与将块复制并粘贴到 BLOCKLY 中不同。连接的块通过链接引用。例如，在工作区上，CSs 可以形成，只能连接到 SoS 块，如图 12-5 所示。![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig5_HTML.jpg](img/520777_1_En_12_Fig5_HTML.jpg)

图 12-5

SoS 的过滤视图

模块化的 SoS 分组可通过允许合适的块被组合在一起来实现设计的模块化。例如，如图 12-6 所示，所有 CSs 可以被聚集在一起。组块有助于将模型划分为有用的组。

每当提及到一个组的块时，组名也会包含在内，以区别于具有类似标题的其他块。![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig6_HTML.jpg](img/520777_1_En_12_Fig6_HTML.jpg)

图 12-6

类型指示器 cs4 插件以黄色显示

## 环境为 SoS 行为模拟

在创建静态模型后，可以向任何块引入行为。用户可以通过右键单击受影响的块并选择“添加行为”来添加行为。Python 编程语言可用于编写行为，它代表了整个仿真期间将执行的代码（如图 12-7 所示）。

可以指定 init、start 和 run 函数的标题，并且它们分别在启动时、块启动时和仿真执行时执行。服务块的 run 函数具有特定的理解，并被表示为 TCP-IP 服务器。¹

所有为各个区块创建的行为代码在代码生成期间合并到单个文件中。XML 和代码生成模型可能会被生产到 XML，并在通过工具右上角的必要按钮点击导入后进行模拟。¹

以下格式用于为所有区块生成唯一对象名称：<blocktype> <blockname> <blockid>

+   **模拟器的组成部分**。模拟器是一组用于运行设计师预期情景的 Python 脚本。模拟器的主要组成部分包括对象初始化器、目录、活动图、GUI、程序执行顺序图、日志生成和时钟。

+   **对象初始化器**。模拟使用模型中描述的每个区块的构造函数来初始化它。单个输入被视为文本、数字或对象，而多个输入被视为数组。

![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig7_HTML.jpg](img/520777_1_En_12_Fig7_HTML.jpg)

图 12-7

与需求管理相关联的区块是这样的区块的一个示例

可以在某些区块中找到一个名为“基数”的成员，例如 CS 或包装器或 CPS。它指定将要模拟的项目数量。这是通过在原始对象上使用 Python 的 deep_copy() 方法来完成的。每个实例被赋予一个从 1 到 *n* 的唯一 ID，其中 *n* 是模型的基数。

例如，以下模型生成了一个名为 My_SoS 的 SoS，其中包含 200 个名为 cs_1 的 CS。每个 CS 都将具有从 1 到 200 的实例 ID 属性。

模拟器的关键组成部分之一是日志。它是一个服务，用于跟踪 SoS 中各个 CS 提供的服务。CS 利用它来对某种服务进行分析。

注册表在模拟器中被应用为 TCP-IP 服务器，允许 CS 添加、删除和更新其自身的相关详细信息。

可以在多个链接的计算机系统序列图集上执行模拟的能力是通过具有已知的公共寄存器来实现的。用于序列图的相关块有助于创建明确的序列图，这些序列图可以立即转换为代码。在图的情况下，模拟复制了用户创建的序列。

结果，当模拟器已启动并初始化时，从序列图创建的代码（参见图 12-8）会立即运行。为了模拟一种情况，一个序列图被加入到模型中（参见图 12-9）；序列图是用支持结构工具构建的。![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig8_HTML.jpg](img/520777_1_En_12_Fig8_HTML.jpg)

图 12-8

每个块都可以满足特定的标准

![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig9_HTML.jpg](img/520777_1_En_12_Fig9_HTML.jpg)

图 12-9

描述了一个约束的插图，在这个约束中，成员变量 m 的有效性被检查

![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig10_HTML.jpg](img/520777_1_En_12_Fig10_HTML.jpg)

图 12-10

使用约束在模型中检测出现

![../images/520777_1_En_12_Chapter/520777_1_En_12_Fig11_HTML.jpg](img/520777_1_En_12_Fig11_HTML.jpg)

图 12-11

“return true”查询的结果

## 12.3 复习问题

1.  1.

    “BLOCKLY 是一个用于创建带有块的应用程序的库。用户可以使用可视块构建块编程中的脚本和程序。”这个说法正确吗？

1.  2.以下哪项描述了 BLOCKLY 4SoS？

    1.  a.

        每个块代表了一部分代码，可以堆叠并轻松转换为元模型。

    1.  b.

        每个块代表了一部分可以被堆叠并轻松转换为算法的代码。

    1.  c.

        每个块代表一个可随时堆叠和转换的编码块。

    1.  d.

        以上全部。

1.  3.以下哪种描述是关于 *模拟器* 组件的正确？

    1.  a.

        一个模拟器是一组用于运行设计者预期情景的 Python 程序集合。

    1.  b.

        模拟器是一组旨在执行设计者计划情景的程序集合。

    1.  c.

        一个模拟器是一组用于运行设计者准备的情景的 Java 应用程序集合。

    1.  d.

        以上都不是。

1.  4.以下哪种描述是关于 *事件* 的正确？

    1.  a.

        BLOCKLY 包含了创建和在拖放式编辑器中呈现块所需的一切。

    1.  b.

        BLOCKLY 包含了定义和显示块所需的一切。

    1.  c.

        BLOCKLY 包含了创建和在编辑器中呈现块所需的一切。

    1.  d.

        以上全部。

1.  5.

    “需求管理是 SoS 架构的关键组成部分，因为它允许查看和监控需求的可追溯性。透视图和构建块可用于拆分需求。” 这个说法正确还是错误？

## 12.4 复习答案

1.  1.

    答案：正确，BLOCKLY 是一个用于开发基于块的应用程序的库。在块编程中，用户可以使用可视块来创建脚本和程序。

1.  2.

    答案：C，每个块代表一个可随时堆叠和转换的编码块。

1.  3.

    答案：B，一个模拟器是一组旨在执行设计者计划情景的程序集合

1.  4.

    答案：A，BLOCKLY 包含了创建和在拖放式编辑器中呈现块所需的一切。

1.  5.

    答案：正确，因为它使得能够查看和监控需求的可追溯性，需求管理是 SoS 设计的关键组成部分。为了分割需求，可以使用视角和构建块。

## 12.5 总结

本章解释了 BLOCKLY 4SOS 工具。它是一个系统级建模、验证、查询和模拟工具。

AMADEOS 支持工具的目标是利用 AMADEOS 的理念和 BLOCKLY 工具来简化和直观地设计 SoS。在设计分布式系统（一个网络物理系统）时，这个工具非常有帮助。

下一章概述了利用 Kilobots 的帮助完成的第一个网络物理系统项目。
