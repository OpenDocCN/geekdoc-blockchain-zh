# 什么是最大可提取值(MEV)？

> 原文：<https://blog.chain.link/maximal-extractable-value-mev/>

*最大可提取价值(MEV)是指区块链采矿者或验证者在区块生产过程中通过包括、排除或改变交易顺序所能获得的最大价值。T3】*

区块链经济在过去几年经历了一段指数增长期，锁定在 [DeFi](https://chain.link/education/defi) 生态系统中的价值在 2022 年达到 3000 亿美元的顶峰。然而，随着智能合约的日益普及，新的漏洞也随之出现，价值可能会从不知情的用户那里流失。一个这样的例子是 *最大可提取价值*(MEV)——一种动态，其中区块链中的块生产者(例如，矿工、验证者)能够通过任意重新排序来提取价值，包括或排除块内的交易，这通常对用户有害。简而言之，大宗商品生产商可以决定交易在区块链的处理顺序，并利用这种权力为自己谋利。

在 2019 年题为“[Flash Boys 2.0](https://arxiv.org/abs/1904.05234)”的研究论文中，该论文的作者包括 Chainlink Labs 的研究人员 Ari Juels 和 Lorenz Breidenbach，MEV 和交易重新排序不仅仅是作为一个理论概念来解释，而是作为一种动态，它已经以分散式交易所上的交易前端运行的形式大规模发生，并且可以对用户体验产生重大影响。

在本文中，我们将探讨 MEV 存在的原因、当今 MEV 的例子，以及 Chainlink [公平测序服务](https://blog.chain.link/chainlink-fair-sequencing-services-enabling-a-provably-fair-defi-ecosystem/) 如何为区块链经济体中这一持续存在的问题提供一种新颖的解决方案。

## 最小可提取值与最大可提取值

MEV 越来越多地被称为 [最大可提取价值](https://ethereum.org/en/developers/docs/mev/) ，而不是最初的术语矿工可提取价值，因为 MEV 不仅仅限于工作证明(PoW)区块链中的矿工，还适用于股权证明(PoS)和其他类型网络中的验证者。为了涵盖跨多链生态系统的 MEV 的全部范围，我们将在这篇博文中参考以前的术语。

## 最大可提取值(MEV)出现的原因

比特币和以太坊等区块链网络是不可变的总账，由分散的计算机网络保护，这些计算机被称为“区块生产者”，包括区块链电力公司的矿工和 PoS 网络的验证者。这些块生产者负责定期将未决交易汇总成块，然后由整个网络验证并附加到全局分类账中。虽然区块链网络确保所有交易都是有效的(例如，没有重复花费)并且不断产生新的交易块(防止停机)，但实际上并不能保证交易将按照提交给区块链的确切方式排序。

由于每个块只能包含有限数量的事务，所以块生成者可以完全自主地选择在 mempool(块生成者存储未确认的离线事务的位置)中将哪些未决事务包含在其块中。尽管区块生产商默认按照最高天然气价格(交易费)订购交易，以便最大化其利润，但这不是网络的要求。因此，块生产者可以通过利用他们任意重新排序交易的能力来提取额外的价值，创造所谓的最大可提取价值(MEV)。

![MEV diagram with mempool, searchers, builders, relayers, and block producers.](img/1334b59a779ae8d5929631ba7baa232b.png)

<figcaption id="caption-attachment-5080" class="wp-caption-text">By default, block producers do not order transactions by time of submission but the amount of fees paid.</figcaption>



由于提取 MEV 所需的资源和专业知识，区块链网络中的区块生产商通常将区块的创建外包给由搜索者、建造者和转播者组成的第三方网络。搜索者寻找 MEV 机会并创建多个交易的捆绑包，通常包含另一个用户的交易。这些包被发送给构建者，构建者将这些包组合成完整的块有效载荷。然后，建筑商向中继站提供完整的砌块，中继站是区块链砌块生产商的连接点。请注意，这只是当今砌块生产商如何提取 MEV 的一个例子，但生态系统仍在快速发展。

MEV 通常是以普通用户为代价的，很多时候，所有用户可能直到他们的交易被处理后才立即发现。这可能包括对用户交易的更差的价格执行，其中 MEV 是直接从用户提取的。

## MEV 的类型

虽然由于 MEV 现象的持续性质以及搜索者隐藏其策略的财务动机，MEV 提取技术的明确列表很难收集，但有一些记录良好的 MEV 示例。

### 抢跑和三明治攻击

可以被认为直接损害用户体验的 MEV 是抢先进行用户在[【DEXs】](https://blog.chain.link/dex-decentralized-exchange/)上进行的交易的机器人。因为来自用户的交易经常通过公共内存池(存储未确认的区块链交易的队列)，前端运行的机器人可以监控大型交易，并利用这一知识为自己谋利。

例如，如果发现了一笔大额交易，一个前端运行的机器人可以复制用户的交易，并创建一个交易捆绑包，在用户的交易之前先处理他们的交易。这将改变交易资产的市场价格，导致用户的交易产生更大的滑点——交易的预期价格和实际价格之间的差异。在用户的交易被处理后，被交易资产的市场价格进一步向有利于领先者的方向移动，这使得他们可以通过反向交易出售资产来获利，这就是通常所说的“三明治攻击”。

结果，用户的交易以次优的汇率执行，以“无形费用”的形式增加了使用分散交易的成本，在分散交易中收到的令牌比最初预期的少。

### **外汇套利和清算**

当第三方机器人在两个或更多分散的交易所之间进行套利时，MEV 也可能发生。当一个交易所的加密资产价格偏离另一个交易所时，就会产生套利机会，这通常是由其中一个交易所的大宗交易引起的。套利机器人通过在交易所以较低的价格购买资产，并在交易所以较高的价格出售，使两个交易所的价格恢复平衡，同时获得利润，从而从这一机会中获利。此外，套利也可以在链上 dex 和链外集中交易所之间进行，或者在两个不同的区块链网络(跨域 MEV)上的链上 dex 之间进行。

随着 DeFi 越来越多的采用和 dex 内流动性的不断增长，这些套利机会的出现和盈利能力都有所增加，导致套利机器人之间的竞争越来越激烈。这些机器人通过参与竞标战来竞争，这导致他们不断提高他们愿意支付给区块生产商的费用，试图将他们的捆绑包包含在生产的区块中

虽然套利是一种正常健康的市场活动，但 MEV 机器人可以通过监控交易内存池和复制交易来窃取其他用户的套利机会，同时支付更高的费用来阻止生产者将他们的交易而不是原始套利交易包括在内。DeFi 贷款市场中抵押贷款的清算也出现了类似的动态。

### 广义抢跑

提取 MEV 的一种更先进的技术是机器人，它们参与所谓的广义先跑。这涉及到搜索者扫描公共内存池中的交易，并以更高的费用向块生产者提交相同的交易，同时用他们自己的地址替换交易有效载荷中出现的任何用户地址。这在实践中已经出现过[](https://www.paradigm.xyz/2020/08/ethereum-is-a-dark-forest)白帽黑客拯救处于风险中的用户资金，却被一个普遍的领先者用他们自己的交易复制/替换一个关键交易而挫败。这种机器人通常不会解释事务正在做什么，而是简单地运行一种算法来扫描 mempool 事务，替换事务有效载荷中的地址，并模拟其执行以检测它是否会带来利润。

这些只是 MEV 如何被提取以及它如何对用户产生负面影响的几个例子。然而，它们并不是 MEV 可能出现的唯一情况。如果当区块生产者开始为自己捕捉更多 MEV 机会时，有可能使用更高级的重新排序策略来进一步从用户那里提取价值。

## 缓解 MEV: Chainlink 公平测序服务(FSS)

为了减轻 MEV 的不利影响，Chainlink 正在开发公平排序服务(FSS)——一种使用 [分散式 oracle networks](https://chain.link/education/blockchain-oracles) 的交易排序解决方案。Chainlink FSS 的工作原理是收集用户离线交易，为交易排序生成分散的一致意见，并以分散的方式在链上提交已排序的交易。

正如 Chainlink Labs 的首席科学家 Ari Juels 在最近的 SmartCon 2022 上的一次演示中所探讨的那样，FSS 旨在帮助提高订单公平性，降低交易成本，减少或消除信息泄露。

此设计的第一个组成部分涉及安全因果排序(原子广播)，其中用户交易首先由用户加密以隐藏交易细节，由分散的 oracle 网络排序，然后解密以在区块链网络上执行。因此，在订购流程开始之前，节点将看不到事务负载，从而无法根据早期可见性提前运行事务。

第二个组件是时间排序，这是一种机制，旨在确保 oracle 网络最先收到的事务最先输出，有助于确保先进先出(FIFO)的排序策略。

当与交易加密相结合时，深度防御解决方案可实现用户交易的公平排序。使 FSS 成为可能的技术在 [Chainlink 2.0 白皮书](https://research.chain.link/whitepaper-v2.pdf) 的第 5 节中进一步深入探讨。

![Chainlink FSS preventing MEV](img/c8bec0aeeea3b95222be91a40d0e5125.png)

<figcaption id="caption-attachment-1624" class="wp-caption-text">An example of Chainlink FSS ordering transaction by the time of arrival in the mempool</figcaption>



从根本上说，链家 FSS 旨在分散交易订购流程，帮助确保 [智能合约](https://chain.link/education/smart-contracts) 以可证明的公平方式处理交易，没有任何优先订购。Chainlink FSS 可以以多种方式使用，包括作为第 1 层区块链上智能合约的预处理阶段，以及为第 2 层网络和 [分散汇总排序器](https://blog.chain.link/arbitrum-and-chainlink-fair-sequencing-services/) 订购交易。

通过帮助确保交易公平有序并降低网络交易费用，FSS 极大地改善了用户与智能合约应用程序交互的体验。最终结果是一个 DeFi 生态系统，能够实现其最大的潜力，提供一个更加经济公平的世界，由分布式共识和加密强制保证提供支持。

如果您是一名开发人员，并希望将您的智能合约连接到底层区块链之外的现有数据和基础设施，请访问 [Chainlink 开发人员文档](https://docs.chain.link/) 或点击此处[](https://chainlink.typeform.com/to/gEwrPO)。

### 关于这个话题的更多信息

*   [公平测序服务:实现可证明公平的 DeFi 生态系统](https://blog.chain.link/chainlink-fair-sequencing-services-enabling-a-provably-fair-defi-ecosystem/)
*   [Chainlink 2.0:分布式 Oracle 网络发展的下一步](https://chain.link/whitepaper)
*   [使用 Arbitrum 和公平测序服务创建高度可扩展和抗 MEV 的 DeFi 生态系统](https://blog.chain.link/arbitrum-and-chainlink-fair-sequencing-services/)