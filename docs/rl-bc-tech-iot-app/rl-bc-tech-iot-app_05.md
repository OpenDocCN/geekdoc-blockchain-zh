第四章

# 区块链技术用于去中心化自治组织

Madhusudan Singh^(a)^,^(b); Shiho Kim^(b)    ^a 韩国大田乌松大学国际研究学院技术研究学院

^b 韩国首尔延世大学延世大学收敛技术研究所

## 摘要

随着组织运营和业务需求不断变化，去中心化自治组织（DAO）是当前组织的需求。集中自治组织（CAO）缺乏透明度，由少数高效管理者管理，而去中心化自治组织（DAO）是一种新颖的可扩展的、自组织的区块链协调，由智能合约控制，其基本运营根据在代码中指定的规则和原则自动化，无需人工参与。在本章中，我们讨论了去中心化自治组织（DAO）的需求和该领域的关键工作。然后，我们介绍了一种采用以太坊区块链的前景性解决方案，该解决方案结合了具有智能合约计算功能的图灵完备编程语言。我们阐述了一种允许参与者实时监督贡献资金并使用软件规范化、自动化和实施治理政策的组织形成的解决方案。编写了智能合约的基本代码，以在以太坊区块链上创建去中心化自治组织（DAO）。我们还解释了 DAO 的代码工作原理，重点是组织的基本建立和治理特征，包括组织、形成和投票权。DAO 被认为是未来商业工作的期望达成。但是，在区块链社区中，仍然缺乏 DAO 的运营基础。

### 关键词

去中心化自治组织；区块链技术；智能合约；分布式账本；以太坊 Gas

## 1 引言

我们知道，组织的含义是在字典中定义的；一个成员为了共同的目的而持续工作在一起的群体。组织的概念在先前的文章中已经提到。

“⋯ 组织是一种特定的结构、人员、任务和技术的模式。”

来源：Leavitt [[1]](S0065245819300257.xhtml#bb0010)。

“⋯ 一个由一组子系统组成的系统…”

来源：Katz 和 Kahn [[2]](S0065245819300257.xhtml#bb0015)。

每个组织都必须遵循一个绝对规则，由组织的政府管理。一个组织由一群股东组成，他们以百分比格式代表组织的所有权。

区块链技术是互联网的一种新颖且日益重要的技术基础。区块链技术正在影响组织行为，以发展一种称为“去中心化自治组织（DAO）”的新组织形式。DAO 是一个运行在点对点网络上的计算机程序，结合了治理和决策规则。DAO 可以被编程成自主运行，无需人类参与，或者代码可以直接、实时地控制 DAO 及其控制的资金。最早的 DAO 是由软件控制的社区组织实验，试图重新实现传统公司治理的某些方面，将公司章程的自愿遵守替换为使用预先协商的计算机代码的实际遵守。去中心化组织（DO）将是一组按照代码规定的规则相互作用的人类。添加“自治”一词用于指代其主要功能为自动化的组织，而人类活动和互动并不是那么必要。

### 1.1 中央自治组织（CAO）

集中式自治组织（CAO）通过一群精英经理从高层管理层开始，逐级进行决策，仅由最优秀的管理者负责总体判断。这种层级结构被称为指挥链。

在集中式自治组织（CAO）中，判断过程是逐渐的，这进一步使得进展缓慢，如图 1 所示。

![图 1](img/f04-01-9780128171899.jpg)

图 1 集中式自治组织概览。

### 1.2 CAO 存在的问题

大多数集中式自治组织（CAO）是集中管理的。它们缺乏透明度，由少数有效的管理者管理。他们通过法律系统保证财产。为了解决这些问题，我们需要一个分布式自治组织（DAO）。通过 DAO，我们可以终止以前的结构，但我们仍需要一个精英管理人员团队相互合作。

### 1.3 CAO 的用例/应用

集中式自治系统专注于管理行政机构和独立行政单位中的判断过程，信息由最优秀的管理者传递到多个企业。DAO 构建看起来更像是一个独立构建的多个小规模合作，引入了管理的重复和更为紧密的控制链。意识到这两种本质上不同的设计原则之间的差异可以帮助建立一个有效的企业基础。

1.  （a）管理基础比较

    在集中式结构中，每个经理被授权处理更广泛的工人、部门和业务操作。管理模式在集中式基础上可能会变得自信，因为经理们与个人助手交流的时间非常少。

    在分散型结构中，每个管理者被授权处理较少的员工和业务操作，并且在业务的几个领域中，几个管理者贡献相似的工作内容和职责。分散型基础允许管理者在较小的层面上做出决策，这对需要独立团队适应特定工作场所考虑的情况（例如直销）非常理想。

    +   ▪ 决策和信息流动

        在集中型组织结构中，决策是在高层次上制定的，并通过各级层次传达到较低层次。中层和低层管理者的决策受限于如何执行传递给他们的决策。

        分散型结构则恰好相反。在分散型组织中，低层管理者和员工有权为自己和他们的工作团队做出重要决策，并且关于他们的选择的信息向管理层的高层报告。

1.  (b) 集中型结构的应用

    小规模企业的人员较少，因此它们以集中的方式进行控制。在小规模企业中，企业的所有者可能是唯一的公司经理，并且他立即受到公司其他员工的监督。

    集中型组织结构的一个例子是货运公司。所有的功能决策都由公司管理者形成。管理者通过启动器向个别司机发送信息。

1.  (c) 分散型结构的应用

    分散型组织结构的一个例子是特许经营组织。特许经营组织以产品生产和销售为主，并且在经营独立店铺时给予相当大的自由。

#### 1.3.1 区块链技术背景

区块链已经在互联网之后改变了信息和媒体的交流方式。区块链技术被认为是一项开创性的创新，是一个新经济时代的先驱。区块链催生了一种新型的系统，称为区块链经济系统。每当激励性交易被自主执行时，区块链经济系统的规范将由智能合约确定。显然，区块链经济已经形成了一种新型的组织结构，称为去中心化自治组织（DAO）。区块链是去中心化自治组织（DAOs）的基础，通过消除信任和错误问题，提供了新的众包协调阶段。

### 1.4 区块链的用例/应用

区块链技术有能力在许多领域改变我们的生活方式。区块链有可能通过诸如加密货币、供应链管理、数字身份、投票、医疗保健、筹款（ICO 或安全代币发行）、公证、食品安全、知识产权（IP）、去中心化自治组织（DAO）、分布式云存储、共享经济、音乐、智能合约、慈善、汽车、房地产、物联网、网络安全和保险等潜在的区块链用例而影响我们的生活方式。

<hgroup>

## 2 去中心化自治组织（DAO）

### 2.1 DAO 简介

</hgroup>

去中心化自治组织（DAO）是一种其基本运作是根据在代码中指定的规则和原则自动化的组织，无需人类参与。DAO 是一种新型的可扩展的、自组织的区块链协调，由智能合约控制。DAO 被认为是未来商业工作预期的符合者。但在区块链社区中，对 DAO 缺乏运作基础（图 2）。

![图 2](img/f04-02-9780128171899.jpg)

图 2 去中心化自治组织概述。

DAO 项目由 Jentzsch 引入并开发，为提供组织解决方案[[3]](S0065245819300257.xhtml#bb0020)。它在以太坊区块链上实施。他详细阐述了白皮书中分布式资金管理的运作描述，该描述详细说明了通过参与者在正式化的、基于软件的组织系统中的控制来建立分布式资金的操作，该组织系统是由 Slock.It 的编码人员制作的应用组织模型。它旨在使股东投票决定公司应该将资金投资到何处。

“DAO”是这一模型的首次重大测试，是 DAO 最杰出的例子。第一个公开的 DAO 于 2016 年 4 月 30 日在以太坊上成立。动机是为了为参与者的改进建立一个新的业务管理轨道，并使用无懈可击的代码的不断决策。在开始阶段，它从多个投资者那里获得了相当多的关注，从而筹集了相当于 1.68 亿美元的资金，创造了世界上最大的众筹项目。但是很快，“DAO”由于 DAO 代码的缺陷而被恶意滥用并受到了相当程度的损害。

DAOs 使用以太坊区块链，使用以太作为执行合同的加密货币。在以太坊网络中用于验证交易的计算能力是用以太加密货币支付的。

分布式算法设计的先进解决方案可以与从分布式市场人员获得的先进理解的推理和学习相结合，形成自组织、强大且具有弹性的治理的新结构[[4]](S0065245819300257.xhtml#bb0025)。

### 2.2 对去中心化自治组织的需求

1.  (a) 这为什么重要？

    DAO 是建立在以太坊区块链上的系统。DAO 是一个例子，说明了平台如何将以前的协调模式转变为数字、互联世界，而不是简单地转变为新型的协调和治理方式。DAO 是一个可以从投资基金到共同数据存储等多种行动中构建的系统。它可以用来组织一个自主的共享乘车系统，其中有竞争性的行动来协调、商业、界面等，所有这些都能顺利地协同运作。它改变了新型的治理模式，如“未来政治”，它利用预测市场来选择规则。

    DAO 也可以被视为对工作变革的一种反应，类似于平台合作社。随着工作变得更像是一种不安全的承诺而不是稳定的财务来源，组织基础可以帮助应对新的现实。而平台合作社通过利用数字平台改变了资源和能力的合理分配来解决这一问题，DAO 则试图通过智能合约、代码和区块链实现相同的目标。

    去中心化自治组织（DAO）提供了一个安全可信的分布式账本，利用区块链技术在互联网上进行金融交易路由，使用分布式数据库中的可信时间戳来使欺诈变得困难。不需要共同接受的第三方，这简化了金融交易的流程，也无需在不同记录中复制合同，进一步降低了在区块链网络中的交易成本。

    “去中心化组织公司”的概念最早由 [丹尼尔·拉里默](https://en.wikipedia.org/wiki/Daniel_Larimer) 于 2013 年 9 月 7 日提出，并于 2014 年在比特股中实现，2018 年在 EOS 中实现。

    [维塔利克·布特林](https://en.wikipedia.org/wiki/Vitalik_Buterin) 指出，在启动 DAO 后，如果图灵完备平台支持智能合约，它将在没有人为管理干预的情况下进行协调和执行。[以太坊](https://en.wikipedia.org/wiki/Ethereum) 达到了图灵门槛，可以实现这样的 DAO。参与者在开放平台去中心化自治组织中操作他们的实体和个人记录。

### 2.3 DAO 的算法/工具

1.  (a) 用于 DAO 的算法/工具

    我们需要大量而精确的经典合法工具来发展 DAO 和智能合约。最好利用由管理机构承认的定制工具。有一些工具是按照法律规定的规则和法规而制定的。一个例子是欧盟的 eIDAS 规例，它规定了电子认证的基础和执行数字签名等信任服务的工具，而不是使用传统的身份证明。利用这些工具可以极大地简化智能合约的使用，并且还可以定义任何智能合约的法律后果。

    斯塔福德·比尔（Stafford Beer）的可行系统模型（VSM）运作及其关系规定了描述去中心化自治组织实用性的工具。

    但是，VSM 在遵守多种组织特定构造和组件方面突然中断。尽管 VSM 规定了实用性的标准，但这些标准只是在功能上进行了解释。

    VSM 是一个声誉良好且相对古老的模型；然而，由于其复杂的性质，VSM 难以应用[[12]](S0065245819300257.xhtml#bb0065)。VSM 是描绘组织的有效工具[[6]](S0065245819300257.xhtml#bb0035)；但是，难以操作。因此，在研究中，VSM 被作为概念工具[[13]](S0065245819300257.xhtml#bb0070)来描述系统，而不是在现实中操作。

    在硬分叉之后，VSM 建议是在没有足够的链上合法控制工具可用的情况下提出的[[14]](S0065245819300257.xhtml#bb0075)。社区讨论了几种与 ETC 的运作方式相关的替代方案。所选的替代方案允许 DGD 持有者收回他们的 ETC，而不会在 DigixGlobal 和 DigixDAO 之间产生重大的合法和财务问题[[15]](S0065245819300257.xhtml#bb0080)。

    “CarbonVote” 是另一种选项，因为 DigixDAO 治理模型不适用于投票。CarbonVote 在投票过程中消除了黑客攻击的可能性，并且简单、安全，提供便利[[15]](S0065245819300257.xhtml#bb0080)。

    轻量级钱包包括在浏览器中提供完整工具范围的软件，用于与区块链进行通信。

    项目可以使用 Spectrum 提出建议，DGD 持有者可以在这个轻量级钱包中投票 [[16]](S0065245819300257.xhtml#bb0085)。

1.  (b) DAO 栈

    DAO 栈提供了开发、运作和治理 DAO（分散自治组织）的基本工具，包括在更广泛的通信系统中内部和外部的 DAO。下图显示了 DAO 栈的组件（图 3）。![f04-03-9780128171899](img/f04-03-9780128171899.jpg)

    图 3 DAO 栈。

    DAO 堆栈系统由离散可互操作的 DAO 组成，每个 DAO 与其他 DAO 通信，保持着开放的分布式协作。所有 DAO 都包括由 Arc 部署的序列智能合同。Arc 是用于在以太坊区块链上开发、配置、部署和运行 DAO 的一种稳健的治理模型。DAO 依赖 IPFS 进行数据存储和数据恢复。有两种与这些 DAO 互动的方式。直接方式是通过执行区块链交易，间接方式是通过信任一个前端与基本的区块链系统互动[[17]](S0065245819300257.xhtml#bb0090)。

    Alchemy 由 DAO stack 开发，是一个协作 DApp[[18]](S0065245819300257.xhtml#bb0095)。它使一个人能够在 DAO 堆栈系统中与其他 DAO 协作创建一个新的 DAO。它基于 Arc.js，这是一个通过 Web3.js 控制 Arc 框架的 JavaScript 库。它旨在为前端 JavaScript 开发人员开发在不需要直接与以太坊区块链通信的情况下，在 Arc 上开发协作应用程序提供便利。ArcHives 是由 DAO stack 社区组织的用于有效网络通信的公共记录群[[17]](S0065245819300257.xhtml#bb0090)，[[19]](S0065245819300257.xhtml#bb0100)。

### 2.4 DAO 面临的挑战

1.  (a) The DAO and the challenges

    DAO 象征着一场革命，一场宣告历史上一个新阶段的爆炸，在这个阶段中，攻击可以被创造在市场和其他领域上，而不是被规则所捍卫，在这些规则中，个人可以更独立地协调自己和自己的资产。只有这个新世界相对未开发，并且充满了困难。首先，在 DAO 的情况下，它的财政支持可能无意中已经获得了比在其生计中的分散系统中投入更具挑战性的负担，那里的产出和收益可能来自相对不可避免的规则、数学和智能合约原则的行动。相反，它们主要将在链下价值中发挥作用；普通组织将被社会契约预期回报他们最终产生的净利润的一部分。一个核心问题是它不为资本家提供在其财务评估中赚取利润的机会。要实现这一目标，相信去中心化计划的资本家，如以太坊，购买其测量项目，如 ether（ETH）。这些项目在交易所上以自由方式交换，随着企业将该任务的潜力估计得非常高，甚至在实际项目速度和对非理论储量的需求之前，它们的价值会上升。例如，由于以太坊网络成功地开发了 ETH 的价值，资本家们期待着对 DAO 等方案产生的项目的分布需求的出现。这些项目能够反映其所遇到的进展程度，并且像公开交易的资本一样流动。

    相比之下，虽然商业机构的价值可以迅速增长，但它们可能需要很长时间才能获利。DAO 模型的需求是，利益基本上是通过调查建立的，并通过社会契约共享回报以为项目持有者产生奖励，这可能需要几年的时间才能出现；然而，企业正在遵循一个合理的信念，即 DAO 中的大多数资本家正试图在更短的时间内获得回报。因此，风险在于一旦承诺达成，资金被投资的现实将被锁定在不愉快的无限和不规则的时间段内，项目持有者将急于退出。结果将是市场上选择项目的数量急剧下降，导致持有者不得不被迫履行承诺或造成重大损失。

    自然而然，我们关心的是如何以及何时才能产生回报，除非 DAO 所做的努力最终在初始投资中产生回报。这在一定程度上取决于 DAO 的投票系统是否能够在初期形成更好的承诺决策。关于它是否会成功，有很多不同的看法。

<hgroup>

## 3 区块链用于 DAO

### 3.1 用于 DAO 的智能合约

</hgroup>

去中心化自治组织（DAO）是一个于 2016 年组建的投资基金，完全由智能合约监管，没有人为管理干预。投资者对基金的投资过程进行投票。许多记者描述了 DAO 如何改变投资过程。 20。

图 4A 展示了类似 DAO 的合同的伪代码，允许投资者取款的权限。在第 2 行，该函数获取客户的地址，然后在第 3 行检查客户是否有足够的资金可以提现。如果为真，则通过外部函数调用，在第 6 行将资金发送给客户。在第 8 行，成功转账后减少了客户的余额[[21]](S0065245819300257.xhtml#bb0110)。

![图 4](img/f04-04-9780128171899.jpg)

图 4 (A) 类似 DAO 合同的伪代码，给予投资者取款权限[[21]](S0065245819300257.xhtml#bb0110)。 (B) 类似 DAO 利用的伪代码[[21]](S0065245819300257.xhtml#bb0110)。

代码中的上述函数于 2016 年 6 月被恶意利用，从 DAO 中窃取了约 5000 万美元的资金。第 3 行的语句是对客户合同中的一个函数的调用。图 4B 展示了客户的代码。在第 4 行客户合同中立即调用了提现功能。第 3 行中的调用再次测试是否有足够的资金可以提现。在嵌套调用完成后，提现()函数会减少余额。当测试通过并且之后时，资金会第二次转移。当调用堆栈溢出时，循环停止。这种攻击形式乍一看似乎是由一种新颖的编程方式带来的一个奇怪的风险，但如果我们稍微改变视角，我们就可以看到一个意想不到的困难[[21]](S0065245819300257.xhtml#bb0110)。

Herlihy [[21]](S0065245819300257.xhtml#bb0110) 和 Hoare [[22]](S0065245819300257.xhtml#bb0115) 提出了一种并发编程语言，称为监视器。该编程语言是一个内置互斥锁的对象。当调用此方法时，该锁会自动采用，并在方法返回时释放。监视器还提供了一个 wait () 调用，允许线程停止持有监视器锁，挂起、唤醒并重新获取锁。监视器常量是合理化监视器执行正确性的主要设备。当没有线程在监视器中执行时，此语句成立。当线程持有监视器锁时，该常量可能会被违反，但当线程释放锁时，监视器锁将通过从方法返回或通过 wait () 挂起而恢复。

当通过监视器和监视器常量查看智能合约时，漏洞似乎很普遍。DAO 类似的合约假定了在余额表中每个客户的入口记录表明了其实际余额的常量。故障发生在这个常量，虽然不是永久违反，但在通过获得外部调用来终止监视器锁之前没有修复。

### 3.2 面向 DAO 的分布式分类帐

分布式分类帐技术 (DLT) 使组织能够共享数据和代码。新型分布式应用正在出现，如由一群共同怀疑的机构开发的 DAPPs，这些机构共同努力解决各自组织中去中心化的问题。

分布式账本技术减少了对单一中心化方的需求，监督交易、合同和其他流程，这些之前都是基于中心化治理的。最初看起来有利，但对于依赖于银行等中心化机构的各方存在严重的担忧。由于分布式账本不受特定立法的影响，当前的规则难以执行。

难以组织互不信任的组织群体开发分布式应用。DAPP 机构的发展增长较差，因为它们不愿与不信任的组织联系，除非有共同的模型来分享代码和数据。

许多项目开始发展新的中心化公司来监督他们的 DAPP 治理。这使得分布式账本技术的使用变得不成功，并且难以实现分布式账本技术的优势 [[23]](S0065245819300257.xhtml#bb0120)。

### 3.3 DAO 的用例/应用

1.  (a) 以太坊 DAO

    以太坊 DAO 基于智能合约。智能合约是由开发人员构建的逻辑执行的简单程序。智能合约有多种应用，不仅包括资金转移，还包括废物管理行业的其他应用。例如，通过智能合约，奖励积分可以自动转移到以良好方式处理废物的人们手中 [[24]](S0065245819300257.xhtml#bb0125)。

1.  (b) 通过区块链上的智能合约实现组织所有权的民主化

    1.  1. DigixDAO：DigixDAO 平台成立于 2016 年，用于利用黄金代币实现不可变性、透明度和可审计性。它基于以太坊，从分布式账本中获得优势。更多详情请查阅[`digix.global`](https://digix.global) [[15]](S0065245819300257.xhtml#bb0080)

    1.  2.  DAO：DAO 也称为 Genesis DAO，始于 2016 年。它是一种资本主义导向的风险投资基金。DAO 代码是开源的。更多细节可以在[`DAO.Link`](http://DAO.Link) [[25]](S0065245819300257.xhtml#bb0130)找到。

    1.  3. MakerDAO：Maker DAO 相信平衡的数字资产对于实现区块链技术的完全潜力至关重要。为了实现这一目标，它推出了 Dai，该代币由抵押资产支持。他们致力于减少 DAI 的波动性。与美元相比，它是一种稳定的代币。更多细节可以在[`makerdao.com`](https://makerdao.com) [[26]](S0065245819300257.xhtml#bb0135)找到。

1.  (c) DAO 的用例

    实施在下面描述的 DAO 用例上的 DAO 可以极大受益。

    1.  1.  作为服务的支付：DAO 可以引入“按使用付费”的概念，并围绕此构建应用程序。例如，Slock.it。Slock.it 是一家 DAO 注册公司，它通过形成一个安全和去中心化的无处不在的共享网络，将区块链技术与物联网（IoT）结合起来，为租户和业主提供使用租赁服务。不再需要第三方来处理支付，如 Airbnb，PayPal 或 Visa。

    1.  2.  众筹/ICO：DAO 通常被用作众筹的工具。代币通过以太坊和比特币加密货币换取资金，并使用智能合约进行自动收集和分配代币。

    1.  3. 治理：DAO 可以应用于治理的各个方面。使用 DAO，人们可以透明地投票支持政府提出的任何新法律或政策。人们将不需要依赖中间方，他们将拥有更多权力来为改善社会做出改变。

<hgroup>

## 4 DAO 实施

### 4.1 以太坊

</hgroup>

以太坊的目标是创建一个构建去中心化应用程序的替代协议。这些应用程序提供了非常有效的不同权衡，非常适用于广泛的去中心化应用程序分布。特别强调了应用程序需要快速开发时间、高效交互以及中等和很少使用的应用程序的安全性的情况[[27]](S0065245819300257.xhtml#bb0140)。

### 4.2 DAO 的实施

本节介绍了一种采用区块链以太坊（[28,[29]](S0065245819300257.xhtml#bb0150)）的前瞻性解决方案，该解决方案结合了具有智能合约计算功能的图灵完备编程语言。详细阐述了一种方案，允许形成组织，其中参与者保留对贡献集的直接实时检查，并且治理政策通过软件形式自动化和强制。特别地，编写了智能合约的基本代码[30,[31]](S0065245819300257.xhtml#bb0160)，以在以太坊区块链上创建去中心化自治组织（DAO）。接下来，我们解释了 DAO 代码的工作原理，重点是组织的基本建立和治理特征，包括组织、形成和投票权。

以太坊区块链构建了一个具有内置图灵完备编程语言的概念结构层。该层允许任何人编写智能合约和去中心化应用程序，他们可以为所有权、交易格式和状态转换函数制定自己的自主法律[[24]](S0065245819300257.xhtml#bb0125)。

1.  (a) 以太坊账户

    在以太坊中，状态由称为“账户”的对象组成，每个账户都有一个 20 字节大小的地址，并且状态转换考虑了价值和信息在账户之间的直接转移。

    以太坊账户包括四个值：

    +   ▪ 一个计数器 nonce，以确保每笔交易仅被处理一次

    +   ▪ 最新帐户的以太币余额

    +   ▪ 帐户的合约代码

    +   ▪ 帐户存储

    “以太币”是以太坊的加密货币，用于支付交易费用。一般来说，存在两种类型的帐户，一种是外部拥有的帐户，另一种是合约帐户。外部帐户由私钥操作，没有代码，而合约帐户由合约代码操作。

1.  (b) 消息和交易

    “交易”在以太坊中指的是一个数字签名的数据包，其中包含一个消息。交易包含 [[24]](S0065245819300257.xhtml#bb0125)：

    +   ▪ 消息的接收者

    +   ▪ 发送者的数字签名

    +   ▪ 需要从发送者转移给接收者的以太币总数

    +   ▪ 可选数据字段

    +   ▪ 一个 Startgas 值，表示执行交易的计算步骤的上限。

    +   ▪ 一个 Gasprice 值，表示发送者每个计算步骤支付的费用。

    加密货币通常由前三个字段组成。默认情况下，可选数据字段没有操作。然而，在虚拟机中有一个 OPCODE，用于合约检索数据。

    对于以太坊的反否认服务模型，Startgas 和 Gasprice 字段是必不可少的。

    每笔交易调整计算步骤的数量，以在执行过程中避免计算损失。计算以 gas 单位进行度量。一般来说，单个计算步骤的成本是一定的 gas。对于多帧数据交易，会收取多个 gas 费用。

1.  (c) 消息

    合约能够向其他合约发送消息。消息是存在于以太坊执行环境中的不可序列化的虚拟对象。一条消息包括：

    +   • 消息发送者（绝对）

    +   • 消息接收者

    +   • 随消息一起转移的以太币总数

    +   • 可选数据字段

    +   • Startgas 值

    在代码执行期间通过 CALL OPCODE 由合约生成消息。合约与其他合约有关系。

    合约分配的燃气津贴利用了所有交易和所有子执行消耗的总燃气。

    例如，如果外部代理 X 向 Y 发送一笔拥有 1200 燃气的交易，并且 Y 在向 Z 发送交易之前消耗了 700 燃气，并且 Z 的内部执行在偿还前消耗了 300 燃气，那么 Y 可以在燃气耗尽之前再消耗另外 200 燃气。

    以太坊的状态转换函数为 EMPLOY (R, TS) → R′。函数定义如下（图 5）：![f04-05-9780128171899](img/f04-05-9780128171899.jpg)

    图 5 显示了以太坊智能合约的状态转换示例。

    1.  1. 检查交易是否正确，签名是否合法，以及 nonce 是否与发送方账户中的 nonce 对应。如果条件不满足，则返回错误。

    1.  2. 将交易费用计算为 Startgas * Gasprice，并从签名中找出广播地址。扣除费用，维护发送方账户的余额并增加发送方的 nonce。如果余额不足，则返回一个错误消息。

    1.  3. 指定 Gas = Startgas，并根据每字节扣除一定数量的燃气来支付交易字节。

    1.  4. 将交易金额从发送方的账户转移到接收方的账户。如果接收方的账户不存在，则创建它。如果接收方的账户是一个合约，执行合约的代码直至结束或执行耗尽燃气。

    1.  5. 如果转移值失败，原因是发送方余额不足，或者代码执行消耗了燃气，则回滚所有状态变更，不包括费用支付，并将费用添加到矿工的账户。

    1.  6. 否则，将所有剩余燃气的费用归还给发送方，并将费用转移到用于消耗燃气的矿工。

    例如，假设合约的代码如下：

    +   如果!auto.store[assigndatapayload(0)]：

    +   auto.store[assigndatapayload(0)] = assigndatapayload (64)。

    这是高级语言 Serpent 代码，这段代码可以编译成 EVM 代码。合同代码是用低级 EVM 代码脚本化的。

    假设合同的存储启动为空，并且传输了价值 20 ether、3000 gas、0.001 ether Gasprice 和 64 字节数据的交易，其中字节 0–31 表示数字 2，字节 32–63 表示字符串 CHARLIE，字节 64–127 表示字符串 DELTA。在这种情况下，状态转换函数的过程描述如下：

    +   ▪ 检查交易是否合法且正确。

    +   ▪ 检查交易发送者是否至少有 3000 * 0.001 = 3 ether。如果是，则从发送者的账户中扣除三个 ether。

    +   ▪ 分配 gas = 3000；假设交易长度为 200 字节，字节费用为 6，扣除 1200 后剩余 1800 gas。

    +   ▪ 从发送者的账户中再扣除 20 个 ether，并加到合同的账户上。

    +   ▪ 执行代码。代码检查合同存储在索引 3 处是否被占用，发现如果没有被占用，则将索引 3 处的存储修复为值 DELTA。假设它消耗了 287 个 gas，因此剩余的 gas 量为 1800 − 287 = 1513。

    +   ▪ 将 1513 * 0.001 = 1.513 ether 返回到发送者的账户，并返回结果状态。

    如果接收方的交易方没有合同，则总交易费用等于提供的 Gasprice 乘以交易长度（以字节为单位）。

    消息的工作等同于与返回相关的事务。如果某些消息执行耗尽了 gas，那么该消息和由该消息激活的其他消息的执行返回，但父执行不需要返回。一个合同调用另一个合同是无害的。如果 X 以 G gas 调用 Y，那么保证 X 的执行最多消耗 G gas。CREATE OPCODE 创建一个合同，其工作类似于 CALL。

1.  （d）代码执行

    以太坊虚拟机代码或 EVM 代码是一种低级、基于堆栈的字节码语言。以太坊合同是用 EVM 代码编写的。代码中的每个字节表示一个函数。当代码执行时，它进入一个无限循环，该循环由在当前程序计数器处执行函数的多次执行组成。程序计数器从零开始，并且逐个递增，直到代码终止，或者在出现错误或注意到 STOP 或 RETURN 等指令时。函数可以检索三种空间来存储数据：

    +   ▪ 栈，后进先出（LIFO）数据结构，其中数据可以被推送和弹出

    +   ▪ 内存，一个字节数组

    +   ▪ 合同的长期重置密钥和值存储。

        以太坊虚拟机（EVM）代码的常规执行模型非常简单。EVM 由一个包含八个属性的元组确定，例如元组（block_state，transaction，message，code，memory，stack，pc，gas），其中 block_state 是包含全局所有账户和允许余额和存储的状态。在执行的每一轮中，在代码的第 PC 字节处找到当前指令。例如，在栈中的 ADD 操作弹出栈中的两个数据值，并将它们的总和推入栈中。此外，该操作将 gas 减少 1，并将 PC 增加 1。STORE 操作从栈中弹出两个顶部数据值，并将第一个数据值中提到的地址的第二个数据值附加到合同的存储中。

1.  (e) 区块链与挖矿

    从许多方面来看，以太坊区块链与比特币区块链相似，但仍存在一些不同之处。就区块链的架构而言，以太坊的区块包含交易列表的副本和最新状态，而比特币仅包含交易列表的副本 [[32]](S0065245819300257.xhtml#bb0165)。

    以太坊中的基本区块验证算法如下：

    +   ▪ 检查引用的上一个区块是否合法且存在。

    +   ▪ 检查区块的时间戳是否在先前引用的区块之后且不超过未来 15 分钟。

    +   ▪ 检查区块编号、难度、交易根、叔叔根和 gas 限制的合法性。

    +   ▪ 检查区块的工作证明（PoW）是否合法。

    +   ▪ 让状态在上一个区块结束时为 S [0]。

    +   ▪ 让区块交易列表为 TL，其中包含 n 个交易。对于所有 i 在 0 … n - 1，设置 S[i + 1] = APPLY(S[i], TL[i])。如果区块中花费的总 gas 超过 GASLIMIT 或应用返回错误，则返回错误。

    +   ▪ 在添加支付给矿工的区块激励点之后，让最终状态为 S[n]。

    +   ▪ 要检查区块的有效性，请检查最终状态 S_FINAL 的默克尔树根是否与区块头中提供的最终状态根相等，否则，该区块无效。

    一开始看起来，每个区块都需要存储完整状态的方法可能看起来效率极低。这种方法的效率应该与比特币的效率相符合。这是因为状态存储在树结构中，只有树的一小部分需要修改。因此，两个相邻区块的树结构非常相似，并且可以使用指针一次存储数据两次引用。为此，使用了“帕特里夏树”，考虑到了默克尔树概念的调整，允许不仅有效更改节点还能插入和删除节点[[32]](S0065245819300257.xhtml#bb0165)。

<hgroup>

## 5 组织的未来

### 5.1 传统组织

</hgroup>

代表的协调增强了他们对外在竞争市场驱动因素的技能。这是组织的基本来源，也是公司希望发展的原因。然而，代表的合作意味着随着公司的发展，合作的货币价值也会提高，因此公司不能无限期地发展。在发展过程中，公司需要固定的结构，并且面临着一个不断增加的挑战：(a) 在迅速变化的考虑因素方面保持灵活性，以及 (b) 在参与者之间保持关注、信仰和就业安排。简而言之，公司越大，它需要处理的内部工作就越多，而公司越小，外部竞争就越频繁。一般而言，公司的真实规模是这两个拉力之间的最佳平衡。有时，一项新技术或范式变革的基础会改变协调成本的简化，将公司的规模和效率提升到新的水平。互联网为国际标准上的开放、点对点和实时信息交换提供了便利。因此，互联网媒体实际上比传统媒体更具可扩展性。

### 5.2 开放组织

当前的经济体系建立在零和博弈的基础上。竞争的后果激发了为了执行而增长，这在局部而非全局胜利方面被最大化。非关键的纳什均衡存在这个问题。纳什均衡意味着即使对每个人都有利的其他合作平衡存在，一个个体行动者也没有影响力来独家改变他/她的方案。大规模的互动存在这个障碍，它阻止了从竞争到忠诚的转变。纳什均衡在生产和发展中最为频繁。这在知识和信息的透明度或不透明度的形式以及总体上反竞争资产的形式上明确地描述出来。反竞争资产在消费上是无限的，而且它们被使用得越多，价值就越大。

例如，代码永远不会用尽，而且越多人关注它，它就会变得更精细。与此同时，企业没有奖励开源他们的代码的动机；否则，他们会不对称地将奖励投入到他们的竞争对手身上。如果有几家竞争的公司开发类似的产品，他们可以通过共同开发产品的共同组件而非独立生产来获得更多利润。知识产权（IP）是将反竞争资产转化为稀缺组件的传统手段，从而使它们具有销售价值，尽管在今天快速创新的环境中，这一手段变得越来越不合理和不实用。开放共享共同资产与当前的经济体系存在冲突。相反，对于大规模、开放的协作和 DAOs 来说，这是基础性的。DAO 需要奖励和激励才能发挥效力，同时共享可重复使用的组件。通过现有的共享组件，DAO 的发展和效率将得到增强。开放组织的目标是从目前的非协作纳什均衡转变为未来的协作状态。然而，DAO 将取代现有的组织基础，并非因为它们更好或更不腐败，而是因为它们将更有效率。

### 5.3 DAO 的影响

无论“The DAO”的最终失败如何，去中心化自治组织都有可能给世界带来潜在的影响。正因为这一点，“The DAO”以其巨大的短期成功而备受关注。随着进步性知识分子对基于 DAO 的项目和 dApps 进行探讨[[33]](S0065245819300257.xhtml#bb0170)，这项技术仍在不断发展。这将引导我们进入一个不受第三方控制的经济自由的新时代。

Dash 的支持者允许用户对将获得融资的团队和项目进行投票，这是其财政模型的一部分[[34]](S0065245819300257.xhtml#bb0175)。

最后，DAO 对于技术世界来说是一种新颖而极具观察价值的增益，例如区块链技术。根据支持者的说法，DAO 的历史为即将到来的项目提供了极好的学习经验，而不是因为 DAO 的后果而拒绝它们的前景。

### 5.4 组织的未来

良好协调和组织大量人员的能力是社会最重要的力量和驱动力，这是通过数千年的持续发展而变得如此。在本节中，我们讨论了传统组织的问题，以及一个新潜在的网络建立形式：DAO

1.  (a) 实施 DAO 可以给现代世界带来什么？

    DAO 完全控制着基础设施和通信的技术方式，而不是传统的方式。然而，系统中缺乏层次结构。相比之下，当你成为 DAO 的一部分时，你关心的是你工作的结果。你自己承担了你的工作的全部责任，这使你成为了一个更好的决策者。

    DAO 项目中的每个参与者都有关键和平等的权利。成功或失败完全取决于每个参与者，它影响 DAO 工作的每个方面。个人的影响取决于一个人在项目中投资的金额总和。这种观点比过时的权力分配系统更值得信赖。匿名性是 DAO 的另一个令人惊讶的特点。这意味着利益相关者不需要证明他们的身份，如果他们想参与投资。因此，在没有政府控制的情况下，它保持了隐私。

    总体而言，分散自治组织的实施对我们的世界比传统组织更加有益和成功，这正在朝着一个政治、经济和商业社会的方向发展。DAO 的另一个亮点是大群体的批判性思维增长。

## 6 总结

在这一章中，我们讨论了基于以太坊区块链智能合约的去中心化自治组织（DAO），它使组织的形成得以实现，参与者保持对贡献的实时检查，而治理政策则通过软件形式化、自动化并实施。我们提供了在以太坊区块链上形成去中心化自治组织（DAO）的智能合约的基本代码。我们还解释了 DAO 的工作原理，重点是基本的建立和治理特征，包括组织、形成和他们的投票权。 DAO 被认为同意未来业务工作的期望。

## 参考资料

[1] Leavitt H.J. 应用组织和阅读。工业变革：结构、技术和人文方法。 在：Cooper W.W.等，编。 *组织研究的新视角.* 纽约，纽约州：Wiley; 1962.

[2] Katz D., Kahn R.L. *组织的社会心理学.* 纽约，纽约州：Wiley; 1978.

[3] Jentzsch C. *去中心化自治组织到自动化治理.* 创始人，Slock，IT 白皮书; 2017.

[4] Merkle R.C. *DAOs，民主和治理.* 白皮书; 2016.

[5] [`www.blockchain-council.org/blockchain/decentralized-autonomous-organization-dao-dao-works/`](https://www.blockchain-council.org/blockchain/decentralized-autonomous-organization-dao-dao-works/).

[6] Achterbergh J., Vriens D. 管理可行知识。 *系统研究和行为科学.* 2002;19:223–241\. doi:10.1002/sres.440.

[7] [`blockonomi.com/bitshares-guide/`](https://blockonomi.com/bitshares-guide/).

[8] [`bitsonline.com/vitalik-buterin-daico-new/`](https://bitsonline.com/vitalik-buterin-daico-new/).

[9] [`www.coindesk.com/information/what-is-a-dao-ethereum/`](https://www.coindesk.com/information/what-is-a-dao-ethereum/)。

[10] Wojdyło K., Czarnecki J. *Blockchain, Smart Contracts and DAO.* White Paper; 2016\. [`www.codozasady.pl/wp-content/uploads/2016/11/Wardynski-and-Partners-Blockchain-smart-contracts-and-DAO.pdf`](http://www.codozasady.pl/wp-content/uploads/2016/11/Wardynski-and-Partners-Blockchain-smart-contracts-and-DAO.pdf).

[11] Beer S. The viable system model: its provenance, development, methodology and pathology. *J. Oper. Res. Soc.* 1984;35(1):7–25\. doi:10.1057/jors.1984.2.

[12] Espejo R., Bowling D., Hoverstadt P. The viable system model and the Viplan software. *Kybernetes.* 1999;28(6/7):661–678.

[13] Espejo R., Harnden R. *The Viable Systems Model—Interpretations and Applications of Stafford Beer's VSM.* Wiley; 1989\. Chichester [`searchworks.stanford.edu/view/1346153`](https://searchworks.stanford.edu/view/1346153).

[14] Butrin's V. [`vitalik.ca/general/2017/03/14/forks_and_markets.html”`](https://vitalik.ca/general/2017/03/14/forks_and_markets.html). 2017.

[15] [`digix.global/`](https://digix.global/).

[16] De Wilt J. *DAO, Can It Be Viable? An Exploratory Research on the Viability of a Blockchain Based Decentralized Autonomous Organization.* Unpublished Master thesis Nijmegen, Netherlands: Radboud University; 2018.

[17] White Paper. *DAOStack: An Operating System for Collective Intelligence.* White Paper; 2018\. Work in Progress [`daostack.io/wp/DAOstack-White-Paper-en.pdf`](https://daostack.io/wp/DAOstack-White-Paper-en.pdf).

[18] [`medium.com/ethex-market/how-to-use-the-alchemy-dapp-and-the-genesis-dao-6bfd91a357dc`](https://medium.com/ethex-market/how-to-use-the-alchemy-dapp-and-the-genesis-dao-6bfd91a357dc).

[19] Grossman S., Abraham I., Golan-Gueta G., Michalevsky Y., Rinetzky N., Sagiv M., Zohar Y. Online detection of effectively callback free objects with applications to smart contracts. Article no. 48 *Proc. ACM Program. Lang.* 2017;2(POPL):28\. doi:10.1145/3158136.

[20] Smith C. *区块链、智能合约与 DAO.* Whitepaper: Wardyński & Partners; 2016.

[21] Herlihy M. 区块链：从分布式计算的角度看. *ACM 通讯.* 2019;62(2):78–85\. doi:10.1145/3209623.

[22] Hoare C.A.R. Monitors: 一个操作系统结构概念. *ACM 通讯.* 1974;17(10):549–557.

[23] [`medium.com/@rickcrook/the-case-for-de-centralisation-1ac14935a3fc`](https://medium.com/@rickcrook/the-case-for-de-centralisation-1ac14935a3fc).

[24] [`github.com/ethereum/wiki/wiki/White-Paper#decentralized-autonomous-organizations`](https://github.com/ethereum/wiki/wiki/White-Paper#decentralized-autonomous-organizations).

[25] [`DAO.Link`](http://dao.link/).

[26] [`makerdao.com`](https://makerdao.com/).

[27] Santos F., Kostakis V. *DAO：区块链治理的百万美元教训.* 商学院和治理，拉格纳尔·纽尔克斯创新与治理部门; 2018.

[28] Buterin's V. *以太坊协议的前史.* [`vitalik.ca/2017-09-15-prehistory.html`](https://vitalik.ca/2017-09-15-prehistory.html). 2017.

[29] Wood G. *以太坊：一个安全的去中心化通用交易分类账 Byzantium Version 72dde18–2018-04-07.* Yellow Paper; 2014\. [`pdfs.semanticscholar.org/ee5f/d86e5210b2b59f932a131fda164f030f915e.pdf?_ga=2.69799320.968260507.1555470712-544867317.1555314991`](https://pdfs.semanticscholar.org/ee5f/d86e5210b2b59f932a131fda164f030f915e.pdf?_ga=2.69799320.968260507.1555470712-544867317.1555314991).

[30] Szabo N. *智能合约：数字市场的构建基石.* [`www.fon.hum.uva.nl/rob/Courses/InformationInSpeech/CDROM/Literature/LOTwinterschool2006/szabo.best.vwh.net/smart_contracts_2.html`](http://www.fon.hum.uva.nl/rob/Courses/InformationInSpeech/CDROM/Literature/LOTwinterschool2006/szabo.best.vwh.net/smart_contracts_2.html). 2000.

[31] Delmolino K., Arnett M., Kosba A.E., Miller A., Shi E. 逐步创建安全智能合约的方法：来自加密货币实验室的教训和见解。在：Clark J., Meiklejohn S., Ryan P.Y.A., Wallach D., Brenner M., Rohloff K.等，编辑。*金融密码学和数据安全—FC 2016 国际研讨会，BITCOIN、VOTING 和 WAHC，基督教堂。* 巴巴多斯：Springer 柏林海德堡；2016:79–94\. [`link.springer.com/chapter/10.1007%2F978-3-662-53357-4_6`](https://link.springer.com/chapter/10.1007%2F978-3-662-53357-4_6).

[32] D.A.O. 以太坊，下一代智能合约和分散式应用平台，白皮书。[`github.com/ethereum/wiki/wiki/White-Paper#decentralized-autonomous-organizations`](https://github.com/ethereum/wiki/wiki/White-Paper#decentralized-autonomous-organizations).

[33] [`news.coinsquare.com/learn-coinsquare/dapps-a-look-into-the-world-of-decentralized-applications`](https://news.coinsquare.com/learn-coinsquare/dapps-a-look-into-the-world-of-decentralized-applications).

[34] [`news.coinsquare.com/learn-coinsquare/dash-what-it-is-and-how-to-buy-dash-in-canada/`](https://news.coinsquare.com/learn-coinsquare/dash-what-it-is-and-how-to-buy-dash-in-canada/).

## 进一步阅读

[35] Brinch Hansen P. 并行帕斯卡编程语言。*IEEE 软件工程杂志。* 1975；2（6 月）：199–206.

术语表

**智能合约** 智能合约是一种具有预定义合同政策的自执行程序，提供额外的安全功能，例如在区块链中控制用户数据和监视访问权限。当满足一组预定义条件时，智能合约将自主执行。如果两方之间的相互合同被违反，智能合约将通过删除对等节点进行交易的能力来处理该问题，而无需经纪人。

**去中心化自治组织（DAO）** 定义去中心化自治组织是一种可以依据其预定义协议自行运行而无需任何分层管理的组织。它基于预定义的智能合约代码运作，比如以太坊平台中的以太坊虚拟机（EVM）。

**未来预测市场** 未来预测市场最初由经济学家罗宾·汉森提出，作为一种未来形式的政府。个人将投票选择一个衡量标准，以确定他们的国家（或组织）表现如何，然后使用预测市场来确定最佳优化该标准的政策。

**以太坊 Gas** Gas 是以太坊智能合约系统中用于计算执行某些操作所需费用的单位。Gas 表示执行某些交易将需要的计算成本。Gas 转换为以太币没有固定的转换价格，通常交易发送者会指定愿意支付的最高 Gas 价格。

![u04-01-9780128171899](img/u04-01-9780128171899.jpg)

**Madhusudan Singh** 目前是韩国大田乌松大学国际研究学院技术研究学院的助理教授，也是韩国仁川宋岛延世大学无缝交通实验室的访问研究教授。在此之前，他曾是韩国宋岛延世大学收敛技术研究所的研究教授（2016 年 6 月至 2018 年 2 月）。Singh 博士还曾在韩国永仁市三星显示器的研发部门担任高级工程师（2012 年 3 月至 2016 年 3 月）。目前，他是 IEEE 的高级会员（SMIEEE）和 ACM、IEEE 标准、IEEE 区块链工作组等许多研究和科学组织的成员。他还担任多个国际期刊/会议的编辑/审稿人/技术委员会成员。他发表了 50 多篇经过同行评审的研究文章，拥有 9 个以上的国家/国际专利，并作为演讲者发表了 15 个以上的技术讲座。他的研究兴趣领域包括区块链技术、机器学习、网络安全、软件工程、物联网和计算机视觉。

![u04-02-9780128171899](img/u04-02-9780128171899.jpg)

**Shiho Kim** 是韩国首尔延世大学综合技术学院的教授。他以前的工作包括担任韩国 LG Semicon Ltd.（现为 SK Hynix）的片上系统设计工程师[1995–1996]，RAVERS（高级混合电动汽车能量回收系统研究中心）的主任，这是一个得到政府支持的 IT 研究中心。担任延世大学收敛技术研究所（YICT）副所长，执行韩国国家 ICT 融合计划，这是韩国培养信息和通信技术领域人才的国家计划，韩国[2011 年至 2012 年]。担任延世大学无缝交通实验室主任，韩国[2011 年至今]。他的主要研究兴趣包括智能车辆的软件和硬件技术开发，智能交通系统的区块链技术，以及自主车辆的强化学习。他是各种期刊和国际会议的编委和审稿人。到目前为止，他已经组织了两次国际会议，担任技术主席/总主席。他是 IEIE（韩国电子与信息工程师学会）和 KSAE（韩国汽车工程师学会）的会员，是 KINGC（韩国下一代计算机学会）的副会长，也是 IEEE 的高级会员。他是信息和通信技术领域 100 多篇论文的共同作者，并持有 50 多项专利。
