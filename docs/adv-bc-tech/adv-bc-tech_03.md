© 作者(们)，在 Springer Nature Switzerland AG 2022 年以独家许可下授权 Y. Maleh 等人（主编）Advances in Blockchain Technology for Cyber Physical SystemsInternet of ThingsTechnology，Communications and Computing[`doi.org/10.1007/978-3-030-93646-4_3`](https://doi.org/10.1007/978-3-030-93646-4_3)

# 基于区块链的医疗记录系统

Nisarg Soni^(1)，Saurav Tayal^(1)，Tarun Kumar Singh^(1)和 Gourinath Banda^(1  )(1)印度印度尔工业技术学院，Madhya Pradesh，Simrol，印度 Gourinath Banda（通讯作者）电子邮件：gourinath@iiti.ac.in 关键词电子医疗记录区块链 IPFSEthereum

## 1 简介

医疗记录管理是一个与医学本身一样古老的问题。数据的传输和共享始终是医疗行业的关键组成部分。参与此过程的每个实体都依赖于未篡改和完整的数据，以使整个系统正常运行。除了互操作性之外，还存在保护个人记录免受数据泄露的机密性问题，因为健康是生活中令人同情和私密的一面。

技术的出现为传统的纸质系统带来了电子解决方案。然而，这些系统基于集中式架构，即客户端-服务器架构。在这种系统中，数据和功能由单个服务器通过互联网提供给多个客户端。所有客户端数据和逻辑都驻留在服务器上。这些系统存在与之相关的缺点，例如单点攻击和故障，其中服务器上的任何攻击或故障都会危及整个系统。还存在权力集中化的问题，控制服务器的实体控制所有数据及其访问。解决这些缺点的更好方法是去中心化。去中心化系统对故障和攻击更加强大，而不会集中控制系统。区块链是一个分布式账本。它是一个去中心化系统，对于解决与集中化相关的问题非常有用。

这一章提出了一个系统，允许在适当授权的情况下交换医疗记录。该系统确保系统用户必须请求患者的许可才能查看和上传其医疗记录。为了实现这一点，我们在区块链网络上部署智能合约。通过使用部署的智能合约，患者可以向不同实体（即医院和保险机构）授予读取和写入权限。使用区块链确保授权机制不可篡改。

本章分为八个部分。第一部分描述了医疗记录的重要性，以及基于区块链的去中心化方法如何比当前的集中式方法更好地存储它们。第二部分解释了解决方案中使用的概念，如区块链、密码学技术、星际文件系统（IPFS）和患者在医院就诊的生命周期。第三部分讨论了该领域中的一些相关工作。第四部分描述了提出的解决方案架构。第五部分解释了一些关键实施细节，第六部分详细说明了各种读/写工作流程。最后，第七和第八部分讨论了我们提出的解决方案分析以及结论和未来工作。

## 2 相关工作

早期的电子健康记录（EHR）尝试基于集中式系统，具有集中式访问控制机制，患者对其数据的访问控制几乎没有发言权。这样的系统首先有了类似医院或诊所内的内部集中式数据存储，与早期的纸笔系统相比，这并没有改善任何安全性或隐私性。随着时间的推移，基于云的存储取代了这一点，并为存储的数据提供了更多的安全性。然而，它们仍然是集中化的解决方案，并使医院和当局成为数据所有者，而不是应该是数据的实际所有者的患者。

Ying 等人[1]提出了一种基于 CP-ABE 的策略保留 EHR 系统，以允许在云上安全共享 EHR 数据。尽管这使得存储和健康数据共享更加安全，但仍然完全是一种集中化的解决方案。解决方案中未探讨任何形式的去中心化。

Liang 等人[2]使用区块链来维护健康数据的完整性并允许安全访问控制。他们的解决方案使用基于云的数据库来存储与健康相关的数据、来自医疗提供者和保险公司的数据请求、数据访问记录和数据访问控制策略。在他们的解决方案中，从用户可穿戴设备收集的健康数据以及从医疗提供者获取的数据被处理以创建一个散列数据条目，然后上传到区块链网络。此外，使用去中心化的权限管理协议来处理来自医疗提供者和健康保险公司对用户个人健康数据的每个数据访问请求。数据所有者有权提供许可，如果他们愿意的话。这些访问控制策略确保了稳定性，因为它们以分散的方式存储在区块链上。除此之外，每次发出访问请求并进行任何访问活动时，都会使用区块链，即分布式分类帐，记录该活动。这条记录可以用于进一步审计或调查。在这种情况下，尽管区块链提供了安全性和完整性，但实际数据存储在云中心化数据库中，这带来了许多问题，如前所述。

Vijayakumar 等人[3]使用超级账本区块链来以分散的方式存储所有健康数据。在他们的解决方案中，各个节点连接在一起形成区块链网络，使数据分布在节点之间。这使得每个节点有责任和机会处理其数据，从而使解决方案以患者为中心，并将数据控制在用户手中。区块链是一种分布式分类帐，允许组织存储医疗信息。由于数据以分散的方式存储在区块链中，因此允许在该网络的参与者之间建立信任。通过集成超级账本，所有医疗信息都以不可篡改的方式记录下来，并且可以轻松跟踪已添加详细信息的任何医疗组织。每笔交易都存储在区块链中，并且可以使用查询工具访问曾经记录的个人的所有医疗细节。他们已经讨论了与中心化系统相关的问题，并尝试通过他们的分散解决方案来克服这些问题。这允许数据的完整性和安全性，但他们的解决方案面临将大量数据存储在区块链本身的问题。

Dubovitskaya 等人 [4] 创建了一个以患者为中心的基于区块链的电子健康记录（EHR）数据管理系统。他们提出了一种基于许可的基于区块链的 EHR 数据共享和集成系统。他们的解决方案利用了超级账本区块链。每家医院在区块链网络中充当一个节点，并拥有其集成的 EHR 系统。这些医院节点共同组成了区块链网络。通过基于 Web 的界面连接患者和医生。该界面用于启动共享 EHR 的交易。在这个解决方案中，使用了混合数据管理系统。在这种混合方法中，只有管理元数据存储在链上。符合《健康保险可移植性和责任法案》的云端存储用于存储 EHR 数据。在存储之前，此数据也经过加密。共享的 EHR 数据使用数字签名和基于公钥基础设施的非对称加密进行了安全保护。在这个解决方案中，使用分布式账本作为用户执行的所有操作的共享不可变透明历史记录；这些操作包括定义访问控制策略以及共享、访问和修改数据，尽管数据使用各种加密方案以安全方式存储，但存储仍然是集中式的。

孙等人 [5] 讨论了一个基于区块链的电子医疗记录共享框架，具有细粒度的访问控制。他们提出了一个具有搜索功能的分布式电子医疗记录系统，使用区块链和智能合约技术轻松查找记录。在这个解决方案中，首先，获得的电子医疗数据进行哈希计算。然后将得到的相应哈希值存储在区块链上。这样做是为了确保数据的真实性和完整性。然后，星际文件系统（IPFS）存储加密的电子医疗记录数据。接着，以太坊区块链用于存储医疗记录的加密关键字索引信息。此外，使用在以太坊区块链上部署的智能合约实现关键字搜索。

此外，他们使用基于属性的加密方案来解密加密的电子医疗记录，并且只能由符合访问策略的属性进行访问。此解决方案使用区块链和智能合约来维护安全性和完整性，使用 IPFS 来进行数据的安全分散式存储。该解决方案通过使用 IPFS、区块链和智能合约使存储和访问控制尽可能分散。尽管如此，访问控制系统仍然是以医生为中心的，其中医生或医疗从业者为各种实体提供访问控制，甚至包括患者自己。

我们的解决方案利用以太坊和智能合约来实现安全访问控制和 IPFS 以及使用各种加密方案在存储和共享之前对数据进行加密。但是我们的解决方案完全以患者为中心。所有的访问控制权都掌握在患者手中，没有人可以在没有患者批准的情况下访问任何类型的数据。所有这些访问控制都编码到智能合约中，一旦部署，就无法以任何方式篡改。

## 3 个概念

### 区块链

区块链在 2008 年通过中本聪在一篇名为《比特币：一种点对点的电子现金系统》的白皮书中的介绍而引起轰动。他推出了一种名为比特币的革命性新加密货币，在其中区块链形成了新引入的货币的基础分散技术。区块链本质上是一个数据结构，其中块是一个接一个地添加的，每个新块都通过其加密哈希与前一个块链接起来，形成一个区块链。

区块链中最顶层的区块定义了任何给定时刻的区块链状态。区块链充当分布式分类帐系统。它由连接的点对点用户网络组成。这个分布式分类帐在每个节点系统上都被复制。它由一起存储在一个块中的交易组成。随着更多交易的进行，它们被分组到一个新的块中，然后添加到区块链中。要将一个块添加到区块链中，它必须通过所谓的共识协议得到大多数节点的确认。每个节点都看到并确认区块链的当前状态，而被大多数节点确认的状态将被接受。这些节点根据共识算法行事，该算法允许选择一个节点，然后将一个块添加到区块链中，从而修改区块链的状态。

区块链的密码链接确保了区块链系统是防篡改的。要创建恶意交易，用户需要控制连接到网络的总节点数的一半以上的系统。由于区块链网络可以有数百万个节点，对于恶意实体来说，实际上是不可能实现其意图的。这确保了区块链不会被破坏。

交易是由网络上匿名用户拥有的账户创建的。他们的账户地址标识这些账户。每个账户都与两个密钥 - 私钥和公钥 - 相关联。这些密钥可以使用钱包[6]存储和管理。有几种类型的硬件和软件钱包可供选择。用户可以使用他们的私钥访问他们的账户。私钥和公钥帮助创建可以发送到网络并创建可验证交易的非对称加密消息。

存储在区块链上的数据对所有人都是可见的，但不能以任何方式更改或篡改。区块链的分布式特性与加密学的力量结合在一起，创建了一个抵御攻击的强大系统，同时保持数据隐私和共享。因此，存储在区块链上的数据的透明度、问责制和不可变性解决了与集中式系统相关的数据隐私和安全问题，医疗记录的敏感性需要这些特征。这些特征使区块链成为存储和管理电子医疗记录的合适系统。

早期的加密货币仅使用区块链来记录交易作为分布式分类帐，但以太坊[7]通过在简单区块链上引入应用层进一步发展，允许用户编写和执行代码。因此，以太坊不仅存储交易，还可以运行脚本，使其成为分布式计算技术而不仅仅是分类帐。这催生了智能合约和分布式应用程序的概念，它们处于试图解决中心化问题的去中心化技术的前沿，并且在本节后面将更详细地讨论。

### 加密技术

本节讨论了对称和非对称加密技术，这是我们系统安全的基础。

对称加密

对称加密或私钥加密使用单个秘密密钥来加密和解密数据。它确保数据不能使用其他密钥解密。高级加密标准（AES）是一种广泛使用的对称加密技术。在使用该技术时，良好的密钥管理非常重要。

非对称加密

在非对称加密或公钥加密中，使用一对密钥 - 公钥和私钥。公钥是公开的，而私钥只有加密发起者知道，并且保密。一旦使用公钥加密数据，则只能使用关联的私钥解密。非对称加密在区块链技术中被广泛使用。RSA 是一种常见的加密技术。它基于从两个大质数获得的大整数的因子分解所涉及的计算复杂性。椭圆曲线加密（ECC）也是一种比 RSA 更好的公钥加密技术，因为它提供了更快的计算时间和更强大的加密。

### [IPFS（星际文件系统）](https://ipfs.io)

IPFS [8] 是一个点对点的、内容寻址的、版本控制的文件系统。这个系统天生是去中心化的；因此，没有任何单一实体控制它。在 IPFS 中的文件被复制到 IPFS 节点网络上。它们的内容用 IPFS 中的文件来标识。与今天互联网中的 URL 所做的位置寻址不同，IPFS 使用内容本身的形式来标识数据，这称为基于内容的寻址。因此，IPFS 使用内容 ID（CID）或内容的哈希来寻址该数据或文件，这代表了内容本身，通过网络来访问该数据或文件。这使得数据和文件可以被任何人从任何地方存储和服务。

它通过将文件进行加密哈希处理，得到一个小而可复制的文件表示，以确保每个文件都有其独特的哈希值，然后可以用于寻址该文件。这个 CID 是使用默克尔树有向无环图（DAGs）生成的。Merkle DAG 允许区分地标识 IPFS 上的所有内容，因为 DAG 的每个数据块都有其唯一的哈希，使得数据防篡改，因为改变数据中的任何内容都会改变哈希。我们的解决方案使用 IPFS 存储所有医疗记录数据。

### 以太坊

以太坊是一种区块链技术，也提供智能合约集成。以太坊使用以太币（ETH）作为其加密货币进行交易。它是一个功能强大且健壮的区块链平台，可以实现去中心化的医疗记录系统。在提供的解决方案中，智能合约用于数据的访问控制，并存储在 IPFS 网络上存储的用户数据的加密内容 ID（CID）或哈希。这是以太坊的一个独特特性，用于创建和运行去中心化应用程序（dApps）和智能合约[10]。智能合约是可以用于描述法律文件、资产、协议和其他各种服务的程序，而不涉及中间人的参与。它们实质上是在称为以太坊虚拟机的分布式网络上运行的代码。这些合同是防篡改的，确保它们所持有的所有数据都不能被任何涉及的各方操纵。它们对连接到以太坊网络的任何人都是可见的。

### 患者的生命周期

一般来说，就医的过程从患者去医院开始，医院要求患者分享他们的以前的记录，然后医院用这些记录进行诊断、治疗等。

在提供治疗后，医院为患者生成新的记录，包括检查结果、处方、账单等。这些记录与患者共享，然后要求患者安全地存储它们，以及患者以前的记录（如果有）。

现在，患者需要解决与当前就医有关的保险索赔。为此，保险公司请求患者分享他们的医疗账单，并在经过适当处理后解决索赔。这完成了患者就医到医院的生命周期。

每位患者都有多次就医经历，每次经历都涉及到上述所有功能，这使得流程复杂且容易出现问题。为了以分散的方式解决这些问题，我们提出了下一节中描述的解决方案。

## 4 提出的解决方案

解决方案架构（图 1）展示了形成解决方案的各种实体，即患者（P）、医院（H）和保险机构（A）（左侧），以及技术（右侧）！[](../images/513458_1_En_3_Chapter/513458_1_En_3_Fig1_HTML.png)

图 1

提出的解决方案架构

使用的技术工具包括区块链[11]、IPFS[12]和一个应用界面。这个应用界面直接连接到以太坊区块链和 IPFS 存储，实现了一个安全、私密和透明的系统，这是该解决方案的主要焦点。

应用界面允许患者控制哪些实体可以访问他们的记录。患者是整个解决方案架构中最强大的实体之一，这是该解决方案的重要独特卖点之一，因为它赋予了患者掌控权。医院有能力为患者添加新记录并访问他们的先前记录。保险机构具有查看记录并解决保险索赔的功能。患者通过区块链交易实现的授权机制控制这些医院和保险机构的功能。

当由患者 *P* [*i*] ∈ *P* 授权时，医院 *H* [*j*] ∈ *H* 将生成的用于患者当前就医（v）的记录存储在分散存储解决方案 IPFS 上。存储在 IPFS 上的记录使用患者 *P* [*i*] 的身份编号 *k* [*Pi*] 进行对称加密。存储后，IPFS 返回当前医院就医（v）的记录位置或哈希 *q* [*v*]。

设 *D* [*v*] 为由患者当前就医生成的记录，AES 为一种对称加密函数，它接受数据 *D* [*k*] 和密钥 *k* [*Pi*]，并返回加密数据。因此，加密记录为

![$$ {e}_v=\mathrm{AES}\left({D}_v, {k}_{Pi}\right) $$](img/513458_1_En_3_Chapter_TeX_Equa.png)

如果 *U* 是 IPFS 提供的一个功能，它接受一段数据，将其上传到 IPFS，并返回一个哈希或 CID，则

![$$ {q}_v=U\ \left({e}_v\right) $$](img/513458_1_En_3_Chapter_TeX_Equb.png)

记录的这个位置或哈希*q* [*v*]然后被添加到一个文件中，该文件包含患者在 JSON(JavaScript 对象表示)格式的每次医院访问的详细信息，此后称为主文件![$$ {M}_{Pi}^{\prime } $$](img/513458_1_En_3_Chapter_TeX_IEq1.png)*P* [*i*]的患者。为每次医院访问创建一个对象*J* [*v*]，其中包含医院*H* [*j*]的标识符（名称），访问日期*σ* [*v*]，保险结算状态*δ* [*v*]和存储记录的内容哈希*q* [*v*]（也称为位置哈希和内容 ID）。

![$$ {J}_v=\left({H}_j,{\sigma}_v,{\delta}_v,{q}_v\right) $$](img/513458_1_En_3_Chapter_TeX_Equc.png)

让当前的主文件是所有这样的*J* [*k*]的集合，其中*k* = 1*,* 2*,* 3*,* …*, n*代表*n*次医院访问，

![$$ {M}_{Pi}^{\prime }=\left\{{J}_1,{J}_2,{J}_3,\dots, {J}_n\right\} $$](img/513458_1_En_3_Chapter_TeX_Equd.png)在将数据*J* [*v*]添加到*M* [*Pi*]后，新的主文件*M* [*P*] ^(*t*)将被![$$ {M}_{Pi}^{\prime }=\left\{{J}_1,{J}_2,{J}_3,\dots, {J}_n,{J}_v\right\} $$](img/513458_1_En_3_Chapter_TeX_Eque.png)这个新生成的主文件![$$ {M}_{Pi}^{\prime } $$](img/513458_1_En_3_Chapter_TeX_IEq2.png)在使用身份号*K* [*P*]对称加密后，*K* [*P*]的身份号，然后将其存储在 IPFS 上。这返回主文件本身的新位置。![$$ E=\mathrm{AES}\left({M}_{Pi}^{\prime }, {K}_{Pi}\right)\vspace*{-10pt} $$](img/513458_1_En_3_Chapter_TeX_Equf.png)![$$ Q=U\ (E) $$](img/513458_1_En_3_Chapter_TeX_Equg.png)

主文件的此位置(*Q*)然后使用非对称加密(RSA)进行加密，结果(*L*)通过交易存储到区块链上。各种读/写访问控制功能也通过几个区块链交易进行管理。

RSA 接收数据*Q*和患者*P* [*i*]的公钥*α* [*Pi*]，并返回加密值。

![$$ L=\mathrm{RSA}\left(Q,\kern0.5em {\alpha}_{Pi}\right) $$](img/513458_1_En_3_Chapter_TeX_Equh.png)

这种非对称加密的哈希值*L*只能由患者的秘密私钥解码，该私钥只有患者知道。

写入功能通过患者的授权进行控制。它仅限于医院，在那里他们可以为患者添加新记录，并且可以解决患者在医院就诊产生的医疗费用的保险索赔的保险公司。读取功能适用于所有实体，但授权再次由患者掌握。每当实体希望查看记录时，应用程序通过区块链和 IPFS 获取记录，然后在用户界面上呈现它们。

在每次读取操作中，患者首先使用他们的私钥解码加密位置，然后通过对解密后的位置再次使用读取器的公钥进行对称加密，并通过区块链分享给读取器实体。

## 5 实施细节

以下部分包含系统的两个主要组件的详细信息：患者智能合约和患者主文件的结构。

### 智能合约 Solidity 实现伪代码

合同 Medicaladdress 私有所有者；字符串私有 medicalLocationHash；地址公共读取器；地址公共写入器；映射（地址= > 字符串）公共 readHash；映射（地址= > 布尔值）公共可以写入；function RevokeRead（地址内存读取器地址）公共 readHash [readerAddress] = "";function Read（地址内存读取器地址）公共视图返回（字符串内存）返回 readHash [readerAddress]；function Write（字符串内存位置哈希，地址内存写入器地址）公共需要（canWrite [writerAddress] == true，“您没有写入权限”）；medicalLocationHash = locationHash；canWrite [writerAddress] = false；function AcquireReadPermission（地址内存读取器地址）公共读取器 = 读取器地址；function AcquireWritePermission（地址内存写入器地址）公共写入器 = 写入器地址；读取器 = 写入器地址；function GrantWritePermission（字符串内存加密位置哈希）公共需要（所有者== msg.sender，“您不能授予写入权限”）；需要（字节（写入器）.length！= 0，“无写入者！”）；GrantReadPermission（加密位置哈希）；canWrite [writer] = true；写入器 = "";function GrantReadPermission（字符串内存加密位置哈希）公共需要（所有者== msg.sender，“您不能授予读取权限”）；需要（字节（读取器）.length！= 0，“无读取器！”）；readHash [读取器] = 加密位置哈希；读取器 = "";function CheckWritePermission（地址内存写入器地址）公共视图返回（布尔值）返回 canWrite [writerAddress]；function ViewLocationHash（）公共视图返回（字符串内存）返回 medicalLocationHash；function ViewReader（）公共视图返回（字符串内存）返回 reader；function ViewWriter（）公共视图返回（字符串内存）返回 writer；

### 患者主文件的结构

{患者姓名，患者出生日期，患者性别，[就诊一：{医院名称，就诊日期，索赔结算状态，就诊数据}，就诊二：{医院名称，就诊日期，索赔结算状态，就诊数据} ...]}

## 6 工作流程

提议系统中的实体执行的两个主要操作是读取记录和写入记录。

### 读取操作

系统中的读操作是所有实体都可以执行的通用操作。在其中，各种实体可以在被授权的情况下搜索和访问患者的记录。读操作是一个单次过程。一旦获得授权，实体只能访问记录一次，并且每次再次访问时都需要获得记录所有者的许可（见图 2）。![](img/513458_1_En_3_Fig2_HTML.png)

图 2

读取操作

读操作始于医院（或保险公司）在应用用户界面中搜索患者并请求其查看记录的权限。此操作将医院的地址存储在智能合约的一个变量中。现在，患者授予读取权限。首先获取存储在智能合约的主文件的 CID（内容 ID），然后使用患者的公钥加密的 CID，现在可以使用其私钥解密。该私钥不会存储在任何地方，并且是使用仅患者知道的秘密密码生成的。现在，将主文件的此解密 CID 使用医院的公钥进行加密。然后，通过交易，患者将此新加密的 CID 以与医院的公钥相关联的映射形式存储在智能合约中。这确保了现在医院只能通过患者授权的特定地址访问记录。

现在医院继续查看患者的记录。这通过智能合约交互完成，其中读取映射变量。这会匹配医院的地址并返回存储在映射中的 CID。该 CID 是使用医院的公钥加密的，因此现在只能使用其私钥解密。医院通过使用其秘密密码生成其私钥来解密 CID。然后使用此解密的 CID 从 IPFS 获取主文件。现在可以使用其在主文件中存储的 CID 检索以前的任何记录。获取的记录进一步解密，因为它们是使用患者的唯一 ID 号进行对称加密的。因此，使用唯一的 ID 号解密记录，然后将它们显示在应用程序界面上供医院/保险公司查看。

对于患者来说，读取操作非常简单，因为他们完全掌握了访问控制。患者可以通过在应用程序界面中点击来直接查看其记录。CID 是从智能合约中获取的，该合约由患者拥有和控制，因此不需要任何权限。然后从 IPFS 获取主文件，并从中读取患者希望查看的任何记录的 CID。

### 写操作

医院的写操作是指医院记录生成并且保险公司结算在患者就诊时产生的账单。患者不被允许进行任何形式的写操作。

对于写操作，医院首先在应用程序界面中搜索患者，并请求允许患者添加新记录。这个授权机制被写入区块链智能合约中，因此无法被篡改。当医院请求写权限时，它将其地址作为参数发送到智能合约，智能合约在其中存储了用户名和一个布尔值（true 或 false）之间的映射，指示用户名是否被允许向智能合约写入。在医院发出写请求后，患者登录他们的账户，并授予写权限，在此过程中创建了对智能合约的调用，更新了医院用户名的映射为 true；此授权只能由智能合约的所有者，即患者，发出。现在医院已经准备好为患者添加新记录（图 3）。

图 3

医院的写操作

一旦授权被授予，医院端的应用程序界面会重定向到一个表单，在此表单中，可以填写关于患者就诊的所有细节，并附加任何照片或文件。当医院提交记录时，首先使用患者的唯一 ID 号作为密钥对记录进行对称加密，然后将其存储在 IPFS 上，并返回与此存储记录相关联的 CID。现在从 IPFS 获取主文件。将存储记录的 CID 添加到主文件中，并将其他细节，如就诊日期、医院名称和保险结算状态，以 JavaScript 对象的形式添加到主文件中，并且主文件以 JSON 格式存储。现在，这个主文件存储在 IPFS 上，并且获得了一个 CID。然后，使用患者的公钥加密主文件的 CID，并将其存储在智能合约中。这完成了医院的写操作。请注意，写操作授权自然附带读取记录的权限。  

对于保险公司而言，请求和允许权限的过程与医院类似。区别在于，当患者允许时，医院会被重定向到一个记录页面，在那里他们可以添加一个新记录。相反，保险公司被重定向到一个理赔页面，在那里他们可以简单地查看和为患者的保险理赔结算。保险理赔结算状态被保存为一个与该次访问相关的对象中的真或假的映射，存储在主文件中。当保险公司结算了理赔时，映射被设为真，理赔被期望已经结算。这种映射的改变会在更改后的主文件存储在 IPFS 上时生成一个新的 CID。这个新的 CID 被存储在智能合约中，并用患者的公钥加密。这完成了保险公司的写操作（图 4）。![](img/513458_1_En_3_Fig4_HTML.png)

图 4

保险公司的写操作

## 7 分析

### 安全性和可访问性

在我们的解决方案中，我们使用了区块链和 IPFS 来存储数据，结合了各种加密方案。区块链允许安全、不可篡改的交易记录，并与智能合约功能集成。它产生了迄今为止最有效和安全的系统之一。由于公共账本的存在，该系统更加透明，由于没有任何中心故障点，所以更加安全，而由于始终可用，因此更加可访问和可互操作，任何人都可以在世界任何地方使用。

作为存储解决方案的 IPFS，像区块链一样的分布式系统，提供了类似的可访问性和互操作性好处。IPFS 的内容寻址功能为系统提供了完整性和安全性，确保数据不会被更改或篡改。

加密方案用于数据的安全存储和共享。患者数据使用患者已知的密钥进行对称加密，并且数据的位置再次使用患者的私钥进行非对称加密。每次数据共享时，都进行加密，以便只有患者允许的人才能解密和访问数据。

在数据存储和共享的每一个步骤中使用区块链、IPFS 和加密技术使得数据几乎不可能被任何方式篡改，并使得系统更加安全、可访问和可互操作。

### 隐私

我们的解决方案具有以患者为中心的隐私感知访问控制。从数据生成到存储和共享，每个步骤都由患者控制访问。我们使用对称和非对称加密技术的组合存储数据，并由患者决定和拥有密钥，使患者成为其数据的真正所有者。通过不可篡改的智能合约代码将访问控制权交给患者，使我们的解决方案完全以患者为中心。没有人可以在没有明确许可的情况下访问或使用属于某个人的任何类型的数据。要访问数据，任何实体都需要解密的 CID 和唯一的患者 ID，这些只存储在并且由患者管理。因此，患者隐私和数据所有权是我们解决方案的主要卖点，并且以最严格的方式确保。

## 8 结论与未来工作

### 结论

本章研究并开发了一个系统，用于在维护医疗健康记录方面应用区块链技术，比当前系统允许的更安全、更私密。区块链是当前去中心化革命前沿的技术，旨在为使用技术解决方案的每个领域提供更多安全性和隐私性。医疗记录是一个迫切需要此类革命性解决方案的领域，考虑到此类记录的敏感性和重要性。我们基于区块链的电子医疗记录解决方案提高了安全性、可访问性和互操作性，同时超过传统记录保存系统。

### 未来工作

应用程序的当前版本使用以太坊进行区块链目的。由于大量节点在每笔交易上达成共识，每笔以太坊交易的时间和成本非常高，而且随着技术的不断发展，这些成本和时间在未来肯定会增加。这种高昂的成本降低了当前解决方案的可行性。使用不同共识算法的不同区块链技术可能有助于降低这些成本。需要评估成本和去中心化之间的平衡，以找到这些其他区块链技术的最优解。

除此之外，当前解决方案使用基于 RSA 密钥的非对称加密，这些密钥是从需要被实体记住的密码短语中派生出来的。在应用程序中保持数据安全性，记住密码短语以及使用强密码短语都是必不可少的。然而，记住这样的密码短语变得具有挑战性，因此像生物特征加密这样的加密技术可以改进解决方案，并使其更易于使用。需要评估不同加密技术的有效性，同时又不会 compromis 安全性，以找到最优解。

此外，当前解决方案为先前列出的实体（即患者、医院和保险机构）提供了完整的功能支持。然而，该解决方案可以进一步扩展，以提供用于研究目的的批量数据，并让患者控制他们的数据。
