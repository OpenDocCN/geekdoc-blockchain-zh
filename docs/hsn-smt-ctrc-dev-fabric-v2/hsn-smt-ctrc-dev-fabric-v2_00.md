# 前言

区块链目前是塑造下一代金融科技的先驱技术，提供透明且快速的交易处理、更高的金融数据可用性、更好的安全性以及金融行业的巨大成本节约。通过引入使第三方和中间人角色过时的去中心化权威，区块链已经引发了传统金融机构和其他行业经营业务方式的范式转变。

最近的一项 Gartner 调查显示，超过 40%的公司至少有一个区块链试点项目正在进行中。Gartner 还预测，全球 30%的区块链项目将进入生产阶段。同样，全球区块链市场正在增长，体现在目前有大量福布斯全球 2000 家公司正在尝试数字信任实施。

[Gartner](https://www.gartner.com/en/newsroom/press-releases/2019-07-03-gartner-predicts-90--of-current-enterprise-blockchain)预测，从 2021 年开始的 18 个月内，90%的企业区块链平台部署将需要更换，以保持竞争力和安全性，并防止过时。Gartner 还预测，到 2025 年，区块链产生的商业价值将逐渐上升至 1760 亿美元，然后在 2030 年超过 3.1 万亿美元。

由于区块链的普及，开发者社区积极贡献了几种私有和公共分布式分类账技术（DLT）来构建区块链应用。在现有的 DLT 中，Hyperledger 是构建企业许可区块链应用的领先平台。通过设计，Hyperledger 嵌入了用于构建、扩展和管理企业区块链应用的功能、工具和库。

本书的目的是向您展示如何使用 Hyperledger Fabric 构建私有企业区块链系统，并组装 Fabric 的各个组件，以创建和维护一个强大、安全和可扩展的区块链应用程序。

自 2018 年以来，我们通过我们的公司 Hashflow 和 Coding Bootcamps 提供区块链咨询、开发和培训服务。在[Hashflow](http://www.hashflow.us)，我们建议各种规模的公司利用区块链技术和金融科技来克服业务挑战或通过全新愿景带来可预见的价值。我们还与金融科技、医疗保健、音乐和能源等行业的开拓性公司合作，利用区块链技术构建软件即服务（SaaS）产品。我们的团队由业界领先的实践者组成，他们已将区块链框架应用于传统业务模式和新颖创业中，实现了期望的收益。

除了 Hashflow 之外，我们成立了一家培训公司，为希望在内部构建和部署区块链解决方案的潜在雇员建立能力和技能。关于我们（个人或企业）的培训经验，我们注意到大多数初学者缺乏（如 Linux bash 脚本、Docker 或 Go 编程）的先决技能，这些技能对于掌握 Hyperledger Fabric 至关重要。因此，在编码训练营，我们量身定制了培训计划，以满足多种商业需求。您可以从访问以下我们公司网站上的页面开始：

+   [编码训练营](https://www.coding-bootcamps.com/) 公司

+   [自学培训](https://learn.coding-bootcamps.com/p/coding-and-technology-training-bundles)

+   [现场团体和混合培训](https://learn.coding-bootcamps.com/p/coding-bootcamps-live-tutoring-and-group-training-sessions)

+   [密集型区块链训练营](https://www.coding-bootcamps.com/education-blockchain-design-and-development-immersive-training.php)

我们的区块链课程提供英语和西班牙语两种语言。此外，针对超级账本，我们提供两门课程：Fabric 系统管理和 Fabric 开发。虽然系统管理课程为学生准备了认证超级账本 Fabric 管理员（CHFA）考试，但开发课程涵盖了认证超级账本 Fabric 开发者（CHFD）考试中的主题。

在过去几年中，我们创造的所有课程中，我们最自豪的是我们的区块链工程训练营。它提供超过 180 小时的现场和录制指导，许多实践实验室，并在完成测验和最终项目后提供结业证书。我们每年多次举办区块链训练营，并在每个队列中更新和改进。在线项目是首个其类别的，因为每组中的优秀学生还将被推荐给我们的雇主网络。

# 如何使用超级账本构建企业区块链应用

当前，一个又一个行业都在试验区块链。目前领导区块链应用案例的主要行业包括房地产、医疗保健、政府、高等教育、物流、航空、金融和能源。在这些行业中，金融业更愿意采用各种区块链应用案例。例如，根据国际清算银行（BIS）的一份报告，全球 80%的中央银行正在研究数字货币的优缺点。

根据我们在金融科技客户方面的个人经验，包括私人银行，许多金融机构和独立企业家正在探索数字银行的概念。在这样做的过程中，他们希望利用区块链技术提供银行产品，如数字货币、数字钱包、点对点支付、贷款和信用、实用代币以及安全代币。同样，我们已经经历了银行对于为他们的数字银行实施了解您的客户和反洗钱指南的需求的增长，而我们通常使用超级账本分布式账本技术（DLT）如 Fabric、Aries 或 Indy 来管理他们的客户身份。

无论用例或行业如何，所有企业区块链实施都不可避免地经历四个阶段：概念验证（PoC）、最小可行产品、生产引入集成以及维护（包括性能监控和扩展）。根据我们在企业区块链开发方面的个人经验，大多数大型企业都会遇到两个问题：

+   充满激情的技术团队和对区块链技术只有基础知识的高层管理之间的沟通不畅

+   缺乏与当前系统集成的适当规划

要解决第一个问题，公司需要为其高管提供高水平的培训。对于第二个问题，开发人员需要能够访问像无服务器架构这样的解决方案，这些解决方案可以最小化对当前系统运行的干扰。

在使用 Hyperledger 构建私有企业区块链应用时，您可以利用多种分布式分类账技术（DLT）、工具和库。例如，Hyperledger Grid DLT 非常适合构建和管理企业供应链应用，我们在最后一章中进行了介绍。虽然一些 Hyperledger 工具和库仍处于孵化阶段（正如我们将在第二章中讨论的那样），但一旦所有 Hyperledger 成员都活跃起来，它们将共同为开发人员和系统管理员提供一套完整的工具，用于构建和管理企业联盟区块链应用。由于业界广泛采用，Hyperledger Fabric 是 Hyperledger 生态系统内领先的分布式分类账技术。因此，我们涵盖了对于所有企业区块链应用都至关重要的 Hyperledger Fabric 组件。

从我们的个人经验来看，我们一次又一次地看到，成功地开发企业区块链应用取决于几个因素，包括可扩展的架构、云服务提供商的选择、性能监控、与现有系统的集成、安全审计、智能合约生命周期管理、链外数据管理和文档编制。仅仅掌握链码或者 Fabric 组件本身并不足以成功部署和扩展区块链应用。例如，正如我们在第八章中讨论的那样，选择合适的云服务提供商需要考虑多个因素，因为每个提供商在其平台上为构建企业区块链提供了众多功能和服务，以及与同一提供商提供的其他服务集成和升级应用的各种方法。

# 这本书是为谁准备的？

本书涵盖的主题面向想要使用 Hyperledger 构建企业私有区块链应用或参加认证的 Hyperledger Fabric 开发者（CHFD）考试的初学者。然而，从高层次来看，Hyperledger Fabric 专业人员有两条主要的职业路线：Fabric 系统管理和 Fabric 开发。每条职业路线都需要不同的技能和能力，可以通过参加 Linux Foundation 提供的认证 Hyperledger Fabric 管理员（CHFA）或 CHFD 考试进行验证。

要成为一名专业的 Fabric 开发者，你应该知道如何设计、开发、测试、部署和调用 Fabric 智能合约。简而言之，你需要非常熟悉本书涵盖的以下七个主题：

+   定义交易函数

+   执行简单查询

+   创建复杂查询

+   使用键值对定义资产

+   辨别潜在的私有数据

+   整合私有数据收集

+   通过调用智能合约提交、评估和查询交易

简言之，作为一个 Fabric 开发者，你应该展示你打包和部署 Fabric 应用程序和智能合约的能力，执行端到端的 Fabric 应用程序生命周期和智能合约管理，并且能够使用 Java、JavaScript 或 Go 进行编程。

# 章节概览

本书的章节遵循自顶向下的层次结构，从介绍区块链技术到部署智能合约。具体来说，本节提供了每章的摘要。

第一章，*区块链的基本概念* 介绍了所有区块链平台通用的基本组件。特别是，对加密、共识和智能合约等概念进行了简明扼要的解释。

第二章，*Hyperledger 项目和工具概述* 为您提供了对 Hyperledger 生态系统的高层概述，包括所有 Hyperledger 家族成员之间的共同组件。 它继续简要讨论所有 Hyperledger 分布式账本技术（DLT）、工具和库。

第三章，*Hyperledger Fabric 架构和组件* 讨论了 Hyperledger Fabric 架构以及其主要组件，如成员服务提供者、策略、对等体、订购方、智能合约、Fabric 网络等等。

第四章，*智能合约开发* 展示了如何使用 JavaScript 编程语言编写您的第一个 Fabric 智能合约。 它涵盖了诸如定义智能合约类、安装和实例化智能合约、验证和清理输入和参数、运行简单或复杂查询、处理私有数据等实践性主题。

第五章，*智能合约调用* 展示了如何通过命令行界面调用智能合约，提交交易，查询交易等等。 您还将学习如何创建和发布应用合约。

第六章，*测试与维护* 讨论了实践性的主题，如如何处理错误和处理响应。 它还向您展示了如何在智能合约上运行单元测试。 此外，通过构建一个作为智能合约客户端的 Fabcar UI web 应用程序，您将学习如何执行 Fabric 维护任务。 通过向 Fabcar UI 添加功能，我们将为您提供测试和调试 Fabric 智能合约的实践步骤。

第七章，*使用 Hyperledger Fabric 构建供应链 DApps* 讲述了使用 Fabric 构建的端到端制药供应链。这是一个将从前几章获得的知识付诸实践的完整项目。在这个过程中，您将学习如何为区块链供应链设计架构，编写用于跟踪库存的智能合约，编译和部署智能合约等。此外，您还将学习如何通过 SDK 开发使用 Hyperledger Fabric 的应用程序。

第八章，*在云上部署超级账本 Fabric* 展示了如何在三个流行的云服务提供商上设置和部署 Fabric：亚马逊网络服务（Amazon Web Services）、IBM 和 Oracle。通过实例项目的实践，我们将指导您在每个云平台上设置 Fabric 网络并部署智能合约，并解释使用每个平台的主要考虑因素。

第九章，*Hyperledger Fabric V2 集成* 介绍了 Fabric v2 提供的新功能，如新的链码应用程序模式、外部链码启动器、基于 Alpine 的 Docker 镜像等。我们还讨论了如何更新通道的能力级别以及升级 Fabric 组件，以及升级到 Fabric V2 的主要考虑因素。

第十章，*其他 Hyperledger 项目概述*介绍了四个更多的 Hyperledger 家族成员：Hyperledger Aries、Hyperledger Avalon、Hyperledger Besu 和 Hyperledger Grid。具体而言，我们展示了如何利用 Aries 管理身份，并使用 Avalon 安全地移动和处理区块链数据。我们还展示了如何使用 Besu 来运行具有不同共识算法的公共和私有区块链应用程序。最后，我们演示了如何使用 Grid 来构建和管理端到端的区块链供应链。

# 本书中使用的约定

本书使用以下印刷约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名和文件扩展名。

`固定宽度`

用于程序清单，以及在段落中引用程序元素，例如变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

`**固定宽度粗体**`

显示用户应按字面输入的命令或其他文本。

`*固定宽度斜体*`

显示应替换为用户提供的值或由上下文确定的值的文本。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般说明。

###### 警告

此元素指示警告或注意事项。

# 使用代码示例

本书提供了补充材料（代码示例、练习等），可在[*https://myhsts.org/hyperledger-fabric-book/*](https://myhsts.org/hyperledger-fabric-book/)下载。

如果您有技术问题或使用代码示例时遇到问题，请发送电子邮件至*bookquestions@oreilly.com*。

本书旨在帮助您完成工作任务。一般而言，如果本书提供了示例代码，您可以在您的程序和文档中使用它。除非您复制了大量代码，否则您无需联系我们获得许可。例如，编写一个使用了本书多个代码片段的程序不需要许可。销售或分发来自 O’Reilly 图书的示例需要许可。通过引用本书并引用示例代码回答问题不需要许可。将本书的大量示例代码纳入您产品的文档中需要许可。

我们感谢，但不需要，署名。署名通常包括标题、作者、出版商和 ISBN。例如：“Hands-on Smart Contract Development with Hyperledger Fabric V2 by Matt Zand, Xun Wu, and Mark Anthony Morris (O’Reilly)。版权所有 2021 WEG2G LLC，978-1-492-08612-3。”

如果您觉得您对代码示例的使用超出了合理使用范围或上述许可，请随时通过 *permissions@oreilly.com* 联系我们。

# O’Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](http://oreilly.com) 提供技术和商业培训、知识和见解，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专业知识。O’Reilly 的在线学习平台为您提供按需访问实时培训课程、深入学习路径、交互式编码环境以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。有关更多信息，请访问 [*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题发送至出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或本地）

+   707-829-0104（传真）

我们有一本这本书的网页，其中列出了勘误、示例和任何额外信息。您可以访问此页面：[*https://oreil.ly/smart-contract-development*](https://oreil.ly/smart-contract-development)。

通过电子邮件 *bookquestions@oreilly.com* 对本书提出评论或技术问题。

欲了解我们的图书和课程的最新消息，请访问：[*http://oreilly.com*](http://oreilly.com)。

在 Facebook 上关注我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)

在 YouTube 上观看我们：[*http://youtube.com/oreillymedia*](http://youtube.com/oreillymedia)

# 致谢

在撰写本书的过程中，我们得到了许多优秀人士的大力支持。非常感谢每个帮助使这本书成为现实的人！我们特别要向以下人表示衷心的感谢。

在整本书的整个生命周期中，O’Reilly 的每个人都非常棒，值得合作。感谢我们的编辑 Gary O’Brien、Michelle Smith 和 Chris Faucher，感谢你们的大力支持、持续鼓励和深思熟虑的反馈。同时也感谢 Katie Tozer 和 Jonathan Hassell 在这段旅程中的支持。

感谢 Ashwani Kumar、Sergio Torres 和 Sushma Varadaiah 对整本书进行的审阅，并提供了许多有用的建议和深入的评论。你们的审阅使最终草稿变成了一本更好的书。感谢你们花费了大量时间对书籍进行如此详细的审阅。

感谢 Angelo De Caro 和 Sergio Torres 为 第二章 和 第三章 做出的贡献。

特别感谢甲骨文团队的维克·阿恰里亚对第八章关于在甲骨文云平台上开发 Hyperledger Fabric 的细节的贡献。同样，我们深深感谢 IBM 团队的 Shikha Maheshwari 对该章节关于在 IBM 云平台上开发 Hyperledger Fabric 的信息的贡献。

感谢杰森·贾恩持续为我们带来与具有前瞻性的企业家和进步性公司合作的好运，共同致力于世界各地真正令人兴奋和价值驱动的区块链项目。

感谢在各个阶段帮助的其他贡献者：Abhik Banerjee、Robin Pilling、Mohammed Nihal Ansari 和 Jim Sullivan。

没有我的合著者吴（勋）斌和马克·安东尼·莫里斯，这篇文章将无法问世。感谢你们的友谊、鼓励和无尽的耐心。我很高兴我们能够一起完成这篇文章。

**吴（勋）斌**

我要感谢我的家人和朋友在整个努力过程中的耐心和支持。

感谢 O’Reilly 富有才华的团队在整个项目中提供的及时指导和宝贵反馈。

**马克·安东尼·莫里斯**

致我亲爱的母亲格蕾丝·莫里斯——我的灵感、目标和力量，让我努力不懈，永不放弃。谢谢你，妈妈。我爱你！
